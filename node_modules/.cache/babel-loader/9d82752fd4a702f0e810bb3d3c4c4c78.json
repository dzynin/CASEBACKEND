{"ast":null,"code":"var _jsxFileName = \"/home/taymur/Documents/legal2/DATA/Highlight/newmerged/CASEFRONTt/src/shared/Chatbox.js\";\nimport React, { useState, useEffect, useRef } from 'react';\nimport io from 'socket.io-client'; // Import socket.io-client\nimport '../style/theme-styles/components/Chatstyles.css';\nconst ChatUI = ({\n  socket: propSocket,\n  publicId,\n  pdfDocumentName\n}) => {\n  const [messages, setMessages] = useState([{\n    id: 1,\n    nickName: 'Casebook AI',\n    message: 'Hello there!',\n    type: 'me'\n  }]);\n  const [inputText, setInputText] = useState('');\n  const [messageId, setMessageId] = useState(2); // Start from 2 since the initial message has id 1\n  const socketRef = useRef();\n  useEffect(() => {\n    if (propSocket) {\n      socketRef.current = propSocket;\n    } else {\n      const newSocket = io(\"http://localhost:8000\");\n      socketRef.current = newSocket;\n      console.log(\"Socket connection established\");\n      return () => {\n        newSocket.disconnect();\n        console.log(\"Socket disconnected\");\n      };\n    }\n  }, [propSocket]);\n  const sendMessage = (text, sender = 'Yahya') => {\n    if (text.trim()) {\n      console.log('Sending message:', text);\n      const newMessage = {\n        id: messageId,\n        nickName: sender,\n        message: text,\n        type: sender === 'Yahya' ? 'user' : 'me',\n        publicId: publicId,\n        pdfDocumentName: pdfDocumentName\n      };\n      setMessages(prevMessages => [...prevMessages, newMessage]);\n      setMessageId(prevId => prevId + 1); // Increment the message ID only for user messages\n      if (sender === 'Yahya' && socketRef.current) {\n        console.log('Emitting to socket:', text);\n        socketRef.current.emit('openai-chat', {\n          query: newMessage\n        });\n      }\n    }\n  };\n  useEffect(() => {\n    if (socketRef.current) {\n      const handleResponse = response => {\n        console.log('Received response:', response);\n        const newMessage = {\n          id: messages.length + 1,\n          // Keep the same id as the previous message\n          nickName: 'Casebook AI',\n          message: response.recommendation,\n          type: 'me'\n        };\n        setMessages(prevMessages => [...prevMessages, newMessage]);\n      };\n      socketRef.current.on('openai-query-response', handleResponse);\n      return () => {\n        socketRef.current.off('openai-query-response', handleResponse);\n      };\n    }\n  }, [messages.length]);\n  const handleSend = () => {\n    sendMessage(inputText);\n    setInputText(''); // Clear the input after sending the message\n  };\n  return /*#__PURE__*/React.createElement(\"div\", {\n    id: \"chat\",\n    className: \"--dark-theme\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"chat__conversation-board\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 13\n    }\n  }, messages.map((msg, index) => /*#__PURE__*/React.createElement(\"div\", {\n    key: index,\n    className: `chat__conversation-board__message-container ${msg.type === 'me' ? 'me' : 'user'}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"chat__conversation-board__message__person\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 25\n    }\n  }, msg.type === 'me' && /*#__PURE__*/React.createElement(\"img\", {\n    src: \"/static/media/scaletransm2.5eb52ef8.png\",\n    alt: msg.nickName,\n    style: {\n      width: '35px',\n      height: '35px',\n      borderRadius: '50%'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 33\n    }\n  }), /*#__PURE__*/React.createElement(\"p\", {\n    className: \"chat__conversation-board__message__person__nickname\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 29\n    }\n  }, msg.nickName)), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"chat__conversation-board__message__context\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: `chat__conversation-board__message__bubble ${msg.type === 'user' ? 'user-message' : ''}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 29\n    }\n  }, msg.message))))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"chat__conversation-panel\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    className: \"chat__conversation-panel__input\",\n    placeholder: \"Ask Casebook AI a question about this document...\",\n    value: inputText,\n    onChange: e => setInputText(e.target.value),\n    onKeyDown: e => {\n      if (e.key === 'Enter') {\n        handleSend();\n      }\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    className: \"chat__conversation-panel__button\",\n    onClick: handleSend,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"svg\", {\n    viewBox: \"0 0 24 24\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M2 21l21-9L2 3v7l15 2-15 2v7z\",\n    fill: \"currentColor\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 25\n    }\n  })))));\n};\nexport default ChatUI;","map":{"version":3,"names":["React","useState","useEffect","useRef","io","ChatUI","socket","propSocket","publicId","pdfDocumentName","messages","setMessages","id","nickName","message","type","inputText","setInputText","messageId","setMessageId","socketRef","current","newSocket","console","log","disconnect","sendMessage","text","sender","trim","newMessage","prevMessages","prevId","emit","query","handleResponse","response","length","recommendation","on","off","handleSend","createElement","className","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","map","msg","index","key","src","alt","style","width","height","borderRadius","placeholder","value","onChange","e","target","onKeyDown","onClick","viewBox","fill","xmlns","d"],"sources":["/home/taymur/Documents/legal2/DATA/Highlight/newmerged/CASEFRONTt/src/shared/Chatbox.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport io from 'socket.io-client'; // Import socket.io-client\nimport '../style/theme-styles/components/Chatstyles.css';\n\nconst ChatUI = ({ socket: propSocket, publicId, pdfDocumentName }) => {\n    const [messages, setMessages] = useState([\n        { id: 1, nickName: 'Casebook AI', message: 'Hello there!', type: 'me' }\n    ]);\n    const [inputText, setInputText] = useState('');\n    const [messageId, setMessageId] = useState(2); // Start from 2 since the initial message has id 1\n    const socketRef = useRef();\n\n    useEffect(() => {\n        if (propSocket) {\n            socketRef.current = propSocket;\n        } else {\n            const newSocket = io(\"http://localhost:8000\");\n            socketRef.current = newSocket;\n            console.log(\"Socket connection established\");\n\n            return () => {\n                newSocket.disconnect();\n                console.log(\"Socket disconnected\");\n            };\n        }\n    }, [propSocket]);\n\n    const sendMessage = (text, sender = 'Yahya') => {\n        if (text.trim()) {\n            console.log('Sending message:', text);\n            const newMessage = {\n                id: messageId,\n                nickName: sender,\n                message: text,\n                type: sender === 'Yahya' ? 'user' : 'me',\n                publicId: publicId,\n                pdfDocumentName: pdfDocumentName\n            };\n            setMessages(prevMessages => [...prevMessages, newMessage]);\n            setMessageId(prevId => prevId + 1); // Increment the message ID only for user messages\n            if (sender === 'Yahya' && socketRef.current) {\n                console.log('Emitting to socket:', text);\n                socketRef.current.emit('openai-chat', { query: newMessage });\n            }\n        }\n    };\n\n    useEffect(() => {\n        if (socketRef.current) {\n            const handleResponse = (response) => {\n                console.log('Received response:', response);\n                const newMessage = {\n                    id: messages.length + 1, // Keep the same id as the previous message\n                    nickName: 'Casebook AI',\n                    message: response.recommendation,\n                    type: 'me'\n                };\n                setMessages(prevMessages => [...prevMessages, newMessage]);\n            };\n\n            socketRef.current.on('openai-query-response', handleResponse);\n\n            return () => {\n                socketRef.current.off('openai-query-response', handleResponse);\n            };\n        }\n    }, [messages.length]);\n\n    const handleSend = () => {\n        sendMessage(inputText);\n        setInputText(''); // Clear the input after sending the message\n    };\n\n    return (\n        <div id=\"chat\" className=\"--dark-theme\">\n            <div className=\"chat__conversation-board\">\n                {messages.map((msg, index) => (\n                    <div key={index} className={`chat__conversation-board__message-container ${msg.type === 'me' ? 'me' : 'user'}`}>\n                        <div className=\"chat__conversation-board__message__person\">\n                            {msg.type === 'me' &&\n                                <img src=\"/static/media/scaletransm2.5eb52ef8.png\" alt={msg.nickName} style={{ width: '35px', height: '35px', borderRadius: '50%' }} />\n                            }\n                            <p className=\"chat__conversation-board__message__person__nickname\">{msg.nickName}</p>\n                        </div>\n                        <div className=\"chat__conversation-board__message__context\">\n                            <span className={`chat__conversation-board__message__bubble ${msg.type === 'user' ? 'user-message' : ''}`}>{msg.message}</span>\n                        </div>\n                    </div>\n                ))}\n            </div>\n            <div className=\"chat__conversation-panel\">\n                <input\n                    className=\"chat__conversation-panel__input\"\n                    placeholder=\"Ask Casebook AI a question about this document...\"\n                    value={inputText}\n                    onChange={(e) => setInputText(e.target.value)}\n                    onKeyDown={(e) => {\n                        if (e.key === 'Enter') {\n                            handleSend();\n                        }\n                    }}\n                />\n                <button className=\"chat__conversation-panel__button\" onClick={handleSend}>\n                    <svg viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n                        <path d=\"M2 21l21-9L2 3v7l15 2-15 2v7z\" fill=\"currentColor\"/>\n                    </svg>\n                </button>\n            </div>\n        </div>\n    );\n};\n\nexport default ChatUI;\n"],"mappings":";AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,EAAEC,MAAM,QAAQ,OAAO;AAC1D,OAAOC,EAAE,MAAM,kBAAkB,CAAC,CAAC;AACnC,OAAO,iDAAiD;AAExD,MAAMC,MAAM,GAAGA,CAAC;EAAEC,MAAM,EAAEC,UAAU;EAAEC,QAAQ;EAAEC;AAAgB,CAAC,KAAK;EAClE,MAAM,CAACC,QAAQ,EAAEC,WAAW,CAAC,GAAGV,QAAQ,CAAC,CACrC;IAAEW,EAAE,EAAE,CAAC;IAAEC,QAAQ,EAAE,aAAa;IAAEC,OAAO,EAAE,cAAc;IAAEC,IAAI,EAAE;EAAK,CAAC,CAC1E,CAAC;EACF,MAAM,CAACC,SAAS,EAAEC,YAAY,CAAC,GAAGhB,QAAQ,CAAC,EAAE,CAAC;EAC9C,MAAM,CAACiB,SAAS,EAAEC,YAAY,CAAC,GAAGlB,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;EAC/C,MAAMmB,SAAS,GAAGjB,MAAM,CAAC,CAAC;EAE1BD,SAAS,CAAC,MAAM;IACZ,IAAIK,UAAU,EAAE;MACZa,SAAS,CAACC,OAAO,GAAGd,UAAU;IAClC,CAAC,MAAM;MACH,MAAMe,SAAS,GAAGlB,EAAE,CAAC,uBAAuB,CAAC;MAC7CgB,SAAS,CAACC,OAAO,GAAGC,SAAS;MAC7BC,OAAO,CAACC,GAAG,CAAC,+BAA+B,CAAC;MAE5C,OAAO,MAAM;QACTF,SAAS,CAACG,UAAU,CAAC,CAAC;QACtBF,OAAO,CAACC,GAAG,CAAC,qBAAqB,CAAC;MACtC,CAAC;IACL;EACJ,CAAC,EAAE,CAACjB,UAAU,CAAC,CAAC;EAEhB,MAAMmB,WAAW,GAAGA,CAACC,IAAI,EAAEC,MAAM,GAAG,OAAO,KAAK;IAC5C,IAAID,IAAI,CAACE,IAAI,CAAC,CAAC,EAAE;MACbN,OAAO,CAACC,GAAG,CAAC,kBAAkB,EAAEG,IAAI,CAAC;MACrC,MAAMG,UAAU,GAAG;QACflB,EAAE,EAAEM,SAAS;QACbL,QAAQ,EAAEe,MAAM;QAChBd,OAAO,EAAEa,IAAI;QACbZ,IAAI,EAAEa,MAAM,KAAK,OAAO,GAAG,MAAM,GAAG,IAAI;QACxCpB,QAAQ,EAAEA,QAAQ;QAClBC,eAAe,EAAEA;MACrB,CAAC;MACDE,WAAW,CAACoB,YAAY,IAAI,CAAC,GAAGA,YAAY,EAAED,UAAU,CAAC,CAAC;MAC1DX,YAAY,CAACa,MAAM,IAAIA,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC;MACpC,IAAIJ,MAAM,KAAK,OAAO,IAAIR,SAAS,CAACC,OAAO,EAAE;QACzCE,OAAO,CAACC,GAAG,CAAC,qBAAqB,EAAEG,IAAI,CAAC;QACxCP,SAAS,CAACC,OAAO,CAACY,IAAI,CAAC,aAAa,EAAE;UAAEC,KAAK,EAAEJ;QAAW,CAAC,CAAC;MAChE;IACJ;EACJ,CAAC;EAED5B,SAAS,CAAC,MAAM;IACZ,IAAIkB,SAAS,CAACC,OAAO,EAAE;MACnB,MAAMc,cAAc,GAAIC,QAAQ,IAAK;QACjCb,OAAO,CAACC,GAAG,CAAC,oBAAoB,EAAEY,QAAQ,CAAC;QAC3C,MAAMN,UAAU,GAAG;UACflB,EAAE,EAAEF,QAAQ,CAAC2B,MAAM,GAAG,CAAC;UAAE;UACzBxB,QAAQ,EAAE,aAAa;UACvBC,OAAO,EAAEsB,QAAQ,CAACE,cAAc;UAChCvB,IAAI,EAAE;QACV,CAAC;QACDJ,WAAW,CAACoB,YAAY,IAAI,CAAC,GAAGA,YAAY,EAAED,UAAU,CAAC,CAAC;MAC9D,CAAC;MAEDV,SAAS,CAACC,OAAO,CAACkB,EAAE,CAAC,uBAAuB,EAAEJ,cAAc,CAAC;MAE7D,OAAO,MAAM;QACTf,SAAS,CAACC,OAAO,CAACmB,GAAG,CAAC,uBAAuB,EAAEL,cAAc,CAAC;MAClE,CAAC;IACL;EACJ,CAAC,EAAE,CAACzB,QAAQ,CAAC2B,MAAM,CAAC,CAAC;EAErB,MAAMI,UAAU,GAAGA,CAAA,KAAM;IACrBf,WAAW,CAACV,SAAS,CAAC;IACtBC,YAAY,CAAC,EAAE,CAAC,CAAC,CAAC;EACtB,CAAC;EAED,oBACIjB,KAAA,CAAA0C,aAAA;IAAK9B,EAAE,EAAC,MAAM;IAAC+B,SAAS,EAAC,cAAc;IAAAC,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,gBACnCjD,KAAA,CAAA0C,aAAA;IAAKC,SAAS,EAAC,0BAA0B;IAAAC,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,GACpCvC,QAAQ,CAACwC,GAAG,CAAC,CAACC,GAAG,EAAEC,KAAK,kBACrBpD,KAAA,CAAA0C,aAAA;IAAKW,GAAG,EAAED,KAAM;IAACT,SAAS,EAAG,+CAA8CQ,GAAG,CAACpC,IAAI,KAAK,IAAI,GAAG,IAAI,GAAG,MAAO,EAAE;IAAA6B,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,gBAC3GjD,KAAA,CAAA0C,aAAA;IAAKC,SAAS,EAAC,2CAA2C;IAAAC,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,GACrDE,GAAG,CAACpC,IAAI,KAAK,IAAI,iBACdf,KAAA,CAAA0C,aAAA;IAAKY,GAAG,EAAC,yCAAyC;IAACC,GAAG,EAAEJ,GAAG,CAACtC,QAAS;IAAC2C,KAAK,EAAE;MAAEC,KAAK,EAAE,MAAM;MAAEC,MAAM,EAAE,MAAM;MAAEC,YAAY,EAAE;IAAM,CAAE;IAAAf,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,CAAE,CAAC,eAE3IjD,KAAA,CAAA0C,aAAA;IAAGC,SAAS,EAAC,qDAAqD;IAAAC,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,GAAEE,GAAG,CAACtC,QAAY,CACnF,CAAC,eACNb,KAAA,CAAA0C,aAAA;IAAKC,SAAS,EAAC,4CAA4C;IAAAC,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,gBACvDjD,KAAA,CAAA0C,aAAA;IAAMC,SAAS,EAAG,6CAA4CQ,GAAG,CAACpC,IAAI,KAAK,MAAM,GAAG,cAAc,GAAG,EAAG,EAAE;IAAA6B,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,GAAEE,GAAG,CAACrC,OAAc,CAC7H,CACJ,CACR,CACA,CAAC,eACNd,KAAA,CAAA0C,aAAA;IAAKC,SAAS,EAAC,0BAA0B;IAAAC,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,gBACrCjD,KAAA,CAAA0C,aAAA;IACIC,SAAS,EAAC,iCAAiC;IAC3CiB,WAAW,EAAC,mDAAmD;IAC/DC,KAAK,EAAE7C,SAAU;IACjB8C,QAAQ,EAAGC,CAAC,IAAK9C,YAAY,CAAC8C,CAAC,CAACC,MAAM,CAACH,KAAK,CAAE;IAC9CI,SAAS,EAAGF,CAAC,IAAK;MACd,IAAIA,CAAC,CAACV,GAAG,KAAK,OAAO,EAAE;QACnBZ,UAAU,CAAC,CAAC;MAChB;IACJ,CAAE;IAAAG,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,CACL,CAAC,eACFjD,KAAA,CAAA0C,aAAA;IAAQC,SAAS,EAAC,kCAAkC;IAACuB,OAAO,EAAEzB,UAAW;IAAAG,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,gBACrEjD,KAAA,CAAA0C,aAAA;IAAKyB,OAAO,EAAC,WAAW;IAACC,IAAI,EAAC,MAAM;IAACC,KAAK,EAAC,4BAA4B;IAAAzB,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,gBACnEjD,KAAA,CAAA0C,aAAA;IAAM4B,CAAC,EAAC,+BAA+B;IAACF,IAAI,EAAC,cAAc;IAAAxB,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,CAAC,CAC3D,CACD,CACP,CACJ,CAAC;AAEd,CAAC;AAED,eAAe5C,MAAM","ignoreList":[]},"metadata":{},"sourceType":"module"}