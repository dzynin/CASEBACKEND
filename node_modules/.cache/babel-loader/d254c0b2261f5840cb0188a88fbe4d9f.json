{"ast":null,"code":"import axios from 'axios';\nimport async from 'async';\nimport { BASE_URL_DEV } from '../utils';\nexport async function fetchAndSetFileHighlights(dispatch, state, files, setIsLoading) {\n  try {\n    async.eachSeries(files, function (element, cbBatch) {\n      axios.get(`${BASE_URL_DEV}/highlights-json/${state.auth.userPublicId}/${element.name}`, {\n        headers: {\n          'x-access-token': state.auth && state.auth.authToken\n        }\n      }).then(function (result) {\n        const fileHighlights = result.data;\n        if (fileHighlights && fileHighlights.highlights) {\n          dispatch({\n            type: \"SET_FILE_HIGHLIGHTS\",\n            payload: {\n              name: element.name,\n              highlights: fileHighlights.highlights\n            }\n          });\n        }\n        cbBatch(null);\n      }).catch(function (error) {\n        cbBatch(error);\n      });\n    }, async loopErrBatch => {\n      if (loopErrBatch) {\n        console.log(loopErrBatch);\n        setIsLoading(false);\n        return;\n      }\n      const result = await axios(`${BASE_URL_DEV}/get/files`, {\n        headers: {\n          \"x-access-token\": state.auth && state.auth.authToken\n        }\n      });\n      const filesResponse = result.data && result.data.files;\n      if (filesResponse && filesResponse.length > 0) {\n        const results = await axios(`${BASE_URL_DEV}/get-graphdata`, {\n          headers: {\n            \"x-access-token\": state.auth && state.auth.authToken\n          }\n        });\n        const allgraphs = results.data;\n        let Obj = {};\n        let _id = \"\";\n        allgraphs.graphdata.forEach(x => {\n          _id = x.fileName;\n          Obj[_id] = x.links.filter(e => e.source === \"CITATION\" || e.source === \"PROVISION\");\n        });\n        const fileNew = filesResponse.map(element => {\n          return {\n            ...element,\n            CITATION: Obj[element.name] && Obj[element.name].length > 0 ? Obj[element.name].filter(e => e.source === \"CITATION\") : [\"N/A\"],\n            PROVISION: Obj[element.name] && Obj[element.name].length > 0 ? Obj[element.name].filter(e => e.source === \"PROVISION\") : [\"N/A\"]\n          };\n        });\n        setIsLoading(false);\n        dispatch({\n          type: \"ADD_FILE\",\n          payload: fileNew\n        });\n        dispatch({\n          type: \"SET_MODAL\",\n          payload: true\n        });\n      }\n    });\n  } catch (error) {\n    console.log(\"error :--- \", error);\n    setIsLoading(false);\n  }\n}","map":{"version":3,"names":["axios","async","BASE_URL_DEV","fetchAndSetFileHighlights","dispatch","state","files","setIsLoading","eachSeries","element","cbBatch","get","auth","userPublicId","name","headers","authToken","then","result","fileHighlights","data","highlights","type","payload","catch","error","loopErrBatch","console","log","filesResponse","length","results","allgraphs","Obj","_id","graphdata","forEach","x","fileName","links","filter","e","source","fileNew","map","CITATION","PROVISION"],"sources":["/home/taymur/Documents/legal2/DATA/Highlight/newmerged/CASEFRONTt/src/utils/setPdfHighlights.js"],"sourcesContent":["import axios from 'axios';\nimport async from 'async';\nimport { BASE_URL_DEV } from '../utils';\n\nexport async function fetchAndSetFileHighlights(dispatch, state, files, setIsLoading) {\n    try {\n        async.eachSeries(files, function (element, cbBatch) {\n            axios.get(`${BASE_URL_DEV}/highlights-json/${state.auth.userPublicId}/${element.name}`, {\n                headers: {\n                    'x-access-token': state.auth && state.auth.authToken,\n                }\n            })\n            .then(function (result) {\n                const fileHighlights = result.data;\n                if (fileHighlights && fileHighlights.highlights) {\n                    dispatch({\n                        type: \"SET_FILE_HIGHLIGHTS\",\n                        payload: {\n                            name: element.name,\n                            highlights: fileHighlights.highlights\n                        }\n                    });\n                }\n                cbBatch(null);\n            })\n            .catch(function (error) {\n                cbBatch(error);\n            });\n        }, async (loopErrBatch) => {\n            if (loopErrBatch) {\n                console.log(loopErrBatch);\n                setIsLoading(false);\n                return;\n            }\n\n            const result = await axios(`${BASE_URL_DEV}/get/files`, {\n                headers: {\n                    \"x-access-token\": state.auth && state.auth.authToken,\n                },\n            });\n            const filesResponse = result.data && result.data.files;\n            if (filesResponse && filesResponse.length > 0) {\n                const results = await axios(`${BASE_URL_DEV}/get-graphdata`, {\n                    headers: {\n                        \"x-access-token\": state.auth && state.auth.authToken,\n                    },\n                });\n                const allgraphs = results.data;\n                let Obj = {};\n                let _id = \"\";\n\n                allgraphs.graphdata.forEach(x => {\n                    _id = x.fileName;\n                    Obj[_id] = x.links.filter(e => e.source === \"CITATION\" || e.source === \"PROVISION\");\n                });\n\n                const fileNew = filesResponse.map(element => {\n                    return {\n                        ...element,\n                        CITATION: Obj[element.name] && Obj[element.name].length > 0 ? Obj[element.name].filter(e => e.source === \"CITATION\") : [\"N/A\"],\n                        PROVISION: Obj[element.name] && Obj[element.name].length > 0 ? Obj[element.name].filter(e => e.source === \"PROVISION\") : [\"N/A\"]\n                    };\n                });\n\n                setIsLoading(false);\n                dispatch({ type: \"ADD_FILE\", payload: fileNew });\n                dispatch({ type: \"SET_MODAL\", payload: true });\n            }\n        });\n    } catch (error) {\n        console.log(\"error :--- \", error);\n        setIsLoading(false);\n    }\n}\n"],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,OAAOC,KAAK,MAAM,OAAO;AACzB,SAASC,YAAY,QAAQ,UAAU;AAEvC,OAAO,eAAeC,yBAAyBA,CAACC,QAAQ,EAAEC,KAAK,EAAEC,KAAK,EAAEC,YAAY,EAAE;EAClF,IAAI;IACAN,KAAK,CAACO,UAAU,CAACF,KAAK,EAAE,UAAUG,OAAO,EAAEC,OAAO,EAAE;MAChDV,KAAK,CAACW,GAAG,CAAE,GAAET,YAAa,oBAAmBG,KAAK,CAACO,IAAI,CAACC,YAAa,IAAGJ,OAAO,CAACK,IAAK,EAAC,EAAE;QACpFC,OAAO,EAAE;UACL,gBAAgB,EAAEV,KAAK,CAACO,IAAI,IAAIP,KAAK,CAACO,IAAI,CAACI;QAC/C;MACJ,CAAC,CAAC,CACDC,IAAI,CAAC,UAAUC,MAAM,EAAE;QACpB,MAAMC,cAAc,GAAGD,MAAM,CAACE,IAAI;QAClC,IAAID,cAAc,IAAIA,cAAc,CAACE,UAAU,EAAE;UAC7CjB,QAAQ,CAAC;YACLkB,IAAI,EAAE,qBAAqB;YAC3BC,OAAO,EAAE;cACLT,IAAI,EAAEL,OAAO,CAACK,IAAI;cAClBO,UAAU,EAAEF,cAAc,CAACE;YAC/B;UACJ,CAAC,CAAC;QACN;QACAX,OAAO,CAAC,IAAI,CAAC;MACjB,CAAC,CAAC,CACDc,KAAK,CAAC,UAAUC,KAAK,EAAE;QACpBf,OAAO,CAACe,KAAK,CAAC;MAClB,CAAC,CAAC;IACN,CAAC,EAAE,MAAOC,YAAY,IAAK;MACvB,IAAIA,YAAY,EAAE;QACdC,OAAO,CAACC,GAAG,CAACF,YAAY,CAAC;QACzBnB,YAAY,CAAC,KAAK,CAAC;QACnB;MACJ;MAEA,MAAMW,MAAM,GAAG,MAAMlB,KAAK,CAAE,GAAEE,YAAa,YAAW,EAAE;QACpDa,OAAO,EAAE;UACL,gBAAgB,EAAEV,KAAK,CAACO,IAAI,IAAIP,KAAK,CAACO,IAAI,CAACI;QAC/C;MACJ,CAAC,CAAC;MACF,MAAMa,aAAa,GAAGX,MAAM,CAACE,IAAI,IAAIF,MAAM,CAACE,IAAI,CAACd,KAAK;MACtD,IAAIuB,aAAa,IAAIA,aAAa,CAACC,MAAM,GAAG,CAAC,EAAE;QAC3C,MAAMC,OAAO,GAAG,MAAM/B,KAAK,CAAE,GAAEE,YAAa,gBAAe,EAAE;UACzDa,OAAO,EAAE;YACL,gBAAgB,EAAEV,KAAK,CAACO,IAAI,IAAIP,KAAK,CAACO,IAAI,CAACI;UAC/C;QACJ,CAAC,CAAC;QACF,MAAMgB,SAAS,GAAGD,OAAO,CAACX,IAAI;QAC9B,IAAIa,GAAG,GAAG,CAAC,CAAC;QACZ,IAAIC,GAAG,GAAG,EAAE;QAEZF,SAAS,CAACG,SAAS,CAACC,OAAO,CAACC,CAAC,IAAI;UAC7BH,GAAG,GAAGG,CAAC,CAACC,QAAQ;UAChBL,GAAG,CAACC,GAAG,CAAC,GAAGG,CAAC,CAACE,KAAK,CAACC,MAAM,CAACC,CAAC,IAAIA,CAAC,CAACC,MAAM,KAAK,UAAU,IAAID,CAAC,CAACC,MAAM,KAAK,WAAW,CAAC;QACvF,CAAC,CAAC;QAEF,MAAMC,OAAO,GAAGd,aAAa,CAACe,GAAG,CAACnC,OAAO,IAAI;UACzC,OAAO;YACH,GAAGA,OAAO;YACVoC,QAAQ,EAAEZ,GAAG,CAACxB,OAAO,CAACK,IAAI,CAAC,IAAImB,GAAG,CAACxB,OAAO,CAACK,IAAI,CAAC,CAACgB,MAAM,GAAG,CAAC,GAAGG,GAAG,CAACxB,OAAO,CAACK,IAAI,CAAC,CAAC0B,MAAM,CAACC,CAAC,IAAIA,CAAC,CAACC,MAAM,KAAK,UAAU,CAAC,GAAG,CAAC,KAAK,CAAC;YAC9HI,SAAS,EAAEb,GAAG,CAACxB,OAAO,CAACK,IAAI,CAAC,IAAImB,GAAG,CAACxB,OAAO,CAACK,IAAI,CAAC,CAACgB,MAAM,GAAG,CAAC,GAAGG,GAAG,CAACxB,OAAO,CAACK,IAAI,CAAC,CAAC0B,MAAM,CAACC,CAAC,IAAIA,CAAC,CAACC,MAAM,KAAK,WAAW,CAAC,GAAG,CAAC,KAAK;UACnI,CAAC;QACL,CAAC,CAAC;QAEFnC,YAAY,CAAC,KAAK,CAAC;QACnBH,QAAQ,CAAC;UAAEkB,IAAI,EAAE,UAAU;UAAEC,OAAO,EAAEoB;QAAQ,CAAC,CAAC;QAChDvC,QAAQ,CAAC;UAAEkB,IAAI,EAAE,WAAW;UAAEC,OAAO,EAAE;QAAK,CAAC,CAAC;MAClD;IACJ,CAAC,CAAC;EACN,CAAC,CAAC,OAAOE,KAAK,EAAE;IACZE,OAAO,CAACC,GAAG,CAAC,aAAa,EAAEH,KAAK,CAAC;IACjClB,YAAY,CAAC,KAAK,CAAC;EACvB;AACJ","ignoreList":[]},"metadata":{},"sourceType":"module"}