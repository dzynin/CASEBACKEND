{"ast":null,"code":"import { L10n, createElement, isNullOrUndefined } from '@syncfusion/ej2-base';\n//import { DocumentEditorRulerModel } from '../ruler-settings-model';\nimport { Ruler } from '../ruler/index';\nimport { HelperMethods, Point } from '../editor/editor-helper';\nimport { WTabStop } from '../format/paragraph-format';\n/**\n * Size defines and processes the size(width/height) of the objects\n * @private\n */\nvar Size = /** @class */function () {\n  function Size(width, height) {\n    this.width = width;\n    this.height = height;\n  }\n  /**\n   * isEmpty method \\\n   *\n   * @returns { boolean } isEmpty method .\\\n   *\n   * @private\n   */\n  Size.prototype.isEmpty = function () {\n    return this.height === 0 && this.width === 0;\n  };\n  /**\n  * clone method \\\n  *\n  * @returns { Size } clone method .\\\n  *\n  * @private\n  */\n  Size.prototype.clone = function () {\n    return new Size(this.width, this.height);\n  };\n  return Size;\n}();\nexport { Size };\n/* eslint-disable */\n/**\n * defines the helper methods for the ruler\n * @private\n */\nvar RulerHelper = /** @class */function () {\n  function RulerHelper() {}\n  /**\n   * @private\n   */\n  RulerHelper.prototype.hideTabStopSwitch = function (show) {\n    if (this.tabStopStwitch) {\n      this.showHideElement(show, this.tabStopStwitch);\n    }\n  };\n  /**\n   * @private\n   */\n  RulerHelper.prototype.hideRulerBottom = function (show) {\n    if (this.hRulerBottom) {\n      this.showHideElement(show, this.hRulerBottom);\n    }\n    if (this.vRulerBottom) {\n      this.showHideElement(show, this.vRulerBottom);\n    }\n  };\n  RulerHelper.prototype.showHideElement = function (show, element) {\n    if (show) {\n      element.style.display = 'block';\n    } else {\n      element.style.display = 'none';\n    }\n  };\n  /* eslint-enable */\n  /**\n   * createHtmlElement method \\\n   *\n   * @returns {SVGSVGElement} createHtmlElement method .\\\n   * @param { string } elementType - provide the diagramId  value.\n   * @param { Object } attribute - provide the diagramId  value.\n   * @private\n   */\n  RulerHelper.prototype.createHtmlElement = function (elementType, attribute) {\n    var element = createElement(elementType);\n    this.setAttributeHtml(element, attribute);\n    return element;\n  };\n  /**\n   * createSvgElement method \\\n   *\n   * @returns {SVGSVGElement} createSvgElement method .\\\n   * @param { string } elementType - provide the elementType  value.\n   * @param { Object } attribute - provide the attribute  value.\n   * @private\n   */\n  RulerHelper.prototype.createSvgElement = function (elementType, attribute) {\n    var element = document.createElementNS('http://www.w3.org/2000/svg', elementType);\n    this.setAttributeSvg(element, attribute);\n    return element;\n  };\n  /**\n   * applyStyleAgainstCsp method   \\\n   *\n   * @returns {void} applyStyleAgainstCsp method .\\\n   * @param { SVGElement } svg - provide the svg  value.\n   * @param { string } attributes - provide the boolean  value.\n   * @private\n   */\n  RulerHelper.prototype.applyStyleAgainstCsp = function (svg, attributes) {\n    var keys = attributes.split(';');\n    for (var i = 0; i < keys.length; i++) {\n      var attribute = keys[parseInt(i.toString(), 10)].split(':');\n      if (attribute.length === 2) {\n        svg.style[attribute[0].trim()] = attribute[1].trim();\n      }\n    }\n  };\n  /**\n   * setAttributeSvg method.\n   *\n   * @returns {void} setAttributeSvg method .\\\n   * @param { SVGElement } svg - provide the svg  value.\n   * @param { Object } attributes - provide the boolean  value.\n   * @private\n   */\n  RulerHelper.prototype.setAttributeSvg = function (svg, attributes) {\n    var keys = Object.keys(attributes);\n    for (var i = 0; i < keys.length; i++) {\n      // Added below condition to check whether svg is undefined or not\n      if (svg && keys[parseInt(i.toString(), 10)] !== 'style') {\n        svg.setAttribute(keys[parseInt(i.toString(), 10)], attributes[keys[parseInt(i.toString(), 10)]]);\n      } else {\n        this.applyStyleAgainstCsp(svg, attributes[keys[parseInt(i.toString(), 10)]]);\n      }\n    }\n  };\n  /**\n   * setAttributeHtml method   \\\n   *\n   * @returns {void} setAttributeHtml method .\\\n   * @param { HTMLElement } element - provide the svg  value.\n   * @param { Object } attributes - provide the boolean  value.\n   * @private\n   */\n  RulerHelper.prototype.setAttributeHtml = function (element, attributes) {\n    var keys = Object.keys(attributes);\n    for (var i = 0; i < keys.length; i++) {\n      if (keys[parseInt(i.toString(), 10)] !== 'style') {\n        element.setAttribute(keys[parseInt(i.toString(), 10)], attributes[keys[parseInt(i.toString(), 10)]]);\n      } else {\n        this.applyStyleAgainstCsp(element, attributes[keys[parseInt(i.toString(), 10)]]);\n      }\n    }\n  };\n  /**\n   * renderOverlapElement method \\\n   *\n   * @returns {void} renderOverlapElement method .\\\n   * @param { DocumentEditor} documentEditor - provide the content  value.\n   * @private\n   */\n  RulerHelper.prototype.renderOverlapElement = function (documentEditor) {\n    var rulerSize = this.getRulerSize(documentEditor);\n    var attributes = {\n      'id': documentEditor.element.id + '_overlapRuler',\n      style: 'height:' + rulerSize.height + 'px;width:' + rulerSize.width + 'px;position:absolute;margin-left:0;margin-top:0;diplay:none',\n      class: 'e-ruler-overlap'\n    };\n    var overlap = this.createHtmlElement('div', attributes);\n    var element = document.getElementById(documentEditor.element.id + '_viewerContainer');\n    element.insertBefore(overlap, element.firstChild);\n    return overlap;\n  };\n  RulerHelper.prototype.renderRulerMarkerIndicatorElement = function (documentEditor) {\n    if (!documentEditor.enableSelection) {\n      return;\n    }\n    var rulerSize = this.getRulerSize(documentEditor);\n    var attributes = {\n      'id': documentEditor.element.id + '_markIndicator',\n      style: 'height:' + rulerSize.height + 'px;width:' + rulerSize.width + 'px;position:absolute;margin-left:0;margin-top:0;z-index:5;border:1px solid #ccc;display:' + (documentEditor.layoutType === 'Pages' ? 'block;' : 'none;'),\n      class: 'e-de-ruler-markIndicator'\n    };\n    var markIndicator = this.createHtmlElement('div', attributes);\n    this.tabStopStwitch = markIndicator;\n    var element = document.getElementById(documentEditor.element.id + '_viewerContainer');\n    element.insertBefore(markIndicator, element.firstChild);\n    var ownerId = documentEditor.element.id;\n    var firstLineIndent = document.getElementById(ownerId + '_firstLineIndent').cloneNode(true);\n    var hangingIndent = document.getElementById(ownerId + '_hangingIndent').cloneNode(true);\n    firstLineIndent.style.left = '1px';\n    firstLineIndent.style.top = rulerSize.height / 2 - 3 + 'px';\n    firstLineIndent.style.display = 'none';\n    firstLineIndent.classList.add('e-de-ruler-marker');\n    firstLineIndent.setAttribute('id', ownerId + '_firstLineIndent_-1');\n    hangingIndent.style.left = '1px';\n    hangingIndent.style.top = rulerSize.height / 2 - 3 + 'px';\n    hangingIndent.style.display = 'none';\n    hangingIndent.classList.add('e-de-ruler-marker');\n    hangingIndent.setAttribute('id', ownerId + '_hangingIndent_-1');\n    markIndicator.appendChild(hangingIndent);\n    markIndicator.appendChild(firstLineIndent);\n    var justification = ['Left', 'Center', 'Right', 'Decimal', 'Bar'];\n    var locale = new L10n('documenteditor', documentEditor.defaultLocale);\n    locale.setLocale(documentEditor.locale);\n    for (var i = 0; i < 5; i++) {\n      this.renderTab(documentEditor, rulerSize, undefined, justification[parseInt(i.toString(), 10)], -1, locale);\n      var element_1 = document.getElementById(documentEditor.element.id + '_' + justification[parseInt(i.toString(), 10)] + 'Tab_-1');\n      if (!isNullOrUndefined(element_1)) {\n        element_1.classList.remove('e-de-ruler-tab');\n        element_1.classList.add('e-de-ruler-marker');\n        element_1.style.display = i == 0 ? 'block' : 'none';\n        element_1.style.position = 'absolute';\n        element_1.style.margin = '4px 3px';\n        markIndicator.appendChild(element_1);\n      }\n    }\n    markIndicator.addEventListener('click', function (event) {\n      var divElements = document.querySelector('.e-de-ruler-markIndicator');\n      for (var i = 0; i < divElements.childNodes.length; i++) {\n        var currentDiv = divElements.childNodes[parseInt(i.toString(), 10)];\n        if (currentDiv.style.display === 'block') {\n          currentDiv.style.display = 'none';\n          var nextIndex = (i + 1) % divElements.childNodes.length;\n          divElements.childNodes[parseInt(nextIndex.toString(), 10)].style.display = 'block';\n          break;\n        }\n      }\n    });\n  };\n  /**\n   * renderRuler method \\\n   *\n   * @returns {void} renderRuler method .\\\n   * @param { DocumentEditor} documentEditor - provide the content  value.\n   * @param { boolean} isHorizontal - provide the content  value.\n   * @private\n   */\n  RulerHelper.prototype.renderRuler = function (documentEditor, isHorizontal) {\n    var _this = this;\n    if (!documentEditor.enableSelection) {\n      return;\n    }\n    var div = document.getElementById(documentEditor.element.id + (isHorizontal ? '_hRuler' : '_vRuler'));\n    var rulerSize = this.getRulerSize(documentEditor);\n    var rulerGeometry = this.getRulerGeometry(documentEditor);\n    var height = isHorizontal ? documentEditor.selectionModule.end.paragraph.bodyWidget.page.boundingRectangle.x : documentEditor.selectionModule.getPageTop(documentEditor.selectionModule.end.paragraph.bodyWidget.page);\n    var margin = isHorizontal ? 'margin-left:' + height + 'px;' : 'margin-top:' + height + 'px;';\n    if (documentEditor.selectionModule.isForward) {\n      this.position = documentEditor.selectionModule.start;\n    } else {\n      this.position = documentEditor.selectionModule.end;\n    }\n    // const margin: string = isHorizontal ? ('margin-left:' + (pixelsToPoints(documentEditor.selection.end.paragraph.bodyWidget.page.boundingRectangle.x)) + 'px;') : ('margin-top:' + rulerSize.height + 'px;');\n    if (!div) {\n      var style_1 = 'height:' + (isHorizontal ? rulerSize.height : rulerGeometry.height) + 'px;overflow:hidden;width:' + (isHorizontal ? rulerGeometry.width : rulerSize.width) + 'px;position:absolute;font-size:9px;text-align: left;z-index: 4;user-select:none;' + margin;\n      var attributes_1 = {\n        'id': documentEditor.element.id + (isHorizontal ? '_hRuler' : '_vRuler'),\n        style: style_1,\n        class: isHorizontal ? 'e-de-hRuler' : 'e-de-vRuler'\n      };\n      div = this.createHtmlElement('div', attributes_1);\n    }\n    div.addEventListener('dblclick', function () {\n      documentEditor.showDialog('PageSetup');\n    });\n    var pageElement = document.getElementById(documentEditor.element.id + '_pageContainer');\n    var style = 'height:' + (isHorizontal ? rulerSize.height : pageElement.getBoundingClientRect().height) + 'px;overflow:hidden;width:' + (isHorizontal ? pageElement.getBoundingClientRect().width : rulerSize.width) + 'px;position:absolute;z-index: 3;';\n    var attributes = {\n      'id': documentEditor.element.id + (isHorizontal ? '_hRulerBottom' : '_vRulerBottom'),\n      style: style,\n      class: isHorizontal ? 'e-de-hRuler' : 'e-de-vRuler'\n    };\n    var overlap = this.createHtmlElement('div', attributes);\n    isHorizontal ? this.hRulerBottom = overlap : this.vRulerBottom = overlap;\n    var parentElement = document.getElementById(documentEditor.element.id + '_viewerContainer');\n    parentElement.insertBefore(overlap, parentElement.firstChild);\n    var element = isHorizontal ? document.getElementById(documentEditor.element.id + '_hRulerBottom') : document.getElementById(documentEditor.element.id + '_vRulerBottom');\n    element.insertBefore(div, element.firstChild);\n    this.renderRulerMargins(documentEditor, isHorizontal, div);\n    //const documentEditorRuler: DocumentEditorRulerModel = isHorizontal ? documentEditor.documentEditorSettings.rulerSettings.horizontalRuler : documentEditor.documentEditorSettings.rulerSettings.verticalRuler;\n    var ruler = new Ruler(div, this);\n    ruler.orientation = isHorizontal ? 'Horizontal' : 'Vertical';\n    this.updateMargin(ruler, documentEditor, isHorizontal);\n    // ruler.pageWidth = documentEditor.selection.end.paragraph.bodyWidget.page.boundingRectangle.width;\n    // ruler.pageHeight = documentEditor.selection.end.paragraph.bodyWidget.page.boundingRectangle.height;\n    // ruler.length = (isHorizontal ? rulerGeometry.width : rulerGeometry.height) + documentEditorRuler.segmentWidth;\n    ruler.length = ruler.zeroPosition * 2;\n    ruler.appendTo();\n    // eslint-disable-next-line\n    isHorizontal ? documentEditor.hRuler = ruler : documentEditor.vRuler = ruler;\n    this.updateRulerPosition(documentEditor, isHorizontal);\n    var rulerObj = document.getElementById(documentEditor.element.id + (isHorizontal ? '_hRuler' : '_vRuler'));\n    // eslint-disable-next-line\n    isHorizontal ? documentEditor.hRuler.element = rulerObj : documentEditor.vRuler.element = rulerObj;\n    if (rulerObj) {\n      // Set the scrollLeft property to the desired value (e.g., 100 pixels)\n      if (isHorizontal) {\n        rulerObj.scrollLeft = ruler.zeroPosition - HelperMethods.convertPointToPixel(documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin);\n      } else {\n        rulerObj.scrollTop = ruler.zeroPosition - HelperMethods.convertPointToPixel(documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.topMargin);\n      }\n    }\n    this.locale = new L10n('documenteditor', documentEditor.defaultLocale);\n    if (isHorizontal) {\n      this.renderIndents(documentEditor, isHorizontal, rulerSize, rulerGeometry, this.locale);\n    }\n    var resizerEnabled = false;\n    var isDragging = false;\n    var isLeftRulerMargin = undefined;\n    var isLeftMultiColumn = false;\n    var isRightMultiColumn = false;\n    var multiColumnElement;\n    var hRuler = document.getElementById(documentEditor.element.id + '_hRuler');\n    var columnInitialValue;\n    var initialValue;\n    var currentScrollLeft;\n    var initialRightMargin;\n    var finalmouseXRelativeToDiv;\n    if (isHorizontal) {\n      document.addEventListener('mousemove', function (e) {\n        if (documentEditor.isDestroyed || !documentEditor.documentEditorSettings.showRuler) {\n          return;\n        }\n        var divRect = hRuler.getBoundingClientRect();\n        var leftMargin = documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin * documentEditor.zoomFactor;\n        var rightMargin = HelperMethods.convertPixelToPoint(divRect.width) - documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.rightMargin * documentEditor.zoomFactor;\n        var pixelValue = Math.round(e.clientX - divRect.left);\n        var mouseXRelativeToDiv = HelperMethods.convertPixelToPoint(pixelValue);\n        if (!isDragging) {\n          if (documentEditor.isOnIndent) {\n            hRuler.style.cursor = 'default';\n            if (hRuler.hasAttribute('title')) {\n              hRuler.removeAttribute('title');\n            }\n            resizerEnabled = false;\n          } else if (leftMargin - 3 <= mouseXRelativeToDiv && leftMargin + 3 >= mouseXRelativeToDiv) {\n            if (documentEditor.layoutType === 'Pages') {\n              hRuler.style.cursor = 'e-resize';\n              hRuler.setAttribute('title', _this.locale.getConstant('Left Margin'));\n              resizerEnabled = true;\n              isLeftRulerMargin = true;\n            }\n          } else if (rightMargin - 3 <= mouseXRelativeToDiv && rightMargin + 3 >= mouseXRelativeToDiv) {\n            if (documentEditor.layoutType === 'Pages') {\n              hRuler.style.cursor = 'e-resize';\n              hRuler.setAttribute('title', _this.locale.getConstant('Right Margin'));\n              resizerEnabled = true;\n              isLeftRulerMargin = false;\n            }\n          } else if (documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.columns.length > 0) {\n            var columns = documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.columns;\n            if (documentEditor.layoutType === 'Pages') {\n              for (var i = 1; i <= columns.length; i++) {\n                var rulerMarginDiv = document.getElementById(documentEditor.element.id + '_hRuler_Margin' + i);\n                var maginLeft = rulerMarginDiv.getBoundingClientRect().left;\n                var width = rulerMarginDiv.getBoundingClientRect().width;\n                if (maginLeft - 3 <= e.clientX && maginLeft + 3 >= e.clientX) {\n                  hRuler.style.cursor = \"e-resize\";\n                  multiColumnElement = rulerMarginDiv;\n                  hRuler.setAttribute('title', _this.locale.getConstant('Left Margin'));\n                  isLeftMultiColumn = true;\n                  resizerEnabled = true;\n                  break;\n                } else if (maginLeft + width - 3 <= e.clientX && maginLeft + width + 3 >= e.clientX) {\n                  hRuler.style.cursor = \"e-resize\";\n                  multiColumnElement = rulerMarginDiv;\n                  hRuler.setAttribute('title', _this.locale.getConstant('Right Margin'));\n                  isRightMultiColumn = true;\n                  resizerEnabled = true;\n                  break;\n                } else {\n                  hRuler.style.cursor = \"default\";\n                  if (hRuler.hasAttribute('title')) {\n                    hRuler.removeAttribute('title');\n                  }\n                  isLeftMultiColumn = false;\n                  isRightMultiColumn = false;\n                  resizerEnabled = false;\n                }\n              }\n            }\n          } else {\n            hRuler.style.cursor = 'default';\n            if (hRuler.hasAttribute('title')) {\n              hRuler.removeAttribute('title');\n            }\n            resizerEnabled = false;\n          }\n        }\n        if (isDragging) {\n          var rulerZeroPoint = HelperMethods.convertPointToPixel(1584 - documentEditor.selectionModule.sectionFormat.leftMargin) * documentEditor.zoomFactor;\n          var pageWidth = documentEditor.selectionModule.sectionFormat.pageWidth;\n          var rightMarginValue = documentEditor.selectionModule.sectionFormat.rightMargin;\n          var rightIndentValue = documentEditor.selectionModule.paragraphFormat.rightIndent;\n          rightIndentValue = rightIndentValue > 0 ? rightIndentValue : 0;\n          var minimumValue = 42;\n          var firstLineIndent = documentEditor.selectionModule.paragraphFormat.firstLineIndent;\n          var leftMarginValue = documentEditor.selectionModule.sectionFormat.leftMargin;\n          firstLineIndent = firstLineIndent >= 0 ? firstLineIndent : 0;\n          var leftIndent = documentEditor.selectionModule.paragraphFormat.leftIndent;\n          if (isLeftRulerMargin) {\n            var leftMaxLimit = rulerZeroPoint + HelperMethods.convertPointToPixel(pageWidth - rightMarginValue - rightIndentValue - minimumValue - firstLineIndent - leftIndent) * documentEditor.zoomFactor;\n            var leftMinLimit = rulerZeroPoint;\n            if (pixelValue + rulerZeroPoint > leftMaxLimit) {\n              pixelValue = leftMaxLimit - rulerZeroPoint;\n              mouseXRelativeToDiv = HelperMethods.convertPixelToPoint(pixelValue);\n            } else if (pixelValue + rulerZeroPoint < leftMinLimit) {\n              pixelValue = leftMinLimit - rulerZeroPoint;\n              mouseXRelativeToDiv = HelperMethods.convertPixelToPoint(pixelValue);\n            }\n          } else {\n            var rightMinLimit = rulerZeroPoint + HelperMethods.convertPointToPixel(leftMarginValue + leftIndent + firstLineIndent + minimumValue + rightIndentValue) * documentEditor.zoomFactor;\n            var rightMaxLimit = rulerZeroPoint + HelperMethods.convertPointToPixel(pageWidth) * documentEditor.zoomFactor;\n            if (pixelValue + rulerZeroPoint > rightMaxLimit) {\n              pixelValue = rightMaxLimit - rulerZeroPoint;\n              mouseXRelativeToDiv = HelperMethods.convertPixelToPoint(pixelValue);\n            } else if (pixelValue + rulerZeroPoint < rightMinLimit) {\n              pixelValue = rightMinLimit - rulerZeroPoint;\n              mouseXRelativeToDiv = HelperMethods.convertPixelToPoint(pixelValue);\n            }\n          }\n          finalmouseXRelativeToDiv = mouseXRelativeToDiv;\n          var currentRightMargin = HelperMethods.convertPixelToPoint(divRect.width) - documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.rightMargin * documentEditor.zoomFactor;\n          if (documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.numberOfColumns <= 1) {\n            _this.resizeRulerMargins(isLeftRulerMargin, initialValue, currentScrollLeft, currentRightMargin, hRuler, mouseXRelativeToDiv, true, documentEditor);\n          }\n          var rightIndent = document.getElementById(documentEditor.element.id + '_rightIndent');\n          if (isLeftRulerMargin) {\n            var difference = mouseXRelativeToDiv - initialValue;\n            rightIndent.style.left = initialRightMargin - HelperMethods.convertPointToPixel(difference) + 'px';\n          } else {\n            var difference = mouseXRelativeToDiv - initialValue;\n            rightIndent.style.left = initialRightMargin + HelperMethods.convertPointToPixel(difference) + 'px';\n          }\n          var startValue = documentEditor.documentHelper.currentPage.boundingRectangle.x;\n          var indicatorLineValue = startValue + pixelValue;\n          var lineSvg = document.getElementById(documentEditor.element.id + '_hRuler_indicator_svg');\n          lineSvg.style.left = indicatorLineValue + 'px';\n        }\n      });\n      var mouseDownTabValue_1;\n      var mouseUpTabValue_1;\n      hRuler.addEventListener(\"mouseenter\", function (e) {\n        if (!isNullOrUndefined(_this.currentTabStopElement)) {\n          _this.currentTabStopElement.style.display = 'block';\n        }\n      });\n      hRuler.addEventListener(\"mouseleave\", function (e) {\n        if (!isNullOrUndefined(_this.currentTabStopElement)) {\n          _this.currentTabStopElement.style.display = 'none';\n          //this.currentTabStopElement = undefined;\n        }\n      });\n      hRuler.addEventListener(\"mousedown\", function (e) {\n        if (resizerEnabled && !documentEditor.isTableMarkerDragging) {\n          isDragging = true;\n          if (documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.columns.length > 0) {\n            if (isLeftMultiColumn) {\n              columnInitialValue = multiColumnElement.getBoundingClientRect().left;\n            } else if (isRightMultiColumn) {\n              columnInitialValue = multiColumnElement.getBoundingClientRect().left + multiColumnElement.getBoundingClientRect().width;\n            }\n          }\n          var divRect_1 = hRuler.getBoundingClientRect();\n          initialValue = HelperMethods.convertPixelToPoint(Math.round(e.clientX - divRect_1.left));\n          currentScrollLeft = hRuler.scrollLeft;\n          var rightIndent = document.getElementById(documentEditor.element.id + '_rightIndent');\n          initialRightMargin = HelperMethods.getNumberFromString(rightIndent.style.left);\n          var pixelValue = Math.round(e.clientX - divRect_1.left);\n          var startValue = documentEditor.documentHelper.currentPage.boundingRectangle.x;\n          var indicatorLineValue = startValue + pixelValue;\n          var lineSvg = document.getElementById(documentEditor.element.id + '_hRuler_indicator_svg');\n          lineSvg.style.left = indicatorLineValue + 'px';\n          lineSvg.style.display = 'block';\n        }\n        var divRect = hRuler.getBoundingClientRect();\n        if (divRect.y + divRect.height / 2 <= e.clientY) {\n          mouseDownTabValue_1 = e.clientX - hRuler.getBoundingClientRect().left;\n          if (documentEditor.layoutType === 'Pages') {\n            mouseDownTabValue_1 = HelperMethods.convertPixelToPoint(mouseDownTabValue_1 - HelperMethods.convertPointToPixel(documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin) * documentEditor.zoomFactor);\n            if (_this.position.paragraph.paragraphFormat.bidi) {\n              var paraWidth = !isNullOrUndefined(_this.position.paragraph['absoluteXPosition']) ? parseFloat(_this.position.paragraph['absoluteXPosition']['width'].toString()) : _this.position.paragraph.width;\n              paraWidth = HelperMethods.convertPixelToPoint(paraWidth * documentEditor.zoomFactor);\n              mouseDownTabValue_1 = paraWidth - mouseDownTabValue_1;\n            }\n          } else if (documentEditor.layoutType === 'Continuous') {\n            if (_this.position.paragraph.paragraphFormat.bidi) {\n              mouseDownTabValue_1 = HelperMethods.convertPixelToPoint(mouseDownTabValue_1 - 20);\n              var paraWidth = !isNullOrUndefined(_this.position.paragraph['absoluteXPosition']) ? parseFloat(_this.position.paragraph['absoluteXPosition']['width'].toString()) : _this.position.paragraph.width;\n              paraWidth = HelperMethods.convertPixelToPoint(paraWidth * documentEditor.zoomFactor);\n              mouseDownTabValue_1 = paraWidth - mouseDownTabValue_1;\n            } else {\n              mouseDownTabValue_1 = HelperMethods.convertPixelToPoint(mouseDownTabValue_1 - 20);\n            }\n          }\n        }\n      });\n      hRuler.addEventListener(\"mouseup\", function (e) {\n        var container = document.getElementById(documentEditor.element.id + '_markIndicator');\n        var divRect = hRuler.getBoundingClientRect();\n        if (divRect.y + divRect.height / 2 <= e.clientY) {\n          mouseUpTabValue_1 = e.clientX - hRuler.getBoundingClientRect().left;\n          if (documentEditor.layoutType === 'Pages') {\n            mouseUpTabValue_1 = HelperMethods.convertPixelToPoint(mouseUpTabValue_1 - HelperMethods.convertPointToPixel(documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin) * documentEditor.zoomFactor);\n            if (_this.position.paragraph.paragraphFormat.bidi) {\n              var paraWidth = !isNullOrUndefined(_this.position.paragraph['absoluteXPosition']) ? parseFloat(_this.position.paragraph['absoluteXPosition']['width'].toString()) : _this.position.paragraph.width;\n              paraWidth = HelperMethods.convertPixelToPoint(paraWidth * documentEditor.zoomFactor);\n              mouseUpTabValue_1 = paraWidth - mouseUpTabValue_1;\n            }\n          } else if (documentEditor.layoutType === 'Continuous') {\n            if (_this.position.paragraph.paragraphFormat.bidi) {\n              mouseUpTabValue_1 = HelperMethods.convertPixelToPoint(mouseUpTabValue_1 - 20);\n              var paraWidth = !isNullOrUndefined(_this.position.paragraph['absoluteXPosition']) ? parseFloat(_this.position.paragraph['absoluteXPosition']['width'].toString()) : _this.position.paragraph.width;\n              paraWidth = HelperMethods.convertPixelToPoint(paraWidth * documentEditor.zoomFactor);\n              mouseUpTabValue_1 = paraWidth - mouseUpTabValue_1;\n            } else {\n              mouseUpTabValue_1 = HelperMethods.convertPixelToPoint(mouseUpTabValue_1 - 20);\n            }\n          }\n          var rightIndent = document.getElementById(documentEditor.element.id + '_rightIndent');\n          var rightIndentValue = HelperMethods.getNumberFromString(rightIndent.style.left);\n          var maxValue = rightIndentValue;\n          if (mouseUpTabValue_1 > 0 && mouseUpTabValue_1 < maxValue && mouseDownTabValue_1 == mouseUpTabValue_1) {\n            if (!isNullOrUndefined(container)) {\n              var visibleElement = container.querySelector('.e-de-ruler-marker[style*=\"display: block;\"]');\n              if (!isNullOrUndefined(visibleElement)) {\n                mouseUpTabValue_1 /= documentEditor.zoomFactor;\n                var dataNameValue = visibleElement.getAttribute('data-name');\n                if (dataNameValue == 'LeftTab' || dataNameValue == 'CenterTab' || dataNameValue == 'RightTab' || dataNameValue == 'DecimalTab' || dataNameValue == 'BarTab') {\n                  var tabStop = new WTabStop();\n                  tabStop.position = mouseUpTabValue_1;\n                  tabStop.tabJustification = _this.getTabJustification(dataNameValue);\n                  tabStop.deletePosition = 0;\n                  tabStop.tabLeader = 'None';\n                  documentEditor.editorModule.onApplyParagraphFormat('tabStop', [tabStop], false, false);\n                } else if (dataNameValue == 'FirstLineIndent' || dataNameValue == 'HangingIndent') {\n                  var property = 'firstLineIndent';\n                  if (dataNameValue == 'HangingIndent') {\n                    var initialValue = documentEditor.selectionModule.paragraphFormat.firstLineIndent;\n                    var differenceValue = mouseUpTabValue_1 + initialValue;\n                    var currentValue = documentEditor.selectionModule.start.paragraph.paragraphFormat.firstLineIndent;\n                    documentEditor.editorModule.onApplyParagraphFormat('firstLineIndent', currentValue - differenceValue, false, false);\n                    var leftIndentCurrentValue = documentEditor.selectionModule.start.paragraph.paragraphFormat.leftIndent + currentValue;\n                    currentValue = currentValue - differenceValue;\n                    documentEditor.editorModule.onApplyParagraphFormat('leftIndent', leftIndentCurrentValue - currentValue, false, false, true);\n                  } else {\n                    documentEditor.editorModule.onApplyParagraphFormat(property, mouseDownTabValue_1, false, false);\n                  }\n                }\n              }\n            }\n          }\n        }\n      });\n      document.addEventListener(\"mouseup\", function (e) {\n        if (isDragging && !documentEditor.isTableMarkerDragging) {\n          var divRect = hRuler.getBoundingClientRect();\n          var mouseXRelativeToDiv = finalmouseXRelativeToDiv; // HelperMethods.convertPixelToPoint(Math.round(e.clientX - divRect.left));\n          // const currentLeftMargin = documentEditor.hRuler.startMargin * documentEditor.zoomFactor;\n          // const currentScrollLeft = hRuler.scrollLeft;\n          // const currentRightMargin = (HelperMethods.convertPixelToPoint(divRect.width) - (documentEditor.selection.end.paragraph.bodyWidget.sectionFormat.rightMargin * documentEditor.zoomFactor));\n          // resizeRulerMargins(isLeftRulerMargin, currentLeftMargin, currentScrollLeft, currentRightMargin, hRuler, mouseXRelativeToDiv, true, documentEditor);\n          // if (hRuler) {\n          //     rulerObj.scrollLeft = rulerObj.scrollLeft - HelperMethods.convertPointToPixel((documentEditor.hRuler.leftMargin < mouseXRelativeToDiv) ? (mouseXRelativeToDiv - documentEditor.hRuler.leftMargin) : (documentEditor.hRuler.leftMargin - mouseXRelativeToDiv));\n          // }\n          // updateRuler(documentEditor, documentEditor.hRuler, true);\n          if (isLeftMultiColumn || isRightMultiColumn) {\n            var finalvalue = 0;\n            finalvalue = e.clientX - columnInitialValue;\n            var secFormat = documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.cloneFormat();\n            var pageWidth = documentEditor.selectionModule.sectionFormat.pageWidth - documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin - documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.rightMargin;\n            var columnSpace = isLeftMultiColumn ? secFormat.columns[0].space + HelperMethods.convertPixelToPoint(finalvalue) : secFormat.columns[0].space - HelperMethods.convertPixelToPoint(finalvalue);\n            for (var i = 0; i < secFormat.columns.length; i++) {\n              var col = secFormat.columns[parseInt(i.toString(), 10)];\n              if (columnSpace >= 0 && col.width >= 36) {\n                var widthCal = HelperMethods.convertPointToPixel((pageWidth - HelperMethods.convertPixelToPoint(columnSpace) * (secFormat.numberOfColumns - 1)) / secFormat.numberOfColumns);\n                col.width = widthCal;\n                if (i < secFormat.columns.length - 1) {\n                  col.space = columnSpace;\n                }\n              } else {\n                col[0].space = col[1].space;\n              }\n            }\n            documentEditor.editorModule.onApplySectionFormat(undefined, secFormat);\n            isLeftMultiColumn = false;\n            isRightMultiColumn = false;\n          } else if (isLeftRulerMargin) {\n            documentEditor.hRuler.startMargin = mouseXRelativeToDiv / documentEditor.zoomFactor;\n            documentEditor.selectionModule.sectionFormat.leftMargin = mouseXRelativeToDiv / documentEditor.zoomFactor;\n          } else {\n            var rightMargin = HelperMethods.convertPixelToPoint(rulerGeometry.width) - mouseXRelativeToDiv / documentEditor.zoomFactor;\n            // documentEditor.hRuler.endMargin = rightMargin;\n            documentEditor.selectionModule.sectionFormat.rightMargin = rightMargin;\n          }\n          resizerEnabled = false;\n          isDragging = false;\n          isLeftRulerMargin = undefined;\n          var lineSvg = document.getElementById(documentEditor.element.id + '_hRuler_indicator_svg');\n          lineSvg.style.display = 'none';\n        }\n      });\n    }\n    //Vertical Ruler Resizing\n    var vRuler = document.getElementById(documentEditor.element.id + '_vRuler');\n    var isTopRulerMargin = false;\n    var initialYValue;\n    var currentScrollTop;\n    if (!isHorizontal) {\n      document.addEventListener(\"mousemove\", function (e) {\n        if (documentEditor.isDestroyed || !documentEditor.documentEditorSettings.showRuler) {\n          return;\n        }\n        var divRect = vRuler.getBoundingClientRect();\n        var topMargin = documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.topMargin * documentEditor.zoomFactor;\n        var bottomMargin = HelperMethods.convertPixelToPoint(divRect.height) - documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.bottomMargin * documentEditor.zoomFactor;\n        var mouseXRelativeToDiv = HelperMethods.convertPixelToPoint(Math.round(e.clientY - divRect.top));\n        var pixelValue = Math.round(e.clientY - divRect.top);\n        if (!isDragging) {\n          if (topMargin - 3 <= mouseXRelativeToDiv && topMargin + 3 >= mouseXRelativeToDiv) {\n            vRuler.style.cursor = \"n-resize\";\n            vRuler.setAttribute('title', _this.locale.getConstant('Top Margin'));\n            resizerEnabled = true;\n            isTopRulerMargin = true;\n          } else if (bottomMargin - 3 <= mouseXRelativeToDiv && bottomMargin + 3 >= mouseXRelativeToDiv) {\n            vRuler.style.cursor = \"n-resize\";\n            vRuler.setAttribute('title', _this.locale.getConstant('Bottom Margin'));\n            resizerEnabled = true;\n            isTopRulerMargin = false;\n          } else {\n            vRuler.style.cursor = \"default\";\n            if (vRuler.hasAttribute('title')) {\n              vRuler.removeAttribute('title');\n            }\n            resizerEnabled = false;\n          }\n        }\n        if (isDragging) {\n          var mouseXRelativeToDiv_1 = HelperMethods.convertPixelToPoint(Math.round(e.clientY - divRect.top));\n          var rulerZeroPoint = HelperMethods.convertPointToPixel(1584 - documentEditor.selectionModule.sectionFormat.topMargin) * documentEditor.zoomFactor;\n          var pageHeight = documentEditor.selectionModule.sectionFormat.pageHeight;\n          var minimumValue = 12;\n          var bottomMarginValue = documentEditor.selectionModule.sectionFormat.bottomMargin;\n          var topMarginValue = documentEditor.selectionModule.sectionFormat.topMargin;\n          if (isTopRulerMargin) {\n            var topMinLimit = rulerZeroPoint;\n            var topMaxLimit = rulerZeroPoint + HelperMethods.convertPointToPixel(pageHeight - bottomMarginValue - minimumValue) * documentEditor.zoomFactor;\n            if (pixelValue + rulerZeroPoint > topMaxLimit) {\n              pixelValue = topMaxLimit - rulerZeroPoint;\n              mouseXRelativeToDiv_1 = HelperMethods.convertPixelToPoint(pixelValue);\n            } else if (pixelValue + rulerZeroPoint < topMinLimit) {\n              pixelValue = topMinLimit - rulerZeroPoint;\n              mouseXRelativeToDiv_1 = HelperMethods.convertPixelToPoint(pixelValue);\n            }\n          } else {\n            var bottomMinLimit = rulerZeroPoint + HelperMethods.convertPointToPixel(topMarginValue + minimumValue) * documentEditor.zoomFactor;\n            var bottomMaxLimit = rulerZeroPoint + HelperMethods.convertPointToPixel(pageHeight) * documentEditor.zoomFactor;\n            if (pixelValue + rulerZeroPoint > bottomMaxLimit) {\n              pixelValue = bottomMaxLimit - rulerZeroPoint;\n              mouseXRelativeToDiv_1 = HelperMethods.convertPixelToPoint(pixelValue);\n            } else if (pixelValue + rulerZeroPoint < bottomMinLimit) {\n              pixelValue = bottomMinLimit - rulerZeroPoint;\n              mouseXRelativeToDiv_1 = HelperMethods.convertPixelToPoint(pixelValue);\n            }\n          }\n          var currentBottomMargin = HelperMethods.convertPixelToPoint(divRect.height) - documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.bottomMargin * documentEditor.zoomFactor;\n          _this.resizeVRulerMargins(isTopRulerMargin, initialYValue, currentScrollTop, currentBottomMargin, vRuler, mouseXRelativeToDiv_1, documentEditor);\n          var startValue = documentEditor.documentHelper.currentPage.boundingRectangle.y * documentEditor.zoomFactor;\n          var indicatorLineValue = startValue + pixelValue; // + 15;\n          var lineSvg = document.getElementById(documentEditor.element.id + '_vRuler_indicator_svg');\n          lineSvg.style.top = indicatorLineValue + 'px';\n        }\n      });\n      vRuler.addEventListener(\"mousedown\", function (e) {\n        if (resizerEnabled) {\n          isDragging = true;\n          var divRect = vRuler.getBoundingClientRect();\n          initialYValue = HelperMethods.convertPixelToPoint(Math.round(e.clientY - divRect.top));\n          currentScrollTop = vRuler.scrollTop;\n          var pixelValue = Math.round(e.clientY - divRect.top);\n          var lineSvg = document.getElementById(documentEditor.element.id + '_vRuler_indicator_svg');\n          var startValue = documentEditor.documentHelper.currentPage.boundingRectangle.y * documentEditor.zoomFactor;\n          var indicatorLineValue = startValue + pixelValue; // + 15;\n          lineSvg.style.top = indicatorLineValue + 'px';\n          lineSvg.style.display = 'block';\n        }\n      });\n      document.addEventListener(\"mouseup\", function (e) {\n        if (isDragging) {\n          var divRect = vRuler.getBoundingClientRect();\n          var mouseXRelativeToDiv = HelperMethods.convertPixelToPoint(Math.round(e.clientY - divRect.top));\n          // const currentTopMargin = documentEditor.hRuler.startMargin * documentEditor.zoomFactor;\n          // const currentScrollTop = vRuler.scrollTop;\n          // const currentBottomMargin = (HelperMethods.convertPixelToPoint(divRect.height) - (documentEditor.selection.end.paragraph.bodyWidget.sectionFormat.bottomMargin * documentEditor.zoomFactor));\n          // resizeVRulerMargins(isTopRulerMargin, currentTopMargin, currentScrollTop, currentBottomMargin, vRuler, mouseXRelativeToDiv, documentEditor);\n          // if (hRuler) {\n          //     rulerObj.scrollLeft = rulerObj.scrollLeft - HelperMethods.convertPointToPixel((documentEditor.hRuler.leftMargin < mouseXRelativeToDiv) ? (mouseXRelativeToDiv - documentEditor.hRuler.leftMargin) : (documentEditor.hRuler.leftMargin - mouseXRelativeToDiv));\n          // }\n          // updateRuler(documentEditor, documentEditor.hRuler, true);\n          if (isTopRulerMargin) {\n            documentEditor.vRuler.startMargin = mouseXRelativeToDiv / documentEditor.zoomFactor;\n            documentEditor.selectionModule.sectionFormat.topMargin = mouseXRelativeToDiv / documentEditor.zoomFactor;\n          } else {\n            var bottomtMargin = HelperMethods.convertPixelToPoint(rulerGeometry.height) - mouseXRelativeToDiv / documentEditor.zoomFactor;\n            documentEditor.vRuler.endMargin = bottomtMargin;\n            documentEditor.selectionModule.sectionFormat.bottomMargin = bottomtMargin;\n          }\n          resizerEnabled = false;\n          isDragging = false;\n          var lineSvg = document.getElementById(documentEditor.element.id + '_vRuler_indicator_svg');\n          lineSvg.style.display = 'none';\n          isTopRulerMargin = undefined;\n        }\n      });\n    }\n  };\n  RulerHelper.prototype.updateRulerPosition = function (documentEditor, isHorizontal) {\n    var rulerObj = document.getElementById(documentEditor.element.id + (isHorizontal ? '_hRuler' : '_vRuler'));\n    // eslint-disable-next-line\n    isHorizontal ? documentEditor.hRuler.element = rulerObj : documentEditor.vRuler.element = rulerObj;\n    if (rulerObj) {\n      // Set the scrollLeft property to the desired value (e.g., 100 pixels)\n      rulerObj.scrollLeft = 2112 - HelperMethods.convertPointToPixel(documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin);\n    }\n  };\n  RulerHelper.prototype.updateIndicatorLines = function (documentEditor) {\n    var hRulerSvg = document.getElementById(documentEditor.element.id + '_hRuler_indicator_svg');\n    var hRulerLine = document.getElementById(documentEditor.element.id + '_hRuler_indicator');\n    var vRulerSvg = document.getElementById(documentEditor.element.id + '_vRuler_indicator_svg');\n    var vRulerLine = document.getElementById(documentEditor.element.id + '_vRuler_indicator');\n    var pageContainer = document.getElementById(documentEditor.element.id + '_pageContainer');\n    var pageData = pageContainer.getBoundingClientRect();\n    var pageHeight = pageData.height;\n    var pageWidth = pageData.width;\n    hRulerSvg.style.height = pageHeight + 'px';\n    hRulerLine.setAttribute('y2', \"\" + pageHeight);\n    vRulerSvg.style.width = pageWidth + 'px';\n    vRulerLine.setAttribute('x2', \"\" + pageWidth);\n  };\n  RulerHelper.prototype.createIndicatorLines = function (documentEditor) {\n    if (!documentEditor.enableSelection) {\n      return;\n    }\n    var viewerContainer = document.getElementById(documentEditor.element.id + '_viewerContainer');\n    var pageContainer = document.getElementById(documentEditor.element.id + '_pageContainer');\n    // let container = document.getElementById(documentEditor.element.id);\n    var data = viewerContainer.getBoundingClientRect();\n    var pageData = pageContainer.getBoundingClientRect();\n    var pageHeight = pageData.height;\n    var pageWidth = pageData.width;\n    var hRuler = document.getElementById(documentEditor.element.id + '_hRuler');\n    var hSvgAttr = {\n      id: documentEditor.element.id + '_hRuler_indicator_svg',\n      width: 0.5 + 'px',\n      height: pageHeight + 'px',\n      style: 'position:absolute;z-index:1;display:none;'\n    };\n    var hSvg = this.createSvgElement('svg', hSvgAttr);\n    var verticalLineAttr = {\n      'x1': 0,\n      'y1': hRuler.getBoundingClientRect().height + 5,\n      'x2': 0,\n      'y2': pageHeight,\n      'stroke-width': 0.5,\n      'stroke': 'black'\n    };\n    var vLine = this.createSvgElement('line', verticalLineAttr);\n    vLine.setAttribute('id', documentEditor.element.id + '_hRuler_indicator');\n    hSvg.appendChild(vLine);\n    viewerContainer.insertBefore(hSvg, viewerContainer.firstChild);\n    var vRuler = document.getElementById(documentEditor.element.id + '_vRuler');\n    var vSvgAttr = {\n      id: documentEditor.element.id + '_vRuler_indicator_svg',\n      width: pageWidth + 'px',\n      height: 0.5 + 'px',\n      style: 'position:absolute;z-index:1;display:none;'\n    };\n    var vSvg = this.createSvgElement('svg', vSvgAttr);\n    var horizontalLineAttr = {\n      'x1': vRuler.getBoundingClientRect().width + 5,\n      'y1': 0,\n      'x2': pageWidth,\n      'y2': 0,\n      'stroke-width': 0.5,\n      'stroke': 'black'\n    };\n    var hLine = this.createSvgElement('line', horizontalLineAttr);\n    hLine.setAttribute('id', documentEditor.element.id + '_vRuler_indicator');\n    vSvg.appendChild(hLine);\n    viewerContainer.insertBefore(vSvg, viewerContainer.firstChild);\n  };\n  RulerHelper.prototype.updateIndentMarkers = function (documentEditor) {\n    if (isNullOrUndefined(documentEditor) || isNullOrUndefined(documentEditor.element) || isNullOrUndefined(documentEditor.element.id) || isNullOrUndefined(documentEditor.hRuler) || isNullOrUndefined(documentEditor.hRuler.zeroPosition)) {\n      return;\n    }\n    var indent = undefined;\n    var ownerId = documentEditor.element.id;\n    var rulerZeroPoint = HelperMethods.convertPointToPixel(1584 - documentEditor.selectionModule.sectionFormat.leftMargin);\n    var currentIndentValue;\n    var finalValue;\n    var currentMargin;\n    var pixelValue;\n    // if (documentEditor.selection.end.paragraph.isInsideTable) {\n    //     currentIndentValue = documentEditor.selection.paragraphFormat.leftIndent;\n    //     currentMargin = documentEditor.selection.sectionFormat.leftMargin;\n    //     finalValue = HelperMethods.convertPointToPixel(currentIndentValue) + currentCell.x;\n    //     pixelValue = (((rulerZeroPoint + ((finalValue))) * documentEditor.zoomFactor)) + 'px';\n    //     indent = document.getElementById(ownerId + '_leftIndent');\n    //     if (!isNullOrUndefined(indent)) {\n    //         indent.style.left = pixelValue;\n    //     }\n    //     indent = document.getElementById(ownerId + '_hangingIndent');\n    //     if (!isNullOrUndefined(indent)) {\n    //         indent.style.left = pixelValue;\n    //     }\n    //     indent = document.getElementById(ownerId + '_firstLineIndent');\n    //     currentIndentValue = documentEditor.selection.paragraphFormat.firstLineIndent;\n    //     currentMargin = documentEditor.selection.paragraphFormat.leftIndent;\n    //     finalValue = HelperMethods.convertPointToPixel(currentIndentValue + currentMargin) + currentCell.x;\n    //     pixelValue = (((rulerZeroPoint + ((finalValue))) * documentEditor.zoomFactor)) + 'px';\n    //     if (!isNullOrUndefined(indent)) {\n    //         indent.style.left = pixelValue;\n    //     }\n    //     indent = document.getElementById(ownerId + '_rightIndent');\n    //     currentIndentValue = documentEditor.selection.paragraphFormat.rightIndent;\n    //     currentMargin = documentEditor.selection.sectionFormat.rightMargin;\n    //     finalValue = (currentCell.x + currentCell.width) - HelperMethods.convertPointToPixel(currentIndentValue);\n    //     pixelValue = ((rulerZeroPoint + finalValue - 2) * documentEditor.zoomFactor) + 'px';\n    //     if (!isNullOrUndefined(indent)) {\n    //         indent.style.left = pixelValue;\n    //     }\n    // }\n    // else {\n    //     indent = document.getElementById(ownerId + '_leftIndent');\n    //     currentIndentValue = documentEditor.selection.paragraphFormat.leftIndent;\n    //     currentMargin = documentEditor.selection.sectionFormat.leftMargin;\n    //     finalValue = currentMargin + currentIndentValue;\n    //     pixelValue = (((rulerZeroPoint + (HelperMethods.convertPointToPixel(finalValue))) * documentEditor.zoomFactor) - 6) + 'px';\n    //     if (!isNullOrUndefined(indent)) {\n    //         indent.style.left = pixelValue;\n    //     }\n    //     indent = document.getElementById(ownerId + '_hangingIndent');\n    //     if (!isNullOrUndefined(indent)) {\n    //         indent.style.left = pixelValue;\n    //     }\n    //     indent = document.getElementById(ownerId + '_firstLineIndent');\n    //     currentIndentValue = documentEditor.selection.paragraphFormat.firstLineIndent;\n    //     let leftIndent = documentEditor.selection.paragraphFormat.leftIndent;\n    //     let leftMargin = documentEditor.selection.sectionFormat.leftMargin;\n    //     if (currentIndentValue < 0 && leftIndent < 0) {\n    //         currentIndentValue = currentIndentValue < 0 ? 0 : currentIndentValue;\n    //     }\n    //     finalValue = leftMargin + leftIndent + currentIndentValue;\n    //     pixelValue = (((rulerZeroPoint + HelperMethods.convertPointToPixel(finalValue)) * documentEditor.zoomFactor) - 6) + 'px';\n    //     if (!isNullOrUndefined(indent)) {\n    //         indent.style.left = pixelValue;\n    //     }\n    //     indent = document.getElementById(ownerId + '_rightIndent');\n    //     currentIndentValue = documentEditor.selection.paragraphFormat.rightIndent;\n    //     currentMargin = documentEditor.selection.sectionFormat.rightMargin;\n    //     finalValue = documentEditor.selection.sectionFormat.pageWidth - (currentIndentValue + currentMargin);\n    //     pixelValue = (((rulerZeroPoint + HelperMethods.convertPointToPixel(finalValue)) * documentEditor.zoomFactor) - 6) + 'px';\n    //     if (!isNullOrUndefined(indent)) {\n    //         indent.style.left = pixelValue;\n    //     }\n    // }\n    var rulerGeometry = this.getRulerGeometry(documentEditor);\n    if (this.position.paragraph.paragraphFormat.bidi || this.position.paragraph.isInsideTable && this.position.paragraph.associatedCell.ownerTable.tableFormat.bidi) {\n      var rulerMarginDivWidth = rulerGeometry.width / documentEditor.zoomFactor - HelperMethods.convertPointToPixel(this.position.paragraph.bodyWidget.sectionFormat.rightMargin + this.position.paragraph.bodyWidget.sectionFormat.leftMargin);\n      rulerZeroPoint -= rulerMarginDivWidth;\n    }\n    var paraStart = !isNullOrUndefined(this.position.paragraph['absoluteXPosition']) ? parseFloat(this.position.paragraph['absoluteXPosition']['x'].toString()) : this.position.paragraph.x;\n    var paraWidth = !isNullOrUndefined(this.position.paragraph['absoluteXPosition']) ? parseFloat(this.position.paragraph['absoluteXPosition']['width'].toString()) : this.position.paragraph.width;\n    var finalValueTemp;\n    if (this.position.paragraph.paragraphFormat.bidi) {\n      rulerZeroPoint = HelperMethods.convertPointToPixel(1584 - documentEditor.selectionModule.sectionFormat.leftMargin - (documentEditor.selectionModule.sectionFormat.pageWidth - documentEditor.selectionModule.sectionFormat.leftMargin - documentEditor.selectionModule.sectionFormat.rightMargin));\n    }\n    var leftIndent = document.getElementById(documentEditor.element.id + '_leftIndent');\n    var rightIndent = document.getElementById(documentEditor.element.id + '_rightIndent');\n    if (this.position.paragraph.paragraphFormat.bidi) {\n      leftIndent.setAttribute('title', this.locale.getConstant('Right Indent'));\n      rightIndent.setAttribute('title', this.locale.getConstant('Left Indent'));\n      finalValueTemp = rulerZeroPoint + paraStart + paraWidth;\n    } else {\n      leftIndent.setAttribute('title', this.locale.getConstant('Left Indent'));\n      rightIndent.setAttribute('title', this.locale.getConstant('Right Indent'));\n      finalValueTemp = rulerZeroPoint + paraStart;\n    }\n    var firstLineIndent = this.position.paragraph.paragraphFormat.firstLineIndent;\n    indent = document.getElementById(ownerId + '_leftIndent');\n    if (!isNullOrUndefined(indent)) {\n      if (documentEditor.layoutType === 'Pages') {\n        indent.style.left = finalValueTemp * documentEditor.zoomFactor - 6 + 'px';\n      } else if (documentEditor.layoutType === 'Continuous') {\n        if (this.position.paragraph.paragraphFormat.bidi) {\n          rulerZeroPoint = documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor - 20 - documentEditor.viewer.clientArea.width;\n          finalValueTemp = rulerZeroPoint + paraStart + paraWidth;\n          indent.style.left = finalValueTemp + 'px';\n        } else {\n          rulerZeroPoint = documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor - 20;\n          finalValueTemp = rulerZeroPoint + paraStart * documentEditor.zoomFactor;\n          indent.style.left = finalValueTemp + 'px';\n        }\n      }\n    }\n    indent = document.getElementById(ownerId + '_hangingIndent');\n    if (!isNullOrUndefined(indent)) {\n      if (documentEditor.layoutType === 'Pages') {\n        indent.style.left = finalValueTemp * documentEditor.zoomFactor - 6 + 'px';\n      } else if (documentEditor.layoutType === 'Continuous') {\n        if (this.position.paragraph.paragraphFormat.bidi) {\n          rulerZeroPoint = documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor - 20 - documentEditor.viewer.clientArea.width;\n          finalValueTemp = rulerZeroPoint + paraStart + paraWidth;\n          indent.style.left = finalValueTemp + 'px';\n        } else {\n          rulerZeroPoint = documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor - 20;\n          finalValueTemp = rulerZeroPoint + paraStart * documentEditor.zoomFactor;\n          indent.style.left = finalValueTemp + 'px';\n        }\n      }\n    }\n    indent = document.getElementById(ownerId + '_firstLineIndent');\n    if (documentEditor.layoutType === 'Pages') {\n      if (!isNullOrUndefined(indent)) {\n        if (this.position.paragraph.paragraphFormat.bidi) {\n          indent.style.left = (finalValueTemp - HelperMethods.convertPointToPixel(firstLineIndent)) * documentEditor.zoomFactor - 6 + 'px';\n        } else {\n          indent.style.left = (finalValueTemp + HelperMethods.convertPointToPixel(firstLineIndent)) * documentEditor.zoomFactor - 6 + 'px';\n        }\n      }\n    } else if (documentEditor.layoutType === 'Continuous') {\n      if (this.position.paragraph.paragraphFormat.bidi) {\n        rulerZeroPoint = documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor - 20 - documentEditor.viewer.clientArea.width;\n        finalValueTemp = rulerZeroPoint + paraStart + paraWidth - HelperMethods.convertPointToPixel(firstLineIndent) * documentEditor.zoomFactor;\n      } else {\n        rulerZeroPoint = documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor - 20;\n        finalValueTemp = rulerZeroPoint + (paraStart + HelperMethods.convertPointToPixel(firstLineIndent)) * documentEditor.zoomFactor;\n      }\n      indent.style.left = finalValueTemp + 'px';\n    }\n    indent = document.getElementById(ownerId + '_rightIndent');\n    if (documentEditor.layoutType === 'Pages') {\n      if (this.position.paragraph.paragraphFormat.bidi) {\n        finalValueTemp = rulerZeroPoint + paraStart;\n      } else {\n        finalValueTemp = rulerZeroPoint + paraStart + paraWidth;\n      }\n      if (!isNullOrUndefined(indent)) {\n        indent.style.left = finalValueTemp * documentEditor.zoomFactor - 6 + 'px';\n      }\n    } else if (documentEditor.layoutType === 'Continuous') {\n      if (this.position.paragraph.paragraphFormat.bidi) {\n        rulerZeroPoint = documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor - 20 - documentEditor.viewer.clientArea.width * documentEditor.zoomFactor;\n        finalValueTemp = rulerZeroPoint + paraStart;\n        indent.style.left = finalValueTemp + 'px';\n      } else {\n        rulerZeroPoint = documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor - 20;\n        finalValueTemp = rulerZeroPoint + (paraStart + paraWidth) * documentEditor.zoomFactor;\n        indent.style.left = finalValueTemp + 'px';\n      }\n    }\n  };\n  RulerHelper.prototype.updateTabStopMarkers = function (documentEditor) {\n    if (isNullOrUndefined(documentEditor) || isNullOrUndefined(documentEditor.element) || isNullOrUndefined(documentEditor.element.id) || isNullOrUndefined(documentEditor.hRuler) || isNullOrUndefined(documentEditor.hRuler.zeroPosition)) {\n      return;\n    }\n    var locale = new L10n('documenteditor', documentEditor.defaultLocale);\n    locale.setLocale(documentEditor.locale);\n    var ownerId = documentEditor.element.id;\n    var element = document.getElementById(ownerId + '_markIndicator');\n    element.style.display = documentEditor.layoutType === 'Pages' ? 'block' : 'none';\n    var paragarph = this.position.paragraph;\n    var tabs = paragarph.paragraphFormat.tabs;\n    var zoomFactor = documentEditor.zoomFactor;\n    var rulerSize = this.getRulerSize(documentEditor);\n    var RenderedTabElement = HelperMethods.convertNodeListToArray(document.querySelectorAll('.e-de-ruler-tab'));\n    for (var i = 0; i < tabs.length; i++) {\n      var tabStop = tabs[parseInt(i.toString(), 10)];\n      var justification = tabStop.tabJustification;\n      // const position: number = tabStop.position;\n      var id = documentEditor.element.id + '_' + justification + 'Tab_' + i.toString();\n      var tabMarker = document.getElementById(id);\n      if (!isNullOrUndefined(tabMarker)) {\n        if (!isNullOrUndefined(RenderedTabElement) && RenderedTabElement.length > 0) {\n          RenderedTabElement.splice(RenderedTabElement.indexOf(tabMarker), 1);\n        }\n        var value = this.position.paragraph.paragraphFormat.bidi ? HelperMethods.convertPointToPixel(1584 - tabStop.position) : HelperMethods.convertPointToPixel(1584 + tabStop.position);\n        if (justification === 'Center' || justification === 'Decimal') {\n          tabMarker.style.left = value * zoomFactor - 4 + 'px';\n        } else if (justification === 'Right') {\n          tabMarker.style.left = value * zoomFactor - 5.5 + 'px';\n        } else {\n          tabMarker.style.left = value * zoomFactor - 1.5 + 'px';\n        }\n      } else {\n        if (justification !== \"List\") {\n          this.renderTab(documentEditor, rulerSize, tabStop, justification, i, locale);\n        }\n      }\n    }\n    if (!isNullOrUndefined(RenderedTabElement)) {\n      for (var i = 0; i < RenderedTabElement.length; i++) {\n        var elementToRemove = RenderedTabElement[parseInt(i.toString(), 10)];\n        if (!isNullOrUndefined(elementToRemove)) {\n          elementToRemove.parentNode.removeChild(elementToRemove);\n        }\n      }\n    }\n  };\n  RulerHelper.prototype.renderRulerMargins = function (documentEditor, isHorizontal, rulerContainer) {\n    var rulerSize = this.getRulerSize(documentEditor);\n    var rulerGeometry = this.getRulerGeometry(documentEditor);\n    var height = isHorizontal ? documentEditor.selectionModule.end.paragraph.bodyWidget.page.boundingRectangle.x : documentEditor.selectionModule.end.paragraph.bodyWidget.page.boundingRectangle.y + rulerSize.height;\n    // const margin: string = isHorizontal ? ('margin-left:' + height + 'px;') : ('margin-top:' + height + 'px;');\n    //const leftMarginValue = 2112 - (HelperMethods.convertPointToPixel(documentEditor.selection.end.paragraph.bodyWidget.sectionFormat.leftMargin));\n    var leftMarginValue = 2112 * documentEditor.zoomFactor;\n    var rulerMarginDiv;\n    var rulerMargin = isHorizontal ? 'margin-left:' + leftMarginValue + 'px;' : 'margin-top:' + leftMarginValue + 'px;';\n    var rulerHeight = isHorizontal ? rulerSize.height : rulerGeometry.height - HelperMethods.convertPointToPixel(documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.topMargin + documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.bottomMargin) * documentEditor.zoomFactor;\n    // const rulerHeight =  (isHorizontal ? rulerSize.height : rulerGeometry.height);\n    if (isHorizontal) {\n      for (var i = 1; i <= 13; i++) {\n        rulerMarginDiv = document.getElementById(documentEditor.element.id + '_hRuler_Margin' + i);\n        if (!rulerMarginDiv) {\n          var rulerstyle = 'height:' + rulerHeight + 'px;overflow:hidden;width:' + (rulerGeometry.width - HelperMethods.convertPointToPixel(documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.rightMargin + documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin) * documentEditor.zoomFactor) + 'px;position:absolute;' + 'font-size:9px;text-align: left;z-index: -1;display: block' + rulerMargin;\n          var rulerattributes = {\n            'id': documentEditor.element.id + '_hRuler_Margin' + i,\n            style: rulerstyle,\n            class: 'e-de-ruler-margin'\n          };\n          rulerMarginDiv = this.createHtmlElement('div', rulerattributes);\n        }\n        rulerContainer.appendChild(rulerMarginDiv);\n      }\n    } else {\n      if (!rulerMarginDiv) {\n        rulerMarginDiv = document.getElementById(documentEditor.element.id + '_vRuler_Margin');\n        var rulerstyle = 'height:' + rulerHeight + 'px;overflow:hidden;width:' + rulerSize.width + 'px;position:absolute;' + 'font-size:9px;text-align: left;z-index: -1;' + rulerMargin;\n        var rulerattributes = {\n          'id': documentEditor.element.id + '_vRuler_Margin',\n          style: rulerstyle,\n          class: 'e-de-ruler-margin'\n        };\n        rulerMarginDiv = this.createHtmlElement('div', rulerattributes);\n      }\n      rulerContainer.appendChild(rulerMarginDiv);\n    }\n  };\n  RulerHelper.prototype.updateRulerMargins = function (documentEditor) {\n    var rulerGeometry = this.getRulerGeometry(documentEditor);\n    var leftMarginValue = documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor;\n    this.updateHorizontalRulerMargin(documentEditor);\n    var verticalRulerMarginDiv = document.getElementById(documentEditor.element.id + '_vRuler_Margin');\n    var rulerMarginDivHeight = rulerGeometry.height - HelperMethods.convertPointToPixel(documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.bottomMargin * documentEditor.zoomFactor + documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.topMargin * documentEditor.zoomFactor);\n    verticalRulerMarginDiv.style.marginTop = leftMarginValue + \"px\";\n    verticalRulerMarginDiv.style.height = rulerMarginDivHeight + \"px\";\n  };\n  RulerHelper.prototype.updateHorizontalRulerMargin = function (documentEditor) {\n    var columns = documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.columns;\n    var leftMarginValue = documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor;\n    var skipLoop = false;\n    var paraBidi = this.position.paragraph.paragraphFormat.bidi;\n    var tableBidi = false;\n    var currnLefttMargin = HelperMethods.convertPointToPixel(documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin - 72);\n    var currentRightMargin = HelperMethods.convertPointToPixel(documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.rightMargin - 72);\n    if (this.position.paragraph.isInsideTable) {\n      tableBidi = this.position.paragraph.associatedCell.ownerTable.tableFormat.bidi;\n    }\n    var rulerMarginDivWidth = this.getRulerGeometry(documentEditor).width - HelperMethods.convertPointToPixel(documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.rightMargin * documentEditor.zoomFactor + documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin * documentEditor.zoomFactor);\n    if (paraBidi || tableBidi) {\n      leftMarginValue = documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor - rulerMarginDivWidth;\n    }\n    for (var i = 0; i < 13; i++) {\n      var horizontalRulerMarginDiv = document.getElementById(documentEditor.element.id + '_hRuler_Margin' + (i + 1));\n      if (horizontalRulerMarginDiv) {\n        if (columns.length === 0 && !skipLoop || documentEditor.layoutType === \"Continuous\" && !skipLoop) {\n          if (paraBidi || tableBidi) {\n            var startValue = documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor - rulerMarginDivWidth;\n            horizontalRulerMarginDiv.style.marginLeft = startValue + \"px\";\n          } else {\n            horizontalRulerMarginDiv.style.marginLeft = leftMarginValue + \"px\";\n          }\n          horizontalRulerMarginDiv.style.display = 'block';\n          if (documentEditor.layoutType === 'Continuous') {\n            var paraWidth = !isNullOrUndefined(this.position.paragraph['absoluteXPosition']) ? parseFloat(this.position.paragraph['absoluteXPosition']['width'].toString()) : this.position.paragraph.width;\n            horizontalRulerMarginDiv.style.width = paraWidth * documentEditor.zoomFactor + \"px\";\n          } else {\n            horizontalRulerMarginDiv.style.width = rulerMarginDivWidth + \"px\";\n          }\n          skipLoop = true;\n        } else if (columns.length >= i + 1 && documentEditor.layoutType === \"Pages\") {\n          if (paraBidi || tableBidi) {\n            horizontalRulerMarginDiv.style.marginLeft = leftMarginValue + 'px';\n            leftMarginValue -= (currnLefttMargin + currentRightMargin) / columns.length * documentEditor.zoomFactor;\n            leftMarginValue = leftMarginValue + (columns[parseInt(i.toString(), 10)].width + columns[parseInt(i.toString(), 10)].space) * documentEditor.zoomFactor;\n          } else {\n            horizontalRulerMarginDiv.style.marginLeft = leftMarginValue + 'px';\n            leftMarginValue -= (currnLefttMargin + currentRightMargin) / columns.length * documentEditor.zoomFactor;\n            leftMarginValue = leftMarginValue + (columns[parseInt(i.toString(), 10)].width + columns[parseInt(i.toString(), 10)].space) * documentEditor.zoomFactor;\n          }\n          horizontalRulerMarginDiv.style.display = 'block';\n          horizontalRulerMarginDiv.style.width = (columns[parseInt(i.toString(), 10)].width - (currnLefttMargin + currentRightMargin) / columns.length) * documentEditor.zoomFactor + \"px\";\n        } else {\n          horizontalRulerMarginDiv.style.display = 'none';\n        }\n      }\n    }\n  };\n  RulerHelper.prototype.resizeVRulerMargins = function (isRulerTopMargin, currentTopMargin, currentScrollTop, currentBottomMargin, ruler, mousePosition, documentEditor) {\n    var rulerMarginDiv = document.getElementById(documentEditor.element.id + '_vRuler_Margin');\n    var rulerGeometry = this.getRulerGeometry(documentEditor);\n    if (isRulerTopMargin) {\n      rulerMarginDiv.style.height = (rulerGeometry.height - HelperMethods.convertPointToPixel(documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.bottomMargin * documentEditor.zoomFactor + mousePosition)).toString() + \"px\";\n      if (currentTopMargin < mousePosition) {\n        ruler.scrollTop = currentScrollTop - HelperMethods.convertPointToPixel(mousePosition - currentTopMargin);\n      } else {\n        ruler.scrollTop = currentScrollTop + HelperMethods.convertPointToPixel(currentTopMargin - mousePosition);\n      }\n    } else {\n      var bottomMargin = HelperMethods.convertPixelToPoint(rulerGeometry.height) - mousePosition;\n      rulerMarginDiv.style.height = (rulerGeometry.height - HelperMethods.convertPointToPixel(documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.topMargin * documentEditor.zoomFactor + bottomMargin)).toString() + \"px\";\n      if (currentBottomMargin < mousePosition) {\n        //  ruler.scrollLeft = currentScrollLeft - HelperMethods.convertPointToPixel(mousePosition - currentRightMargin);\n      } else {\n        //  ruler.scrollLeft = currentScrollLeft + HelperMethods.convertPointToPixel(currentRightMargin - mousePosition);\n      }\n    }\n  };\n  RulerHelper.prototype.resizeRulerMargins = function (isRulerLeftMargin, currentLeftMargin, currentScrollLeft, currentRightMargin, ruler, mousePosition, isHorizontal, documentEditor) {\n    var rulerMarginDiv = document.getElementById(documentEditor.element.id + (isHorizontal ? '_hRuler_Margin1' : '_vRuler_Margin'));\n    var rulerGeometry = this.getRulerGeometry(documentEditor);\n    if (!isNullOrUndefined(isRulerLeftMargin) && isRulerLeftMargin) {\n      rulerMarginDiv.style.width = (rulerGeometry.width - HelperMethods.convertPointToPixel(documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.rightMargin * documentEditor.zoomFactor + mousePosition)).toString() + \"px\";\n      if (currentLeftMargin < mousePosition) {\n        ruler.scrollLeft = currentScrollLeft - HelperMethods.convertPointToPixel(mousePosition - currentLeftMargin);\n      } else {\n        ruler.scrollLeft = currentScrollLeft + HelperMethods.convertPointToPixel(currentLeftMargin - mousePosition);\n      }\n    } else {\n      var rightMargin = HelperMethods.convertPixelToPoint(rulerGeometry.width) - mousePosition;\n      rulerMarginDiv.style.width = (rulerGeometry.width - HelperMethods.convertPointToPixel(documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin * documentEditor.zoomFactor + rightMargin)).toString() + \"px\";\n      if (currentRightMargin < mousePosition) {\n        //  ruler.scrollLeft = currentScrollLeft - HelperMethods.convertPointToPixel(mousePosition - currentRightMargin);\n      } else {\n        //  ruler.scrollLeft = currentScrollLeft + HelperMethods.convertPointToPixel(currentRightMargin - mousePosition);\n      }\n    }\n  };\n  RulerHelper.prototype.getRulerOrigin = function () {\n    var range = 1584;\n    var pixelValue = HelperMethods.convertPointToPixel(1584);\n    //console.log('PixelValue: ', pixelValue);\n    //console.log('PointsValue: ', range);\n  };\n  RulerHelper.prototype.renderIndents = function (documentEditor, isHorizontal, rulerSize, rulerGeometry, locale) {\n    var _this = this;\n    var hRuler = document.getElementById(documentEditor.element.id + '_hRuler');\n    var firstLineIndent = document.getElementById(documentEditor.element.id + '_firstLineIndent');\n    if (!firstLineIndent) {\n      var margin = 'left:' + (HelperMethods.convertPointToPixel(documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin) - 6) * documentEditor.zoomFactor + 'px;';\n      var style = 'height:' + (rulerSize.height - 3) / 2 + 'px;overflow:hidden;width:12px;position:absolute;font-size:11px;text-align: left;z-index: 5;' + margin;\n      var attributes = {\n        'id': documentEditor.element.id + '_firstLineIndent',\n        style: style,\n        'data-name': 'FirstLineIndent',\n        class: 'e-de-ruler-indent'\n      };\n      firstLineIndent = this.createHtmlElement('div', attributes);\n      firstLineIndent.setAttribute('title', locale.getConstant('First Line Indent'));\n      var svg = void 0;\n      // Create an SVG element\n      var attr = {\n        'id': documentEditor.element.id + '_firstLineIndent_svg',\n        width: rulerSize.width + 'px',\n        height: (rulerSize.height - 3) / 2 + 'px',\n        style: 'position:inherit;left:0px'\n      };\n      svg = this.createSvgElement('svg', attr);\n      svg.setAttribute(\"fill\", \"none\");\n      var pathattr = {\n        style: 'position:inherit;left:0px'\n      };\n      // Create a path element inside the SVG\n      var pathElement = this.createSvgElement('path', pathattr);\n      pathElement.setAttribute(\"class\", \"e-de-ruler-indent-svg\");\n      pathElement.setAttribute(\"d\", \"M 0.5 0.5 H 11.5 V 2.7128 L 6 5.4211 L 0.5 2.7128 V 0.5 Z\");\n      pathElement.setAttribute(\"fill\", \"white\");\n      pathElement.setAttribute(\"stroke\", \"#A1A1A1\");\n      // Append the path element to the SVG element\n      svg.appendChild(pathElement);\n      firstLineIndent.appendChild(svg);\n      hRuler.append(firstLineIndent);\n      firstLineIndent.addEventListener(\"dblclick\", function (event) {\n        documentEditor.showDialog('Paragraph');\n        event.stopPropagation();\n      });\n      //Draggable for first line Indent.\n      var isDragging_1 = false;\n      var firstLineOffset_1;\n      var initialValue_1 = HelperMethods.getNumberFromString(firstLineIndent.style.left); // for mouse up event\n      var initialValue2 = HelperMethods.getNumberFromString(firstLineIndent.style.left); // for mouse move event\n      firstLineIndent.addEventListener(\"mouseenter\", function (e) {\n        documentEditor.isOnIndent = true;\n      });\n      firstLineIndent.addEventListener(\"mouseleave\", function (e) {\n        documentEditor.isOnIndent = false;\n      });\n      firstLineIndent.addEventListener(\"mousedown\", function (e) {\n        isDragging_1 = true;\n        firstLineOffset_1 = e.clientX - firstLineIndent.getBoundingClientRect().left;\n        initialValue_1 = HelperMethods.getNumberFromString(firstLineIndent.style.left);\n        var rulerZeroPoint = HelperMethods.convertPointToPixel(1584 - documentEditor.selectionModule.sectionFormat.leftMargin) * documentEditor.zoomFactor;\n        if (documentEditor.selectionModule.paragraphFormat.bidi) {\n          rulerZeroPoint = HelperMethods.convertPointToPixel(1584 - documentEditor.selectionModule.sectionFormat.leftMargin - (documentEditor.selectionModule.sectionFormat.pageWidth - documentEditor.selectionModule.sectionFormat.leftMargin - documentEditor.selectionModule.sectionFormat.rightMargin)) * documentEditor.zoomFactor;\n        }\n        if (documentEditor.layoutType === 'Continuous') {\n          rulerZeroPoint = documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor - 20;\n          if (documentEditor.selectionModule.paragraphFormat.bidi) {\n            rulerZeroPoint = documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor - 20 - documentEditor.viewer.clientArea.width * documentEditor.zoomFactor;\n          }\n        }\n        var value = rulerZeroPoint + e.clientX - firstLineOffset_1 - hRuler.getBoundingClientRect().left;\n        var startValue = documentEditor.documentHelper.currentPage.boundingRectangle.x;\n        startValue = documentEditor.layoutType === 'Continuous' ? 0 : startValue;\n        var indicatorLineValue = startValue + (value - rulerZeroPoint) + 6;\n        var lineSvg = document.getElementById(documentEditor.element.id + '_hRuler_indicator_svg');\n        lineSvg.style.left = indicatorLineValue + 'px';\n        lineSvg.style.display = 'block';\n        e.stopPropagation();\n      });\n      document.addEventListener(\"mousemove\", function (e) {\n        if (isDragging_1) {\n          var rulerZeroPoint = void 0;\n          var maxValue = void 0;\n          var minValue = void 0;\n          var rightIndent_1 = document.getElementById(documentEditor.element.id + '_rightIndent');\n          var rightIndentValue = HelperMethods.getNumberFromString(rightIndent_1.style.left);\n          if (documentEditor.layoutType === 'Pages') {\n            if (documentEditor.selectionModule.paragraphFormat.bidi) {\n              rulerZeroPoint = HelperMethods.convertPointToPixel(1584 - documentEditor.selectionModule.sectionFormat.leftMargin - (documentEditor.selectionModule.sectionFormat.pageWidth - documentEditor.selectionModule.sectionFormat.leftMargin - documentEditor.selectionModule.sectionFormat.rightMargin)) * documentEditor.zoomFactor;\n              maxValue = rulerZeroPoint - 6 + HelperMethods.convertPointToPixel(documentEditor.selectionModule.sectionFormat.pageWidth) * documentEditor.zoomFactor;\n              minValue = rightIndentValue + HelperMethods.convertPointToPixel(42) * documentEditor.zoomFactor;\n            } else {\n              rulerZeroPoint = HelperMethods.convertPointToPixel(1584 - documentEditor.selectionModule.sectionFormat.leftMargin) * documentEditor.zoomFactor;\n              minValue = rulerZeroPoint - 6;\n              maxValue = rightIndentValue - HelperMethods.convertPointToPixel(42) * documentEditor.zoomFactor;\n            }\n          } else if (documentEditor.layoutType === 'Continuous') {\n            if (_this.position.paragraph.paragraphFormat.bidi) {\n              rulerZeroPoint = documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor - 20 - documentEditor.viewer.clientArea.width * documentEditor.zoomFactor;\n              maxValue = documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor - 20 + 40 - 6;\n              minValue = rightIndentValue + HelperMethods.convertPointToPixel(42) * documentEditor.zoomFactor;\n            } else {\n              rulerZeroPoint = documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor - 20;\n              minValue = rulerZeroPoint - 6;\n              maxValue = rightIndentValue - HelperMethods.convertPointToPixel(42) * documentEditor.zoomFactor;\n            }\n          }\n          var value = rulerZeroPoint + e.clientX - firstLineOffset_1 - hRuler.getBoundingClientRect().left;\n          if (value < minValue) {\n            value = minValue;\n          } else if (value > maxValue) {\n            value = maxValue;\n          }\n          firstLineIndent.style.left = value + \"px\";\n          var startValue = documentEditor.documentHelper.currentPage.boundingRectangle.x;\n          startValue = documentEditor.layoutType === 'Continuous' ? 0 : startValue;\n          var indicatorLineValue = startValue + (value - rulerZeroPoint) + 6;\n          var lineSvg = document.getElementById(documentEditor.element.id + '_hRuler_indicator_svg');\n          lineSvg.style.left = indicatorLineValue + 'px';\n        }\n      });\n      document.addEventListener(\"mouseup\", function () {\n        if (isDragging_1) {\n          isDragging_1 = false;\n          var finalValue = HelperMethods.getNumberFromString(firstLineIndent.style.left);\n          if (parseInt(firstLineIndent.style.left.replace('px', '')) < 0) {\n            finalValue *= -1;\n          }\n          if (documentEditor.selectionModule.paragraphFormat.bidi) {\n            documentEditor.editorModule.applyRulerMarkerValues('firstLineIndent', finalValue, initialValue_1);\n          } else {\n            documentEditor.editorModule.applyRulerMarkerValues('firstLineIndent', initialValue_1, finalValue);\n          }\n          initialValue_1 = finalValue;\n          var lineSvg = document.getElementById(documentEditor.element.id + '_hRuler_indicator_svg');\n          lineSvg.style.display = 'none';\n        }\n      });\n    }\n    //Rendering HangingIndent\n    var hangingIndent = document.getElementById(documentEditor.element.id + '_hangingIndent');\n    if (!hangingIndent) {\n      var margin = 'left:' + (HelperMethods.convertPointToPixel(documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin) - 6) + 'px;';\n      var style = 'height:' + rulerSize.height / 2 + 'px;top:' + ((rulerSize.height - 3) / 2 + 1) + 'px;overflow:hidden;width:12px;position:absolute;font-size:11px;text-align: left;z-index: 5;' + margin;\n      var attributes = {\n        'id': documentEditor.element.id + '_hangingIndent',\n        style: style,\n        'data-name': 'HangingIndent',\n        class: 'e-de-ruler-indent'\n      };\n      hangingIndent = this.createHtmlElement('div', attributes);\n      hangingIndent.setAttribute('title', locale.getConstant('Hanging Indent'));\n      var hangingIndentSvg = void 0;\n      // Create an SVG element\n      var attr = {\n        'id': documentEditor.element.id + '_hangingIndent_svg',\n        width: rulerSize.width + 'px',\n        height: (rulerSize.height - 3) / 2 + 'px',\n        style: 'position:inherit;left:0px'\n      };\n      hangingIndentSvg = this.createSvgElement('svg', attr);\n      hangingIndentSvg.setAttribute(\"fill\", \"none\");\n      var pathattr = {\n        style: 'position:inherit;left:0px'\n      };\n      // Create a path element inside the SVG\n      var pathElement = this.createSvgElement('path', pathattr);\n      pathElement.setAttribute(\"class\", \"e-de-ruler-indent-svg\");\n      pathElement.setAttribute(\"d\", \"M 0.5 5.3211 H 11.5 V 3.1083 L 6 0.4 L 0.5 3.1083 V 5.3211 Z\");\n      pathElement.setAttribute(\"fill\", \"white\");\n      pathElement.setAttribute(\"stroke\", \"#A1A1A1\");\n      // Append the path element to the SVG element\n      hangingIndentSvg.appendChild(pathElement);\n      hangingIndent.appendChild(hangingIndentSvg);\n      hRuler.append(hangingIndent);\n      hangingIndent.addEventListener(\"dblclick\", function (event) {\n        documentEditor.showDialog('Paragraph');\n        event.stopPropagation();\n      });\n      //Draggable for hanging line Indent.\n      var isDragging_2 = false;\n      var hangingLineOffset_1;\n      var initialValue_2 = HelperMethods.getNumberFromString(hangingIndent.style.left); // for mouse up event\n      var initialValue2 = HelperMethods.getNumberFromString(hangingIndent.style.left); // for mouse move event\n      var minLimit_1;\n      var maxLimit_1;\n      var leftIndent_1;\n      hangingIndent.addEventListener(\"mouseenter\", function (e) {\n        documentEditor.isOnIndent = true;\n      });\n      hangingIndent.addEventListener(\"mouseleave\", function (e) {\n        documentEditor.isOnIndent = false;\n      });\n      hangingIndent.addEventListener(\"mousedown\", function (e) {\n        isDragging_2 = true;\n        hangingLineOffset_1 = e.clientX - hangingIndent.getBoundingClientRect().left;\n        initialValue_2 = HelperMethods.getNumberFromString(hangingIndent.style.left);\n        var rightIndent = document.getElementById(documentEditor.element.id + '_rightIndent');\n        var rightPosition = HelperMethods.getNumberFromString(rightIndent.style.left);\n        var rulerZeroPoint;\n        if (documentEditor.layoutType === 'Pages') {\n          if (documentEditor.selectionModule.paragraphFormat.bidi) {\n            rulerZeroPoint = HelperMethods.convertPointToPixel(1584 - documentEditor.selectionModule.sectionFormat.leftMargin - (documentEditor.selectionModule.sectionFormat.pageWidth - documentEditor.selectionModule.sectionFormat.leftMargin - documentEditor.selectionModule.sectionFormat.rightMargin)) * documentEditor.zoomFactor;\n            minLimit_1 = rightPosition + HelperMethods.convertPointToPixel(42) * documentEditor.zoomFactor;\n            maxLimit_1 = rulerZeroPoint - 6 + HelperMethods.convertPointToPixel(documentEditor.selectionModule.sectionFormat.pageWidth) * documentEditor.zoomFactor;\n          } else {\n            rulerZeroPoint = HelperMethods.convertPointToPixel(1584 - documentEditor.selectionModule.sectionFormat.leftMargin) * documentEditor.zoomFactor;\n            minLimit_1 = rulerZeroPoint - 6;\n            maxLimit_1 = rightPosition - HelperMethods.convertPointToPixel(42) * documentEditor.zoomFactor;\n          }\n        } else if (documentEditor.layoutType === 'Continuous') {\n          if (_this.position.paragraph.paragraphFormat.bidi) {\n            rulerZeroPoint = documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor - 20 - documentEditor.viewer.clientArea.width * documentEditor.zoomFactor;\n            maxLimit_1 = documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor - 20 + 40 - 6;\n            minLimit_1 = rightPosition + HelperMethods.convertPointToPixel(42) * documentEditor.zoomFactor;\n          } else {\n            rulerZeroPoint = documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor - 20;\n            minLimit_1 = rulerZeroPoint - 6;\n            maxLimit_1 = rightPosition - HelperMethods.convertPointToPixel(42) * documentEditor.zoomFactor;\n          }\n        }\n        leftIndent_1 = document.getElementById(documentEditor.element.id + '_leftIndent');\n        var value = rulerZeroPoint + e.clientX - hangingLineOffset_1 - hRuler.getBoundingClientRect().left;\n        var startValue = documentEditor.documentHelper.currentPage.boundingRectangle.x;\n        startValue = documentEditor.layoutType === 'Continuous' ? 0 : startValue;\n        var indicatorLineValue = startValue + (value - rulerZeroPoint) + 6;\n        var lineSvg = document.getElementById(documentEditor.element.id + '_hRuler_indicator_svg');\n        lineSvg.style.left = indicatorLineValue + 'px';\n        lineSvg.style.display = 'block';\n        e.stopPropagation();\n      });\n      document.addEventListener(\"mousemove\", function (e) {\n        if (isDragging_2) {\n          var rulerZeroPoint = void 0;\n          if (documentEditor.layoutType === 'Pages') {\n            if (documentEditor.selectionModule.paragraphFormat.bidi) {\n              rulerZeroPoint = HelperMethods.convertPointToPixel(1584 - documentEditor.selectionModule.sectionFormat.leftMargin - (documentEditor.selectionModule.sectionFormat.pageWidth - documentEditor.selectionModule.sectionFormat.leftMargin - documentEditor.selectionModule.sectionFormat.rightMargin)) * documentEditor.zoomFactor;\n            } else {\n              rulerZeroPoint = HelperMethods.convertPointToPixel(1584 - documentEditor.selectionModule.sectionFormat.leftMargin) * documentEditor.zoomFactor;\n            }\n          } else if (documentEditor.layoutType === 'Continuous') {\n            if (_this.position.paragraph.paragraphFormat.bidi) {\n              rulerZeroPoint = documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor - 20 - documentEditor.viewer.clientArea.width * documentEditor.zoomFactor;\n            } else {\n              rulerZeroPoint = documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor - 20;\n            }\n          }\n          var value = rulerZeroPoint + e.clientX - hangingLineOffset_1 - hRuler.getBoundingClientRect().left;\n          if (value > maxLimit_1) {\n            value = maxLimit_1;\n          } else if (value < minLimit_1) {\n            value = minLimit_1;\n          }\n          leftIndent_1.style.left = value + \"px\";\n          hangingIndent.style.left = value + \"px\";\n          var startValue = documentEditor.documentHelper.currentPage.boundingRectangle.x;\n          startValue = documentEditor.layoutType === 'Continuous' ? 0 : startValue;\n          var indicatorLineValue = startValue + (value - rulerZeroPoint) + 6;\n          var lineSvg = document.getElementById(documentEditor.element.id + '_hRuler_indicator_svg');\n          lineSvg.style.left = indicatorLineValue + 'px';\n        }\n      });\n      document.addEventListener(\"mouseup\", function () {\n        if (isDragging_2) {\n          isDragging_2 = false;\n          var finalValue = HelperMethods.getNumberFromString(hangingIndent.style.left);\n          if (parseInt(hangingIndent.style.left.replace('px', '')) < 0) {\n            finalValue *= -1;\n          }\n          if (documentEditor.selectionModule.paragraphFormat.bidi) {\n            documentEditor.editorModule.applyRulerMarkerValues('hangingIndent', finalValue, initialValue_2);\n          } else {\n            documentEditor.editorModule.applyRulerMarkerValues('hangingIndent', initialValue_2, finalValue);\n          }\n          initialValue_2 = finalValue;\n          var lineSvg = document.getElementById(documentEditor.element.id + '_hRuler_indicator_svg');\n          lineSvg.style.display = 'none';\n        }\n      });\n    }\n    //Rendering LeftIndent\n    var leftIndent = document.getElementById(documentEditor.element.id + '_leftIndent');\n    if (!leftIndent) {\n      var margin = 'left:' + (HelperMethods.convertPointToPixel(documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin) - 6) + 'px;';\n      var style = 'height:4px;top:11px;overflow:hidden;width:12px;position:absolute;font-size:11px;text-align: left;z-index: 5;' + margin;\n      var attributes = {\n        'id': documentEditor.element.id + '_leftIndent',\n        style: style,\n        class: 'e-de-ruler-indent'\n      };\n      leftIndent = this.createHtmlElement('div', attributes);\n      leftIndent.setAttribute('title', locale.getConstant('Left Indent'));\n      var leftIndentSvg = void 0;\n      // Create an SVG element\n      var attr = {\n        'id': documentEditor.element.id + '_leftIndent_svg',\n        width: rulerSize.width + 'px',\n        height: '4px',\n        style: 'position:inherit;left:0px'\n      };\n      leftIndentSvg = this.createSvgElement('svg', attr);\n      leftIndentSvg.setAttribute(\"fill\", \"none\");\n      var pathattr = {\n        style: 'position:inherit;left:0px'\n      };\n      // Create a path element inside the SVG\n      var pathElement = this.createSvgElement('path', pathattr);\n      pathElement.setAttribute(\"class\", \"e-de-ruler-indent-svg\");\n      pathElement.setAttribute(\"d\", \"M 0.5 3.5 H 11.5 V 0.5 H 0.5 V 3.5 Z\");\n      pathElement.setAttribute(\"fill\", \"white\");\n      pathElement.setAttribute(\"stroke\", \"#A1A1A1\");\n      // Append the path element to the SVG element\n      leftIndentSvg.appendChild(pathElement);\n      leftIndent.appendChild(leftIndentSvg);\n      hRuler.append(leftIndent);\n      leftIndent.addEventListener(\"dblclick\", function (event) {\n        documentEditor.showDialog('Paragraph');\n        event.stopPropagation();\n      });\n      //Draggable for left line Indent.\n      var isDragging_3 = false;\n      var leftLineOffset_1;\n      var initialValue_3 = HelperMethods.getNumberFromString(leftIndent.style.left); // for mouse down event\n      var initialValue2 = HelperMethods.getNumberFromString(leftIndent.style.left); // for mouse move event\n      var firstIndentInitialValue_1;\n      var diff_1;\n      var minLimit_2;\n      var maxLimit_2;\n      var isHangingIndent_1;\n      leftIndent.addEventListener(\"mouseenter\", function (e) {\n        documentEditor.isOnIndent = true;\n      });\n      leftIndent.addEventListener(\"mouseleave\", function (e) {\n        documentEditor.isOnIndent = false;\n      });\n      leftIndent.addEventListener(\"mousedown\", function (e) {\n        var rulerZeroPoint;\n        isDragging_3 = true;\n        leftLineOffset_1 = e.clientX - leftIndent.getBoundingClientRect().left;\n        initialValue_3 = HelperMethods.getNumberFromString(leftIndent.style.left);\n        firstIndentInitialValue_1 = HelperMethods.getNumberFromString(firstLineIndent.style.left);\n        diff_1 = firstIndentInitialValue_1 - initialValue_3;\n        firstLineIndent = document.getElementById(documentEditor.element.id + '_firstLineIndent');\n        var rightIndent = document.getElementById(documentEditor.element.id + '_rightIndent');\n        var rightPosition = HelperMethods.getNumberFromString(rightIndent.style.left);\n        if (documentEditor.layoutType === 'Pages') {\n          if (documentEditor.selectionModule.paragraphFormat.bidi) {\n            rulerZeroPoint = HelperMethods.convertPointToPixel(1584 - documentEditor.selectionModule.sectionFormat.leftMargin - (documentEditor.selectionModule.sectionFormat.pageWidth - documentEditor.selectionModule.sectionFormat.leftMargin - documentEditor.selectionModule.sectionFormat.rightMargin)) * documentEditor.zoomFactor;\n            minLimit_2 = rightPosition + HelperMethods.convertPointToPixel(42) * documentEditor.zoomFactor;\n            maxLimit_2 = rulerZeroPoint - 6 + HelperMethods.convertPointToPixel(documentEditor.selectionModule.sectionFormat.pageWidth) * documentEditor.zoomFactor;\n            isHangingIndent_1 = HelperMethods.getNumberFromString(hangingIndent.style.left) - rightPosition <= HelperMethods.getNumberFromString(firstLineIndent.style.left) - rightPosition;\n          } else {\n            rulerZeroPoint = HelperMethods.convertPointToPixel(1584 - documentEditor.selectionModule.sectionFormat.leftMargin) * documentEditor.zoomFactor;\n            minLimit_2 = rulerZeroPoint - 6;\n            maxLimit_2 = rightPosition - HelperMethods.convertPointToPixel(42) * documentEditor.zoomFactor;\n            isHangingIndent_1 = rightPosition - HelperMethods.getNumberFromString(hangingIndent.style.left) <= rightPosition - HelperMethods.getNumberFromString(firstLineIndent.style.left);\n          }\n        } else if (documentEditor.layoutType === 'Continuous') {\n          if (_this.position.paragraph.paragraphFormat.bidi) {\n            rulerZeroPoint = documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor - 20 - documentEditor.viewer.clientArea.width * documentEditor.zoomFactor;\n            maxLimit_2 = documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor - 20 + 40 - 6;\n            minLimit_2 = rightPosition + HelperMethods.convertPointToPixel(42) * documentEditor.zoomFactor;\n            isHangingIndent_1 = HelperMethods.getNumberFromString(hangingIndent.style.left) - rightPosition <= HelperMethods.getNumberFromString(firstLineIndent.style.left) - rightPosition;\n          } else {\n            rulerZeroPoint = documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor - 20;\n            minLimit_2 = rulerZeroPoint - 6;\n            maxLimit_2 = rightPosition - HelperMethods.convertPointToPixel(42) * documentEditor.zoomFactor;\n            isHangingIndent_1 = rightPosition - HelperMethods.getNumberFromString(hangingIndent.style.left) <= rightPosition - HelperMethods.getNumberFromString(firstLineIndent.style.left);\n          }\n        }\n        var value = rulerZeroPoint + e.clientX - leftLineOffset_1 - hRuler.getBoundingClientRect().left;\n        var startValue = documentEditor.documentHelper.currentPage.boundingRectangle.x;\n        startValue = documentEditor.layoutType === 'Continuous' ? 0 : startValue;\n        var indicatorLineValue = startValue + (value - rulerZeroPoint) + 6;\n        var lineSvg = document.getElementById(documentEditor.element.id + '_hRuler_indicator_svg');\n        lineSvg.style.left = indicatorLineValue + 'px';\n        lineSvg.style.display = 'block';\n        e.stopPropagation();\n      });\n      document.addEventListener(\"mousemove\", function (e) {\n        if (isDragging_3) {\n          var rulerZeroPoint = void 0;\n          var value = void 0;\n          if (documentEditor.selectionModule.paragraphFormat.bidi) {\n            if (documentEditor.layoutType === 'Pages') {\n              rulerZeroPoint = HelperMethods.convertPointToPixel(1584 - documentEditor.selectionModule.sectionFormat.leftMargin - (documentEditor.selectionModule.sectionFormat.pageWidth - documentEditor.selectionModule.sectionFormat.leftMargin - documentEditor.selectionModule.sectionFormat.rightMargin)) * documentEditor.zoomFactor;\n            } else if (documentEditor.layoutType === 'Continuous') {\n              rulerZeroPoint = documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor - 20 - documentEditor.viewer.clientArea.width * documentEditor.zoomFactor;\n            }\n            value = rulerZeroPoint + e.clientX - leftLineOffset_1 - hRuler.getBoundingClientRect().left;\n            if (isHangingIndent_1) {\n              if (value + diff_1 > maxLimit_2) {\n                value = maxLimit_2 - diff_1;\n              }\n            } else {\n              if (value > maxLimit_2) {\n                value = maxLimit_2;\n              }\n            }\n            if (isHangingIndent_1) {\n              if (value < minLimit_2) {\n                value = minLimit_2;\n              }\n            } else {\n              if (value + diff_1 < minLimit_2) {\n                value = minLimit_2 - diff_1;\n              }\n            }\n          } else {\n            if (documentEditor.layoutType === 'Pages') {\n              rulerZeroPoint = HelperMethods.convertPointToPixel(1584 - documentEditor.selectionModule.sectionFormat.leftMargin) * documentEditor.zoomFactor;\n            } else if (documentEditor.layoutType === 'Continuous') {\n              rulerZeroPoint = documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor - 20;\n            }\n            value = rulerZeroPoint + e.clientX - leftLineOffset_1 - hRuler.getBoundingClientRect().left;\n            if (isHangingIndent_1) {\n              if (value > maxLimit_2) {\n                value = maxLimit_2;\n              }\n            } else {\n              if (value + diff_1 > maxLimit_2) {\n                value = maxLimit_2 - diff_1;\n              }\n            }\n            if (isHangingIndent_1) {\n              if (value + diff_1 < minLimit_2) {\n                value = minLimit_2 - diff_1;\n              }\n            } else {\n              if (value < minLimit_2) {\n                value = minLimit_2;\n              }\n            }\n          }\n          hangingIndent.style.left = value + \"px\";\n          leftIndent.style.left = value + \"px\";\n          firstLineIndent.style.left = firstIndentInitialValue_1 + (value - initialValue_3) + \"px\";\n          var startValue = documentEditor.documentHelper.currentPage.boundingRectangle.x;\n          startValue = documentEditor.layoutType === 'Continuous' ? 0 : startValue;\n          var indicatorLineValue = startValue + (value - rulerZeroPoint) + 6;\n          var lineSvg = document.getElementById(documentEditor.element.id + '_hRuler_indicator_svg');\n          lineSvg.style.left = indicatorLineValue + 'px';\n        }\n      });\n      document.addEventListener(\"mouseup\", function () {\n        if (isDragging_3) {\n          isDragging_3 = false;\n          var finalValue = HelperMethods.getNumberFromString(leftIndent.style.left);\n          if (parseInt(leftIndent.style.left.replace('px', '')) < 0) {\n            finalValue *= -1;\n          }\n          if (documentEditor.selectionModule.paragraphFormat.bidi) {\n            documentEditor.editorModule.applyRulerMarkerValues('leftIndent', finalValue, initialValue_3);\n          } else {\n            documentEditor.editorModule.applyRulerMarkerValues('leftIndent', initialValue_3, finalValue);\n          }\n          initialValue_3 = finalValue;\n          var lineSvg = document.getElementById(documentEditor.element.id + '_hRuler_indicator_svg');\n          lineSvg.style.display = 'none';\n        }\n      });\n    }\n    //Rendering RightIndent\n    var rightIndent = document.getElementById(documentEditor.element.id + '_rightIndent');\n    if (!rightIndent) {\n      var margin = 'left:' + (documentEditor.selectionModule.end.paragraph.bodyWidget.page.boundingRectangle.width - HelperMethods.convertPointToPixel(documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.rightMargin) - 6) + 'px;';\n      var style = 'height:7px;top:8px;overflow:hidden;width:12px;position:absolute;font-size:11px;text-align: left;z-index: 4;' + margin;\n      var attributes = {\n        'id': documentEditor.element.id + '_rightIndent',\n        style: style,\n        class: 'e-de-ruler-indent'\n      };\n      rightIndent = this.createHtmlElement('div', attributes);\n      rightIndent.setAttribute('title', locale.getConstant('Right Indent'));\n      var rightIndentSvg = void 0;\n      // Create an SVG element\n      var attr = {\n        'id': documentEditor.element.id + '_rightIndent_svg',\n        width: rulerSize.width + 'px',\n        height: '7px',\n        style: 'position:inherit;left:0px'\n      };\n      rightIndentSvg = this.createSvgElement('svg', attr);\n      rightIndentSvg.setAttribute(\"fill\", \"none\");\n      var pathattr = {\n        style: 'position:inherit;left:0px'\n      };\n      // Create a path element inside the SVG\n      var pathElement = this.createSvgElement('path', pathattr);\n      pathElement.setAttribute(\"class\", \"e-de-ruler-indent-svg\");\n      pathElement.setAttribute(\"d\", \"M 0.5 6.5 H 11.5 V 4.2872 L 6 1.5789 L 0.5 4.2872 V 6.5 Z\");\n      pathElement.setAttribute(\"fill\", \"white\");\n      pathElement.setAttribute(\"stroke\", \"#A1A1A1\");\n      // Append the path element to the SVG element\n      rightIndentSvg.appendChild(pathElement);\n      rightIndent.appendChild(rightIndentSvg);\n      hRuler.append(rightIndent);\n      rightIndent.addEventListener(\"dblclick\", function (event) {\n        documentEditor.showDialog('Paragraph');\n        event.stopPropagation();\n      });\n      //Draggable for left line Indent.\n      var isDragging_4 = false;\n      var rightLineOffset_1;\n      var initialValue_4 = HelperMethods.getNumberFromString(rightIndent.style.left); // for mouse down event\n      var initialValue2 = HelperMethods.getNumberFromString(rightIndent.style.left); // for mouse move event\n      rightIndent.addEventListener(\"mouseenter\", function (e) {\n        documentEditor.isOnIndent = true;\n      });\n      rightIndent.addEventListener(\"mouseleave\", function (e) {\n        documentEditor.isOnIndent = false;\n      });\n      rightIndent.addEventListener(\"mousedown\", function (e) {\n        isDragging_4 = true;\n        rightLineOffset_1 = e.clientX - rightIndent.getBoundingClientRect().left;\n        initialValue_4 = HelperMethods.getNumberFromString(rightIndent.style.left);\n        var rulerZeroPoint = HelperMethods.convertPointToPixel(1584 - documentEditor.selectionModule.sectionFormat.leftMargin) * documentEditor.zoomFactor;\n        if (documentEditor.selectionModule.paragraphFormat.bidi) {\n          rulerZeroPoint = HelperMethods.convertPointToPixel(1584 - documentEditor.selectionModule.sectionFormat.leftMargin - (documentEditor.selectionModule.sectionFormat.pageWidth - documentEditor.selectionModule.sectionFormat.leftMargin - documentEditor.selectionModule.sectionFormat.rightMargin)) * documentEditor.zoomFactor;\n        }\n        if (documentEditor.layoutType === 'Continuous') {\n          rulerZeroPoint = documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor - 20;\n          if (documentEditor.selectionModule.paragraphFormat.bidi) {\n            rulerZeroPoint = documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor - 20 - documentEditor.viewer.clientArea.width * documentEditor.zoomFactor;\n          }\n        }\n        var value = rulerZeroPoint + e.clientX - rightLineOffset_1 - hRuler.getBoundingClientRect().left;\n        var startValue = documentEditor.documentHelper.currentPage.boundingRectangle.x;\n        startValue = documentEditor.layoutType === 'Continuous' ? 0 : startValue;\n        var indicatorLineValue = startValue + (value - rulerZeroPoint) + 6;\n        var lineSvg = document.getElementById(documentEditor.element.id + '_hRuler_indicator_svg');\n        lineSvg.style.left = indicatorLineValue + 'px';\n        lineSvg.style.display = 'block';\n        e.stopPropagation();\n      });\n      document.addEventListener(\"mousemove\", function (e) {\n        if (isDragging_4) {\n          var rulerZeroPoint = void 0;\n          var value = void 0;\n          var leftIndent_2 = document.getElementById(documentEditor.element.id + '_leftIndent');\n          var firstLineIndent_1 = document.getElementById(documentEditor.element.id + '_firstLineIndent');\n          var maxValue = void 0;\n          var minValue = void 0;\n          if (documentEditor.selectionModule.paragraphFormat.bidi) {\n            if (documentEditor.layoutType === 'Pages') {\n              rulerZeroPoint = HelperMethods.convertPointToPixel(1584 - documentEditor.selectionModule.sectionFormat.leftMargin - (documentEditor.selectionModule.sectionFormat.pageWidth - documentEditor.selectionModule.sectionFormat.leftMargin - documentEditor.selectionModule.sectionFormat.rightMargin)) * documentEditor.zoomFactor;\n            } else if (documentEditor.layoutType === 'Continuous') {\n              rulerZeroPoint = documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor - 20 - documentEditor.viewer.clientArea.width * documentEditor.zoomFactor;\n            }\n            value = rulerZeroPoint + e.clientX - rightLineOffset_1 - hRuler.getBoundingClientRect().left;\n            var nearestElement = HelperMethods.getNumberFromString(leftIndent_2.style.left) - value <= HelperMethods.getNumberFromString(firstLineIndent_1.style.left) - value ? leftIndent_2 : firstLineIndent_1;\n            var indentValue = HelperMethods.getNumberFromString(nearestElement.style.left);\n            maxValue = indentValue - HelperMethods.convertPointToPixel(42) * documentEditor.zoomFactor;\n            minValue = rulerZeroPoint - 6;\n          } else {\n            if (documentEditor.layoutType === 'Pages') {\n              rulerZeroPoint = HelperMethods.convertPointToPixel(1584 - documentEditor.selectionModule.sectionFormat.leftMargin) * documentEditor.zoomFactor;\n            } else if (documentEditor.layoutType === 'Continuous') {\n              rulerZeroPoint = documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor - 20;\n            }\n            value = rulerZeroPoint + e.clientX - rightLineOffset_1 - hRuler.getBoundingClientRect().left;\n            var nearestElement = value - HelperMethods.getNumberFromString(leftIndent_2.style.left) <= value - HelperMethods.getNumberFromString(firstLineIndent_1.style.left) ? leftIndent_2 : firstLineIndent_1;\n            var indentValue = HelperMethods.getNumberFromString(nearestElement.style.left);\n            maxValue = rulerZeroPoint + documentEditor.documentHelper.currentPage.boundingRectangle.width * documentEditor.zoomFactor - 6;\n            minValue = indentValue + HelperMethods.convertPointToPixel(42) * documentEditor.zoomFactor;\n          }\n          if (value < minValue) {\n            value = minValue;\n          } else if (value > maxValue) {\n            value = maxValue;\n          }\n          rightIndent.style.left = value + \"px\";\n          var startValue = documentEditor.documentHelper.currentPage.boundingRectangle.x;\n          startValue = documentEditor.layoutType === 'Continuous' ? 0 : startValue;\n          var indicatorLineValue = startValue + (value - rulerZeroPoint) + 6;\n          var lineSvg = document.getElementById(documentEditor.element.id + '_hRuler_indicator_svg');\n          lineSvg.style.left = indicatorLineValue + 'px';\n        }\n      });\n      document.addEventListener(\"mouseup\", function () {\n        if (isDragging_4) {\n          isDragging_4 = false;\n          var finalValue = HelperMethods.getNumberFromString(rightIndent.style.left);\n          if (documentEditor.selectionModule.paragraphFormat.bidi) {\n            documentEditor.editorModule.applyRulerMarkerValues('rightIndent', initialValue_4, finalValue);\n          } else {\n            documentEditor.editorModule.applyRulerMarkerValues('rightIndent', finalValue, initialValue_4);\n          }\n          initialValue_4 = finalValue;\n          var lineSvg = document.getElementById(documentEditor.element.id + '_hRuler_indicator_svg');\n          lineSvg.style.display = 'none';\n        }\n      });\n    }\n    this.updateIndentMarkers(documentEditor);\n  };\n  /**\n   * updateRuler method\n   *\n   * @returns {void} updateRuler method.\n   * @param { DocumentEditor} documentEditor - provide the documentEditor  value.\n   * @private\n   */\n  RulerHelper.prototype.updateRuler = function (documentEditor, rerenderRuler) {\n    if (documentEditor.rulerHelper && documentEditor.documentEditorSettings && !documentEditor.documentEditorSettings.showRuler || documentEditor.isReadOnlyMode) {\n      return;\n    }\n    // const hOffset: number = - documentEditor.scroller.horizontalOffset;\n    // const vOffset: number = - documentEditor.scroller.verticalOffset;\n    var hOffset = 0;\n    // const vOffset: number = - documentEditor.scroller.verticalOffset;\n    if (isNullOrUndefined(documentEditor.hRuler) && isNullOrUndefined(documentEditor.vRuler)) {\n      return;\n    }\n    if (documentEditor.selectionModule.isForward) {\n      this.position = documentEditor.selectionModule.start;\n    } else {\n      this.position = documentEditor.selectionModule.end;\n    }\n    this.updateRulerDimension(documentEditor, documentEditor.hRuler, hOffset, rerenderRuler);\n    this.updateRulerDimension(documentEditor, documentEditor.vRuler, hOffset, rerenderRuler);\n    this.updateRulerMargins(documentEditor);\n    this.updateIndentMarkers(documentEditor);\n    this.updateTabStopMarkers(documentEditor);\n    if (this.position.paragraph.isInsideTable) {\n      this.updateTableMarkers(documentEditor, documentEditor.hRuler);\n    } else {\n      this.removeTableMarkers(documentEditor, documentEditor.hRuler);\n    }\n    this.updateIndicatorLines(documentEditor);\n  };\n  RulerHelper.prototype.removeTableMarkers = function (documentEditor, ruler) {\n    var renderedTableMarkers = HelperMethods.convertNodeListToArray(document.querySelectorAll('.e-de-ruler-table-marker'));\n    if (!isNullOrUndefined(renderedTableMarkers)) {\n      for (var i = 0; i < renderedTableMarkers.length; i++) {\n        var elementToRemove = renderedTableMarkers[parseInt(i.toString(), 10)];\n        if (!isNullOrUndefined(elementToRemove)) {\n          elementToRemove.parentNode.removeChild(elementToRemove);\n        }\n      }\n    }\n  };\n  RulerHelper.prototype.updateTableMarkers = function (documentEditor, ruler) {\n    var renderedTableMarkers = HelperMethods.convertNodeListToArray(document.querySelectorAll('.e-de-ruler-table-marker'));\n    if (isNullOrUndefined(renderedTableMarkers)) {\n      // const tablewidget: TableWidget =\n      // ((documentEditor.selection.end.paragraph.containerWidget as TableCellWidget).ownerTable as TableWidget);\n      // const tableColumns = ((documentEditor.selection.end.paragraph.containerWidget as TableCellWidget).ownerTable\n      //  as TableWidget).tableHolder.columns.length;\n      // const tableXPos: number = undefined;\n      // const hRuler: HTMLElement = document.getElementById(documentEditor.element.id + '_hRuler');\n      this.renderTableMarkers(documentEditor, ruler);\n    } else if (this.position.paragraph.isInsideTable) {\n      this.renderTableMarkers(documentEditor, ruler);\n    }\n  };\n  RulerHelper.prototype.renderTableMarkers = function (documentEditor, ruler) {\n    var _this = this;\n    this.removeTableMarkers(documentEditor, documentEditor.hRuler);\n    var intialPosition;\n    var tablewidget = this.position.paragraph.containerWidget.ownerTable;\n    var tableRowWidget = this.position.paragraph.associatedCell.ownerRow.clone();\n    var cellWidgets = tableRowWidget.childWidgets;\n    var value = this.position.paragraph.associatedCell.ownerTable.tableFormat.bidi ? cellWidgets.length : 0;\n    if (this.position.paragraph.associatedCell.ownerTable.tableFormat.bidi) {\n      cellWidgets.reverse();\n    }\n    var tableXPos;\n    var hRuler = document.getElementById(documentEditor.element.id + '_hRuler');\n    var _loop_1 = function (i) {\n      var tableMarker = document.getElementById(documentEditor.element.id + '_tableMarker_' + value);\n      //if (!tableMarker) {   \n      var margin = void 0;\n      if (i == 0) {\n        tableXPos = (cellWidgets[parseInt(i.toString(), 10)].x - cellWidgets[parseInt(i.toString(), 10)].margin.left) * documentEditor.zoomFactor + hRuler.scrollLeft;\n        margin = 'left:' + (tableXPos - 4) + 'px;';\n      } else {\n        tableXPos = tableXPos + (cellWidgets[i - 1].width + cellWidgets[i - 1].margin.left + cellWidgets[i - 1].margin.right) * documentEditor.zoomFactor;\n        margin = 'left:' + (tableXPos - 4) + 'px;';\n      }\n      var style = 'height:' + ruler.thickness + 'px;overflow:hidden;width:10px;position:absolute;font-size:11px;text-align: left;z-index: 4;' + margin;\n      var attributes = {\n        'id': documentEditor.element.id + '_tableMarker_' + value,\n        'class': 'e-de-ruler-table-marker',\n        style: style\n      };\n      tableMarker = this_1.createHtmlElement('div', attributes);\n      var locale = new L10n('documenteditor', documentEditor.defaultLocale);\n      tableMarker.setAttribute('title', locale.getConstant('Move Table Column'));\n      // Create an SVG element\n      var attr = {\n        'id': documentEditor.element.id + '_tableMarker_svg' + i,\n        width: 9 + 'px',\n        height: 11 + 'px',\n        style: 'position:inherit;left:0px;top:3px;'\n      };\n      var svg = this_1.createSvgElement('svg', attr);\n      svg.setAttribute('fill', 'none');\n      var pathattr = {\n        style: 'position:inherit;left:0px;'\n      };\n      // Create a path element inside the SVG\n      var pathElement = this_1.createSvgElement('path', pathattr);\n      pathElement.setAttribute('class', 'e-de-ruler-table-svg');\n      pathElement.setAttribute('d', 'M1 1V0H2V1H3V0H4V1H5V0H6V1H7V2H6V3H7V4H6V5H7V6H6V7H7V8H0V7H1V6H0V5H1V4H0V3H1V2H0V1H1ZM2 2V3H3V2H2ZM4 2V3H5V2H4ZM5 4H4V5H5V4ZM5 6H4V7H5V6ZM3 7V6H2V7H3ZM2 5H3V4H2V5Z');\n      pathElement.setAttribute('fill', '#A1A1A1');\n      // Append the path element to the SVG element\n      svg.appendChild(pathElement);\n      tableMarker.appendChild(svg);\n      hRuler.append(tableMarker);\n      // }\n      if (this_1.position.paragraph.associatedCell.ownerTable.tableFormat.bidi) {\n        value--;\n      } else {\n        value++;\n      }\n      tableMarker.addEventListener('dblclick', function (event) {\n        documentEditor.showDialog('TableProperties');\n        event.stopPropagation();\n      });\n      var tableMarkerOffset;\n      tableMarker.addEventListener('mousedown', function (e) {\n        tableMarkerOffset = e.clientX - tableMarker.getBoundingClientRect().left;\n        documentEditor.startXPosition = HelperMethods.convertPixelToPoint(e.clientX);\n        documentEditor.isTableMarkerDragging = true;\n        var cursorPoint = new Point(e.clientX, e.clientY);\n        var touchPoint = documentEditor.viewer.findFocusedPage(cursorPoint, true, true);\n        var currentMarkerPostion;\n        if (e.currentTarget instanceof HTMLElement) {\n          var parts = e.currentTarget.id.split('_');\n          var value_1 = parts[parts.length - 1];\n          currentMarkerPostion = parseInt(value_1);\n        }\n        var tableWidget = documentEditor.selectionModule.end.paragraph.containerWidget.ownerTable;\n        documentEditor.editorModule.tableResize.currentResizingTable = tableWidget;\n        documentEditor.editorModule.tableResize.resizeNode = 0;\n        documentEditor.editorModule.tableResize.resizerPosition = currentMarkerPostion;\n        documentEditor.editorModule.tableResize.startingPoint.x = touchPoint.x;\n        documentEditor.editorModule.tableResize.startingPoint.y = touchPoint.y;\n        documentEditor.editorHistoryModule.initResizingHistory(touchPoint, documentEditor.editorModule.tableResize);\n        var rulerZeroPoint = HelperMethods.convertPointToPixel(1584 - documentEditor.selectionModule.sectionFormat.leftMargin) * documentEditor.zoomFactor;\n        var value = rulerZeroPoint + e.clientX - tableMarkerOffset - hRuler.getBoundingClientRect().left;\n        var startValue = documentEditor.documentHelper.currentPage.boundingRectangle.x;\n        var indicatorLineValue = startValue + (value - rulerZeroPoint) + 6;\n        var lineSvg = document.getElementById(documentEditor.element.id + '_hRuler_indicator_svg');\n        lineSvg.style.left = indicatorLineValue - 6 + 'px';\n        lineSvg.style.display = 'block';\n      });\n      document.addEventListener(\"mousemove\", function (e) {\n        if (documentEditor.isDestroyed || !documentEditor.documentEditorSettings.showRuler) {\n          return;\n        }\n        if (documentEditor.isTableMarkerDragging) {\n          var hRuler_1 = document.getElementById(documentEditor.element.id + '_hRuler');\n          var rulerZeroPoint = HelperMethods.convertPointToPixel(1584 - documentEditor.selectionModule.sectionFormat.leftMargin) * documentEditor.zoomFactor;\n          if (documentEditor.selectionModule.end.paragraph.associatedCell.ownerTable.tableFormat.bidi) {\n            var rulerGeometry = _this.getRulerGeometry(documentEditor);\n            var rulerMarginDivWidth = rulerGeometry.width - HelperMethods.convertPointToPixel(documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.rightMargin * documentEditor.zoomFactor + documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin * documentEditor.zoomFactor);\n            rulerZeroPoint -= rulerMarginDivWidth;\n          }\n          var value_2 = rulerZeroPoint + e.clientX - tableMarkerOffset - hRuler_1.getBoundingClientRect().left;\n          tableMarker.style.left = value_2 + \"px\";\n          var startValue = documentEditor.documentHelper.currentPage.boundingRectangle.x;\n          var indicatorLineValue = startValue + (value_2 - rulerZeroPoint) + 6;\n          var lineSvg = document.getElementById(documentEditor.element.id + '_hRuler_indicator_svg');\n          lineSvg.style.left = indicatorLineValue - 6 + 'px';\n        }\n      });\n      document.addEventListener(\"mouseup\", function (e) {\n        if (documentEditor.isDestroyed || !documentEditor.documentEditorSettings.showRuler) {\n          return;\n        }\n        if (documentEditor.isTableMarkerDragging) {\n          var cursorPoint = new Point(e.clientX, e.clientY);\n          var dragValue = _this.position.paragraph.associatedCell.ownerTable.tableFormat.bidi ? documentEditor.startXPosition - HelperMethods.convertPixelToPoint(e.clientX) : HelperMethods.convertPixelToPoint(e.clientX) - documentEditor.startXPosition;\n          documentEditor.editorModule.tableResize.handleResizing(cursorPoint, true, dragValue / documentEditor.zoomFactor);\n          documentEditor.editorModule.tableResize.updateResizingHistory(documentEditor.viewer.findFocusedPage(cursorPoint, true, true));\n          documentEditor.isTableMarkerDragging = false;\n          var lineSvg = document.getElementById(documentEditor.element.id + '_hRuler_indicator_svg');\n          lineSvg.style.display = 'none';\n        }\n      });\n    };\n    var this_1 = this;\n    for (var i = 0; i <= cellWidgets.length; i++) {\n      _loop_1(i);\n    }\n  };\n  /**\n   * updateRulerDimension method \\\n   *\n   * @returns {void} updateRulerDimension method .\\\n   * @param { Diagram} diagram - provide the content  value.\n   * @param { Ruler} ruler - provide the content  value.\n   * @param { number} offset - provide the content  value.\n   * @param { boolean} isHorizontal - provide the content  value.\n   * @private\n   */\n  RulerHelper.prototype.updateRulerDimension = function (documentEditor, ruler, offset, rerenderRuler) {\n    var isHorizontal = ruler.orientation === \"Horizontal\" ? true : false;\n    var rulerSize = this.getRulerSize(documentEditor);\n    var rulerGeometry = this.getRulerGeometry(documentEditor);\n    //const documentEditorRuler: DocumentEditorRulerModel = isHorizontal ? documentEditor.documentEditorSettings.rulerSettings.horizontalRuler : documentEditor.documentEditorSettings.rulerSettings.verticalRuler;\n    this.updateRulerDiv(documentEditor, rulerGeometry, isHorizontal, ruler);\n    this.updateRulerSpace(documentEditor, rulerGeometry, isHorizontal, ruler);\n    this.updateMargin(ruler, documentEditor, isHorizontal);\n    // ruler.pageWidth = documentEditor.selection.end.paragraph.bodyWidget.page.boundingRectangle.width * documentEditor.zoomFactor;\n    // ruler.pageHeight = documentEditor.selection.end.paragraph.bodyWidget.page.boundingRectangle.height * documentEditor.zoomFactor;\n    ruler.length = documentEditor.zoomFactor < 1 ? ruler.zeroPosition * 2 / documentEditor.zoomFactor : ruler.zeroPosition * 2 * documentEditor.zoomFactor;\n    var rulerObj = ruler.element;\n    if (isHorizontal) {\n      rulerObj.style.marginLeft = (documentEditor.layoutType === 'Pages' ? documentEditor.selectionModule.end.paragraph.bodyWidget.page.boundingRectangle.x : 0) + 'px';\n    } else {\n      rulerObj.parentElement.style.display = documentEditor.layoutType === 'Pages' ? 'block' : 'none';\n      rulerObj.style.marginTop = documentEditor.selectionModule.getPageTop(documentEditor.selectionModule.end.paragraph.bodyWidget.page) + 'px';\n    }\n    if (rerenderRuler) {\n      ruler.offset = offset;\n      ruler.scale = documentEditor.zoomFactor;\n      // if (documentEditor.layoutType === 'Pages') {\n      ruler.length = documentEditor.zoomFactor < 1 ? ruler.zeroPosition * 2 / documentEditor.zoomFactor : ruler.zeroPosition * 2 * documentEditor.zoomFactor;\n      // } else if (documentEditor.layoutType === 'Continuous') {\n      //     ruler.length = (ruler.zeroPosition * 2) / documentEditor.zoomFactor;\n      // }\n      ruler.updateRuler();\n    }\n    if (isHorizontal) {\n      if (documentEditor.layoutType === 'Pages') {\n        var paraBidi = this.position.paragraph.paragraphFormat.bidi;\n        var tableBidi = false;\n        if (this.position.paragraph.isInsideTable) {\n          tableBidi = this.position.paragraph.associatedCell.ownerTable.tableFormat.bidi;\n        }\n        if (paraBidi || tableBidi) {\n          var rulerMarginDivWidth = rulerGeometry.width - HelperMethods.convertPointToPixel(documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.rightMargin * documentEditor.zoomFactor);\n          rulerObj.scrollLeft = documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor - rulerMarginDivWidth;\n        } else {\n          rulerObj.scrollLeft = (ruler.zeroPosition - HelperMethods.convertPointToPixel(documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin)) * documentEditor.zoomFactor;\n        }\n      } else {\n        var paraBidi = this.position.paragraph.paragraphFormat.bidi;\n        var tableBidi = false;\n        if (this.position.paragraph.isInsideTable) {\n          tableBidi = this.position.paragraph.associatedCell.ownerTable.tableFormat.bidi;\n        }\n        if (paraBidi || tableBidi) {\n          // const rulerMarginDivWidth = (rulerGeometry.width - 40);\n          rulerObj.scrollLeft = (ruler.zeroPosition - documentEditor.viewer.clientActiveArea.width) * documentEditor.zoomFactor - 20;\n        } else {\n          // 20 is set approximately to the web layout.\n          rulerObj.scrollLeft = ruler.zeroPosition * documentEditor.zoomFactor - 20;\n        }\n      }\n    } else {\n      rulerObj.scrollTop = (ruler.zeroPosition - HelperMethods.convertPointToPixel(documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.topMargin)) * documentEditor.zoomFactor;\n    }\n  };\n  /**\n   * updateRulerSpace method \\\n   *\n   * @returns {void} updateRulerSpace method .\\\n   * @param { Diagram} diagram - provide the content  value.\n   * @param { Size} rulerGeometry - provide the content  value.\n   * @param { boolean} isHorizontal - provide the content  value.\n   * @private\n   */\n  RulerHelper.prototype.updateRulerSpace = function (documentEditor, rulerGeometry, isHorizontal, ruler) {\n    var div = document.getElementById(documentEditor.element.id + (isHorizontal ? '_hRuler_ruler_space' : '_vRuler_ruler_space'));\n    if (div && documentEditor && rulerGeometry) {\n      div.style.width = (isHorizontal ? rulerGeometry.width + ruler.segmentWidth * 2 : ruler.thickness) + 'px';\n      div.style.height = (isHorizontal ? ruler.thickness : rulerGeometry.height + ruler.segmentWidth * 2) + 'px';\n    }\n  };\n  /**\n   * updateRulerDiv method \\\n   *\n   * @returns {void} updateRulerDiv method .\\\n   * @param { Diagram} diagram - provide the content  value.\n   * @param { Size} rulerGeometry - provide the content  value.\n   * @param { boolean} isHorizontal - provide the content  value.\n   * @private\n   */\n  RulerHelper.prototype.updateRulerDiv = function (documentEditor, rulerGeometry, isHorizontal, ruler) {\n    // parent div\n    var div = document.getElementById(documentEditor.element.id + (isHorizontal ? '_hRuler' : '_vRuler'));\n    if (div && documentEditor && rulerGeometry) {\n      div.style.width = (isHorizontal ? documentEditor.layoutType === 'Continuous' ? rulerGeometry.width / documentEditor.zoomFactor : rulerGeometry.width : ruler.thickness) + 'px';\n      div.style.height = (isHorizontal ? ruler.thickness : rulerGeometry.height) + 'px';\n      div = document.getElementById(documentEditor.element.id + '_overlapRuler');\n      if (div) {\n        // eslint-disable-next-line\n        isHorizontal ? div.style.height === ruler.thickness + 'px' : div.style.width === ruler.thickness + 'px';\n      }\n    }\n    if (isHorizontal) {\n      if (this.hRulerBottom) {\n        var pageElement = document.getElementById(documentEditor.element.id + '_pageContainer');\n        this.hRulerBottom.style.width = pageElement.getBoundingClientRect().width + 'px';\n      }\n    }\n    // let vRulerDiv: HTMLElement = document.getElementById(documentEditor.element.id + '_vRuler');\n    // if (vRulerDiv) {\n    //     vRulerDiv.style.width = ruler.thickness + 'px';\n    //     vRulerDiv.style.height =  rulerGeometry.height + 'px';                  \n    // }\n  };\n  /**\n   * getRulerGeometry method \\\n   *\n   * @returns {void} getRulerGeometry method .\\\n   * @param { DocumentEditor} documentEditor - provide the documentEditor  value.\n   * @private\n   */\n  RulerHelper.prototype.getRulerGeometry = function (documentEditor) {\n    var rulerSize = this.getRulerSize(documentEditor);\n    var height = documentEditor.selectionModule.end.paragraph.bodyWidget.page.boundingRectangle.height * documentEditor.zoomFactor;\n    var width = documentEditor.selectionModule.end.paragraph.bodyWidget.page.boundingRectangle.width * documentEditor.zoomFactor;\n    return new Size(width, height);\n  };\n  RulerHelper.prototype.getVerticalHeight = function (documentEditor) {\n    var pageheight = HelperMethods.convertPixelToPoint(documentEditor.selectionModule.end.paragraph.bodyWidget.page.boundingRectangle.height);\n    var containerHeight = documentEditor.element.getBoundingClientRect().height;\n    if (pageheight < containerHeight) {\n      return pageheight;\n    } else {\n      return containerHeight - documentEditor.documentHelper.pages[0].boundingRectangle.y;\n    }\n  };\n  RulerHelper.prototype.renderTab = function (documentEditor, rulerSize, tabStop, tabJustification, i, locale) {\n    var _this = this;\n    var hRuler = document.getElementById(documentEditor.element.id + '_hRuler');\n    var zoomFactor = documentEditor.documentHelper.zoomFactor;\n    var value;\n    switch (tabJustification) {\n      case 'Left':\n        var leftTab = document.getElementById(documentEditor.element.id + '_LeftTab' + '_' + i);\n        if (!leftTab) {\n          var style = '';\n          if (!isNullOrUndefined(tabStop)) {\n            value = this.position.paragraph.paragraphFormat.bidi ? HelperMethods.convertPointToPixel(1584 - tabStop.position) : HelperMethods.convertPointToPixel(1584 + tabStop.position);\n            var margin = 'left:' + (value - 1.5) * zoomFactor + 'px;';\n            style = 'height:9px;overflow:hidden;top:7px;width:12px;position:absolute;font-size:11px;text-align: left;z-index: 4;' + margin;\n          }\n          var attributes = {\n            'id': documentEditor.element.id + '_LeftTab' + '_' + i,\n            'class': 'e-de-ruler-tab e-de-ruler-tab-left',\n            style: style,\n            'data-name': 'LeftTab'\n          };\n          leftTab = this.createHtmlElement('div', attributes);\n          leftTab.setAttribute('title', locale.getConstant('Left Tab'));\n          var svg = void 0;\n          // Create an SVG element\n          var attr = {\n            'id': documentEditor.element.id + '_leftTab_svg',\n            width: rulerSize.width / 2 + 'px',\n            height: rulerSize.height / 2 + 'px',\n            style: 'position:inherit;left:0px'\n          };\n          svg = this.createSvgElement('svg', attr);\n          svg.setAttribute(\"fill\", \"none\");\n          var pathattr = {\n            style: 'position:inherit;left:0px'\n          };\n          // Create a path element inside the SVG\n          var pathElement = this.createSvgElement('path', pathattr);\n          pathElement.setAttribute(\"class\", \"e-de-ruler-tab-svg\");\n          pathElement.setAttribute(\"d\", \"M3 5H7V7H1V1H3V5Z\");\n          pathElement.setAttribute(\"fill\", \"#605E5C\");\n          pathElement.setAttribute(\"stroke\", \"#A1A1A1\");\n          // Append the path element to the SVG element\n          svg.appendChild(pathElement);\n          leftTab.appendChild(svg);\n          hRuler.append(leftTab);\n        }\n        break;\n      case 'Center':\n        var centerTab = document.getElementById(documentEditor.element.id + '_CenterTab' + '_' + i);\n        if (!centerTab) {\n          var style = '';\n          if (!isNullOrUndefined(tabStop)) {\n            value = this.position.paragraph.paragraphFormat.bidi ? HelperMethods.convertPointToPixel(1584 - tabStop.position) : HelperMethods.convertPointToPixel(1584 + tabStop.position);\n            var margin = 'left:' + (value - 4) * zoomFactor + 'px;';\n            style = 'height:9px;overflow:hidden;top:7px;width:12px;position:absolute;font-size:11px;text-align: left;z-index: 4;' + margin;\n          }\n          var attributes = {\n            'id': documentEditor.element.id + '_CenterTab' + '_' + i,\n            'class': 'e-de-ruler-tab e-de-ruler-tab-center',\n            style: style,\n            'data-name': 'CenterTab'\n          };\n          centerTab = this.createHtmlElement('div', attributes);\n          centerTab.setAttribute('title', locale.getConstant('Center Tab'));\n          var svg = void 0;\n          // Create an SVG element\n          var attr = {\n            'id': documentEditor.element.id + '_centerTab_svg',\n            width: rulerSize.width / 2 + 'px',\n            height: rulerSize.height / 2 + 'px',\n            style: 'position:inherit;left:0px'\n          };\n          svg = this.createSvgElement('svg', attr);\n          svg.setAttribute(\"fill\", \"none\");\n          var pathattr = {\n            style: 'position:inherit;left:0px'\n          };\n          // Create a path element inside the SVG\n          var pathElement = this.createSvgElement('path', pathattr);\n          pathElement.setAttribute(\"class\", \"e-de-ruler-tab-svg\");\n          pathElement.setAttribute(\"d\", \"M5 5H8V7H0V5H3V1H5V5Z\");\n          pathElement.setAttribute(\"fill\", \"#605E5C\");\n          pathElement.setAttribute(\"stroke\", \"#A1A1A1\");\n          // Append the path element to the SVG element\n          svg.appendChild(pathElement);\n          centerTab.appendChild(svg);\n          hRuler.append(centerTab);\n        }\n        break;\n      case 'Right':\n        var rightTab = document.getElementById(documentEditor.element.id + '_RightTab' + '_' + i);\n        if (!rightTab) {\n          var style = '';\n          if (!isNullOrUndefined(tabStop)) {\n            value = this.position.paragraph.paragraphFormat.bidi ? HelperMethods.convertPointToPixel(1584 - tabStop.position) : HelperMethods.convertPointToPixel(1584 + tabStop.position);\n            var margin = 'left:' + (value - 5.5) * zoomFactor + 'px;';\n            style = 'height:9px;overflow:hidden;top:7px;width:12px;position:absolute;font-size:11px;text-align: left;z-index: 4;' + margin;\n          }\n          var attributes = {\n            'id': documentEditor.element.id + '_RightTab' + '_' + i,\n            'class': 'e-de-ruler-tab e-de-ruler-tab-right',\n            style: style,\n            'data-name': 'RightTab'\n          };\n          rightTab = this.createHtmlElement('div', attributes);\n          rightTab.setAttribute('title', locale.getConstant('Right Tab'));\n          var svg = void 0;\n          // Create an SVG element\n          var attr = {\n            'id': documentEditor.element.id + '_rightTab_svg',\n            width: rulerSize.width / 2 + 'px',\n            height: rulerSize.height / 2 + 'px',\n            style: 'position:inherit;left:0px'\n          };\n          svg = this.createSvgElement('svg', attr);\n          svg.setAttribute(\"fill\", \"none\");\n          var pathattr = {\n            style: 'position:inherit;left:0px'\n          };\n          // Create a path element inside the SVG\n          var pathElement = this.createSvgElement('path', pathattr);\n          pathElement.setAttribute(\"class\", \"e-de-ruler-tab-svg\");\n          pathElement.setAttribute(\"d\", \"M5 5V1H7V7H1V5H5Z\");\n          pathElement.setAttribute(\"fill\", \"#605E5C\");\n          pathElement.setAttribute(\"stroke\", \"#A1A1A1\");\n          // Append the path element to the SVG element\n          svg.appendChild(pathElement);\n          rightTab.appendChild(svg);\n          hRuler.append(rightTab);\n        }\n        break;\n      case 'Decimal':\n        var decimalTab = document.getElementById(documentEditor.element.id + '_DecimalTab' + '_' + i);\n        if (!decimalTab) {\n          var style = '';\n          if (!isNullOrUndefined(tabStop)) {\n            value = this.position.paragraph.paragraphFormat.bidi ? HelperMethods.convertPointToPixel(1584 - tabStop.position) : HelperMethods.convertPointToPixel(1584 + tabStop.position);\n            var margin = 'left:' + (value * zoomFactor - 4) + 'px;';\n            style = 'height:9px;overflow:hidden;top:7px;width:12px;position:absolute;font-size:11px;text-align: left;z-index: 4;' + margin;\n          }\n          var attributes = {\n            'id': documentEditor.element.id + '_DecimalTab' + '_' + i,\n            'class': 'e-de-ruler-tab e-de-ruler-tab-decimal',\n            style: style,\n            'data-name': 'DecimalTab'\n          };\n          decimalTab = this.createHtmlElement('div', attributes);\n          decimalTab.setAttribute('title', locale.getConstant('Decimal Tab'));\n          var svg = void 0;\n          // Create an SVG element\n          var attr = {\n            'id': documentEditor.element.id + '_decimalTab_svg',\n            width: rulerSize.width / 2 + 'px',\n            height: rulerSize.height / 2 + 'px',\n            style: 'position:inherit;left:0px'\n          };\n          svg = this.createSvgElement('svg', attr);\n          svg.setAttribute(\"fill\", \"none\");\n          var pathattr = {\n            style: 'position:inherit;left:0px'\n          };\n          // Create a path element inside the SVG\n          var pathElement = this.createSvgElement('path', pathattr);\n          pathElement.setAttribute(\"class\", \"e-de-ruler-tab-svg\");\n          pathElement.setAttribute(\"d\", \"M6 0H4V6H0V8H4H6H10V6H6V0Z\");\n          pathElement.setAttribute(\"fill\", \"#605E5C\");\n          pathElement.setAttribute(\"clip-rule\", \"evenodd\");\n          pathElement.setAttribute(\"fill-rule\", \"evenodd\");\n          pathElement.setAttribute(\"stroke\", \"#A1A1A1\");\n          // Append the path element to the SVG element\n          svg.appendChild(pathElement);\n          decimalTab.appendChild(svg);\n          hRuler.append(decimalTab);\n        }\n        break;\n      case 'Bar':\n        var barTab = document.getElementById(documentEditor.element.id + '_BarTab' + '_' + i);\n        if (!barTab) {\n          var style = '';\n          if (!isNullOrUndefined(tabStop)) {\n            value = this.position.paragraph.paragraphFormat.bidi ? HelperMethods.convertPointToPixel(1584 - tabStop.position) : HelperMethods.convertPointToPixel(1584 + tabStop.position);\n            var margin = 'left:' + (value - 1.5) * zoomFactor + 'px;';\n            style = 'height:9px;overflow:hidden;top:7px;width:12px;position:absolute;font-size:11px;text-align: left;z-index: 4;' + margin;\n          }\n          var attributes = {\n            'id': documentEditor.element.id + '_BarTab' + '_' + i,\n            'class': 'e-de-ruler-tab e-de-ruler-tab-bar',\n            style: style,\n            'data-name': 'BarTab'\n          };\n          barTab = this.createHtmlElement('div', attributes);\n          barTab.setAttribute('title', locale.getConstant('Bar Tab'));\n          var svg = void 0;\n          // Create an SVG element\n          var attr = {\n            'id': documentEditor.element.id + '_barTab_svg',\n            width: rulerSize.width / 2 + 'px',\n            height: rulerSize.height / 2 + 'px',\n            style: 'position:inherit;left:0px'\n          };\n          svg = this.createSvgElement('svg', attr);\n          svg.setAttribute(\"fill\", \"none\");\n          var rectAttr = {\n            style: 'position:inherit;left:0px'\n          };\n          var rect = this.createSvgElement('rect', rectAttr);\n          rect.setAttribute(\"width\", \"2\");\n          rect.setAttribute(\"height\", \"8\");\n          rect.setAttribute(\"fill\", \"#605E5C\");\n          rect.setAttribute(\"stroke\", \"#A1A1A1\");\n          // Append the path element to the SVG element\n          svg.appendChild(rect);\n          barTab.appendChild(svg);\n          hRuler.append(barTab);\n        }\n        break;\n    }\n    if (!isNullOrUndefined(tabStop)) {\n      var tabStopElement_1 = document.getElementById(documentEditor.element.id + '_' + tabJustification + 'Tab' + '_' + i);\n      if (!isNullOrUndefined(tabStop)) {\n        tabStopElement_1.addEventListener(\"dblclick\", function (event) {\n          documentEditor.showTabDialog();\n          event.stopPropagation();\n        });\n      }\n      //Draggable for tab stop.\n      var isDragging_5 = false;\n      var tabStopOffset_1;\n      var initialValue_5 = HelperMethods.getNumberFromString(tabStopElement_1.style.left); // for mouse up event\n      var initialValue2 = HelperMethods.getNumberFromString(tabStopElement_1.style.left); // for mouse move event\n      var justification_1 = tabStopElement_1.getAttribute('data-name');\n      var currrentParagraph_1 = this.position.paragraph;\n      var tabIndex_1 = 0;\n      var currentTabStop_1 = undefined;\n      tabStopElement_1.addEventListener(\"mousedown\", function (e) {\n        e.stopPropagation();\n        isDragging_5 = true;\n        tabStopOffset_1 = e.clientX - tabStopElement_1.getBoundingClientRect().left;\n        initialValue_5 = HelperMethods.getNumberFromString(tabStopElement_1.style.left);\n        tabIndex_1 = parseInt(tabStopElement_1.id.split('_')[tabStopElement_1.id.split('_').length - 1]);\n        currentTabStop_1 = currrentParagraph_1.paragraphFormat.tabs[parseInt(tabIndex_1.toString(), 10)];\n        _this.currentTabStopElement = tabStopElement_1;\n        var rulerZeroPoint = HelperMethods.convertPointToPixel(1584 - documentEditor.selectionModule.sectionFormat.leftMargin) * documentEditor.zoomFactor;\n        if (documentEditor.layoutType === 'Continuous') {\n          rulerZeroPoint = documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor - 20;\n          if (_this.position.paragraph.paragraphFormat.bidi) {\n            rulerZeroPoint = documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor - 20 - documentEditor.viewer.clientArea.width * documentEditor.zoomFactor;\n          }\n        }\n        var value = rulerZeroPoint + e.clientX - tabStopOffset_1 - hRuler.getBoundingClientRect().left;\n        var startValue = documentEditor.documentHelper.currentPage.boundingRectangle.x;\n        startValue = documentEditor.layoutType === 'Continuous' ? 0 : startValue;\n        var indicatorLineValue = startValue + (value - rulerZeroPoint);\n        var lineSvg = document.getElementById(documentEditor.element.id + '_hRuler_indicator_svg');\n        lineSvg.style.left = indicatorLineValue + 'px';\n        lineSvg.style.display = 'block';\n      });\n      tabStopElement_1.addEventListener('mouseup', function () {\n        if (!isNullOrUndefined(_this.currentTabStopElement)) {\n          _this.currentTabStopElement = undefined;\n        }\n      });\n      document.addEventListener('mousemove', function (e) {\n        if (isDragging_5) {\n          var rulerZeroPoint = void 0;\n          if (documentEditor.layoutType === 'Continuous') {\n            rulerZeroPoint = documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor - 20;\n            if (_this.position.paragraph.paragraphFormat.bidi) {\n              rulerZeroPoint = documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor - 20 - documentEditor.viewer.clientArea.width * documentEditor.zoomFactor;\n            }\n          } else if (documentEditor.layoutType === 'Pages') {\n            rulerZeroPoint = HelperMethods.convertPointToPixel(1584 - documentEditor.selectionModule.sectionFormat.leftMargin) * documentEditor.zoomFactor;\n            if (_this.position.paragraph.bidi) {\n              rulerZeroPoint = HelperMethods.convertPointToPixel(1584 + documentEditor.selectionModule.sectionFormat.rightMargin - documentEditor.selectionModule.sectionFormat.pageWidth) * documentEditor.zoomFactor;\n            }\n          }\n          var value_3 = rulerZeroPoint + e.clientX - tabStopOffset_1 - hRuler.getBoundingClientRect().left;\n          var minValue = rulerZeroPoint;\n          var rightIndent = document.getElementById(documentEditor.element.id + '_rightIndent');\n          var rightIndentValue = HelperMethods.getNumberFromString(rightIndent.style.left);\n          var maxValue = rightIndentValue;\n          var leftIndent = document.getElementById(documentEditor.element.id + '_leftIndent');\n          var leftIndentValue = HelperMethods.getNumberFromString(leftIndent.style.left);\n          minValue = leftIndentValue;\n          if (_this.position.paragraph.paragraphFormat.bidi) {\n            minValue = rightIndentValue;\n            maxValue = leftIndentValue;\n          }\n          if (justification_1 === 'CenterTab' || justification_1 === 'DecimalTab') {\n            maxValue += 4;\n          } else if (justification_1 === 'RightTab') {\n            maxValue += 5.5;\n          } else {\n            maxValue += 1.5;\n          }\n          if (value_3 < minValue) {\n            value_3 = minValue;\n          } else if (value_3 > maxValue) {\n            value_3 = maxValue;\n          }\n          tabStopElement_1.style.left = value_3 + 'px';\n          var startValue = documentEditor.documentHelper.currentPage.boundingRectangle.x;\n          startValue = documentEditor.layoutType === 'Continuous' ? 0 : startValue;\n          var indicatorLineValue = startValue + (value_3 - rulerZeroPoint) + 6;\n          var lineSvg = document.getElementById(documentEditor.element.id + '_hRuler_indicator_svg');\n          lineSvg.style.left = indicatorLineValue + 'px';\n        }\n      });\n      document.addEventListener(\"mouseup\", function () {\n        if (isDragging_5 && !isNullOrUndefined(currentTabStop_1)) {\n          if (!isNullOrUndefined(_this.currentTabStopElement) && _this.currentTabStopElement.style.display == 'none') {\n            documentEditor.editorModule.removeTabStops([currrentParagraph_1], [currentTabStop_1]);\n            _this.currentTabStopElement.parentNode.removeChild(_this.currentTabStopElement);\n          } else {\n            var finalValue = HelperMethods.getNumberFromString(tabStopElement_1.style.left);\n            initialValue_5 = finalValue;\n            documentEditor.editorModule.removeTabStops([currrentParagraph_1], [currentTabStop_1]);\n            finalValue = HelperMethods.convertPixelToPoint(finalValue / documentEditor.zoomFactor) - 1584;\n            finalValue = currrentParagraph_1.paragraphFormat.bidi ? finalValue * -1 : finalValue;\n            currentTabStop_1.position = finalValue;\n            documentEditor.editorModule.updateTabStopCollection(currrentParagraph_1, [currentTabStop_1]);\n          }\n          _this.updateTabStopMarkers(documentEditor);\n          isDragging_5 = false;\n          var lineSvg = document.getElementById(documentEditor.element.id + '_hRuler_indicator_svg');\n          lineSvg.style.display = 'none';\n          _this.currentTabStopElement = undefined;\n        }\n      });\n    }\n  };\n  RulerHelper.prototype.updateMargin = function (ruler, documentEditor, isHorizontal) {\n    if (isHorizontal) {\n      ruler.startMargin = documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin;\n      ruler.endMargin = documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.rightMargin;\n    } else {\n      ruler.startMargin = documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.topMargin;\n      ruler.endMargin = documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.bottomMargin;\n    }\n  };\n  RulerHelper.prototype.getTabJustification = function (dataNameValue) {\n    switch (dataNameValue) {\n      case 'LeftTab':\n        return 'Left';\n      case 'CenterTab':\n        return 'Center';\n      case 'RightTab':\n        return 'Right';\n      case 'DecimalTab':\n        return 'Decimal';\n      case 'BarTab':\n        return 'Bar';\n    }\n    return 'Left';\n  };\n  /**\n  * getRulerSize method \\\n  *\n  * @returns {void} getRulerSize method .\\\n  * @param { DocumentEditor} documentEditor - provide the documentEditor  value.\n  * @private\n  */\n  RulerHelper.prototype.getRulerSize = function (documentEditor) {\n    var top = 0;\n    var left = 0;\n    //if (diagram.rulerSettings.showRulers) {\n    // top = documentEditor.documentEditorSettings.rulerSettings.horizontalRuler.thickness;\n    // left = documentEditor.documentEditorSettings.rulerSettings.verticalRuler.thickness;\n    top = 15;\n    left = 15;\n    //}\n    return new Size(left, top);\n  };\n  return RulerHelper;\n}();\nexport { RulerHelper };","map":{"version":3,"names":["L10n","createElement","isNullOrUndefined","Ruler","HelperMethods","Point","WTabStop","Size","width","height","prototype","isEmpty","clone","RulerHelper","hideTabStopSwitch","show","tabStopStwitch","showHideElement","hideRulerBottom","hRulerBottom","vRulerBottom","element","style","display","createHtmlElement","elementType","attribute","setAttributeHtml","createSvgElement","document","createElementNS","setAttributeSvg","applyStyleAgainstCsp","svg","attributes","keys","split","i","length","parseInt","toString","trim","Object","setAttribute","renderOverlapElement","documentEditor","rulerSize","getRulerSize","id","class","overlap","getElementById","insertBefore","firstChild","renderRulerMarkerIndicatorElement","enableSelection","layoutType","markIndicator","ownerId","firstLineIndent","cloneNode","hangingIndent","left","top","classList","add","appendChild","justification","locale","defaultLocale","setLocale","renderTab","undefined","element_1","remove","position","margin","addEventListener","event","divElements","querySelector","childNodes","currentDiv","nextIndex","renderRuler","isHorizontal","_this","div","rulerGeometry","getRulerGeometry","selectionModule","end","paragraph","bodyWidget","page","boundingRectangle","x","getPageTop","isForward","start","style_1","attributes_1","showDialog","pageElement","getBoundingClientRect","parentElement","renderRulerMargins","ruler","orientation","updateMargin","zeroPosition","appendTo","hRuler","vRuler","updateRulerPosition","rulerObj","scrollLeft","convertPointToPixel","sectionFormat","leftMargin","scrollTop","topMargin","renderIndents","resizerEnabled","isDragging","isLeftRulerMargin","isLeftMultiColumn","isRightMultiColumn","multiColumnElement","columnInitialValue","initialValue","currentScrollLeft","initialRightMargin","finalmouseXRelativeToDiv","e","isDestroyed","documentEditorSettings","showRuler","divRect","zoomFactor","rightMargin","convertPixelToPoint","pixelValue","Math","round","clientX","mouseXRelativeToDiv","isOnIndent","cursor","hasAttribute","removeAttribute","getConstant","columns","rulerMarginDiv","maginLeft","rulerZeroPoint","pageWidth","rightMarginValue","rightIndentValue","paragraphFormat","rightIndent","minimumValue","leftMarginValue","leftIndent","leftMaxLimit","leftMinLimit","rightMinLimit","rightMaxLimit","currentRightMargin","numberOfColumns","resizeRulerMargins","difference","startValue","documentHelper","currentPage","indicatorLineValue","lineSvg","mouseDownTabValue_1","mouseUpTabValue_1","currentTabStopElement","isTableMarkerDragging","divRect_1","getNumberFromString","y","clientY","bidi","paraWidth","parseFloat","container","maxValue","visibleElement","dataNameValue","getAttribute","tabStop","tabJustification","getTabJustification","deletePosition","tabLeader","editorModule","onApplyParagraphFormat","property","differenceValue","currentValue","leftIndentCurrentValue","finalvalue","secFormat","cloneFormat","columnSpace","space","col","widthCal","onApplySectionFormat","startMargin","isTopRulerMargin","initialYValue","currentScrollTop","bottomMargin","mouseXRelativeToDiv_1","pageHeight","bottomMarginValue","topMarginValue","topMinLimit","topMaxLimit","bottomMinLimit","bottomMaxLimit","currentBottomMargin","resizeVRulerMargins","bottomtMargin","endMargin","updateIndicatorLines","hRulerSvg","hRulerLine","vRulerSvg","vRulerLine","pageContainer","pageData","createIndicatorLines","viewerContainer","data","hSvgAttr","hSvg","verticalLineAttr","vLine","vSvgAttr","vSvg","horizontalLineAttr","hLine","updateIndentMarkers","indent","currentIndentValue","finalValue","currentMargin","isInsideTable","associatedCell","ownerTable","tableFormat","rulerMarginDivWidth","paraStart","finalValueTemp","viewer","clientArea","updateTabStopMarkers","paragarph","tabs","RenderedTabElement","convertNodeListToArray","querySelectorAll","tabMarker","splice","indexOf","value","elementToRemove","parentNode","removeChild","rulerContainer","rulerMargin","rulerHeight","rulerstyle","rulerattributes","updateRulerMargins","updateHorizontalRulerMargin","verticalRulerMarginDiv","rulerMarginDivHeight","marginTop","skipLoop","paraBidi","tableBidi","currnLefttMargin","horizontalRulerMarginDiv","marginLeft","isRulerTopMargin","currentTopMargin","mousePosition","isRulerLeftMargin","currentLeftMargin","getRulerOrigin","range","attr","pathattr","pathElement","append","stopPropagation","isDragging_1","firstLineOffset_1","initialValue_1","initialValue2","minValue","rightIndent_1","replace","applyRulerMarkerValues","hangingIndentSvg","isDragging_2","hangingLineOffset_1","initialValue_2","minLimit_1","maxLimit_1","leftIndent_1","rightPosition","leftIndentSvg","isDragging_3","leftLineOffset_1","initialValue_3","firstIndentInitialValue_1","diff_1","minLimit_2","maxLimit_2","isHangingIndent_1","rightIndentSvg","isDragging_4","rightLineOffset_1","initialValue_4","leftIndent_2","firstLineIndent_1","nearestElement","indentValue","updateRuler","rerenderRuler","rulerHelper","isReadOnlyMode","hOffset","updateRulerDimension","updateTableMarkers","removeTableMarkers","renderedTableMarkers","renderTableMarkers","intialPosition","tablewidget","containerWidget","tableRowWidget","ownerRow","cellWidgets","childWidgets","reverse","tableXPos","_loop_1","tableMarker","right","thickness","this_1","tableMarkerOffset","startXPosition","cursorPoint","touchPoint","findFocusedPage","currentMarkerPostion","currentTarget","HTMLElement","parts","value_1","tableWidget","tableResize","currentResizingTable","resizeNode","resizerPosition","startingPoint","editorHistoryModule","initResizingHistory","hRuler_1","value_2","dragValue","handleResizing","updateResizingHistory","offset","updateRulerDiv","updateRulerSpace","scale","clientActiveArea","segmentWidth","getVerticalHeight","pageheight","containerHeight","pages","leftTab","centerTab","rightTab","decimalTab","barTab","rectAttr","rect","tabStopElement_1","showTabDialog","isDragging_5","tabStopOffset_1","initialValue_5","justification_1","currrentParagraph_1","tabIndex_1","currentTabStop_1","value_3","leftIndentValue","removeTabStops","updateTabStopCollection"],"sources":["/home/taymur/Documents/legal2/DATA/Highlight/newmerged/CASEFRONTt/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/utility/dom-util.js"],"sourcesContent":["import { L10n, createElement, isNullOrUndefined } from '@syncfusion/ej2-base';\n//import { DocumentEditorRulerModel } from '../ruler-settings-model';\nimport { Ruler } from '../ruler/index';\nimport { HelperMethods, Point } from '../editor/editor-helper';\nimport { WTabStop } from '../format/paragraph-format';\n/**\n * Size defines and processes the size(width/height) of the objects\n * @private\n */\nvar Size = /** @class */ (function () {\n    function Size(width, height) {\n        this.width = width;\n        this.height = height;\n    }\n    /**\n     * isEmpty method \\\n     *\n     * @returns { boolean } isEmpty method .\\\n     *\n     * @private\n     */\n    Size.prototype.isEmpty = function () {\n        return this.height === 0 && this.width === 0;\n    };\n    /**\n    * clone method \\\n    *\n    * @returns { Size } clone method .\\\n    *\n    * @private\n    */\n    Size.prototype.clone = function () {\n        return new Size(this.width, this.height);\n    };\n    return Size;\n}());\nexport { Size };\n/* eslint-disable */\n/**\n * defines the helper methods for the ruler\n * @private\n */\nvar RulerHelper = /** @class */ (function () {\n    function RulerHelper() {\n    }\n    /**\n     * @private\n     */\n    RulerHelper.prototype.hideTabStopSwitch = function (show) {\n        if (this.tabStopStwitch) {\n            this.showHideElement(show, this.tabStopStwitch);\n        }\n    };\n    /**\n     * @private\n     */\n    RulerHelper.prototype.hideRulerBottom = function (show) {\n        if (this.hRulerBottom) {\n            this.showHideElement(show, this.hRulerBottom);\n        }\n        if (this.vRulerBottom) {\n            this.showHideElement(show, this.vRulerBottom);\n        }\n    };\n    RulerHelper.prototype.showHideElement = function (show, element) {\n        if (show) {\n            element.style.display = 'block';\n        }\n        else {\n            element.style.display = 'none';\n        }\n    };\n    /* eslint-enable */\n    /**\n     * createHtmlElement method \\\n     *\n     * @returns {SVGSVGElement} createHtmlElement method .\\\n     * @param { string } elementType - provide the diagramId  value.\n     * @param { Object } attribute - provide the diagramId  value.\n     * @private\n     */\n    RulerHelper.prototype.createHtmlElement = function (elementType, attribute) {\n        var element = createElement(elementType);\n        this.setAttributeHtml(element, attribute);\n        return element;\n    };\n    /**\n     * createSvgElement method \\\n     *\n     * @returns {SVGSVGElement} createSvgElement method .\\\n     * @param { string } elementType - provide the elementType  value.\n     * @param { Object } attribute - provide the attribute  value.\n     * @private\n     */\n    RulerHelper.prototype.createSvgElement = function (elementType, attribute) {\n        var element = document.createElementNS('http://www.w3.org/2000/svg', elementType);\n        this.setAttributeSvg(element, attribute);\n        return element;\n    };\n    /**\n     * applyStyleAgainstCsp method   \\\n     *\n     * @returns {void} applyStyleAgainstCsp method .\\\n     * @param { SVGElement } svg - provide the svg  value.\n     * @param { string } attributes - provide the boolean  value.\n     * @private\n     */\n    RulerHelper.prototype.applyStyleAgainstCsp = function (svg, attributes) {\n        var keys = attributes.split(';');\n        for (var i = 0; i < keys.length; i++) {\n            var attribute = keys[parseInt(i.toString(), 10)].split(':');\n            if (attribute.length === 2) {\n                svg.style[attribute[0].trim()] = attribute[1].trim();\n            }\n        }\n    };\n    /**\n     * setAttributeSvg method.\n     *\n     * @returns {void} setAttributeSvg method .\\\n     * @param { SVGElement } svg - provide the svg  value.\n     * @param { Object } attributes - provide the boolean  value.\n     * @private\n     */\n    RulerHelper.prototype.setAttributeSvg = function (svg, attributes) {\n        var keys = Object.keys(attributes);\n        for (var i = 0; i < keys.length; i++) {\n            // Added below condition to check whether svg is undefined or not\n            if (svg && keys[parseInt(i.toString(), 10)] !== 'style') {\n                svg.setAttribute(keys[parseInt(i.toString(), 10)], attributes[keys[parseInt(i.toString(), 10)]]);\n            }\n            else {\n                this.applyStyleAgainstCsp(svg, attributes[keys[parseInt(i.toString(), 10)]]);\n            }\n        }\n    };\n    /**\n     * setAttributeHtml method   \\\n     *\n     * @returns {void} setAttributeHtml method .\\\n     * @param { HTMLElement } element - provide the svg  value.\n     * @param { Object } attributes - provide the boolean  value.\n     * @private\n     */\n    RulerHelper.prototype.setAttributeHtml = function (element, attributes) {\n        var keys = Object.keys(attributes);\n        for (var i = 0; i < keys.length; i++) {\n            if (keys[parseInt(i.toString(), 10)] !== 'style') {\n                element.setAttribute(keys[parseInt(i.toString(), 10)], attributes[keys[parseInt(i.toString(), 10)]]);\n            }\n            else {\n                this.applyStyleAgainstCsp(element, attributes[keys[parseInt(i.toString(), 10)]]);\n            }\n        }\n    };\n    /**\n     * renderOverlapElement method \\\n     *\n     * @returns {void} renderOverlapElement method .\\\n     * @param { DocumentEditor} documentEditor - provide the content  value.\n     * @private\n     */\n    RulerHelper.prototype.renderOverlapElement = function (documentEditor) {\n        var rulerSize = this.getRulerSize(documentEditor);\n        var attributes = {\n            'id': documentEditor.element.id + '_overlapRuler',\n            style: 'height:' + rulerSize.height + 'px;width:' + rulerSize.width + 'px;position:absolute;margin-left:0;margin-top:0;diplay:none',\n            class: 'e-ruler-overlap'\n        };\n        var overlap = this.createHtmlElement('div', attributes);\n        var element = document.getElementById(documentEditor.element.id + '_viewerContainer');\n        element.insertBefore(overlap, element.firstChild);\n        return overlap;\n    };\n    RulerHelper.prototype.renderRulerMarkerIndicatorElement = function (documentEditor) {\n        if (!documentEditor.enableSelection) {\n            return;\n        }\n        var rulerSize = this.getRulerSize(documentEditor);\n        var attributes = {\n            'id': documentEditor.element.id + '_markIndicator',\n            style: 'height:' + rulerSize.height + 'px;width:' + rulerSize.width + 'px;position:absolute;margin-left:0;margin-top:0;z-index:5;border:1px solid #ccc;display:' + (documentEditor.layoutType === 'Pages' ? 'block;' : 'none;'),\n            class: 'e-de-ruler-markIndicator'\n        };\n        var markIndicator = this.createHtmlElement('div', attributes);\n        this.tabStopStwitch = markIndicator;\n        var element = document.getElementById(documentEditor.element.id + '_viewerContainer');\n        element.insertBefore(markIndicator, element.firstChild);\n        var ownerId = documentEditor.element.id;\n        var firstLineIndent = document.getElementById(ownerId + '_firstLineIndent').cloneNode(true);\n        var hangingIndent = document.getElementById(ownerId + '_hangingIndent').cloneNode(true);\n        firstLineIndent.style.left = '1px';\n        firstLineIndent.style.top = rulerSize.height / 2 - 3 + 'px';\n        firstLineIndent.style.display = 'none';\n        firstLineIndent.classList.add('e-de-ruler-marker');\n        firstLineIndent.setAttribute('id', ownerId + '_firstLineIndent_-1');\n        hangingIndent.style.left = '1px';\n        hangingIndent.style.top = rulerSize.height / 2 - 3 + 'px';\n        hangingIndent.style.display = 'none';\n        hangingIndent.classList.add('e-de-ruler-marker');\n        hangingIndent.setAttribute('id', ownerId + '_hangingIndent_-1');\n        markIndicator.appendChild(hangingIndent);\n        markIndicator.appendChild(firstLineIndent);\n        var justification = ['Left', 'Center', 'Right', 'Decimal', 'Bar'];\n        var locale = new L10n('documenteditor', documentEditor.defaultLocale);\n        locale.setLocale(documentEditor.locale);\n        for (var i = 0; i < 5; i++) {\n            this.renderTab(documentEditor, rulerSize, undefined, justification[parseInt(i.toString(), 10)], -1, locale);\n            var element_1 = document.getElementById(documentEditor.element.id + '_' + justification[parseInt(i.toString(), 10)] + 'Tab_-1');\n            if (!isNullOrUndefined(element_1)) {\n                element_1.classList.remove('e-de-ruler-tab');\n                element_1.classList.add('e-de-ruler-marker');\n                element_1.style.display = i == 0 ? 'block' : 'none';\n                element_1.style.position = 'absolute';\n                element_1.style.margin = '4px 3px';\n                markIndicator.appendChild(element_1);\n            }\n        }\n        markIndicator.addEventListener('click', function (event) {\n            var divElements = document.querySelector('.e-de-ruler-markIndicator');\n            for (var i = 0; i < divElements.childNodes.length; i++) {\n                var currentDiv = divElements.childNodes[parseInt(i.toString(), 10)];\n                if (currentDiv.style.display === 'block') {\n                    currentDiv.style.display = 'none';\n                    var nextIndex = (i + 1) % divElements.childNodes.length;\n                    divElements.childNodes[parseInt(nextIndex.toString(), 10)].style.display = 'block';\n                    break;\n                }\n            }\n        });\n    };\n    /**\n     * renderRuler method \\\n     *\n     * @returns {void} renderRuler method .\\\n     * @param { DocumentEditor} documentEditor - provide the content  value.\n     * @param { boolean} isHorizontal - provide the content  value.\n     * @private\n     */\n    RulerHelper.prototype.renderRuler = function (documentEditor, isHorizontal) {\n        var _this = this;\n        if (!documentEditor.enableSelection) {\n            return;\n        }\n        var div = document.getElementById(documentEditor.element.id + (isHorizontal ? '_hRuler' : '_vRuler'));\n        var rulerSize = this.getRulerSize(documentEditor);\n        var rulerGeometry = this.getRulerGeometry(documentEditor);\n        var height = isHorizontal ? documentEditor.selectionModule.end.paragraph.bodyWidget.page.boundingRectangle.x\n            : (documentEditor.selectionModule.getPageTop(documentEditor.selectionModule.end.paragraph.bodyWidget.page));\n        var margin = isHorizontal ? ('margin-left:' + height + 'px;') : ('margin-top:' + height + 'px;');\n        if (documentEditor.selectionModule.isForward) {\n            this.position = documentEditor.selectionModule.start;\n        }\n        else {\n            this.position = documentEditor.selectionModule.end;\n        }\n        // const margin: string = isHorizontal ? ('margin-left:' + (pixelsToPoints(documentEditor.selection.end.paragraph.bodyWidget.page.boundingRectangle.x)) + 'px;') : ('margin-top:' + rulerSize.height + 'px;');\n        if (!div) {\n            var style_1 = 'height:' + (isHorizontal ? rulerSize.height : rulerGeometry.height) + 'px;overflow:hidden;width:' +\n                (isHorizontal ? rulerGeometry.width : rulerSize.width) + 'px;position:absolute;font-size:9px;text-align: left;z-index: 4;user-select:none;' + margin;\n            var attributes_1 = {\n                'id': documentEditor.element.id + (isHorizontal ? '_hRuler' : '_vRuler'),\n                style: style_1, class: (isHorizontal ? 'e-de-hRuler' : 'e-de-vRuler')\n            };\n            div = this.createHtmlElement('div', attributes_1);\n        }\n        div.addEventListener('dblclick', function () {\n            documentEditor.showDialog('PageSetup');\n        });\n        var pageElement = document.getElementById(documentEditor.element.id + '_pageContainer');\n        var style = 'height:' + (isHorizontal ? rulerSize.height : pageElement.getBoundingClientRect().height) + 'px;overflow:hidden;width:' +\n            (isHorizontal ? pageElement.getBoundingClientRect().width : rulerSize.width) + 'px;position:absolute;z-index: 3;';\n        var attributes = {\n            'id': documentEditor.element.id + (isHorizontal ? '_hRulerBottom' : '_vRulerBottom'),\n            style: style, class: (isHorizontal ? 'e-de-hRuler' : 'e-de-vRuler')\n        };\n        var overlap = this.createHtmlElement('div', attributes);\n        isHorizontal ? (this.hRulerBottom = overlap) : (this.vRulerBottom = overlap);\n        var parentElement = document.getElementById(documentEditor.element.id + '_viewerContainer');\n        parentElement.insertBefore(overlap, parentElement.firstChild);\n        var element = isHorizontal ? document.getElementById(documentEditor.element.id + '_hRulerBottom') : document.getElementById(documentEditor.element.id + '_vRulerBottom');\n        element.insertBefore(div, element.firstChild);\n        this.renderRulerMargins(documentEditor, isHorizontal, div);\n        //const documentEditorRuler: DocumentEditorRulerModel = isHorizontal ? documentEditor.documentEditorSettings.rulerSettings.horizontalRuler : documentEditor.documentEditorSettings.rulerSettings.verticalRuler;\n        var ruler = new Ruler(div, this);\n        ruler.orientation = isHorizontal ? 'Horizontal' : 'Vertical';\n        this.updateMargin(ruler, documentEditor, isHorizontal);\n        // ruler.pageWidth = documentEditor.selection.end.paragraph.bodyWidget.page.boundingRectangle.width;\n        // ruler.pageHeight = documentEditor.selection.end.paragraph.bodyWidget.page.boundingRectangle.height;\n        // ruler.length = (isHorizontal ? rulerGeometry.width : rulerGeometry.height) + documentEditorRuler.segmentWidth;\n        ruler.length = ruler.zeroPosition * 2;\n        ruler.appendTo();\n        // eslint-disable-next-line\n        isHorizontal ? documentEditor.hRuler = ruler : documentEditor.vRuler = ruler;\n        this.updateRulerPosition(documentEditor, isHorizontal);\n        var rulerObj = document.getElementById(documentEditor.element.id + (isHorizontal ? '_hRuler' : '_vRuler'));\n        // eslint-disable-next-line\n        isHorizontal ? documentEditor.hRuler.element = rulerObj : documentEditor.vRuler.element = rulerObj;\n        if (rulerObj) {\n            // Set the scrollLeft property to the desired value (e.g., 100 pixels)\n            if (isHorizontal) {\n                rulerObj.scrollLeft = ruler.zeroPosition -\n                    HelperMethods.convertPointToPixel(documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin);\n            }\n            else {\n                rulerObj.scrollTop = ruler.zeroPosition -\n                    HelperMethods.convertPointToPixel(documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.topMargin);\n            }\n        }\n        this.locale = new L10n('documenteditor', documentEditor.defaultLocale);\n        if (isHorizontal) {\n            this.renderIndents(documentEditor, isHorizontal, rulerSize, rulerGeometry, this.locale);\n        }\n        var resizerEnabled = false;\n        var isDragging = false;\n        var isLeftRulerMargin = undefined;\n        var isLeftMultiColumn = false;\n        var isRightMultiColumn = false;\n        var multiColumnElement;\n        var hRuler = document.getElementById(documentEditor.element.id + '_hRuler');\n        var columnInitialValue;\n        var initialValue;\n        var currentScrollLeft;\n        var initialRightMargin;\n        var finalmouseXRelativeToDiv;\n        if (isHorizontal) {\n            document.addEventListener('mousemove', function (e) {\n                if (documentEditor.isDestroyed || !documentEditor.documentEditorSettings.showRuler) {\n                    return;\n                }\n                var divRect = hRuler.getBoundingClientRect();\n                var leftMargin = documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin * documentEditor.zoomFactor;\n                var rightMargin = (HelperMethods.convertPixelToPoint(divRect.width) - documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.rightMargin * documentEditor.zoomFactor);\n                var pixelValue = Math.round(e.clientX - divRect.left);\n                var mouseXRelativeToDiv = HelperMethods.convertPixelToPoint(pixelValue);\n                if (!isDragging) {\n                    if (documentEditor.isOnIndent) {\n                        hRuler.style.cursor = 'default';\n                        if (hRuler.hasAttribute('title')) {\n                            hRuler.removeAttribute('title');\n                        }\n                        resizerEnabled = false;\n                    }\n                    else if (((leftMargin - 3) <= mouseXRelativeToDiv) && ((leftMargin + 3) >= mouseXRelativeToDiv)) {\n                        if (documentEditor.layoutType === 'Pages') {\n                            hRuler.style.cursor = 'e-resize';\n                            hRuler.setAttribute('title', _this.locale.getConstant('Left Margin'));\n                            resizerEnabled = true;\n                            isLeftRulerMargin = true;\n                        }\n                    }\n                    else if ((((rightMargin - 3) <= mouseXRelativeToDiv) && ((rightMargin + 3) >= mouseXRelativeToDiv))) {\n                        if (documentEditor.layoutType === 'Pages') {\n                            hRuler.style.cursor = 'e-resize';\n                            hRuler.setAttribute('title', _this.locale.getConstant('Right Margin'));\n                            resizerEnabled = true;\n                            isLeftRulerMargin = false;\n                        }\n                    }\n                    else if (documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.columns.length > 0) {\n                        var columns = documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.columns;\n                        if (documentEditor.layoutType === 'Pages') {\n                            for (var i = 1; i <= columns.length; i++) {\n                                var rulerMarginDiv = document.getElementById(documentEditor.element.id + '_hRuler_Margin' + i);\n                                var maginLeft = rulerMarginDiv.getBoundingClientRect().left;\n                                var width = rulerMarginDiv.getBoundingClientRect().width;\n                                if (((maginLeft - 3) <= e.clientX) && ((maginLeft + 3) >= e.clientX)) {\n                                    hRuler.style.cursor = \"e-resize\";\n                                    multiColumnElement = rulerMarginDiv;\n                                    hRuler.setAttribute('title', _this.locale.getConstant('Left Margin'));\n                                    isLeftMultiColumn = true;\n                                    resizerEnabled = true;\n                                    break;\n                                }\n                                else if (((maginLeft + width - 3) <= e.clientX) && ((maginLeft + width + 3) >= e.clientX)) {\n                                    hRuler.style.cursor = \"e-resize\";\n                                    multiColumnElement = rulerMarginDiv;\n                                    hRuler.setAttribute('title', _this.locale.getConstant('Right Margin'));\n                                    isRightMultiColumn = true;\n                                    resizerEnabled = true;\n                                    break;\n                                }\n                                else {\n                                    hRuler.style.cursor = \"default\";\n                                    if (hRuler.hasAttribute('title')) {\n                                        hRuler.removeAttribute('title');\n                                    }\n                                    isLeftMultiColumn = false;\n                                    isRightMultiColumn = false;\n                                    resizerEnabled = false;\n                                }\n                            }\n                        }\n                    }\n                    else {\n                        hRuler.style.cursor = 'default';\n                        if (hRuler.hasAttribute('title')) {\n                            hRuler.removeAttribute('title');\n                        }\n                        resizerEnabled = false;\n                    }\n                }\n                if (isDragging) {\n                    var rulerZeroPoint = HelperMethods.convertPointToPixel(1584 - documentEditor.selectionModule.sectionFormat.leftMargin) * documentEditor.zoomFactor;\n                    var pageWidth = documentEditor.selectionModule.sectionFormat.pageWidth;\n                    var rightMarginValue = documentEditor.selectionModule.sectionFormat.rightMargin;\n                    var rightIndentValue = documentEditor.selectionModule.paragraphFormat.rightIndent;\n                    rightIndentValue = rightIndentValue > 0 ? rightIndentValue : 0;\n                    var minimumValue = 42;\n                    var firstLineIndent = documentEditor.selectionModule.paragraphFormat.firstLineIndent;\n                    var leftMarginValue = documentEditor.selectionModule.sectionFormat.leftMargin;\n                    firstLineIndent = firstLineIndent >= 0 ? firstLineIndent : 0;\n                    var leftIndent = documentEditor.selectionModule.paragraphFormat.leftIndent;\n                    if (isLeftRulerMargin) {\n                        var leftMaxLimit = rulerZeroPoint + (HelperMethods.convertPointToPixel(pageWidth - rightMarginValue - rightIndentValue - minimumValue - firstLineIndent - leftIndent) * documentEditor.zoomFactor);\n                        var leftMinLimit = rulerZeroPoint;\n                        if (pixelValue + rulerZeroPoint > leftMaxLimit) {\n                            pixelValue = leftMaxLimit - rulerZeroPoint;\n                            mouseXRelativeToDiv = HelperMethods.convertPixelToPoint(pixelValue);\n                        }\n                        else if (pixelValue + rulerZeroPoint < leftMinLimit) {\n                            pixelValue = leftMinLimit - rulerZeroPoint;\n                            mouseXRelativeToDiv = HelperMethods.convertPixelToPoint(pixelValue);\n                        }\n                    }\n                    else {\n                        var rightMinLimit = rulerZeroPoint + (HelperMethods.convertPointToPixel(leftMarginValue + leftIndent + firstLineIndent + minimumValue + rightIndentValue) * documentEditor.zoomFactor);\n                        var rightMaxLimit = rulerZeroPoint + (HelperMethods.convertPointToPixel(pageWidth) * documentEditor.zoomFactor);\n                        if (pixelValue + rulerZeroPoint > rightMaxLimit) {\n                            pixelValue = rightMaxLimit - rulerZeroPoint;\n                            mouseXRelativeToDiv = HelperMethods.convertPixelToPoint(pixelValue);\n                        }\n                        else if (pixelValue + rulerZeroPoint < rightMinLimit) {\n                            pixelValue = rightMinLimit - rulerZeroPoint;\n                            mouseXRelativeToDiv = HelperMethods.convertPixelToPoint(pixelValue);\n                        }\n                    }\n                    finalmouseXRelativeToDiv = mouseXRelativeToDiv;\n                    var currentRightMargin = (HelperMethods.convertPixelToPoint(divRect.width) - (documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.rightMargin * documentEditor.zoomFactor));\n                    if (documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.numberOfColumns <= 1) {\n                        _this.resizeRulerMargins(isLeftRulerMargin, initialValue, currentScrollLeft, currentRightMargin, hRuler, mouseXRelativeToDiv, true, documentEditor);\n                    }\n                    var rightIndent = document.getElementById(documentEditor.element.id + '_rightIndent');\n                    if (isLeftRulerMargin) {\n                        var difference = mouseXRelativeToDiv - initialValue;\n                        rightIndent.style.left = (initialRightMargin - HelperMethods.convertPointToPixel(difference)) + 'px';\n                    }\n                    else {\n                        var difference = mouseXRelativeToDiv - initialValue;\n                        rightIndent.style.left = (initialRightMargin + HelperMethods.convertPointToPixel(difference)) + 'px';\n                    }\n                    var startValue = documentEditor.documentHelper.currentPage.boundingRectangle.x;\n                    var indicatorLineValue = startValue + pixelValue;\n                    var lineSvg = document.getElementById(documentEditor.element.id + '_hRuler_indicator_svg');\n                    lineSvg.style.left = indicatorLineValue + 'px';\n                }\n            });\n            var mouseDownTabValue_1;\n            var mouseUpTabValue_1;\n            hRuler.addEventListener(\"mouseenter\", function (e) {\n                if (!isNullOrUndefined(_this.currentTabStopElement)) {\n                    _this.currentTabStopElement.style.display = 'block';\n                }\n            });\n            hRuler.addEventListener(\"mouseleave\", function (e) {\n                if (!isNullOrUndefined(_this.currentTabStopElement)) {\n                    _this.currentTabStopElement.style.display = 'none';\n                    //this.currentTabStopElement = undefined;\n                }\n            });\n            hRuler.addEventListener(\"mousedown\", function (e) {\n                if (resizerEnabled && !documentEditor.isTableMarkerDragging) {\n                    isDragging = true;\n                    if (documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.columns.length > 0) {\n                        if (isLeftMultiColumn) {\n                            columnInitialValue = multiColumnElement.getBoundingClientRect().left;\n                        }\n                        else if (isRightMultiColumn) {\n                            columnInitialValue = multiColumnElement.getBoundingClientRect().left + multiColumnElement.getBoundingClientRect().width;\n                        }\n                    }\n                    var divRect_1 = hRuler.getBoundingClientRect();\n                    initialValue = HelperMethods.convertPixelToPoint(Math.round(e.clientX - divRect_1.left));\n                    currentScrollLeft = hRuler.scrollLeft;\n                    var rightIndent = document.getElementById(documentEditor.element.id + '_rightIndent');\n                    initialRightMargin = HelperMethods.getNumberFromString(rightIndent.style.left);\n                    var pixelValue = Math.round(e.clientX - divRect_1.left);\n                    var startValue = documentEditor.documentHelper.currentPage.boundingRectangle.x;\n                    var indicatorLineValue = startValue + pixelValue;\n                    var lineSvg = document.getElementById(documentEditor.element.id + '_hRuler_indicator_svg');\n                    lineSvg.style.left = indicatorLineValue + 'px';\n                    lineSvg.style.display = 'block';\n                }\n                var divRect = hRuler.getBoundingClientRect();\n                if (divRect.y + (divRect.height / 2) <= e.clientY) {\n                    mouseDownTabValue_1 = e.clientX - hRuler.getBoundingClientRect().left;\n                    if (documentEditor.layoutType === 'Pages') {\n                        mouseDownTabValue_1 = HelperMethods.convertPixelToPoint(mouseDownTabValue_1 - HelperMethods.convertPointToPixel(documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin) * documentEditor.zoomFactor);\n                        if (_this.position.paragraph.paragraphFormat.bidi) {\n                            var paraWidth = !isNullOrUndefined(_this.position.paragraph['absoluteXPosition']) ? parseFloat(_this.position.paragraph['absoluteXPosition']['width'].toString()) : _this.position.paragraph.width;\n                            paraWidth = HelperMethods.convertPixelToPoint(paraWidth * documentEditor.zoomFactor);\n                            mouseDownTabValue_1 = paraWidth - mouseDownTabValue_1;\n                        }\n                    }\n                    else if (documentEditor.layoutType === 'Continuous') {\n                        if (_this.position.paragraph.paragraphFormat.bidi) {\n                            mouseDownTabValue_1 = HelperMethods.convertPixelToPoint((mouseDownTabValue_1) - 20);\n                            var paraWidth = !isNullOrUndefined(_this.position.paragraph['absoluteXPosition']) ? parseFloat(_this.position.paragraph['absoluteXPosition']['width'].toString()) : _this.position.paragraph.width;\n                            paraWidth = HelperMethods.convertPixelToPoint(paraWidth * documentEditor.zoomFactor);\n                            mouseDownTabValue_1 = paraWidth - mouseDownTabValue_1;\n                        }\n                        else {\n                            mouseDownTabValue_1 = HelperMethods.convertPixelToPoint((mouseDownTabValue_1) - 20);\n                        }\n                    }\n                }\n            });\n            hRuler.addEventListener(\"mouseup\", function (e) {\n                var container = document.getElementById(documentEditor.element.id + '_markIndicator');\n                var divRect = hRuler.getBoundingClientRect();\n                if (divRect.y + (divRect.height / 2) <= e.clientY) {\n                    mouseUpTabValue_1 = e.clientX - hRuler.getBoundingClientRect().left;\n                    if (documentEditor.layoutType === 'Pages') {\n                        mouseUpTabValue_1 = HelperMethods.convertPixelToPoint(mouseUpTabValue_1 - HelperMethods.convertPointToPixel(documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin) * documentEditor.zoomFactor);\n                        if (_this.position.paragraph.paragraphFormat.bidi) {\n                            var paraWidth = !isNullOrUndefined(_this.position.paragraph['absoluteXPosition']) ? parseFloat(_this.position.paragraph['absoluteXPosition']['width'].toString()) : _this.position.paragraph.width;\n                            paraWidth = HelperMethods.convertPixelToPoint(paraWidth * documentEditor.zoomFactor);\n                            mouseUpTabValue_1 = paraWidth - mouseUpTabValue_1;\n                        }\n                    }\n                    else if (documentEditor.layoutType === 'Continuous') {\n                        if (_this.position.paragraph.paragraphFormat.bidi) {\n                            mouseUpTabValue_1 = HelperMethods.convertPixelToPoint((mouseUpTabValue_1) - 20);\n                            var paraWidth = !isNullOrUndefined(_this.position.paragraph['absoluteXPosition']) ? parseFloat(_this.position.paragraph['absoluteXPosition']['width'].toString()) : _this.position.paragraph.width;\n                            paraWidth = HelperMethods.convertPixelToPoint(paraWidth * documentEditor.zoomFactor);\n                            mouseUpTabValue_1 = paraWidth - mouseUpTabValue_1;\n                        }\n                        else {\n                            mouseUpTabValue_1 = HelperMethods.convertPixelToPoint((mouseUpTabValue_1) - 20);\n                        }\n                    }\n                    var rightIndent = document.getElementById(documentEditor.element.id + '_rightIndent');\n                    var rightIndentValue = HelperMethods.getNumberFromString(rightIndent.style.left);\n                    var maxValue = rightIndentValue;\n                    if (mouseUpTabValue_1 > 0 && mouseUpTabValue_1 < maxValue && mouseDownTabValue_1 == mouseUpTabValue_1) {\n                        if (!isNullOrUndefined(container)) {\n                            var visibleElement = container.querySelector('.e-de-ruler-marker[style*=\"display: block;\"]');\n                            if (!isNullOrUndefined(visibleElement)) {\n                                mouseUpTabValue_1 /= documentEditor.zoomFactor;\n                                var dataNameValue = visibleElement.getAttribute('data-name');\n                                if (dataNameValue == 'LeftTab' || dataNameValue == 'CenterTab' || dataNameValue == 'RightTab' || dataNameValue == 'DecimalTab' || dataNameValue == 'BarTab') {\n                                    var tabStop = new WTabStop();\n                                    tabStop.position = mouseUpTabValue_1;\n                                    tabStop.tabJustification = _this.getTabJustification(dataNameValue);\n                                    tabStop.deletePosition = 0;\n                                    tabStop.tabLeader = 'None';\n                                    documentEditor.editorModule.onApplyParagraphFormat('tabStop', [tabStop], false, false);\n                                }\n                                else if (dataNameValue == 'FirstLineIndent' || dataNameValue == 'HangingIndent') {\n                                    var property = 'firstLineIndent';\n                                    if (dataNameValue == 'HangingIndent') {\n                                        var initialValue = documentEditor.selectionModule.paragraphFormat.firstLineIndent;\n                                        var differenceValue = mouseUpTabValue_1 + initialValue;\n                                        var currentValue = documentEditor.selectionModule.start.paragraph.paragraphFormat.firstLineIndent;\n                                        documentEditor.editorModule.onApplyParagraphFormat('firstLineIndent', currentValue - differenceValue, false, false);\n                                        var leftIndentCurrentValue = documentEditor.selectionModule.start.paragraph.paragraphFormat.leftIndent + currentValue;\n                                        currentValue = currentValue - differenceValue;\n                                        documentEditor.editorModule.onApplyParagraphFormat('leftIndent', leftIndentCurrentValue - currentValue, false, false, true);\n                                    }\n                                    else {\n                                        documentEditor.editorModule.onApplyParagraphFormat(property, mouseDownTabValue_1, false, false);\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            });\n            document.addEventListener(\"mouseup\", function (e) {\n                if (isDragging && !documentEditor.isTableMarkerDragging) {\n                    var divRect = hRuler.getBoundingClientRect();\n                    var mouseXRelativeToDiv = finalmouseXRelativeToDiv; // HelperMethods.convertPixelToPoint(Math.round(e.clientX - divRect.left));\n                    // const currentLeftMargin = documentEditor.hRuler.startMargin * documentEditor.zoomFactor;\n                    // const currentScrollLeft = hRuler.scrollLeft;\n                    // const currentRightMargin = (HelperMethods.convertPixelToPoint(divRect.width) - (documentEditor.selection.end.paragraph.bodyWidget.sectionFormat.rightMargin * documentEditor.zoomFactor));\n                    // resizeRulerMargins(isLeftRulerMargin, currentLeftMargin, currentScrollLeft, currentRightMargin, hRuler, mouseXRelativeToDiv, true, documentEditor);\n                    // if (hRuler) {\n                    //     rulerObj.scrollLeft = rulerObj.scrollLeft - HelperMethods.convertPointToPixel((documentEditor.hRuler.leftMargin < mouseXRelativeToDiv) ? (mouseXRelativeToDiv - documentEditor.hRuler.leftMargin) : (documentEditor.hRuler.leftMargin - mouseXRelativeToDiv));\n                    // }\n                    // updateRuler(documentEditor, documentEditor.hRuler, true);\n                    if (isLeftMultiColumn || isRightMultiColumn) {\n                        var finalvalue = 0;\n                        finalvalue = e.clientX - columnInitialValue;\n                        var secFormat = documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.cloneFormat();\n                        var pageWidth = documentEditor.selectionModule.sectionFormat.pageWidth - documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin - documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.rightMargin;\n                        var columnSpace = isLeftMultiColumn ? (secFormat.columns[0].space + ((HelperMethods.convertPixelToPoint(finalvalue)))) : (secFormat.columns[0].space - ((HelperMethods.convertPixelToPoint(finalvalue))));\n                        for (var i = 0; i < secFormat.columns.length; i++) {\n                            var col = secFormat.columns[parseInt(i.toString(), 10)];\n                            if (columnSpace >= 0 && col.width >= 36) {\n                                var widthCal = HelperMethods.convertPointToPixel((pageWidth - (HelperMethods.convertPixelToPoint(columnSpace) * (secFormat.numberOfColumns - 1))) / (secFormat.numberOfColumns));\n                                col.width = widthCal;\n                                if (i < secFormat.columns.length - 1) {\n                                    col.space = columnSpace;\n                                }\n                            }\n                            else {\n                                col[0].space = col[1].space;\n                            }\n                        }\n                        documentEditor.editorModule.onApplySectionFormat(undefined, secFormat);\n                        isLeftMultiColumn = false;\n                        isRightMultiColumn = false;\n                    }\n                    else if (isLeftRulerMargin) {\n                        documentEditor.hRuler.startMargin = (mouseXRelativeToDiv / documentEditor.zoomFactor);\n                        documentEditor.selectionModule.sectionFormat.leftMargin = mouseXRelativeToDiv / documentEditor.zoomFactor;\n                    }\n                    else {\n                        var rightMargin = HelperMethods.convertPixelToPoint(rulerGeometry.width) - (mouseXRelativeToDiv / documentEditor.zoomFactor);\n                        // documentEditor.hRuler.endMargin = rightMargin;\n                        documentEditor.selectionModule.sectionFormat.rightMargin = rightMargin;\n                    }\n                    resizerEnabled = false;\n                    isDragging = false;\n                    isLeftRulerMargin = undefined;\n                    var lineSvg = document.getElementById(documentEditor.element.id + '_hRuler_indicator_svg');\n                    lineSvg.style.display = 'none';\n                }\n            });\n        }\n        //Vertical Ruler Resizing\n        var vRuler = document.getElementById(documentEditor.element.id + '_vRuler');\n        var isTopRulerMargin = false;\n        var initialYValue;\n        var currentScrollTop;\n        if (!isHorizontal) {\n            document.addEventListener(\"mousemove\", function (e) {\n                if (documentEditor.isDestroyed || !documentEditor.documentEditorSettings.showRuler) {\n                    return;\n                }\n                var divRect = vRuler.getBoundingClientRect();\n                var topMargin = documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.topMargin * documentEditor.zoomFactor;\n                var bottomMargin = (HelperMethods.convertPixelToPoint(divRect.height) - documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.bottomMargin * documentEditor.zoomFactor);\n                var mouseXRelativeToDiv = HelperMethods.convertPixelToPoint(Math.round(e.clientY - divRect.top));\n                var pixelValue = Math.round(e.clientY - divRect.top);\n                if (!isDragging) {\n                    if (((topMargin - 3) <= mouseXRelativeToDiv) && ((topMargin + 3) >= mouseXRelativeToDiv)) {\n                        vRuler.style.cursor = \"n-resize\";\n                        vRuler.setAttribute('title', _this.locale.getConstant('Top Margin'));\n                        resizerEnabled = true;\n                        isTopRulerMargin = true;\n                    }\n                    else if ((((bottomMargin - 3) <= mouseXRelativeToDiv) && ((bottomMargin + 3) >= mouseXRelativeToDiv))) {\n                        vRuler.style.cursor = \"n-resize\";\n                        vRuler.setAttribute('title', _this.locale.getConstant('Bottom Margin'));\n                        resizerEnabled = true;\n                        isTopRulerMargin = false;\n                    }\n                    else {\n                        vRuler.style.cursor = \"default\";\n                        if (vRuler.hasAttribute('title')) {\n                            vRuler.removeAttribute('title');\n                        }\n                        resizerEnabled = false;\n                    }\n                }\n                if (isDragging) {\n                    var mouseXRelativeToDiv_1 = HelperMethods.convertPixelToPoint(Math.round(e.clientY - divRect.top));\n                    var rulerZeroPoint = HelperMethods.convertPointToPixel(1584 - documentEditor.selectionModule.sectionFormat.topMargin) * documentEditor.zoomFactor;\n                    var pageHeight = documentEditor.selectionModule.sectionFormat.pageHeight;\n                    var minimumValue = 12;\n                    var bottomMarginValue = documentEditor.selectionModule.sectionFormat.bottomMargin;\n                    var topMarginValue = documentEditor.selectionModule.sectionFormat.topMargin;\n                    if (isTopRulerMargin) {\n                        var topMinLimit = rulerZeroPoint;\n                        var topMaxLimit = rulerZeroPoint + (HelperMethods.convertPointToPixel(pageHeight - bottomMarginValue - minimumValue) * documentEditor.zoomFactor);\n                        if (pixelValue + rulerZeroPoint > topMaxLimit) {\n                            pixelValue = topMaxLimit - rulerZeroPoint;\n                            mouseXRelativeToDiv_1 = HelperMethods.convertPixelToPoint(pixelValue);\n                        }\n                        else if (pixelValue + rulerZeroPoint < topMinLimit) {\n                            pixelValue = topMinLimit - rulerZeroPoint;\n                            mouseXRelativeToDiv_1 = HelperMethods.convertPixelToPoint(pixelValue);\n                        }\n                    }\n                    else {\n                        var bottomMinLimit = rulerZeroPoint + (HelperMethods.convertPointToPixel(topMarginValue + minimumValue) * documentEditor.zoomFactor);\n                        var bottomMaxLimit = rulerZeroPoint + (HelperMethods.convertPointToPixel(pageHeight) * documentEditor.zoomFactor);\n                        if (pixelValue + rulerZeroPoint > bottomMaxLimit) {\n                            pixelValue = bottomMaxLimit - rulerZeroPoint;\n                            mouseXRelativeToDiv_1 = HelperMethods.convertPixelToPoint(pixelValue);\n                        }\n                        else if (pixelValue + rulerZeroPoint < bottomMinLimit) {\n                            pixelValue = bottomMinLimit - rulerZeroPoint;\n                            mouseXRelativeToDiv_1 = HelperMethods.convertPixelToPoint(pixelValue);\n                        }\n                    }\n                    var currentBottomMargin = (HelperMethods.convertPixelToPoint(divRect.height) - (documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.bottomMargin * documentEditor.zoomFactor));\n                    _this.resizeVRulerMargins(isTopRulerMargin, initialYValue, currentScrollTop, currentBottomMargin, vRuler, mouseXRelativeToDiv_1, documentEditor);\n                    var startValue = documentEditor.documentHelper.currentPage.boundingRectangle.y * documentEditor.zoomFactor;\n                    var indicatorLineValue = startValue + pixelValue; // + 15;\n                    var lineSvg = document.getElementById(documentEditor.element.id + '_vRuler_indicator_svg');\n                    lineSvg.style.top = indicatorLineValue + 'px';\n                }\n            });\n            vRuler.addEventListener(\"mousedown\", function (e) {\n                if (resizerEnabled) {\n                    isDragging = true;\n                    var divRect = vRuler.getBoundingClientRect();\n                    initialYValue = HelperMethods.convertPixelToPoint(Math.round(e.clientY - divRect.top));\n                    currentScrollTop = vRuler.scrollTop;\n                    var pixelValue = Math.round(e.clientY - divRect.top);\n                    var lineSvg = document.getElementById(documentEditor.element.id + '_vRuler_indicator_svg');\n                    var startValue = documentEditor.documentHelper.currentPage.boundingRectangle.y * documentEditor.zoomFactor;\n                    var indicatorLineValue = (startValue + pixelValue); // + 15;\n                    lineSvg.style.top = indicatorLineValue + 'px';\n                    lineSvg.style.display = 'block';\n                }\n            });\n            document.addEventListener(\"mouseup\", function (e) {\n                if (isDragging) {\n                    var divRect = vRuler.getBoundingClientRect();\n                    var mouseXRelativeToDiv = HelperMethods.convertPixelToPoint(Math.round(e.clientY - divRect.top));\n                    // const currentTopMargin = documentEditor.hRuler.startMargin * documentEditor.zoomFactor;\n                    // const currentScrollTop = vRuler.scrollTop;\n                    // const currentBottomMargin = (HelperMethods.convertPixelToPoint(divRect.height) - (documentEditor.selection.end.paragraph.bodyWidget.sectionFormat.bottomMargin * documentEditor.zoomFactor));\n                    // resizeVRulerMargins(isTopRulerMargin, currentTopMargin, currentScrollTop, currentBottomMargin, vRuler, mouseXRelativeToDiv, documentEditor);\n                    // if (hRuler) {\n                    //     rulerObj.scrollLeft = rulerObj.scrollLeft - HelperMethods.convertPointToPixel((documentEditor.hRuler.leftMargin < mouseXRelativeToDiv) ? (mouseXRelativeToDiv - documentEditor.hRuler.leftMargin) : (documentEditor.hRuler.leftMargin - mouseXRelativeToDiv));\n                    // }\n                    // updateRuler(documentEditor, documentEditor.hRuler, true);\n                    if (isTopRulerMargin) {\n                        documentEditor.vRuler.startMargin = (mouseXRelativeToDiv / documentEditor.zoomFactor);\n                        documentEditor.selectionModule.sectionFormat.topMargin = mouseXRelativeToDiv / documentEditor.zoomFactor;\n                    }\n                    else {\n                        var bottomtMargin = HelperMethods.convertPixelToPoint(rulerGeometry.height) - (mouseXRelativeToDiv / documentEditor.zoomFactor);\n                        documentEditor.vRuler.endMargin = bottomtMargin;\n                        documentEditor.selectionModule.sectionFormat.bottomMargin = bottomtMargin;\n                    }\n                    resizerEnabled = false;\n                    isDragging = false;\n                    var lineSvg = document.getElementById(documentEditor.element.id + '_vRuler_indicator_svg');\n                    lineSvg.style.display = 'none';\n                    isTopRulerMargin = undefined;\n                }\n            });\n        }\n    };\n    RulerHelper.prototype.updateRulerPosition = function (documentEditor, isHorizontal) {\n        var rulerObj = document.getElementById(documentEditor.element.id + (isHorizontal ? '_hRuler' : '_vRuler'));\n        // eslint-disable-next-line\n        isHorizontal ? documentEditor.hRuler.element = rulerObj : documentEditor.vRuler.element = rulerObj;\n        if (rulerObj) {\n            // Set the scrollLeft property to the desired value (e.g., 100 pixels)\n            rulerObj.scrollLeft = 2112 - HelperMethods.convertPointToPixel(documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin);\n        }\n    };\n    RulerHelper.prototype.updateIndicatorLines = function (documentEditor) {\n        var hRulerSvg = document.getElementById(documentEditor.element.id + '_hRuler_indicator_svg');\n        var hRulerLine = document.getElementById(documentEditor.element.id + '_hRuler_indicator');\n        var vRulerSvg = document.getElementById(documentEditor.element.id + '_vRuler_indicator_svg');\n        var vRulerLine = document.getElementById(documentEditor.element.id + '_vRuler_indicator');\n        var pageContainer = document.getElementById(documentEditor.element.id + '_pageContainer');\n        var pageData = pageContainer.getBoundingClientRect();\n        var pageHeight = pageData.height;\n        var pageWidth = pageData.width;\n        hRulerSvg.style.height = pageHeight + 'px';\n        hRulerLine.setAttribute('y2', \"\" + pageHeight);\n        vRulerSvg.style.width = pageWidth + 'px';\n        vRulerLine.setAttribute('x2', \"\" + pageWidth);\n    };\n    RulerHelper.prototype.createIndicatorLines = function (documentEditor) {\n        if (!documentEditor.enableSelection) {\n            return;\n        }\n        var viewerContainer = document.getElementById(documentEditor.element.id + '_viewerContainer');\n        var pageContainer = document.getElementById(documentEditor.element.id + '_pageContainer');\n        // let container = document.getElementById(documentEditor.element.id);\n        var data = viewerContainer.getBoundingClientRect();\n        var pageData = pageContainer.getBoundingClientRect();\n        var pageHeight = pageData.height;\n        var pageWidth = pageData.width;\n        var hRuler = document.getElementById(documentEditor.element.id + '_hRuler');\n        var hSvgAttr = {\n            id: documentEditor.element.id + '_hRuler_indicator_svg',\n            width: 0.5 + 'px',\n            height: pageHeight + 'px',\n            style: 'position:absolute;z-index:1;display:none;'\n        };\n        var hSvg = this.createSvgElement('svg', hSvgAttr);\n        var verticalLineAttr = { 'x1': 0, 'y1': hRuler.getBoundingClientRect().height + 5, 'x2': 0, 'y2': pageHeight, 'stroke-width': 0.5, 'stroke': 'black' };\n        var vLine = this.createSvgElement('line', verticalLineAttr);\n        vLine.setAttribute('id', documentEditor.element.id + '_hRuler_indicator');\n        hSvg.appendChild(vLine);\n        viewerContainer.insertBefore(hSvg, viewerContainer.firstChild);\n        var vRuler = document.getElementById(documentEditor.element.id + '_vRuler');\n        var vSvgAttr = {\n            id: documentEditor.element.id + '_vRuler_indicator_svg',\n            width: pageWidth + 'px',\n            height: 0.5 + 'px',\n            style: 'position:absolute;z-index:1;display:none;'\n        };\n        var vSvg = this.createSvgElement('svg', vSvgAttr);\n        var horizontalLineAttr = { 'x1': vRuler.getBoundingClientRect().width + 5, 'y1': 0, 'x2': pageWidth, 'y2': 0, 'stroke-width': 0.5, 'stroke': 'black' };\n        var hLine = this.createSvgElement('line', horizontalLineAttr);\n        hLine.setAttribute('id', documentEditor.element.id + '_vRuler_indicator');\n        vSvg.appendChild(hLine);\n        viewerContainer.insertBefore(vSvg, viewerContainer.firstChild);\n    };\n    RulerHelper.prototype.updateIndentMarkers = function (documentEditor) {\n        if (isNullOrUndefined(documentEditor) || isNullOrUndefined(documentEditor.element) || isNullOrUndefined(documentEditor.element.id) || isNullOrUndefined(documentEditor.hRuler) || isNullOrUndefined(documentEditor.hRuler.zeroPosition)) {\n            return;\n        }\n        var indent = undefined;\n        var ownerId = documentEditor.element.id;\n        var rulerZeroPoint = HelperMethods.convertPointToPixel(1584 - documentEditor.selectionModule.sectionFormat.leftMargin);\n        var currentIndentValue;\n        var finalValue;\n        var currentMargin;\n        var pixelValue;\n        // if (documentEditor.selection.end.paragraph.isInsideTable) {\n        //     currentIndentValue = documentEditor.selection.paragraphFormat.leftIndent;\n        //     currentMargin = documentEditor.selection.sectionFormat.leftMargin;\n        //     finalValue = HelperMethods.convertPointToPixel(currentIndentValue) + currentCell.x;\n        //     pixelValue = (((rulerZeroPoint + ((finalValue))) * documentEditor.zoomFactor)) + 'px';\n        //     indent = document.getElementById(ownerId + '_leftIndent');\n        //     if (!isNullOrUndefined(indent)) {\n        //         indent.style.left = pixelValue;\n        //     }\n        //     indent = document.getElementById(ownerId + '_hangingIndent');\n        //     if (!isNullOrUndefined(indent)) {\n        //         indent.style.left = pixelValue;\n        //     }\n        //     indent = document.getElementById(ownerId + '_firstLineIndent');\n        //     currentIndentValue = documentEditor.selection.paragraphFormat.firstLineIndent;\n        //     currentMargin = documentEditor.selection.paragraphFormat.leftIndent;\n        //     finalValue = HelperMethods.convertPointToPixel(currentIndentValue + currentMargin) + currentCell.x;\n        //     pixelValue = (((rulerZeroPoint + ((finalValue))) * documentEditor.zoomFactor)) + 'px';\n        //     if (!isNullOrUndefined(indent)) {\n        //         indent.style.left = pixelValue;\n        //     }\n        //     indent = document.getElementById(ownerId + '_rightIndent');\n        //     currentIndentValue = documentEditor.selection.paragraphFormat.rightIndent;\n        //     currentMargin = documentEditor.selection.sectionFormat.rightMargin;\n        //     finalValue = (currentCell.x + currentCell.width) - HelperMethods.convertPointToPixel(currentIndentValue);\n        //     pixelValue = ((rulerZeroPoint + finalValue - 2) * documentEditor.zoomFactor) + 'px';\n        //     if (!isNullOrUndefined(indent)) {\n        //         indent.style.left = pixelValue;\n        //     }\n        // }\n        // else {\n        //     indent = document.getElementById(ownerId + '_leftIndent');\n        //     currentIndentValue = documentEditor.selection.paragraphFormat.leftIndent;\n        //     currentMargin = documentEditor.selection.sectionFormat.leftMargin;\n        //     finalValue = currentMargin + currentIndentValue;\n        //     pixelValue = (((rulerZeroPoint + (HelperMethods.convertPointToPixel(finalValue))) * documentEditor.zoomFactor) - 6) + 'px';\n        //     if (!isNullOrUndefined(indent)) {\n        //         indent.style.left = pixelValue;\n        //     }\n        //     indent = document.getElementById(ownerId + '_hangingIndent');\n        //     if (!isNullOrUndefined(indent)) {\n        //         indent.style.left = pixelValue;\n        //     }\n        //     indent = document.getElementById(ownerId + '_firstLineIndent');\n        //     currentIndentValue = documentEditor.selection.paragraphFormat.firstLineIndent;\n        //     let leftIndent = documentEditor.selection.paragraphFormat.leftIndent;\n        //     let leftMargin = documentEditor.selection.sectionFormat.leftMargin;\n        //     if (currentIndentValue < 0 && leftIndent < 0) {\n        //         currentIndentValue = currentIndentValue < 0 ? 0 : currentIndentValue;\n        //     }\n        //     finalValue = leftMargin + leftIndent + currentIndentValue;\n        //     pixelValue = (((rulerZeroPoint + HelperMethods.convertPointToPixel(finalValue)) * documentEditor.zoomFactor) - 6) + 'px';\n        //     if (!isNullOrUndefined(indent)) {\n        //         indent.style.left = pixelValue;\n        //     }\n        //     indent = document.getElementById(ownerId + '_rightIndent');\n        //     currentIndentValue = documentEditor.selection.paragraphFormat.rightIndent;\n        //     currentMargin = documentEditor.selection.sectionFormat.rightMargin;\n        //     finalValue = documentEditor.selection.sectionFormat.pageWidth - (currentIndentValue + currentMargin);\n        //     pixelValue = (((rulerZeroPoint + HelperMethods.convertPointToPixel(finalValue)) * documentEditor.zoomFactor) - 6) + 'px';\n        //     if (!isNullOrUndefined(indent)) {\n        //         indent.style.left = pixelValue;\n        //     }\n        // }\n        var rulerGeometry = this.getRulerGeometry(documentEditor);\n        if (this.position.paragraph.paragraphFormat.bidi || (this.position.paragraph.isInsideTable && this.position.paragraph.associatedCell.ownerTable.tableFormat.bidi)) {\n            var rulerMarginDivWidth = ((rulerGeometry.width / documentEditor.zoomFactor) - (HelperMethods.convertPointToPixel((this.position.paragraph.bodyWidget.sectionFormat.rightMargin) + (this.position.paragraph.bodyWidget.sectionFormat.leftMargin))));\n            rulerZeroPoint -= rulerMarginDivWidth;\n        }\n        var paraStart = !isNullOrUndefined(this.position.paragraph['absoluteXPosition']) ? parseFloat(this.position.paragraph['absoluteXPosition']['x'].toString()) : this.position.paragraph.x;\n        var paraWidth = !isNullOrUndefined(this.position.paragraph['absoluteXPosition']) ? parseFloat(this.position.paragraph['absoluteXPosition']['width'].toString()) : this.position.paragraph.width;\n        var finalValueTemp;\n        if (this.position.paragraph.paragraphFormat.bidi) {\n            rulerZeroPoint = HelperMethods.convertPointToPixel(1584 - documentEditor.selectionModule.sectionFormat.leftMargin - (documentEditor.selectionModule.sectionFormat.pageWidth - documentEditor.selectionModule.sectionFormat.leftMargin - documentEditor.selectionModule.sectionFormat.rightMargin));\n        }\n        var leftIndent = document.getElementById(documentEditor.element.id + '_leftIndent');\n        var rightIndent = document.getElementById(documentEditor.element.id + '_rightIndent');\n        if (this.position.paragraph.paragraphFormat.bidi) {\n            leftIndent.setAttribute('title', this.locale.getConstant('Right Indent'));\n            rightIndent.setAttribute('title', this.locale.getConstant('Left Indent'));\n            finalValueTemp = rulerZeroPoint + paraStart + paraWidth;\n        }\n        else {\n            leftIndent.setAttribute('title', this.locale.getConstant('Left Indent'));\n            rightIndent.setAttribute('title', this.locale.getConstant('Right Indent'));\n            finalValueTemp = rulerZeroPoint + paraStart;\n        }\n        var firstLineIndent = this.position.paragraph.paragraphFormat.firstLineIndent;\n        indent = document.getElementById(ownerId + '_leftIndent');\n        if (!isNullOrUndefined(indent)) {\n            if (documentEditor.layoutType === 'Pages') {\n                indent.style.left = ((finalValueTemp * documentEditor.zoomFactor) - 6) + 'px';\n            }\n            else if (documentEditor.layoutType === 'Continuous') {\n                if (this.position.paragraph.paragraphFormat.bidi) {\n                    rulerZeroPoint = (documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor) - 20 - documentEditor.viewer.clientArea.width;\n                    finalValueTemp = rulerZeroPoint + paraStart + paraWidth;\n                    indent.style.left = finalValueTemp + 'px';\n                }\n                else {\n                    rulerZeroPoint = (documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor) - 20;\n                    finalValueTemp = rulerZeroPoint + (paraStart * documentEditor.zoomFactor);\n                    indent.style.left = finalValueTemp + 'px';\n                }\n            }\n        }\n        indent = document.getElementById(ownerId + '_hangingIndent');\n        if (!isNullOrUndefined(indent)) {\n            if (documentEditor.layoutType === 'Pages') {\n                indent.style.left = ((finalValueTemp * documentEditor.zoomFactor) - 6) + 'px';\n            }\n            else if (documentEditor.layoutType === 'Continuous') {\n                if (this.position.paragraph.paragraphFormat.bidi) {\n                    rulerZeroPoint = (documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor) - 20 - documentEditor.viewer.clientArea.width;\n                    finalValueTemp = rulerZeroPoint + paraStart + paraWidth;\n                    indent.style.left = finalValueTemp + 'px';\n                }\n                else {\n                    rulerZeroPoint = (documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor) - 20;\n                    finalValueTemp = rulerZeroPoint + (paraStart * documentEditor.zoomFactor);\n                    indent.style.left = finalValueTemp + 'px';\n                }\n            }\n        }\n        indent = document.getElementById(ownerId + '_firstLineIndent');\n        if (documentEditor.layoutType === 'Pages') {\n            if (!isNullOrUndefined(indent)) {\n                if (this.position.paragraph.paragraphFormat.bidi) {\n                    indent.style.left = (((finalValueTemp - HelperMethods.convertPointToPixel(firstLineIndent)) * documentEditor.zoomFactor) - 6) + 'px';\n                }\n                else {\n                    indent.style.left = (((finalValueTemp + HelperMethods.convertPointToPixel(firstLineIndent)) * documentEditor.zoomFactor) - 6) + 'px';\n                }\n            }\n        }\n        else if (documentEditor.layoutType === 'Continuous') {\n            if (this.position.paragraph.paragraphFormat.bidi) {\n                rulerZeroPoint = (documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor) - 20 - documentEditor.viewer.clientArea.width;\n                finalValueTemp = rulerZeroPoint + paraStart + paraWidth - (HelperMethods.convertPointToPixel(firstLineIndent) * documentEditor.zoomFactor);\n            }\n            else {\n                rulerZeroPoint = (documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor) - 20;\n                finalValueTemp = rulerZeroPoint + ((paraStart + HelperMethods.convertPointToPixel(firstLineIndent)) * documentEditor.zoomFactor);\n            }\n            indent.style.left = finalValueTemp + 'px';\n        }\n        indent = document.getElementById(ownerId + '_rightIndent');\n        if (documentEditor.layoutType === 'Pages') {\n            if (this.position.paragraph.paragraphFormat.bidi) {\n                finalValueTemp = rulerZeroPoint + paraStart;\n            }\n            else {\n                finalValueTemp = rulerZeroPoint + paraStart + paraWidth;\n            }\n            if (!isNullOrUndefined(indent)) {\n                indent.style.left = ((finalValueTemp * documentEditor.zoomFactor) - 6) + 'px';\n            }\n        }\n        else if (documentEditor.layoutType === 'Continuous') {\n            if (this.position.paragraph.paragraphFormat.bidi) {\n                rulerZeroPoint = (documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor) - 20 - (documentEditor.viewer.clientArea.width * documentEditor.zoomFactor);\n                finalValueTemp = rulerZeroPoint + paraStart;\n                indent.style.left = finalValueTemp + 'px';\n            }\n            else {\n                rulerZeroPoint = (documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor) - 20;\n                finalValueTemp = rulerZeroPoint + ((paraStart + paraWidth) * documentEditor.zoomFactor);\n                indent.style.left = finalValueTemp + 'px';\n            }\n        }\n    };\n    RulerHelper.prototype.updateTabStopMarkers = function (documentEditor) {\n        if (isNullOrUndefined(documentEditor) || isNullOrUndefined(documentEditor.element) || isNullOrUndefined(documentEditor.element.id) || isNullOrUndefined(documentEditor.hRuler) || isNullOrUndefined(documentEditor.hRuler.zeroPosition)) {\n            return;\n        }\n        var locale = new L10n('documenteditor', documentEditor.defaultLocale);\n        locale.setLocale(documentEditor.locale);\n        var ownerId = documentEditor.element.id;\n        var element = document.getElementById(ownerId + '_markIndicator');\n        element.style.display = documentEditor.layoutType === 'Pages' ? 'block' : 'none';\n        var paragarph = this.position.paragraph;\n        var tabs = paragarph.paragraphFormat.tabs;\n        var zoomFactor = documentEditor.zoomFactor;\n        var rulerSize = this.getRulerSize(documentEditor);\n        var RenderedTabElement = HelperMethods.convertNodeListToArray(document.querySelectorAll('.e-de-ruler-tab'));\n        for (var i = 0; i < tabs.length; i++) {\n            var tabStop = tabs[parseInt(i.toString(), 10)];\n            var justification = tabStop.tabJustification;\n            // const position: number = tabStop.position;\n            var id = documentEditor.element.id + '_' + justification + 'Tab_' + i.toString();\n            var tabMarker = document.getElementById(id);\n            if (!isNullOrUndefined(tabMarker)) {\n                if (!isNullOrUndefined(RenderedTabElement) && RenderedTabElement.length > 0) {\n                    RenderedTabElement.splice(RenderedTabElement.indexOf(tabMarker), 1);\n                }\n                var value = this.position.paragraph.paragraphFormat.bidi ?\n                    (HelperMethods.convertPointToPixel(1584 - tabStop.position))\n                    : (HelperMethods.convertPointToPixel(1584 + tabStop.position));\n                if (justification === 'Center' || justification === 'Decimal') {\n                    tabMarker.style.left = ((value * zoomFactor) - 4) + 'px';\n                }\n                else if (justification === 'Right') {\n                    tabMarker.style.left = ((value * zoomFactor) - 5.5) + 'px';\n                }\n                else {\n                    tabMarker.style.left = ((value * zoomFactor) - 1.5) + 'px';\n                }\n            }\n            else {\n                if (justification !== \"List\") {\n                    this.renderTab(documentEditor, rulerSize, tabStop, justification, i, locale);\n                }\n            }\n        }\n        if (!isNullOrUndefined(RenderedTabElement)) {\n            for (var i = 0; i < RenderedTabElement.length; i++) {\n                var elementToRemove = RenderedTabElement[parseInt(i.toString(), 10)];\n                if (!isNullOrUndefined(elementToRemove)) {\n                    elementToRemove.parentNode.removeChild(elementToRemove);\n                }\n            }\n        }\n    };\n    RulerHelper.prototype.renderRulerMargins = function (documentEditor, isHorizontal, rulerContainer) {\n        var rulerSize = this.getRulerSize(documentEditor);\n        var rulerGeometry = this.getRulerGeometry(documentEditor);\n        var height = isHorizontal ? documentEditor.selectionModule.end.paragraph.bodyWidget.page.boundingRectangle.x\n            : (documentEditor.selectionModule.end.paragraph.bodyWidget.page.boundingRectangle.y + rulerSize.height);\n        // const margin: string = isHorizontal ? ('margin-left:' + height + 'px;') : ('margin-top:' + height + 'px;');\n        //const leftMarginValue = 2112 - (HelperMethods.convertPointToPixel(documentEditor.selection.end.paragraph.bodyWidget.sectionFormat.leftMargin));\n        var leftMarginValue = 2112 * documentEditor.zoomFactor;\n        var rulerMarginDiv;\n        var rulerMargin = isHorizontal ? ('margin-left:' + leftMarginValue + 'px;') : ('margin-top:' + leftMarginValue + 'px;');\n        var rulerHeight = (isHorizontal ? rulerSize.height : (rulerGeometry.height - (HelperMethods.convertPointToPixel(documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.topMargin + documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.bottomMargin) * documentEditor.zoomFactor)));\n        // const rulerHeight =  (isHorizontal ? rulerSize.height : rulerGeometry.height);\n        if (isHorizontal) {\n            for (var i = 1; i <= 13; i++) {\n                rulerMarginDiv = document.getElementById(documentEditor.element.id + '_hRuler_Margin' + i);\n                if (!rulerMarginDiv) {\n                    var rulerstyle = 'height:' + rulerHeight + 'px;overflow:hidden;width:' +\n                        (rulerGeometry.width - (HelperMethods.convertPointToPixel(documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.rightMargin + documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin) * documentEditor.zoomFactor)) + 'px;position:absolute;' + 'font-size:9px;text-align: left;z-index: -1;display: block' + rulerMargin;\n                    var rulerattributes = {\n                        'id': documentEditor.element.id + '_hRuler_Margin' + i,\n                        style: rulerstyle,\n                        class: 'e-de-ruler-margin'\n                    };\n                    rulerMarginDiv = this.createHtmlElement('div', rulerattributes);\n                }\n                rulerContainer.appendChild(rulerMarginDiv);\n            }\n        }\n        else {\n            if (!rulerMarginDiv) {\n                rulerMarginDiv = document.getElementById(documentEditor.element.id + '_vRuler_Margin');\n                var rulerstyle = 'height:' + rulerHeight + 'px;overflow:hidden;width:' +\n                    rulerSize.width + 'px;position:absolute;' + 'font-size:9px;text-align: left;z-index: -1;' + rulerMargin;\n                var rulerattributes = {\n                    'id': documentEditor.element.id + '_vRuler_Margin',\n                    style: rulerstyle,\n                    class: 'e-de-ruler-margin'\n                };\n                rulerMarginDiv = this.createHtmlElement('div', rulerattributes);\n            }\n            rulerContainer.appendChild(rulerMarginDiv);\n        }\n    };\n    RulerHelper.prototype.updateRulerMargins = function (documentEditor) {\n        var rulerGeometry = this.getRulerGeometry(documentEditor);\n        var leftMarginValue = (documentEditor.hRuler.zeroPosition) * documentEditor.zoomFactor;\n        this.updateHorizontalRulerMargin(documentEditor);\n        var verticalRulerMarginDiv = document.getElementById(documentEditor.element.id + '_vRuler_Margin');\n        var rulerMarginDivHeight = rulerGeometry.height - (HelperMethods.convertPointToPixel((documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.bottomMargin * documentEditor.zoomFactor) + (documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.topMargin * documentEditor.zoomFactor)));\n        verticalRulerMarginDiv.style.marginTop = leftMarginValue + \"px\";\n        verticalRulerMarginDiv.style.height = rulerMarginDivHeight + \"px\";\n    };\n    RulerHelper.prototype.updateHorizontalRulerMargin = function (documentEditor) {\n        var columns = documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.columns;\n        var leftMarginValue = (documentEditor.hRuler.zeroPosition) * documentEditor.zoomFactor;\n        var skipLoop = false;\n        var paraBidi = this.position.paragraph.paragraphFormat.bidi;\n        var tableBidi = false;\n        var currnLefttMargin = HelperMethods.convertPointToPixel(documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin - 72);\n        var currentRightMargin = HelperMethods.convertPointToPixel(documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.rightMargin - 72);\n        if (this.position.paragraph.isInsideTable) {\n            tableBidi = this.position.paragraph.associatedCell.ownerTable.tableFormat.bidi;\n        }\n        var rulerMarginDivWidth = (this.getRulerGeometry(documentEditor).width - (HelperMethods.convertPointToPixel((documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.rightMargin * documentEditor.zoomFactor) + (documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin * documentEditor.zoomFactor))));\n        if (paraBidi || tableBidi) {\n            leftMarginValue = (documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor) - rulerMarginDivWidth;\n        }\n        for (var i = 0; i < 13; i++) {\n            var horizontalRulerMarginDiv = document.getElementById(documentEditor.element.id + '_hRuler_Margin' + (i + 1));\n            if (horizontalRulerMarginDiv) {\n                if ((columns.length === 0 && !skipLoop) || (documentEditor.layoutType === \"Continuous\" && !skipLoop)) {\n                    if (paraBidi || tableBidi) {\n                        var startValue = (documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor) - rulerMarginDivWidth;\n                        horizontalRulerMarginDiv.style.marginLeft = startValue + \"px\";\n                    }\n                    else {\n                        horizontalRulerMarginDiv.style.marginLeft = leftMarginValue + \"px\";\n                    }\n                    horizontalRulerMarginDiv.style.display = 'block';\n                    if (documentEditor.layoutType === 'Continuous') {\n                        var paraWidth = !isNullOrUndefined(this.position.paragraph['absoluteXPosition']) ? parseFloat(this.position.paragraph['absoluteXPosition']['width'].toString()) : this.position.paragraph.width;\n                        horizontalRulerMarginDiv.style.width = (paraWidth * documentEditor.zoomFactor) + \"px\";\n                    }\n                    else {\n                        horizontalRulerMarginDiv.style.width = rulerMarginDivWidth + \"px\";\n                    }\n                    skipLoop = true;\n                }\n                else if ((columns.length >= i + 1) && documentEditor.layoutType === \"Pages\") {\n                    if (paraBidi || tableBidi) {\n                        horizontalRulerMarginDiv.style.marginLeft = leftMarginValue + 'px';\n                        leftMarginValue -= ((currnLefttMargin + currentRightMargin) / (columns.length)) * documentEditor.zoomFactor;\n                        leftMarginValue = leftMarginValue + (columns[parseInt(i.toString(), 10)].width + columns[parseInt(i.toString(), 10)].space) * documentEditor.zoomFactor;\n                    }\n                    else {\n                        horizontalRulerMarginDiv.style.marginLeft = leftMarginValue + 'px';\n                        leftMarginValue -= ((currnLefttMargin + currentRightMargin) / (columns.length)) * documentEditor.zoomFactor;\n                        leftMarginValue = leftMarginValue + (columns[parseInt(i.toString(), 10)].width + columns[parseInt(i.toString(), 10)].space) * documentEditor.zoomFactor;\n                    }\n                    horizontalRulerMarginDiv.style.display = 'block';\n                    horizontalRulerMarginDiv.style.width = (columns[parseInt(i.toString(), 10)].width - ((currnLefttMargin + currentRightMargin) / columns.length)) * documentEditor.zoomFactor + \"px\";\n                }\n                else {\n                    horizontalRulerMarginDiv.style.display = 'none';\n                }\n            }\n        }\n    };\n    RulerHelper.prototype.resizeVRulerMargins = function (isRulerTopMargin, currentTopMargin, currentScrollTop, currentBottomMargin, ruler, mousePosition, documentEditor) {\n        var rulerMarginDiv = document.getElementById(documentEditor.element.id + '_vRuler_Margin');\n        var rulerGeometry = this.getRulerGeometry(documentEditor);\n        if (isRulerTopMargin) {\n            rulerMarginDiv.style.height = (rulerGeometry.height - HelperMethods.convertPointToPixel((documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.bottomMargin * documentEditor.zoomFactor) + mousePosition)).toString() + \"px\";\n            if (currentTopMargin < mousePosition) {\n                ruler.scrollTop = currentScrollTop - HelperMethods.convertPointToPixel(mousePosition - currentTopMargin);\n            }\n            else {\n                ruler.scrollTop = currentScrollTop + HelperMethods.convertPointToPixel(currentTopMargin - mousePosition);\n            }\n        }\n        else {\n            var bottomMargin = HelperMethods.convertPixelToPoint(rulerGeometry.height) - mousePosition;\n            rulerMarginDiv.style.height = (rulerGeometry.height - HelperMethods.convertPointToPixel((documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.topMargin * documentEditor.zoomFactor) + (bottomMargin))).toString() + \"px\";\n            if (currentBottomMargin < mousePosition) {\n                //  ruler.scrollLeft = currentScrollLeft - HelperMethods.convertPointToPixel(mousePosition - currentRightMargin);\n            }\n            else {\n                //  ruler.scrollLeft = currentScrollLeft + HelperMethods.convertPointToPixel(currentRightMargin - mousePosition);\n            }\n        }\n    };\n    RulerHelper.prototype.resizeRulerMargins = function (isRulerLeftMargin, currentLeftMargin, currentScrollLeft, currentRightMargin, ruler, mousePosition, isHorizontal, documentEditor) {\n        var rulerMarginDiv = document.getElementById(documentEditor.element.id + (isHorizontal ? '_hRuler_Margin1' : '_vRuler_Margin'));\n        var rulerGeometry = this.getRulerGeometry(documentEditor);\n        if (!isNullOrUndefined(isRulerLeftMargin) && isRulerLeftMargin) {\n            rulerMarginDiv.style.width = (rulerGeometry.width - HelperMethods.convertPointToPixel((documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.rightMargin * documentEditor.zoomFactor) + mousePosition)).toString() + \"px\";\n            if (currentLeftMargin < mousePosition) {\n                ruler.scrollLeft = currentScrollLeft - HelperMethods.convertPointToPixel(mousePosition - currentLeftMargin);\n            }\n            else {\n                ruler.scrollLeft = currentScrollLeft + HelperMethods.convertPointToPixel(currentLeftMargin - mousePosition);\n            }\n        }\n        else {\n            var rightMargin = HelperMethods.convertPixelToPoint(rulerGeometry.width) - mousePosition;\n            rulerMarginDiv.style.width = (rulerGeometry.width - HelperMethods.convertPointToPixel((documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin * documentEditor.zoomFactor) + (rightMargin))).toString() + \"px\";\n            if (currentRightMargin < mousePosition) {\n                //  ruler.scrollLeft = currentScrollLeft - HelperMethods.convertPointToPixel(mousePosition - currentRightMargin);\n            }\n            else {\n                //  ruler.scrollLeft = currentScrollLeft + HelperMethods.convertPointToPixel(currentRightMargin - mousePosition);\n            }\n        }\n    };\n    RulerHelper.prototype.getRulerOrigin = function () {\n        var range = 1584;\n        var pixelValue = HelperMethods.convertPointToPixel(1584);\n        //console.log('PixelValue: ', pixelValue);\n        //console.log('PointsValue: ', range);\n    };\n    RulerHelper.prototype.renderIndents = function (documentEditor, isHorizontal, rulerSize, rulerGeometry, locale) {\n        var _this = this;\n        var hRuler = document.getElementById(documentEditor.element.id + '_hRuler');\n        var firstLineIndent = document.getElementById(documentEditor.element.id + '_firstLineIndent');\n        if (!firstLineIndent) {\n            var margin = ('left:' + (HelperMethods.convertPointToPixel(documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin) - 6) * documentEditor.zoomFactor + 'px;');\n            var style = 'height:' + ((rulerSize.height - 3) / 2) + 'px;overflow:hidden;width:12px;position:absolute;font-size:11px;text-align: left;z-index: 5;' + margin;\n            var attributes = {\n                'id': documentEditor.element.id + '_firstLineIndent',\n                style: style,\n                'data-name': 'FirstLineIndent',\n                class: 'e-de-ruler-indent'\n            };\n            firstLineIndent = this.createHtmlElement('div', attributes);\n            firstLineIndent.setAttribute('title', locale.getConstant('First Line Indent'));\n            var svg = void 0;\n            // Create an SVG element\n            var attr = {\n                'id': documentEditor.element.id + '_firstLineIndent_svg',\n                width: rulerSize.width + 'px',\n                height: ((rulerSize.height - 3) / 2) + 'px',\n                style: 'position:inherit;left:0px'\n            };\n            svg = this.createSvgElement('svg', attr);\n            svg.setAttribute(\"fill\", \"none\");\n            var pathattr = {\n                style: 'position:inherit;left:0px'\n            };\n            // Create a path element inside the SVG\n            var pathElement = this.createSvgElement('path', pathattr);\n            pathElement.setAttribute(\"class\", \"e-de-ruler-indent-svg\");\n            pathElement.setAttribute(\"d\", \"M 0.5 0.5 H 11.5 V 2.7128 L 6 5.4211 L 0.5 2.7128 V 0.5 Z\");\n            pathElement.setAttribute(\"fill\", \"white\");\n            pathElement.setAttribute(\"stroke\", \"#A1A1A1\");\n            // Append the path element to the SVG element\n            svg.appendChild(pathElement);\n            firstLineIndent.appendChild(svg);\n            hRuler.append(firstLineIndent);\n            firstLineIndent.addEventListener(\"dblclick\", function (event) {\n                documentEditor.showDialog('Paragraph');\n                event.stopPropagation();\n            });\n            //Draggable for first line Indent.\n            var isDragging_1 = false;\n            var firstLineOffset_1;\n            var initialValue_1 = HelperMethods.getNumberFromString(firstLineIndent.style.left); // for mouse up event\n            var initialValue2 = HelperMethods.getNumberFromString(firstLineIndent.style.left); // for mouse move event\n            firstLineIndent.addEventListener(\"mouseenter\", function (e) {\n                documentEditor.isOnIndent = true;\n            });\n            firstLineIndent.addEventListener(\"mouseleave\", function (e) {\n                documentEditor.isOnIndent = false;\n            });\n            firstLineIndent.addEventListener(\"mousedown\", function (e) {\n                isDragging_1 = true;\n                firstLineOffset_1 = e.clientX - firstLineIndent.getBoundingClientRect().left;\n                initialValue_1 = HelperMethods.getNumberFromString(firstLineIndent.style.left);\n                var rulerZeroPoint = HelperMethods.convertPointToPixel(1584 - documentEditor.selectionModule.sectionFormat.leftMargin) * documentEditor.zoomFactor;\n                if (documentEditor.selectionModule.paragraphFormat.bidi) {\n                    rulerZeroPoint = HelperMethods.convertPointToPixel(1584 - documentEditor.selectionModule.sectionFormat.leftMargin - (documentEditor.selectionModule.sectionFormat.pageWidth - documentEditor.selectionModule.sectionFormat.leftMargin - documentEditor.selectionModule.sectionFormat.rightMargin)) * documentEditor.zoomFactor;\n                }\n                if (documentEditor.layoutType === 'Continuous') {\n                    rulerZeroPoint = (documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor) - 20;\n                    if (documentEditor.selectionModule.paragraphFormat.bidi) {\n                        rulerZeroPoint = (documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor) - 20 - (documentEditor.viewer.clientArea.width * documentEditor.zoomFactor);\n                    }\n                }\n                var value = rulerZeroPoint + e.clientX - firstLineOffset_1 - hRuler.getBoundingClientRect().left;\n                var startValue = documentEditor.documentHelper.currentPage.boundingRectangle.x;\n                startValue = documentEditor.layoutType === 'Continuous' ? 0 : startValue;\n                var indicatorLineValue = startValue + (value - rulerZeroPoint) + 6;\n                var lineSvg = document.getElementById(documentEditor.element.id + '_hRuler_indicator_svg');\n                lineSvg.style.left = indicatorLineValue + 'px';\n                lineSvg.style.display = 'block';\n                e.stopPropagation();\n            });\n            document.addEventListener(\"mousemove\", function (e) {\n                if (isDragging_1) {\n                    var rulerZeroPoint = void 0;\n                    var maxValue = void 0;\n                    var minValue = void 0;\n                    var rightIndent_1 = document.getElementById(documentEditor.element.id + '_rightIndent');\n                    var rightIndentValue = HelperMethods.getNumberFromString(rightIndent_1.style.left);\n                    if (documentEditor.layoutType === 'Pages') {\n                        if (documentEditor.selectionModule.paragraphFormat.bidi) {\n                            rulerZeroPoint = HelperMethods.convertPointToPixel(1584 - documentEditor.selectionModule.sectionFormat.leftMargin - (documentEditor.selectionModule.sectionFormat.pageWidth - documentEditor.selectionModule.sectionFormat.leftMargin - documentEditor.selectionModule.sectionFormat.rightMargin)) * documentEditor.zoomFactor;\n                            maxValue = rulerZeroPoint - 6 + (HelperMethods.convertPointToPixel(documentEditor.selectionModule.sectionFormat.pageWidth) * documentEditor.zoomFactor);\n                            minValue = rightIndentValue + HelperMethods.convertPointToPixel(42) * documentEditor.zoomFactor;\n                        }\n                        else {\n                            rulerZeroPoint = HelperMethods.convertPointToPixel(1584 - documentEditor.selectionModule.sectionFormat.leftMargin) * documentEditor.zoomFactor;\n                            minValue = rulerZeroPoint - 6;\n                            maxValue = rightIndentValue - HelperMethods.convertPointToPixel(42) * documentEditor.zoomFactor;\n                        }\n                    }\n                    else if (documentEditor.layoutType === 'Continuous') {\n                        if (_this.position.paragraph.paragraphFormat.bidi) {\n                            rulerZeroPoint = (documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor) - 20 - (documentEditor.viewer.clientArea.width * documentEditor.zoomFactor);\n                            maxValue = (documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor) - 20 + 40 - 6;\n                            minValue = rightIndentValue + (HelperMethods.convertPointToPixel(42) * documentEditor.zoomFactor);\n                        }\n                        else {\n                            rulerZeroPoint = (documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor) - 20;\n                            minValue = rulerZeroPoint - 6;\n                            maxValue = rightIndentValue - (HelperMethods.convertPointToPixel(42) * documentEditor.zoomFactor);\n                        }\n                    }\n                    var value = rulerZeroPoint + e.clientX - firstLineOffset_1 - hRuler.getBoundingClientRect().left;\n                    if (value < minValue) {\n                        value = minValue;\n                    }\n                    else if (value > maxValue) {\n                        value = maxValue;\n                    }\n                    firstLineIndent.style.left = value + \"px\";\n                    var startValue = documentEditor.documentHelper.currentPage.boundingRectangle.x;\n                    startValue = documentEditor.layoutType === 'Continuous' ? 0 : startValue;\n                    var indicatorLineValue = startValue + (value - rulerZeroPoint) + 6;\n                    var lineSvg = document.getElementById(documentEditor.element.id + '_hRuler_indicator_svg');\n                    lineSvg.style.left = indicatorLineValue + 'px';\n                }\n            });\n            document.addEventListener(\"mouseup\", function () {\n                if (isDragging_1) {\n                    isDragging_1 = false;\n                    var finalValue = HelperMethods.getNumberFromString(firstLineIndent.style.left);\n                    if (parseInt(firstLineIndent.style.left.replace('px', '')) < 0) {\n                        finalValue *= -1;\n                    }\n                    if (documentEditor.selectionModule.paragraphFormat.bidi) {\n                        documentEditor.editorModule.applyRulerMarkerValues('firstLineIndent', finalValue, initialValue_1);\n                    }\n                    else {\n                        documentEditor.editorModule.applyRulerMarkerValues('firstLineIndent', initialValue_1, finalValue);\n                    }\n                    initialValue_1 = finalValue;\n                    var lineSvg = document.getElementById(documentEditor.element.id + '_hRuler_indicator_svg');\n                    lineSvg.style.display = 'none';\n                }\n            });\n        }\n        //Rendering HangingIndent\n        var hangingIndent = document.getElementById(documentEditor.element.id + '_hangingIndent');\n        if (!hangingIndent) {\n            var margin = ('left:' + (HelperMethods.convertPointToPixel(documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin) - 6) + 'px;');\n            var style = 'height:' + (rulerSize.height / 2) + 'px;top:' + (((rulerSize.height - 3) / 2) + 1) + 'px;overflow:hidden;width:12px;position:absolute;font-size:11px;text-align: left;z-index: 5;' + margin;\n            var attributes = {\n                'id': documentEditor.element.id + '_hangingIndent',\n                style: style,\n                'data-name': 'HangingIndent',\n                class: 'e-de-ruler-indent'\n            };\n            hangingIndent = this.createHtmlElement('div', attributes);\n            hangingIndent.setAttribute('title', locale.getConstant('Hanging Indent'));\n            var hangingIndentSvg = void 0;\n            // Create an SVG element\n            var attr = {\n                'id': documentEditor.element.id + '_hangingIndent_svg',\n                width: rulerSize.width + 'px',\n                height: ((rulerSize.height - 3) / 2) + 'px',\n                style: 'position:inherit;left:0px'\n            };\n            hangingIndentSvg = this.createSvgElement('svg', attr);\n            hangingIndentSvg.setAttribute(\"fill\", \"none\");\n            var pathattr = {\n                style: 'position:inherit;left:0px'\n            };\n            // Create a path element inside the SVG\n            var pathElement = this.createSvgElement('path', pathattr);\n            pathElement.setAttribute(\"class\", \"e-de-ruler-indent-svg\");\n            pathElement.setAttribute(\"d\", \"M 0.5 5.3211 H 11.5 V 3.1083 L 6 0.4 L 0.5 3.1083 V 5.3211 Z\");\n            pathElement.setAttribute(\"fill\", \"white\");\n            pathElement.setAttribute(\"stroke\", \"#A1A1A1\");\n            // Append the path element to the SVG element\n            hangingIndentSvg.appendChild(pathElement);\n            hangingIndent.appendChild(hangingIndentSvg);\n            hRuler.append(hangingIndent);\n            hangingIndent.addEventListener(\"dblclick\", function (event) {\n                documentEditor.showDialog('Paragraph');\n                event.stopPropagation();\n            });\n            //Draggable for hanging line Indent.\n            var isDragging_2 = false;\n            var hangingLineOffset_1;\n            var initialValue_2 = HelperMethods.getNumberFromString(hangingIndent.style.left); // for mouse up event\n            var initialValue2 = HelperMethods.getNumberFromString(hangingIndent.style.left); // for mouse move event\n            var minLimit_1;\n            var maxLimit_1;\n            var leftIndent_1;\n            hangingIndent.addEventListener(\"mouseenter\", function (e) {\n                documentEditor.isOnIndent = true;\n            });\n            hangingIndent.addEventListener(\"mouseleave\", function (e) {\n                documentEditor.isOnIndent = false;\n            });\n            hangingIndent.addEventListener(\"mousedown\", function (e) {\n                isDragging_2 = true;\n                hangingLineOffset_1 = e.clientX - hangingIndent.getBoundingClientRect().left;\n                initialValue_2 = HelperMethods.getNumberFromString(hangingIndent.style.left);\n                var rightIndent = document.getElementById(documentEditor.element.id + '_rightIndent');\n                var rightPosition = HelperMethods.getNumberFromString(rightIndent.style.left);\n                var rulerZeroPoint;\n                if (documentEditor.layoutType === 'Pages') {\n                    if (documentEditor.selectionModule.paragraphFormat.bidi) {\n                        rulerZeroPoint = HelperMethods.convertPointToPixel(1584 - documentEditor.selectionModule.sectionFormat.leftMargin - (documentEditor.selectionModule.sectionFormat.pageWidth - documentEditor.selectionModule.sectionFormat.leftMargin - documentEditor.selectionModule.sectionFormat.rightMargin)) * documentEditor.zoomFactor;\n                        minLimit_1 = rightPosition + (HelperMethods.convertPointToPixel(42) * documentEditor.zoomFactor);\n                        maxLimit_1 = rulerZeroPoint - 6 + (HelperMethods.convertPointToPixel(documentEditor.selectionModule.sectionFormat.pageWidth) * documentEditor.zoomFactor);\n                    }\n                    else {\n                        rulerZeroPoint = HelperMethods.convertPointToPixel(1584 - documentEditor.selectionModule.sectionFormat.leftMargin) * documentEditor.zoomFactor;\n                        minLimit_1 = rulerZeroPoint - 6;\n                        maxLimit_1 = (rightPosition - HelperMethods.convertPointToPixel(42) * documentEditor.zoomFactor);\n                    }\n                }\n                else if (documentEditor.layoutType === 'Continuous') {\n                    if (_this.position.paragraph.paragraphFormat.bidi) {\n                        rulerZeroPoint = (documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor) - 20 - (documentEditor.viewer.clientArea.width * documentEditor.zoomFactor);\n                        maxLimit_1 = (documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor) - 20 + 40 - 6;\n                        minLimit_1 = rightPosition + (HelperMethods.convertPointToPixel(42) * documentEditor.zoomFactor);\n                    }\n                    else {\n                        rulerZeroPoint = (documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor) - 20;\n                        minLimit_1 = rulerZeroPoint - 6;\n                        maxLimit_1 = (rightPosition - HelperMethods.convertPointToPixel(42) * documentEditor.zoomFactor);\n                    }\n                }\n                leftIndent_1 = document.getElementById(documentEditor.element.id + '_leftIndent');\n                var value = rulerZeroPoint + e.clientX - hangingLineOffset_1 - hRuler.getBoundingClientRect().left;\n                var startValue = documentEditor.documentHelper.currentPage.boundingRectangle.x;\n                startValue = documentEditor.layoutType === 'Continuous' ? 0 : startValue;\n                var indicatorLineValue = startValue + (value - rulerZeroPoint) + 6;\n                var lineSvg = document.getElementById(documentEditor.element.id + '_hRuler_indicator_svg');\n                lineSvg.style.left = indicatorLineValue + 'px';\n                lineSvg.style.display = 'block';\n                e.stopPropagation();\n            });\n            document.addEventListener(\"mousemove\", function (e) {\n                if (isDragging_2) {\n                    var rulerZeroPoint = void 0;\n                    if (documentEditor.layoutType === 'Pages') {\n                        if (documentEditor.selectionModule.paragraphFormat.bidi) {\n                            rulerZeroPoint = HelperMethods.convertPointToPixel(1584 - documentEditor.selectionModule.sectionFormat.leftMargin - (documentEditor.selectionModule.sectionFormat.pageWidth - documentEditor.selectionModule.sectionFormat.leftMargin - documentEditor.selectionModule.sectionFormat.rightMargin)) * documentEditor.zoomFactor;\n                        }\n                        else {\n                            rulerZeroPoint = HelperMethods.convertPointToPixel(1584 - documentEditor.selectionModule.sectionFormat.leftMargin) * documentEditor.zoomFactor;\n                        }\n                    }\n                    else if (documentEditor.layoutType === 'Continuous') {\n                        if (_this.position.paragraph.paragraphFormat.bidi) {\n                            rulerZeroPoint = (documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor) - 20 - (documentEditor.viewer.clientArea.width * documentEditor.zoomFactor);\n                        }\n                        else {\n                            rulerZeroPoint = (documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor) - 20;\n                        }\n                    }\n                    var value = rulerZeroPoint + e.clientX - hangingLineOffset_1 - hRuler.getBoundingClientRect().left;\n                    if ((value) > maxLimit_1) {\n                        value = maxLimit_1;\n                    }\n                    else if (value < minLimit_1) {\n                        value = minLimit_1;\n                    }\n                    leftIndent_1.style.left = value + \"px\";\n                    hangingIndent.style.left = value + \"px\";\n                    var startValue = documentEditor.documentHelper.currentPage.boundingRectangle.x;\n                    startValue = documentEditor.layoutType === 'Continuous' ? 0 : startValue;\n                    var indicatorLineValue = startValue + (value - rulerZeroPoint) + 6;\n                    var lineSvg = document.getElementById(documentEditor.element.id + '_hRuler_indicator_svg');\n                    lineSvg.style.left = indicatorLineValue + 'px';\n                }\n            });\n            document.addEventListener(\"mouseup\", function () {\n                if (isDragging_2) {\n                    isDragging_2 = false;\n                    var finalValue = HelperMethods.getNumberFromString(hangingIndent.style.left);\n                    if (parseInt(hangingIndent.style.left.replace('px', '')) < 0) {\n                        finalValue *= -1;\n                    }\n                    if (documentEditor.selectionModule.paragraphFormat.bidi) {\n                        documentEditor.editorModule.applyRulerMarkerValues('hangingIndent', finalValue, initialValue_2);\n                    }\n                    else {\n                        documentEditor.editorModule.applyRulerMarkerValues('hangingIndent', initialValue_2, finalValue);\n                    }\n                    initialValue_2 = finalValue;\n                    var lineSvg = document.getElementById(documentEditor.element.id + '_hRuler_indicator_svg');\n                    lineSvg.style.display = 'none';\n                }\n            });\n        }\n        //Rendering LeftIndent\n        var leftIndent = document.getElementById(documentEditor.element.id + '_leftIndent');\n        if (!leftIndent) {\n            var margin = ('left:' + (HelperMethods.convertPointToPixel(documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin) - 6) + 'px;');\n            var style = 'height:4px;top:11px;overflow:hidden;width:12px;position:absolute;font-size:11px;text-align: left;z-index: 5;' + margin;\n            var attributes = {\n                'id': documentEditor.element.id + '_leftIndent',\n                style: style,\n                class: 'e-de-ruler-indent'\n            };\n            leftIndent = this.createHtmlElement('div', attributes);\n            leftIndent.setAttribute('title', locale.getConstant('Left Indent'));\n            var leftIndentSvg = void 0;\n            // Create an SVG element\n            var attr = {\n                'id': documentEditor.element.id + '_leftIndent_svg',\n                width: rulerSize.width + 'px',\n                height: '4px',\n                style: 'position:inherit;left:0px'\n            };\n            leftIndentSvg = this.createSvgElement('svg', attr);\n            leftIndentSvg.setAttribute(\"fill\", \"none\");\n            var pathattr = {\n                style: 'position:inherit;left:0px'\n            };\n            // Create a path element inside the SVG\n            var pathElement = this.createSvgElement('path', pathattr);\n            pathElement.setAttribute(\"class\", \"e-de-ruler-indent-svg\");\n            pathElement.setAttribute(\"d\", \"M 0.5 3.5 H 11.5 V 0.5 H 0.5 V 3.5 Z\");\n            pathElement.setAttribute(\"fill\", \"white\");\n            pathElement.setAttribute(\"stroke\", \"#A1A1A1\");\n            // Append the path element to the SVG element\n            leftIndentSvg.appendChild(pathElement);\n            leftIndent.appendChild(leftIndentSvg);\n            hRuler.append(leftIndent);\n            leftIndent.addEventListener(\"dblclick\", function (event) {\n                documentEditor.showDialog('Paragraph');\n                event.stopPropagation();\n            });\n            //Draggable for left line Indent.\n            var isDragging_3 = false;\n            var leftLineOffset_1;\n            var initialValue_3 = HelperMethods.getNumberFromString(leftIndent.style.left); // for mouse down event\n            var initialValue2 = HelperMethods.getNumberFromString(leftIndent.style.left); // for mouse move event\n            var firstIndentInitialValue_1;\n            var diff_1;\n            var minLimit_2;\n            var maxLimit_2;\n            var isHangingIndent_1;\n            leftIndent.addEventListener(\"mouseenter\", function (e) {\n                documentEditor.isOnIndent = true;\n            });\n            leftIndent.addEventListener(\"mouseleave\", function (e) {\n                documentEditor.isOnIndent = false;\n            });\n            leftIndent.addEventListener(\"mousedown\", function (e) {\n                var rulerZeroPoint;\n                isDragging_3 = true;\n                leftLineOffset_1 = e.clientX - leftIndent.getBoundingClientRect().left;\n                initialValue_3 = HelperMethods.getNumberFromString(leftIndent.style.left);\n                firstIndentInitialValue_1 = HelperMethods.getNumberFromString(firstLineIndent.style.left);\n                diff_1 = firstIndentInitialValue_1 - initialValue_3;\n                firstLineIndent = document.getElementById(documentEditor.element.id + '_firstLineIndent');\n                var rightIndent = document.getElementById(documentEditor.element.id + '_rightIndent');\n                var rightPosition = HelperMethods.getNumberFromString(rightIndent.style.left);\n                if (documentEditor.layoutType === 'Pages') {\n                    if (documentEditor.selectionModule.paragraphFormat.bidi) {\n                        rulerZeroPoint = HelperMethods.convertPointToPixel(1584 - documentEditor.selectionModule.sectionFormat.leftMargin - (documentEditor.selectionModule.sectionFormat.pageWidth - documentEditor.selectionModule.sectionFormat.leftMargin - documentEditor.selectionModule.sectionFormat.rightMargin)) * documentEditor.zoomFactor;\n                        minLimit_2 = (rightPosition + HelperMethods.convertPointToPixel(42) * documentEditor.zoomFactor);\n                        maxLimit_2 = rulerZeroPoint - 6 + (HelperMethods.convertPointToPixel(documentEditor.selectionModule.sectionFormat.pageWidth) * documentEditor.zoomFactor);\n                        isHangingIndent_1 = (HelperMethods.getNumberFromString(hangingIndent.style.left) - rightPosition) <= (HelperMethods.getNumberFromString(firstLineIndent.style.left) - rightPosition);\n                    }\n                    else {\n                        rulerZeroPoint = HelperMethods.convertPointToPixel(1584 - documentEditor.selectionModule.sectionFormat.leftMargin) * documentEditor.zoomFactor;\n                        minLimit_2 = rulerZeroPoint - 6;\n                        maxLimit_2 = (rightPosition - HelperMethods.convertPointToPixel(42) * documentEditor.zoomFactor);\n                        isHangingIndent_1 = (rightPosition - HelperMethods.getNumberFromString(hangingIndent.style.left)) <= (rightPosition - HelperMethods.getNumberFromString(firstLineIndent.style.left));\n                    }\n                }\n                else if (documentEditor.layoutType === 'Continuous') {\n                    if (_this.position.paragraph.paragraphFormat.bidi) {\n                        rulerZeroPoint = (documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor) - 20 - (documentEditor.viewer.clientArea.width * documentEditor.zoomFactor);\n                        maxLimit_2 = (documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor) - 20 + 40 - 6;\n                        minLimit_2 = rightPosition + (HelperMethods.convertPointToPixel(42) * documentEditor.zoomFactor);\n                        isHangingIndent_1 = (HelperMethods.getNumberFromString(hangingIndent.style.left) - rightPosition) <= (HelperMethods.getNumberFromString(firstLineIndent.style.left) - rightPosition);\n                    }\n                    else {\n                        rulerZeroPoint = (documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor) - 20;\n                        minLimit_2 = rulerZeroPoint - 6;\n                        maxLimit_2 = (rightPosition - HelperMethods.convertPointToPixel(42) * documentEditor.zoomFactor);\n                        isHangingIndent_1 = (rightPosition - HelperMethods.getNumberFromString(hangingIndent.style.left)) <= (rightPosition - HelperMethods.getNumberFromString(firstLineIndent.style.left));\n                    }\n                }\n                var value = rulerZeroPoint + e.clientX - leftLineOffset_1 - hRuler.getBoundingClientRect().left;\n                var startValue = documentEditor.documentHelper.currentPage.boundingRectangle.x;\n                startValue = documentEditor.layoutType === 'Continuous' ? 0 : startValue;\n                var indicatorLineValue = startValue + (value - rulerZeroPoint) + 6;\n                var lineSvg = document.getElementById(documentEditor.element.id + '_hRuler_indicator_svg');\n                lineSvg.style.left = indicatorLineValue + 'px';\n                lineSvg.style.display = 'block';\n                e.stopPropagation();\n            });\n            document.addEventListener(\"mousemove\", function (e) {\n                if (isDragging_3) {\n                    var rulerZeroPoint = void 0;\n                    var value = void 0;\n                    if (documentEditor.selectionModule.paragraphFormat.bidi) {\n                        if (documentEditor.layoutType === 'Pages') {\n                            rulerZeroPoint = HelperMethods.convertPointToPixel(1584 - documentEditor.selectionModule.sectionFormat.leftMargin - (documentEditor.selectionModule.sectionFormat.pageWidth - documentEditor.selectionModule.sectionFormat.leftMargin - documentEditor.selectionModule.sectionFormat.rightMargin)) * documentEditor.zoomFactor;\n                        }\n                        else if (documentEditor.layoutType === 'Continuous') {\n                            rulerZeroPoint = (documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor) - 20 - (documentEditor.viewer.clientArea.width * documentEditor.zoomFactor);\n                        }\n                        value = rulerZeroPoint + e.clientX - leftLineOffset_1 - hRuler.getBoundingClientRect().left;\n                        if (isHangingIndent_1) {\n                            if ((value + diff_1) > maxLimit_2) {\n                                value = maxLimit_2 - diff_1;\n                            }\n                        }\n                        else {\n                            if ((value) > maxLimit_2) {\n                                value = maxLimit_2;\n                            }\n                        }\n                        if (isHangingIndent_1) {\n                            if (value < minLimit_2) {\n                                value = minLimit_2;\n                            }\n                        }\n                        else {\n                            if ((value + diff_1) < minLimit_2) {\n                                value = minLimit_2 - diff_1;\n                            }\n                        }\n                    }\n                    else {\n                        if (documentEditor.layoutType === 'Pages') {\n                            rulerZeroPoint = HelperMethods.convertPointToPixel(1584 - documentEditor.selectionModule.sectionFormat.leftMargin) * documentEditor.zoomFactor;\n                        }\n                        else if (documentEditor.layoutType === 'Continuous') {\n                            rulerZeroPoint = (documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor) - 20;\n                        }\n                        value = rulerZeroPoint + e.clientX - leftLineOffset_1 - hRuler.getBoundingClientRect().left;\n                        if (isHangingIndent_1) {\n                            if ((value) > maxLimit_2) {\n                                value = maxLimit_2;\n                            }\n                        }\n                        else {\n                            if ((value + diff_1) > maxLimit_2) {\n                                value = maxLimit_2 - diff_1;\n                            }\n                        }\n                        if (isHangingIndent_1) {\n                            if ((value + diff_1) < minLimit_2) {\n                                value = minLimit_2 - diff_1;\n                            }\n                        }\n                        else {\n                            if (value < minLimit_2) {\n                                value = minLimit_2;\n                            }\n                        }\n                    }\n                    hangingIndent.style.left = value + \"px\";\n                    leftIndent.style.left = value + \"px\";\n                    firstLineIndent.style.left = (firstIndentInitialValue_1 + (value - initialValue_3)) + \"px\";\n                    var startValue = documentEditor.documentHelper.currentPage.boundingRectangle.x;\n                    startValue = documentEditor.layoutType === 'Continuous' ? 0 : startValue;\n                    var indicatorLineValue = startValue + (value - rulerZeroPoint) + 6;\n                    var lineSvg = document.getElementById(documentEditor.element.id + '_hRuler_indicator_svg');\n                    lineSvg.style.left = indicatorLineValue + 'px';\n                }\n            });\n            document.addEventListener(\"mouseup\", function () {\n                if (isDragging_3) {\n                    isDragging_3 = false;\n                    var finalValue = HelperMethods.getNumberFromString(leftIndent.style.left);\n                    if (parseInt(leftIndent.style.left.replace('px', '')) < 0) {\n                        finalValue *= -1;\n                    }\n                    if (documentEditor.selectionModule.paragraphFormat.bidi) {\n                        documentEditor.editorModule.applyRulerMarkerValues('leftIndent', finalValue, initialValue_3);\n                    }\n                    else {\n                        documentEditor.editorModule.applyRulerMarkerValues('leftIndent', initialValue_3, finalValue);\n                    }\n                    initialValue_3 = finalValue;\n                    var lineSvg = document.getElementById(documentEditor.element.id + '_hRuler_indicator_svg');\n                    lineSvg.style.display = 'none';\n                }\n            });\n        }\n        //Rendering RightIndent\n        var rightIndent = document.getElementById(documentEditor.element.id + '_rightIndent');\n        if (!rightIndent) {\n            var margin = ('left:' + (documentEditor.selectionModule.end.paragraph.bodyWidget.page.boundingRectangle.width - HelperMethods.convertPointToPixel(documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.rightMargin) - 6) + 'px;');\n            var style = 'height:7px;top:8px;overflow:hidden;width:12px;position:absolute;font-size:11px;text-align: left;z-index: 4;' + margin;\n            var attributes = {\n                'id': documentEditor.element.id + '_rightIndent',\n                style: style,\n                class: 'e-de-ruler-indent'\n            };\n            rightIndent = this.createHtmlElement('div', attributes);\n            rightIndent.setAttribute('title', locale.getConstant('Right Indent'));\n            var rightIndentSvg = void 0;\n            // Create an SVG element\n            var attr = {\n                'id': documentEditor.element.id + '_rightIndent_svg',\n                width: rulerSize.width + 'px',\n                height: '7px',\n                style: 'position:inherit;left:0px'\n            };\n            rightIndentSvg = this.createSvgElement('svg', attr);\n            rightIndentSvg.setAttribute(\"fill\", \"none\");\n            var pathattr = {\n                style: 'position:inherit;left:0px'\n            };\n            // Create a path element inside the SVG\n            var pathElement = this.createSvgElement('path', pathattr);\n            pathElement.setAttribute(\"class\", \"e-de-ruler-indent-svg\");\n            pathElement.setAttribute(\"d\", \"M 0.5 6.5 H 11.5 V 4.2872 L 6 1.5789 L 0.5 4.2872 V 6.5 Z\");\n            pathElement.setAttribute(\"fill\", \"white\");\n            pathElement.setAttribute(\"stroke\", \"#A1A1A1\");\n            // Append the path element to the SVG element\n            rightIndentSvg.appendChild(pathElement);\n            rightIndent.appendChild(rightIndentSvg);\n            hRuler.append(rightIndent);\n            rightIndent.addEventListener(\"dblclick\", function (event) {\n                documentEditor.showDialog('Paragraph');\n                event.stopPropagation();\n            });\n            //Draggable for left line Indent.\n            var isDragging_4 = false;\n            var rightLineOffset_1;\n            var initialValue_4 = HelperMethods.getNumberFromString(rightIndent.style.left); // for mouse down event\n            var initialValue2 = HelperMethods.getNumberFromString(rightIndent.style.left); // for mouse move event\n            rightIndent.addEventListener(\"mouseenter\", function (e) {\n                documentEditor.isOnIndent = true;\n            });\n            rightIndent.addEventListener(\"mouseleave\", function (e) {\n                documentEditor.isOnIndent = false;\n            });\n            rightIndent.addEventListener(\"mousedown\", function (e) {\n                isDragging_4 = true;\n                rightLineOffset_1 = e.clientX - rightIndent.getBoundingClientRect().left;\n                initialValue_4 = HelperMethods.getNumberFromString(rightIndent.style.left);\n                var rulerZeroPoint = HelperMethods.convertPointToPixel(1584 - documentEditor.selectionModule.sectionFormat.leftMargin) * documentEditor.zoomFactor;\n                if (documentEditor.selectionModule.paragraphFormat.bidi) {\n                    rulerZeroPoint = HelperMethods.convertPointToPixel(1584 - documentEditor.selectionModule.sectionFormat.leftMargin - (documentEditor.selectionModule.sectionFormat.pageWidth - documentEditor.selectionModule.sectionFormat.leftMargin - documentEditor.selectionModule.sectionFormat.rightMargin)) * documentEditor.zoomFactor;\n                }\n                if (documentEditor.layoutType === 'Continuous') {\n                    rulerZeroPoint = (documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor) - 20;\n                    if (documentEditor.selectionModule.paragraphFormat.bidi) {\n                        rulerZeroPoint = (documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor) - 20 - (documentEditor.viewer.clientArea.width * documentEditor.zoomFactor);\n                    }\n                }\n                var value = rulerZeroPoint + e.clientX - rightLineOffset_1 - hRuler.getBoundingClientRect().left;\n                var startValue = documentEditor.documentHelper.currentPage.boundingRectangle.x;\n                startValue = documentEditor.layoutType === 'Continuous' ? 0 : startValue;\n                var indicatorLineValue = startValue + (value - rulerZeroPoint) + 6;\n                var lineSvg = document.getElementById(documentEditor.element.id + '_hRuler_indicator_svg');\n                lineSvg.style.left = indicatorLineValue + 'px';\n                lineSvg.style.display = 'block';\n                e.stopPropagation();\n            });\n            document.addEventListener(\"mousemove\", function (e) {\n                if (isDragging_4) {\n                    var rulerZeroPoint = void 0;\n                    var value = void 0;\n                    var leftIndent_2 = document.getElementById(documentEditor.element.id + '_leftIndent');\n                    var firstLineIndent_1 = document.getElementById(documentEditor.element.id + '_firstLineIndent');\n                    var maxValue = void 0;\n                    var minValue = void 0;\n                    if (documentEditor.selectionModule.paragraphFormat.bidi) {\n                        if (documentEditor.layoutType === 'Pages') {\n                            rulerZeroPoint = HelperMethods.convertPointToPixel(1584 - documentEditor.selectionModule.sectionFormat.leftMargin - (documentEditor.selectionModule.sectionFormat.pageWidth - documentEditor.selectionModule.sectionFormat.leftMargin - documentEditor.selectionModule.sectionFormat.rightMargin)) * documentEditor.zoomFactor;\n                        }\n                        else if (documentEditor.layoutType === 'Continuous') {\n                            rulerZeroPoint = (documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor) - 20 - (documentEditor.viewer.clientArea.width * documentEditor.zoomFactor);\n                        }\n                        value = rulerZeroPoint + e.clientX - rightLineOffset_1 - hRuler.getBoundingClientRect().left;\n                        var nearestElement = (HelperMethods.getNumberFromString(leftIndent_2.style.left) - value) <= (HelperMethods.getNumberFromString(firstLineIndent_1.style.left) - value) ? leftIndent_2 : firstLineIndent_1;\n                        var indentValue = HelperMethods.getNumberFromString(nearestElement.style.left);\n                        maxValue = indentValue - (HelperMethods.convertPointToPixel(42) * documentEditor.zoomFactor);\n                        minValue = rulerZeroPoint - 6;\n                    }\n                    else {\n                        if (documentEditor.layoutType === 'Pages') {\n                            rulerZeroPoint = HelperMethods.convertPointToPixel(1584 - documentEditor.selectionModule.sectionFormat.leftMargin) * documentEditor.zoomFactor;\n                        }\n                        else if (documentEditor.layoutType === 'Continuous') {\n                            rulerZeroPoint = (documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor) - 20;\n                        }\n                        value = rulerZeroPoint + e.clientX - rightLineOffset_1 - hRuler.getBoundingClientRect().left;\n                        var nearestElement = (value - HelperMethods.getNumberFromString(leftIndent_2.style.left)) <= (value - HelperMethods.getNumberFromString(firstLineIndent_1.style.left)) ? leftIndent_2 : firstLineIndent_1;\n                        var indentValue = HelperMethods.getNumberFromString(nearestElement.style.left);\n                        maxValue = rulerZeroPoint + (documentEditor.documentHelper.currentPage.boundingRectangle.width * documentEditor.zoomFactor) - 6;\n                        minValue = indentValue + (HelperMethods.convertPointToPixel(42) * documentEditor.zoomFactor);\n                    }\n                    if (value < minValue) {\n                        value = minValue;\n                    }\n                    else if (value > maxValue) {\n                        value = maxValue;\n                    }\n                    rightIndent.style.left = value + \"px\";\n                    var startValue = documentEditor.documentHelper.currentPage.boundingRectangle.x;\n                    startValue = documentEditor.layoutType === 'Continuous' ? 0 : startValue;\n                    var indicatorLineValue = startValue + (value - rulerZeroPoint) + 6;\n                    var lineSvg = document.getElementById(documentEditor.element.id + '_hRuler_indicator_svg');\n                    lineSvg.style.left = indicatorLineValue + 'px';\n                }\n            });\n            document.addEventListener(\"mouseup\", function () {\n                if (isDragging_4) {\n                    isDragging_4 = false;\n                    var finalValue = HelperMethods.getNumberFromString(rightIndent.style.left);\n                    if (documentEditor.selectionModule.paragraphFormat.bidi) {\n                        documentEditor.editorModule.applyRulerMarkerValues('rightIndent', initialValue_4, finalValue);\n                    }\n                    else {\n                        documentEditor.editorModule.applyRulerMarkerValues('rightIndent', finalValue, initialValue_4);\n                    }\n                    initialValue_4 = finalValue;\n                    var lineSvg = document.getElementById(documentEditor.element.id + '_hRuler_indicator_svg');\n                    lineSvg.style.display = 'none';\n                }\n            });\n        }\n        this.updateIndentMarkers(documentEditor);\n    };\n    /**\n     * updateRuler method\n     *\n     * @returns {void} updateRuler method.\n     * @param { DocumentEditor} documentEditor - provide the documentEditor  value.\n     * @private\n     */\n    RulerHelper.prototype.updateRuler = function (documentEditor, rerenderRuler) {\n        if (documentEditor.rulerHelper && documentEditor.documentEditorSettings && !documentEditor.documentEditorSettings.showRuler ||\n            documentEditor.isReadOnlyMode) {\n            return;\n        }\n        // const hOffset: number = - documentEditor.scroller.horizontalOffset;\n        // const vOffset: number = - documentEditor.scroller.verticalOffset;\n        var hOffset = 0;\n        // const vOffset: number = - documentEditor.scroller.verticalOffset;\n        if (isNullOrUndefined(documentEditor.hRuler) && isNullOrUndefined(documentEditor.vRuler)) {\n            return;\n        }\n        if (documentEditor.selectionModule.isForward) {\n            this.position = documentEditor.selectionModule.start;\n        }\n        else {\n            this.position = documentEditor.selectionModule.end;\n        }\n        this.updateRulerDimension(documentEditor, documentEditor.hRuler, hOffset, rerenderRuler);\n        this.updateRulerDimension(documentEditor, documentEditor.vRuler, hOffset, rerenderRuler);\n        this.updateRulerMargins(documentEditor);\n        this.updateIndentMarkers(documentEditor);\n        this.updateTabStopMarkers(documentEditor);\n        if (this.position.paragraph.isInsideTable) {\n            this.updateTableMarkers(documentEditor, documentEditor.hRuler);\n        }\n        else {\n            this.removeTableMarkers(documentEditor, documentEditor.hRuler);\n        }\n        this.updateIndicatorLines(documentEditor);\n    };\n    RulerHelper.prototype.removeTableMarkers = function (documentEditor, ruler) {\n        var renderedTableMarkers = HelperMethods.convertNodeListToArray(document.querySelectorAll('.e-de-ruler-table-marker'));\n        if (!isNullOrUndefined(renderedTableMarkers)) {\n            for (var i = 0; i < renderedTableMarkers.length; i++) {\n                var elementToRemove = renderedTableMarkers[parseInt(i.toString(), 10)];\n                if (!isNullOrUndefined(elementToRemove)) {\n                    elementToRemove.parentNode.removeChild(elementToRemove);\n                }\n            }\n        }\n    };\n    RulerHelper.prototype.updateTableMarkers = function (documentEditor, ruler) {\n        var renderedTableMarkers = HelperMethods.convertNodeListToArray(document.querySelectorAll('.e-de-ruler-table-marker'));\n        if (isNullOrUndefined(renderedTableMarkers)) {\n            // const tablewidget: TableWidget =\n            // ((documentEditor.selection.end.paragraph.containerWidget as TableCellWidget).ownerTable as TableWidget);\n            // const tableColumns = ((documentEditor.selection.end.paragraph.containerWidget as TableCellWidget).ownerTable\n            //  as TableWidget).tableHolder.columns.length;\n            // const tableXPos: number = undefined;\n            // const hRuler: HTMLElement = document.getElementById(documentEditor.element.id + '_hRuler');\n            this.renderTableMarkers(documentEditor, ruler);\n        }\n        else if (this.position.paragraph.isInsideTable) {\n            this.renderTableMarkers(documentEditor, ruler);\n        }\n    };\n    RulerHelper.prototype.renderTableMarkers = function (documentEditor, ruler) {\n        var _this = this;\n        this.removeTableMarkers(documentEditor, documentEditor.hRuler);\n        var intialPosition;\n        var tablewidget = this.position.paragraph.containerWidget.ownerTable;\n        var tableRowWidget = this.position.paragraph.associatedCell.ownerRow.clone();\n        var cellWidgets = tableRowWidget.childWidgets;\n        var value = this.position.paragraph.associatedCell.ownerTable.tableFormat.bidi ? cellWidgets.length : 0;\n        if (this.position.paragraph.associatedCell.ownerTable.tableFormat.bidi) {\n            cellWidgets.reverse();\n        }\n        var tableXPos;\n        var hRuler = document.getElementById(documentEditor.element.id + '_hRuler');\n        var _loop_1 = function (i) {\n            var tableMarker = document.getElementById(documentEditor.element.id + '_tableMarker_' + value);\n            //if (!tableMarker) {   \n            var margin = void 0;\n            if (i == 0) {\n                tableXPos = (cellWidgets[parseInt(i.toString(), 10)].x - cellWidgets[parseInt(i.toString(), 10)].margin.left) * documentEditor.zoomFactor + hRuler.scrollLeft;\n                margin = ('left:' + (tableXPos - 4) + 'px;');\n            }\n            else {\n                tableXPos = tableXPos + ((cellWidgets[i - 1].width\n                    + cellWidgets[i - 1].margin.left\n                    + cellWidgets[i - 1].margin.right) * documentEditor.zoomFactor);\n                margin = 'left:' + (tableXPos - 4) + 'px;';\n            }\n            var style = 'height:' + (ruler.thickness) + 'px;overflow:hidden;width:10px;position:absolute;font-size:11px;text-align: left;z-index: 4;' + margin;\n            var attributes = {\n                'id': documentEditor.element.id + '_tableMarker_' + value,\n                'class': 'e-de-ruler-table-marker',\n                style: style\n            };\n            tableMarker = this_1.createHtmlElement('div', attributes);\n            var locale = new L10n('documenteditor', documentEditor.defaultLocale);\n            tableMarker.setAttribute('title', locale.getConstant('Move Table Column'));\n            // Create an SVG element\n            var attr = {\n                'id': documentEditor.element.id + '_tableMarker_svg' + i,\n                width: 9 + 'px',\n                height: 11 + 'px',\n                style: 'position:inherit;left:0px;top:3px;'\n            };\n            var svg = this_1.createSvgElement('svg', attr);\n            svg.setAttribute('fill', 'none');\n            var pathattr = {\n                style: 'position:inherit;left:0px;'\n            };\n            // Create a path element inside the SVG\n            var pathElement = this_1.createSvgElement('path', pathattr);\n            pathElement.setAttribute('class', 'e-de-ruler-table-svg');\n            pathElement.setAttribute('d', 'M1 1V0H2V1H3V0H4V1H5V0H6V1H7V2H6V3H7V4H6V5H7V6H6V7H7V8H0V7H1V6H0V5H1V4H0V3H1V2H0V1H1ZM2 2V3H3V2H2ZM4 2V3H5V2H4ZM5 4H4V5H5V4ZM5 6H4V7H5V6ZM3 7V6H2V7H3ZM2 5H3V4H2V5Z');\n            pathElement.setAttribute('fill', '#A1A1A1');\n            // Append the path element to the SVG element\n            svg.appendChild(pathElement);\n            tableMarker.appendChild(svg);\n            hRuler.append(tableMarker);\n            // }\n            if (this_1.position.paragraph.associatedCell.ownerTable.tableFormat.bidi) {\n                value--;\n            }\n            else {\n                value++;\n            }\n            tableMarker.addEventListener('dblclick', function (event) {\n                documentEditor.showDialog('TableProperties');\n                event.stopPropagation();\n            });\n            var tableMarkerOffset;\n            tableMarker.addEventListener('mousedown', function (e) {\n                tableMarkerOffset = e.clientX - tableMarker.getBoundingClientRect().left;\n                documentEditor.startXPosition = HelperMethods.convertPixelToPoint(e.clientX);\n                documentEditor.isTableMarkerDragging = true;\n                var cursorPoint = new Point(e.clientX, e.clientY);\n                var touchPoint = documentEditor.viewer.findFocusedPage(cursorPoint, true, true);\n                var currentMarkerPostion;\n                if (e.currentTarget instanceof HTMLElement) {\n                    var parts = e.currentTarget.id.split('_');\n                    var value_1 = parts[parts.length - 1];\n                    currentMarkerPostion = parseInt(value_1);\n                }\n                var tableWidget = documentEditor.selectionModule.end.paragraph.containerWidget.ownerTable;\n                documentEditor.editorModule.tableResize.currentResizingTable = tableWidget;\n                documentEditor.editorModule.tableResize.resizeNode = 0;\n                documentEditor.editorModule.tableResize.resizerPosition = currentMarkerPostion;\n                documentEditor.editorModule.tableResize.startingPoint.x = touchPoint.x;\n                documentEditor.editorModule.tableResize.startingPoint.y = touchPoint.y;\n                documentEditor.editorHistoryModule.initResizingHistory(touchPoint, documentEditor.editorModule.tableResize);\n                var rulerZeroPoint = HelperMethods.convertPointToPixel(1584 - documentEditor.selectionModule.sectionFormat.leftMargin) * documentEditor.zoomFactor;\n                var value = rulerZeroPoint + e.clientX - tableMarkerOffset - hRuler.getBoundingClientRect().left;\n                var startValue = documentEditor.documentHelper.currentPage.boundingRectangle.x;\n                var indicatorLineValue = startValue + (value - rulerZeroPoint) + 6;\n                var lineSvg = document.getElementById(documentEditor.element.id + '_hRuler_indicator_svg');\n                lineSvg.style.left = (indicatorLineValue - 6) + 'px';\n                lineSvg.style.display = 'block';\n            });\n            document.addEventListener(\"mousemove\", function (e) {\n                if (documentEditor.isDestroyed || !documentEditor.documentEditorSettings.showRuler) {\n                    return;\n                }\n                if (documentEditor.isTableMarkerDragging) {\n                    var hRuler_1 = document.getElementById(documentEditor.element.id + '_hRuler');\n                    var rulerZeroPoint = HelperMethods.convertPointToPixel(1584 - documentEditor.selectionModule.sectionFormat.leftMargin) * documentEditor.zoomFactor;\n                    if (documentEditor.selectionModule.end.paragraph.associatedCell.ownerTable.tableFormat.bidi) {\n                        var rulerGeometry = _this.getRulerGeometry(documentEditor);\n                        var rulerMarginDivWidth = (rulerGeometry.width - (HelperMethods.convertPointToPixel((documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.rightMargin * documentEditor.zoomFactor) + (documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin * documentEditor.zoomFactor))));\n                        rulerZeroPoint -= rulerMarginDivWidth;\n                    }\n                    var value_2 = rulerZeroPoint + e.clientX - tableMarkerOffset - hRuler_1.getBoundingClientRect().left;\n                    tableMarker.style.left = value_2 + \"px\";\n                    var startValue = documentEditor.documentHelper.currentPage.boundingRectangle.x;\n                    var indicatorLineValue = startValue + (value_2 - rulerZeroPoint) + 6;\n                    var lineSvg = document.getElementById(documentEditor.element.id + '_hRuler_indicator_svg');\n                    lineSvg.style.left = (indicatorLineValue - 6) + 'px';\n                }\n            });\n            document.addEventListener(\"mouseup\", function (e) {\n                if (documentEditor.isDestroyed || !documentEditor.documentEditorSettings.showRuler) {\n                    return;\n                }\n                if (documentEditor.isTableMarkerDragging) {\n                    var cursorPoint = new Point(e.clientX, e.clientY);\n                    var dragValue = _this.position.paragraph.associatedCell.ownerTable.tableFormat.bidi ? (documentEditor.startXPosition - HelperMethods.convertPixelToPoint(e.clientX)) : (HelperMethods.convertPixelToPoint(e.clientX) - documentEditor.startXPosition);\n                    documentEditor.editorModule.tableResize.handleResizing(cursorPoint, true, (dragValue / documentEditor.zoomFactor));\n                    documentEditor.editorModule.tableResize.updateResizingHistory(documentEditor.viewer.findFocusedPage(cursorPoint, true, true));\n                    documentEditor.isTableMarkerDragging = false;\n                    var lineSvg = document.getElementById(documentEditor.element.id + '_hRuler_indicator_svg');\n                    lineSvg.style.display = 'none';\n                }\n            });\n        };\n        var this_1 = this;\n        for (var i = 0; i <= cellWidgets.length; i++) {\n            _loop_1(i);\n        }\n    };\n    /**\n     * updateRulerDimension method \\\n     *\n     * @returns {void} updateRulerDimension method .\\\n     * @param { Diagram} diagram - provide the content  value.\n     * @param { Ruler} ruler - provide the content  value.\n     * @param { number} offset - provide the content  value.\n     * @param { boolean} isHorizontal - provide the content  value.\n     * @private\n     */\n    RulerHelper.prototype.updateRulerDimension = function (documentEditor, ruler, offset, rerenderRuler) {\n        var isHorizontal = ruler.orientation === \"Horizontal\" ? true : false;\n        var rulerSize = this.getRulerSize(documentEditor);\n        var rulerGeometry = this.getRulerGeometry(documentEditor);\n        //const documentEditorRuler: DocumentEditorRulerModel = isHorizontal ? documentEditor.documentEditorSettings.rulerSettings.horizontalRuler : documentEditor.documentEditorSettings.rulerSettings.verticalRuler;\n        this.updateRulerDiv(documentEditor, rulerGeometry, isHorizontal, ruler);\n        this.updateRulerSpace(documentEditor, rulerGeometry, isHorizontal, ruler);\n        this.updateMargin(ruler, documentEditor, isHorizontal);\n        // ruler.pageWidth = documentEditor.selection.end.paragraph.bodyWidget.page.boundingRectangle.width * documentEditor.zoomFactor;\n        // ruler.pageHeight = documentEditor.selection.end.paragraph.bodyWidget.page.boundingRectangle.height * documentEditor.zoomFactor;\n        ruler.length = documentEditor.zoomFactor < 1 ? ((ruler.zeroPosition * 2) / documentEditor.zoomFactor) : ((ruler.zeroPosition * 2) * documentEditor.zoomFactor);\n        var rulerObj = ruler.element;\n        if (isHorizontal) {\n            rulerObj.style.marginLeft = (documentEditor.layoutType === 'Pages' ? documentEditor.selectionModule.end.paragraph.bodyWidget.page.boundingRectangle.x : 0) + 'px';\n        }\n        else {\n            rulerObj.parentElement.style.display = documentEditor.layoutType === 'Pages' ? 'block' : 'none';\n            rulerObj.style.marginTop = documentEditor.selectionModule.getPageTop(documentEditor.selectionModule.end.paragraph.bodyWidget.page) + 'px';\n        }\n        if (rerenderRuler) {\n            ruler.offset = offset;\n            ruler.scale = documentEditor.zoomFactor;\n            // if (documentEditor.layoutType === 'Pages') {\n            ruler.length = documentEditor.zoomFactor < 1 ? ((ruler.zeroPosition * 2) / documentEditor.zoomFactor) : ((ruler.zeroPosition * 2) * documentEditor.zoomFactor);\n            // } else if (documentEditor.layoutType === 'Continuous') {\n            //     ruler.length = (ruler.zeroPosition * 2) / documentEditor.zoomFactor;\n            // }\n            ruler.updateRuler();\n        }\n        if (isHorizontal) {\n            if (documentEditor.layoutType === 'Pages') {\n                var paraBidi = this.position.paragraph.paragraphFormat.bidi;\n                var tableBidi = false;\n                if (this.position.paragraph.isInsideTable) {\n                    tableBidi = this.position.paragraph.associatedCell.ownerTable.tableFormat.bidi;\n                }\n                if (paraBidi || tableBidi) {\n                    var rulerMarginDivWidth = (rulerGeometry.width - (HelperMethods.convertPointToPixel((documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.rightMargin * documentEditor.zoomFactor))));\n                    rulerObj.scrollLeft = (documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor) - rulerMarginDivWidth;\n                }\n                else {\n                    rulerObj.scrollLeft = (ruler.zeroPosition - HelperMethods.convertPointToPixel(documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin)) * documentEditor.zoomFactor;\n                }\n            }\n            else {\n                var paraBidi = this.position.paragraph.paragraphFormat.bidi;\n                var tableBidi = false;\n                if (this.position.paragraph.isInsideTable) {\n                    tableBidi = this.position.paragraph.associatedCell.ownerTable.tableFormat.bidi;\n                }\n                if (paraBidi || tableBidi) {\n                    // const rulerMarginDivWidth = (rulerGeometry.width - 40);\n                    rulerObj.scrollLeft = ((ruler.zeroPosition - documentEditor.viewer.clientActiveArea.width) * documentEditor.zoomFactor) - 20;\n                }\n                else {\n                    // 20 is set approximately to the web layout.\n                    rulerObj.scrollLeft = (ruler.zeroPosition * documentEditor.zoomFactor) - 20;\n                }\n            }\n        }\n        else {\n            rulerObj.scrollTop = (ruler.zeroPosition - HelperMethods.convertPointToPixel(documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.topMargin)) * documentEditor.zoomFactor;\n        }\n    };\n    /**\n     * updateRulerSpace method \\\n     *\n     * @returns {void} updateRulerSpace method .\\\n     * @param { Diagram} diagram - provide the content  value.\n     * @param { Size} rulerGeometry - provide the content  value.\n     * @param { boolean} isHorizontal - provide the content  value.\n     * @private\n     */\n    RulerHelper.prototype.updateRulerSpace = function (documentEditor, rulerGeometry, isHorizontal, ruler) {\n        var div = document.getElementById(documentEditor.element.id + (isHorizontal ? '_hRuler_ruler_space' : '_vRuler_ruler_space'));\n        if (div && documentEditor && rulerGeometry) {\n            div.style.width = (isHorizontal ? (rulerGeometry.width + (ruler.segmentWidth * 2)) : ruler.thickness) + 'px';\n            div.style.height = (isHorizontal ? ruler.thickness : (rulerGeometry.height + (ruler.segmentWidth * 2))) + 'px';\n        }\n    };\n    /**\n     * updateRulerDiv method \\\n     *\n     * @returns {void} updateRulerDiv method .\\\n     * @param { Diagram} diagram - provide the content  value.\n     * @param { Size} rulerGeometry - provide the content  value.\n     * @param { boolean} isHorizontal - provide the content  value.\n     * @private\n     */\n    RulerHelper.prototype.updateRulerDiv = function (documentEditor, rulerGeometry, isHorizontal, ruler) {\n        // parent div\n        var div = document.getElementById(documentEditor.element.id + (isHorizontal ? '_hRuler' : '_vRuler'));\n        if (div && documentEditor && rulerGeometry) {\n            div.style.width = (isHorizontal ? documentEditor.layoutType === 'Continuous' ? rulerGeometry.width / documentEditor.zoomFactor : rulerGeometry.width : ruler.thickness) + 'px';\n            div.style.height = (isHorizontal ? ruler.thickness : rulerGeometry.height) + 'px';\n            div = document.getElementById(documentEditor.element.id + '_overlapRuler');\n            if (div) {\n                // eslint-disable-next-line\n                isHorizontal ? (div.style.height === ruler.thickness + 'px') : (div.style.width === ruler.thickness + 'px');\n            }\n        }\n        if (isHorizontal) {\n            if (this.hRulerBottom) {\n                var pageElement = document.getElementById(documentEditor.element.id + '_pageContainer');\n                this.hRulerBottom.style.width = pageElement.getBoundingClientRect().width + 'px';\n            }\n        }\n        // let vRulerDiv: HTMLElement = document.getElementById(documentEditor.element.id + '_vRuler');\n        // if (vRulerDiv) {\n        //     vRulerDiv.style.width = ruler.thickness + 'px';\n        //     vRulerDiv.style.height =  rulerGeometry.height + 'px';                  \n        // }\n    };\n    /**\n     * getRulerGeometry method \\\n     *\n     * @returns {void} getRulerGeometry method .\\\n     * @param { DocumentEditor} documentEditor - provide the documentEditor  value.\n     * @private\n     */\n    RulerHelper.prototype.getRulerGeometry = function (documentEditor) {\n        var rulerSize = this.getRulerSize(documentEditor);\n        var height = (documentEditor.selectionModule.end.paragraph.bodyWidget.page.boundingRectangle.height * documentEditor.zoomFactor);\n        var width = (documentEditor.selectionModule.end.paragraph.bodyWidget.page.boundingRectangle.width * documentEditor.zoomFactor);\n        return new Size(width, height);\n    };\n    RulerHelper.prototype.getVerticalHeight = function (documentEditor) {\n        var pageheight = HelperMethods.convertPixelToPoint(documentEditor.selectionModule.end.paragraph.bodyWidget.page.boundingRectangle.height);\n        var containerHeight = documentEditor.element.getBoundingClientRect().height;\n        if (pageheight < containerHeight) {\n            return pageheight;\n        }\n        else {\n            return containerHeight - documentEditor.documentHelper.pages[0].boundingRectangle.y;\n        }\n    };\n    RulerHelper.prototype.renderTab = function (documentEditor, rulerSize, tabStop, tabJustification, i, locale) {\n        var _this = this;\n        var hRuler = document.getElementById(documentEditor.element.id + '_hRuler');\n        var zoomFactor = documentEditor.documentHelper.zoomFactor;\n        var value;\n        switch (tabJustification) {\n            case 'Left':\n                var leftTab = document.getElementById(documentEditor.element.id + '_LeftTab' + '_' + i);\n                if (!leftTab) {\n                    var style = '';\n                    if (!isNullOrUndefined(tabStop)) {\n                        value = this.position.paragraph.paragraphFormat.bidi ? (HelperMethods.convertPointToPixel(1584 - tabStop.position)) : (HelperMethods.convertPointToPixel(1584 + tabStop.position));\n                        var margin = ('left:' + ((value - 1.5) * zoomFactor) + 'px;');\n                        style = 'height:9px;overflow:hidden;top:7px;width:12px;position:absolute;font-size:11px;text-align: left;z-index: 4;' + margin;\n                    }\n                    var attributes = {\n                        'id': documentEditor.element.id + '_LeftTab' + '_' + i,\n                        'class': 'e-de-ruler-tab e-de-ruler-tab-left',\n                        style: style,\n                        'data-name': 'LeftTab'\n                    };\n                    leftTab = this.createHtmlElement('div', attributes);\n                    leftTab.setAttribute('title', locale.getConstant('Left Tab'));\n                    var svg = void 0;\n                    // Create an SVG element\n                    var attr = {\n                        'id': documentEditor.element.id + '_leftTab_svg',\n                        width: rulerSize.width / 2 + 'px',\n                        height: rulerSize.height / 2 + 'px',\n                        style: 'position:inherit;left:0px'\n                    };\n                    svg = this.createSvgElement('svg', attr);\n                    svg.setAttribute(\"fill\", \"none\");\n                    var pathattr = {\n                        style: 'position:inherit;left:0px'\n                    };\n                    // Create a path element inside the SVG\n                    var pathElement = this.createSvgElement('path', pathattr);\n                    pathElement.setAttribute(\"class\", \"e-de-ruler-tab-svg\");\n                    pathElement.setAttribute(\"d\", \"M3 5H7V7H1V1H3V5Z\");\n                    pathElement.setAttribute(\"fill\", \"#605E5C\");\n                    pathElement.setAttribute(\"stroke\", \"#A1A1A1\");\n                    // Append the path element to the SVG element\n                    svg.appendChild(pathElement);\n                    leftTab.appendChild(svg);\n                    hRuler.append(leftTab);\n                }\n                break;\n            case 'Center':\n                var centerTab = document.getElementById(documentEditor.element.id + '_CenterTab' + '_' + i);\n                if (!centerTab) {\n                    var style = '';\n                    if (!isNullOrUndefined(tabStop)) {\n                        value = this.position.paragraph.paragraphFormat.bidi ? (HelperMethods.convertPointToPixel(1584 - tabStop.position)) : (HelperMethods.convertPointToPixel(1584 + tabStop.position));\n                        var margin = ('left:' + ((value - 4) * zoomFactor) + 'px;');\n                        style = 'height:9px;overflow:hidden;top:7px;width:12px;position:absolute;font-size:11px;text-align: left;z-index: 4;' + margin;\n                    }\n                    var attributes = {\n                        'id': documentEditor.element.id + '_CenterTab' + '_' + i,\n                        'class': 'e-de-ruler-tab e-de-ruler-tab-center',\n                        style: style,\n                        'data-name': 'CenterTab'\n                    };\n                    centerTab = this.createHtmlElement('div', attributes);\n                    centerTab.setAttribute('title', locale.getConstant('Center Tab'));\n                    var svg = void 0;\n                    // Create an SVG element\n                    var attr = {\n                        'id': documentEditor.element.id + '_centerTab_svg',\n                        width: rulerSize.width / 2 + 'px',\n                        height: rulerSize.height / 2 + 'px',\n                        style: 'position:inherit;left:0px'\n                    };\n                    svg = this.createSvgElement('svg', attr);\n                    svg.setAttribute(\"fill\", \"none\");\n                    var pathattr = {\n                        style: 'position:inherit;left:0px'\n                    };\n                    // Create a path element inside the SVG\n                    var pathElement = this.createSvgElement('path', pathattr);\n                    pathElement.setAttribute(\"class\", \"e-de-ruler-tab-svg\");\n                    pathElement.setAttribute(\"d\", \"M5 5H8V7H0V5H3V1H5V5Z\");\n                    pathElement.setAttribute(\"fill\", \"#605E5C\");\n                    pathElement.setAttribute(\"stroke\", \"#A1A1A1\");\n                    // Append the path element to the SVG element\n                    svg.appendChild(pathElement);\n                    centerTab.appendChild(svg);\n                    hRuler.append(centerTab);\n                }\n                break;\n            case 'Right':\n                var rightTab = document.getElementById(documentEditor.element.id + '_RightTab' + '_' + i);\n                if (!rightTab) {\n                    var style = '';\n                    if (!isNullOrUndefined(tabStop)) {\n                        value = this.position.paragraph.paragraphFormat.bidi ? (HelperMethods.convertPointToPixel(1584 - tabStop.position)) : (HelperMethods.convertPointToPixel(1584 + tabStop.position));\n                        var margin = ('left:' + ((value - 5.5) * zoomFactor) + 'px;');\n                        style = 'height:9px;overflow:hidden;top:7px;width:12px;position:absolute;font-size:11px;text-align: left;z-index: 4;' + margin;\n                    }\n                    var attributes = {\n                        'id': documentEditor.element.id + '_RightTab' + '_' + i,\n                        'class': 'e-de-ruler-tab e-de-ruler-tab-right',\n                        style: style,\n                        'data-name': 'RightTab'\n                    };\n                    rightTab = this.createHtmlElement('div', attributes);\n                    rightTab.setAttribute('title', locale.getConstant('Right Tab'));\n                    var svg = void 0;\n                    // Create an SVG element\n                    var attr = {\n                        'id': documentEditor.element.id + '_rightTab_svg',\n                        width: rulerSize.width / 2 + 'px',\n                        height: rulerSize.height / 2 + 'px',\n                        style: 'position:inherit;left:0px'\n                    };\n                    svg = this.createSvgElement('svg', attr);\n                    svg.setAttribute(\"fill\", \"none\");\n                    var pathattr = {\n                        style: 'position:inherit;left:0px'\n                    };\n                    // Create a path element inside the SVG\n                    var pathElement = this.createSvgElement('path', pathattr);\n                    pathElement.setAttribute(\"class\", \"e-de-ruler-tab-svg\");\n                    pathElement.setAttribute(\"d\", \"M5 5V1H7V7H1V5H5Z\");\n                    pathElement.setAttribute(\"fill\", \"#605E5C\");\n                    pathElement.setAttribute(\"stroke\", \"#A1A1A1\");\n                    // Append the path element to the SVG element\n                    svg.appendChild(pathElement);\n                    rightTab.appendChild(svg);\n                    hRuler.append(rightTab);\n                }\n                break;\n            case 'Decimal':\n                var decimalTab = document.getElementById(documentEditor.element.id + '_DecimalTab' + '_' + i);\n                if (!decimalTab) {\n                    var style = '';\n                    if (!isNullOrUndefined(tabStop)) {\n                        value = this.position.paragraph.paragraphFormat.bidi ? (HelperMethods.convertPointToPixel(1584 - tabStop.position)) : (HelperMethods.convertPointToPixel(1584 + tabStop.position));\n                        var margin = ('left:' + ((value * zoomFactor) - 4) + 'px;');\n                        style = 'height:9px;overflow:hidden;top:7px;width:12px;position:absolute;font-size:11px;text-align: left;z-index: 4;' + margin;\n                    }\n                    var attributes = {\n                        'id': documentEditor.element.id + '_DecimalTab' + '_' + i,\n                        'class': 'e-de-ruler-tab e-de-ruler-tab-decimal',\n                        style: style,\n                        'data-name': 'DecimalTab'\n                    };\n                    decimalTab = this.createHtmlElement('div', attributes);\n                    decimalTab.setAttribute('title', locale.getConstant('Decimal Tab'));\n                    var svg = void 0;\n                    // Create an SVG element\n                    var attr = {\n                        'id': documentEditor.element.id + '_decimalTab_svg',\n                        width: rulerSize.width / 2 + 'px',\n                        height: rulerSize.height / 2 + 'px',\n                        style: 'position:inherit;left:0px'\n                    };\n                    svg = this.createSvgElement('svg', attr);\n                    svg.setAttribute(\"fill\", \"none\");\n                    var pathattr = {\n                        style: 'position:inherit;left:0px'\n                    };\n                    // Create a path element inside the SVG\n                    var pathElement = this.createSvgElement('path', pathattr);\n                    pathElement.setAttribute(\"class\", \"e-de-ruler-tab-svg\");\n                    pathElement.setAttribute(\"d\", \"M6 0H4V6H0V8H4H6H10V6H6V0Z\");\n                    pathElement.setAttribute(\"fill\", \"#605E5C\");\n                    pathElement.setAttribute(\"clip-rule\", \"evenodd\");\n                    pathElement.setAttribute(\"fill-rule\", \"evenodd\");\n                    pathElement.setAttribute(\"stroke\", \"#A1A1A1\");\n                    // Append the path element to the SVG element\n                    svg.appendChild(pathElement);\n                    decimalTab.appendChild(svg);\n                    hRuler.append(decimalTab);\n                }\n                break;\n            case 'Bar':\n                var barTab = document.getElementById(documentEditor.element.id + '_BarTab' + '_' + i);\n                if (!barTab) {\n                    var style = '';\n                    if (!isNullOrUndefined(tabStop)) {\n                        value = this.position.paragraph.paragraphFormat.bidi ? (HelperMethods.convertPointToPixel(1584 - tabStop.position)) : (HelperMethods.convertPointToPixel(1584 + tabStop.position));\n                        var margin = ('left:' + ((value - 1.5) * zoomFactor) + 'px;');\n                        style = 'height:9px;overflow:hidden;top:7px;width:12px;position:absolute;font-size:11px;text-align: left;z-index: 4;' + margin;\n                    }\n                    var attributes = {\n                        'id': documentEditor.element.id + '_BarTab' + '_' + i,\n                        'class': 'e-de-ruler-tab e-de-ruler-tab-bar',\n                        style: style,\n                        'data-name': 'BarTab'\n                    };\n                    barTab = this.createHtmlElement('div', attributes);\n                    barTab.setAttribute('title', locale.getConstant('Bar Tab'));\n                    var svg = void 0;\n                    // Create an SVG element\n                    var attr = {\n                        'id': documentEditor.element.id + '_barTab_svg',\n                        width: rulerSize.width / 2 + 'px',\n                        height: rulerSize.height / 2 + 'px',\n                        style: 'position:inherit;left:0px'\n                    };\n                    svg = this.createSvgElement('svg', attr);\n                    svg.setAttribute(\"fill\", \"none\");\n                    var rectAttr = {\n                        style: 'position:inherit;left:0px'\n                    };\n                    var rect = this.createSvgElement('rect', rectAttr);\n                    rect.setAttribute(\"width\", \"2\");\n                    rect.setAttribute(\"height\", \"8\");\n                    rect.setAttribute(\"fill\", \"#605E5C\");\n                    rect.setAttribute(\"stroke\", \"#A1A1A1\");\n                    // Append the path element to the SVG element\n                    svg.appendChild(rect);\n                    barTab.appendChild(svg);\n                    hRuler.append(barTab);\n                }\n                break;\n        }\n        if (!isNullOrUndefined(tabStop)) {\n            var tabStopElement_1 = document.getElementById(documentEditor.element.id + '_' + tabJustification + 'Tab' + '_' + i);\n            if (!isNullOrUndefined(tabStop)) {\n                tabStopElement_1.addEventListener(\"dblclick\", function (event) {\n                    documentEditor.showTabDialog();\n                    event.stopPropagation();\n                });\n            }\n            //Draggable for tab stop.\n            var isDragging_5 = false;\n            var tabStopOffset_1;\n            var initialValue_5 = HelperMethods.getNumberFromString(tabStopElement_1.style.left); // for mouse up event\n            var initialValue2 = HelperMethods.getNumberFromString(tabStopElement_1.style.left); // for mouse move event\n            var justification_1 = tabStopElement_1.getAttribute('data-name');\n            var currrentParagraph_1 = this.position.paragraph;\n            var tabIndex_1 = 0;\n            var currentTabStop_1 = undefined;\n            tabStopElement_1.addEventListener(\"mousedown\", function (e) {\n                e.stopPropagation();\n                isDragging_5 = true;\n                tabStopOffset_1 = e.clientX - tabStopElement_1.getBoundingClientRect().left;\n                initialValue_5 = HelperMethods.getNumberFromString(tabStopElement_1.style.left);\n                tabIndex_1 = parseInt(tabStopElement_1.id.split('_')[tabStopElement_1.id.split('_').length - 1]);\n                currentTabStop_1 = currrentParagraph_1.paragraphFormat.tabs[parseInt(tabIndex_1.toString(), 10)];\n                _this.currentTabStopElement = tabStopElement_1;\n                var rulerZeroPoint = HelperMethods.convertPointToPixel(1584 - documentEditor.selectionModule.sectionFormat.leftMargin)\n                    * documentEditor.zoomFactor;\n                if (documentEditor.layoutType === 'Continuous') {\n                    rulerZeroPoint = (documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor) - 20;\n                    if (_this.position.paragraph.paragraphFormat.bidi) {\n                        rulerZeroPoint = (documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor) - 20 - (documentEditor.viewer.clientArea.width * documentEditor.zoomFactor);\n                    }\n                }\n                var value = rulerZeroPoint + e.clientX - tabStopOffset_1 - hRuler.getBoundingClientRect().left;\n                var startValue = documentEditor.documentHelper.currentPage.boundingRectangle.x;\n                startValue = documentEditor.layoutType === 'Continuous' ? 0 : startValue;\n                var indicatorLineValue = startValue + (value - rulerZeroPoint);\n                var lineSvg = document.getElementById(documentEditor.element.id + '_hRuler_indicator_svg');\n                lineSvg.style.left = indicatorLineValue + 'px';\n                lineSvg.style.display = 'block';\n            });\n            tabStopElement_1.addEventListener('mouseup', function () {\n                if (!isNullOrUndefined(_this.currentTabStopElement)) {\n                    _this.currentTabStopElement = undefined;\n                }\n            });\n            document.addEventListener('mousemove', function (e) {\n                if (isDragging_5) {\n                    var rulerZeroPoint = void 0;\n                    if (documentEditor.layoutType === 'Continuous') {\n                        rulerZeroPoint = (documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor) - 20;\n                        if (_this.position.paragraph.paragraphFormat.bidi) {\n                            rulerZeroPoint = (documentEditor.hRuler.zeroPosition * documentEditor.zoomFactor) - 20 - (documentEditor.viewer.clientArea.width * documentEditor.zoomFactor);\n                        }\n                    }\n                    else if (documentEditor.layoutType === 'Pages') {\n                        rulerZeroPoint = HelperMethods.convertPointToPixel(1584 - documentEditor.selectionModule.sectionFormat.leftMargin)\n                            * documentEditor.zoomFactor;\n                        if (_this.position.paragraph.bidi) {\n                            rulerZeroPoint = HelperMethods.convertPointToPixel(1584 + documentEditor.selectionModule.sectionFormat.rightMargin - documentEditor.selectionModule.sectionFormat.pageWidth) * documentEditor.zoomFactor;\n                        }\n                    }\n                    var value_3 = rulerZeroPoint + e.clientX - tabStopOffset_1 - hRuler.getBoundingClientRect().left;\n                    var minValue = rulerZeroPoint;\n                    var rightIndent = document.getElementById(documentEditor.element.id + '_rightIndent');\n                    var rightIndentValue = HelperMethods.getNumberFromString(rightIndent.style.left);\n                    var maxValue = rightIndentValue;\n                    var leftIndent = document.getElementById(documentEditor.element.id + '_leftIndent');\n                    var leftIndentValue = HelperMethods.getNumberFromString(leftIndent.style.left);\n                    minValue = leftIndentValue;\n                    if (_this.position.paragraph.paragraphFormat.bidi) {\n                        minValue = rightIndentValue;\n                        maxValue = leftIndentValue;\n                    }\n                    if (justification_1 === 'CenterTab' || justification_1 === 'DecimalTab') {\n                        maxValue += 4;\n                    }\n                    else if (justification_1 === 'RightTab') {\n                        maxValue += 5.5;\n                    }\n                    else {\n                        maxValue += 1.5;\n                    }\n                    if (value_3 < minValue) {\n                        value_3 = minValue;\n                    }\n                    else if (value_3 > maxValue) {\n                        value_3 = maxValue;\n                    }\n                    tabStopElement_1.style.left = value_3 + 'px';\n                    var startValue = documentEditor.documentHelper.currentPage.boundingRectangle.x;\n                    startValue = documentEditor.layoutType === 'Continuous' ? 0 : startValue;\n                    var indicatorLineValue = startValue + (value_3 - rulerZeroPoint) + 6;\n                    var lineSvg = document.getElementById(documentEditor.element.id + '_hRuler_indicator_svg');\n                    lineSvg.style.left = indicatorLineValue + 'px';\n                }\n            });\n            document.addEventListener(\"mouseup\", function () {\n                if (isDragging_5 && !isNullOrUndefined(currentTabStop_1)) {\n                    if (!isNullOrUndefined(_this.currentTabStopElement) && _this.currentTabStopElement.style.display == 'none') {\n                        documentEditor.editorModule.removeTabStops([currrentParagraph_1], [currentTabStop_1]);\n                        _this.currentTabStopElement.parentNode.removeChild(_this.currentTabStopElement);\n                    }\n                    else {\n                        var finalValue = HelperMethods.getNumberFromString(tabStopElement_1.style.left);\n                        initialValue_5 = finalValue;\n                        documentEditor.editorModule.removeTabStops([currrentParagraph_1], [currentTabStop_1]);\n                        finalValue = HelperMethods.convertPixelToPoint(finalValue / documentEditor.zoomFactor) - 1584;\n                        finalValue = currrentParagraph_1.paragraphFormat.bidi ? finalValue * -1 : finalValue;\n                        currentTabStop_1.position = finalValue;\n                        documentEditor.editorModule.updateTabStopCollection(currrentParagraph_1, [currentTabStop_1]);\n                    }\n                    _this.updateTabStopMarkers(documentEditor);\n                    isDragging_5 = false;\n                    var lineSvg = document.getElementById(documentEditor.element.id + '_hRuler_indicator_svg');\n                    lineSvg.style.display = 'none';\n                    _this.currentTabStopElement = undefined;\n                }\n            });\n        }\n    };\n    RulerHelper.prototype.updateMargin = function (ruler, documentEditor, isHorizontal) {\n        if (isHorizontal) {\n            ruler.startMargin = documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin;\n            ruler.endMargin = documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.rightMargin;\n        }\n        else {\n            ruler.startMargin = documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.topMargin;\n            ruler.endMargin = documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.bottomMargin;\n        }\n    };\n    RulerHelper.prototype.getTabJustification = function (dataNameValue) {\n        switch (dataNameValue) {\n            case 'LeftTab':\n                return 'Left';\n            case 'CenterTab':\n                return 'Center';\n            case 'RightTab':\n                return 'Right';\n            case 'DecimalTab':\n                return 'Decimal';\n            case 'BarTab':\n                return 'Bar';\n        }\n        return 'Left';\n    };\n    /**\n * getRulerSize method \\\n *\n * @returns {void} getRulerSize method .\\\n * @param { DocumentEditor} documentEditor - provide the documentEditor  value.\n * @private\n */\n    RulerHelper.prototype.getRulerSize = function (documentEditor) {\n        var top = 0;\n        var left = 0;\n        //if (diagram.rulerSettings.showRulers) {\n        // top = documentEditor.documentEditorSettings.rulerSettings.horizontalRuler.thickness;\n        // left = documentEditor.documentEditorSettings.rulerSettings.verticalRuler.thickness;\n        top = 15;\n        left = 15;\n        //}\n        return new Size(left, top);\n    };\n    return RulerHelper;\n}());\nexport { RulerHelper };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}