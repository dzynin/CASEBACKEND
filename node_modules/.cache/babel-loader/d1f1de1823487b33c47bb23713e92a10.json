{"ast":null,"code":"var _jsxFileName = \"/home/taymur/Documents/legal2/DATA/Highlight/newmerged/CASEFRONTt/src/TextEditor.js\";\nimport React, { useContext, useCallback, useEffect, useState } from \"react\";\nimport Quill from \"quill\";\nimport \"quill/dist/quill.snow.css\";\nimport { io } from \"socket.io-client\";\nimport { Button, Modal } from \"react-bootstrap\";\nimport { FaRegPaperPlane, FaBriefcase, FaFile } from 'react-icons/fa';\nimport { UserContext } from \"./App\";\nconst SAVE_INTERVAL_MS = 15000;\nconst TOOLBAR_OPTIONS = [[{\n  header: [1, 2, 3, 4, 5, 6, false]\n}], [{\n  font: []\n}], [{\n  list: \"ordered\"\n}, {\n  list: \"bullet\"\n}], [\"bold\", \"italic\", \"underline\"], [{\n  color: []\n}, {\n  background: []\n}], [{\n  script: \"sub\"\n}, {\n  script: \"super\"\n}], [{\n  align: []\n}], [\"blockquote\", \"code-block\"], [\"clean\"]];\nexport default function TextEditor({\n  id,\n  fileName,\n  showTextEditor,\n  setShowTextEditor\n}) {\n  const [socket, setSocket] = useState();\n  const [quill, setQuill] = useState();\n  const [openaiResponses, setOpenaiResponses] = useState([]);\n  const {\n    state\n  } = useContext(UserContext);\n  const [editorMode, setEditorMode] = useState(null);\n  useEffect(() => {\n    const s = io(\"http://localhost:8000\");\n    setSocket(s);\n    return () => {\n      s.disconnect();\n    };\n  }, []);\n  useEffect(() => {\n    if (!socket || !quill) return;\n\n    if (editorMode === 'edit_document' || editorMode === 'appeal') {\n      socket.emit(\"get-document\", {\n        documentId: id,\n        fileName\n      });\n    }\n\n    const interval = setInterval(() => {\n      if (editorMode === 'edit_document') {\n        socket.emit(\"save-document\", quill.getContents());\n      }\n    }, SAVE_INTERVAL_MS);\n    return () => {\n      clearInterval(interval);\n    };\n  }, [socket, quill, editorMode, id, fileName]);\n  const wrapperRef = useCallback(wrapper => {\n    if (wrapper == null) return;\n    wrapper.innerHTML = \"\";\n    const editor = document.createElement(\"div\");\n    wrapper.append(editor);\n    const q = new Quill(editor, {\n      theme: \"snow\",\n      modules: {\n        toolbar: TOOLBAR_OPTIONS\n      }\n    });\n    q.enable();\n    setQuill(q);\n  }, []);\n  useEffect(() => {\n    const handleOpenaiResponse = data => {\n      setOpenaiResponses(currentResponses => [...currentResponses, data.message]);\n\n      if (editorMode === 'appeal' && data.message) {\n        const length = quill.getLength();\n        quill.insertText(length, \"\\n\" + data.message);\n      }\n    };\n\n    socket === null || socket === void 0 ? void 0 : socket.on(\"openai_response\", handleOpenaiResponse);\n    return () => {\n      socket === null || socket === void 0 ? void 0 : socket.off(\"openai_response\", handleOpenaiResponse);\n    };\n  }, [socket, quill, editorMode]);\n\n  const handleAppeal = () => {\n    setEditorMode('appeal');\n    socket.emit(\"openai-call\", {\n      documentId: id,\n      fileName\n    });\n  };\n\n  const handleClose = () => {\n    setShowTextEditor(false);\n    socket === null || socket === void 0 ? void 0 : socket.disconnect();\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 3\n    }\n  }, !editorMode ? /*#__PURE__*/React.createElement(Modal, {\n    show: showTextEditor,\n    onHide: handleClose,\n    backdrop: \"static\",\n    centered: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 4\n    }\n  }, /*#__PURE__*/React.createElement(Modal.Header, {\n    closeButton: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 6\n    }\n  }, /*#__PURE__*/React.createElement(Modal.Title, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 5\n    }\n  }, \"Choose an Option\")), /*#__PURE__*/React.createElement(Modal.Body, {\n    style: {\n      textAlign: 'center'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 6\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    variant: \"outline-primary\",\n    onClick: handleAppeal,\n    style: {\n      margin: '10px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(FaRegPaperPlane, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 7\n    }\n  }), \" Appeal\"), /*#__PURE__*/React.createElement(Button, {\n    variant: \"outline-success\",\n    onClick: handleEditDocument,\n    style: {\n      margin: '10px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(FaBriefcase, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 7\n    }\n  }), \" Edit Document\"), /*#__PURE__*/React.createElement(Button, {\n    variant: \"outline-info\",\n    onClick: handleNewDocument,\n    style: {\n      margin: '10px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(FaFile, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 7\n    }\n  }), \" New Document\"))) : /*#__PURE__*/React.createElement(Modal, {\n    style: {\n      color: \"#050505\"\n    },\n    show: showTextEditor,\n    onHide: handleClose,\n    backdrop: \"static\",\n    size: \"xl\",\n    centered: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 4\n    }\n  }, /*#__PURE__*/React.createElement(Modal.Body, {\n    style: {\n      height: '60vh'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 6\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      display: 'flex',\n      flexDirection: 'row',\n      height: '100%'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      flex: 2,\n      borderRight: '1px solid #ccc',\n      paddingRight: '20px',\n      overflowY: 'auto'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"h4\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 6\n    }\n  }, \"Highlights\"), state.highlightTextsForEditor && state.highlightTextsForEditor.length > 0 ? state.highlightTextsForEditor.map((highlight, index) => /*#__PURE__*/React.createElement(\"div\", {\n    key: index,\n    style: {\n      padding: '10px',\n      margin: '5px 0'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 9\n    }\n  }, highlight.commentText), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 9\n    }\n  }, highlight.contentText))) : /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 8\n    }\n  }, \"No highlights to show\")), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      flex: 7,\n      marginRight: '20px'\n    },\n    ref: wrapperRef,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      flex: 3,\n      borderLeft: '1px solid #ccc',\n      paddingLeft: '20px',\n      overflowY: 'auto'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"h4\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 6\n    }\n  }, \"Recommendations\"), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      display: 'flex',\n      flexDirection: 'column-reverse'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 6\n    }\n  }, openaiResponses.map((response, index) => /*#__PURE__*/React.createElement(\"div\", {\n    key: index,\n    style: {\n      border: '1px solid #ccc',\n      padding: '10px',\n      margin: '5px 0',\n      display: 'flex',\n      justifyContent: 'space-between',\n      alignItems: 'center'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 9\n    }\n  }, response), /*#__PURE__*/React.createElement(Button, {\n    variant: \"outline-primary\",\n    onClick: () => handleCopyToClipboard(response),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 9\n    }\n  }, \"Insert\"))))))), /*#__PURE__*/React.createElement(Modal.Footer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 6\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    variant: \"secondary\",\n    onClick: handleClose,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 5\n    }\n  }, \"Close\"), /*#__PURE__*/React.createElement(Button, {\n    variant: \"primary\",\n    onClick: handleNoteSave,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 5\n    }\n  }, \"Save\"))));\n}","map":{"version":3,"sources":["/home/taymur/Documents/legal2/DATA/Highlight/newmerged/CASEFRONTt/src/TextEditor.js"],"names":["React","useContext","useCallback","useEffect","useState","Quill","io","Button","Modal","FaRegPaperPlane","FaBriefcase","FaFile","UserContext","SAVE_INTERVAL_MS","TOOLBAR_OPTIONS","header","font","list","color","background","script","align","TextEditor","id","fileName","showTextEditor","setShowTextEditor","socket","setSocket","quill","setQuill","openaiResponses","setOpenaiResponses","state","editorMode","setEditorMode","s","disconnect","emit","documentId","interval","setInterval","getContents","clearInterval","wrapperRef","wrapper","innerHTML","editor","document","createElement","append","q","theme","modules","toolbar","enable","handleOpenaiResponse","data","currentResponses","message","length","getLength","insertText","on","off","handleAppeal","handleClose","textAlign","margin","handleEditDocument","handleNewDocument","height","display","flexDirection","flex","borderRight","paddingRight","overflowY","highlightTextsForEditor","map","highlight","index","padding","commentText","contentText","marginRight","borderLeft","paddingLeft","response","border","justifyContent","alignItems","handleCopyToClipboard","handleNoteSave"],"mappings":"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","sourcesContent":["import React, { useContext, useCallback, useEffect, useState } from \"react\";\nimport Quill from \"quill\";\nimport \"quill/dist/quill.snow.css\";\nimport { io } from \"socket.io-client\";\nimport { Button, Modal } from \"react-bootstrap\";\nimport { FaRegPaperPlane, FaBriefcase, FaFile } from 'react-icons/fa';\nimport { UserContext } from \"./App\";\n\nconst SAVE_INTERVAL_MS = 15000;\nconst TOOLBAR_OPTIONS = [\n  [{ header: [1, 2, 3, 4, 5, 6, false] }],\n  [{ font: [] }],\n  [{ list: \"ordered\" }, { list: \"bullet\" }],\n  [\"bold\", \"italic\", \"underline\"],\n  [{ color: [] }, { background: [] }],\n  [{ script: \"sub\" }, { script: \"super\" }],\n  [{ align: [] }],\n  [\"blockquote\", \"code-block\"],\n  [\"clean\"],\n];\n\nexport default function TextEditor({ id, fileName, showTextEditor, setShowTextEditor }) {\n  const [socket, setSocket] = useState();\n  const [quill, setQuill] = useState();\n  const [openaiResponses, setOpenaiResponses] = useState([]);\n  const { state } = useContext(UserContext);\n  const [editorMode, setEditorMode] = useState(null);\n\n  useEffect(() => {\n    const s = io(\"http://localhost:8000\");\n    setSocket(s);\n\n    return () => {\n      s.disconnect();\n    };\n  }, []);\n\n  useEffect(() => {\n    if (!socket || !quill) return;\n\n    if (editorMode === 'edit_document' || editorMode === 'appeal') {\n      socket.emit(\"get-document\", { documentId: id, fileName });\n    }\n\n    const interval = setInterval(() => {\n      if (editorMode === 'edit_document') {\n        socket.emit(\"save-document\", quill.getContents());\n      }\n    }, SAVE_INTERVAL_MS);\n\n    return () => {\n      clearInterval(interval);\n    };\n  }, [socket, quill, editorMode, id, fileName]);\n\n  const wrapperRef = useCallback((wrapper) => {\n    if (wrapper == null) return;\n\n    wrapper.innerHTML = \"\";\n    const editor = document.createElement(\"div\");\n    wrapper.append(editor);\n    const q = new Quill(editor, {\n      theme: \"snow\",\n      modules: { toolbar: TOOLBAR_OPTIONS },\n    });\n    q.enable();\n    setQuill(q);\n  }, []);\n\n  useEffect(() => {\n    const handleOpenaiResponse = (data) => {\n      setOpenaiResponses(currentResponses => [...currentResponses, data.message]);\n      if (editorMode === 'appeal' && data.message) {\n        const length = quill.getLength();\n        quill.insertText(length, \"\\n\" + data.message);\n      }\n    };\n\n    socket?.on(\"openai_response\", handleOpenaiResponse);\n\n    return () => {\n      socket?.off(\"openai_response\", handleOpenaiResponse);\n    };\n  }, [socket, quill, editorMode]);\n\n  const handleAppeal = () => {\n    setEditorMode('appeal');\n    socket.emit(\"openai-call\", { documentId: id, fileName });\n  };\n\n  const handleClose = () => {\n    setShowTextEditor(false);\n    socket?.disconnect();\n  };\n\treturn (\n\t\t<React.Fragment>\n\t\t  {!editorMode ? (\n\t\t\t<Modal show={showTextEditor} onHide={handleClose} backdrop=\"static\" centered>\n\t\t\t  <Modal.Header closeButton>\n\t\t\t\t<Modal.Title>Choose an Option</Modal.Title>\n\t\t\t  </Modal.Header>\n\t\t\t  <Modal.Body style={{ textAlign: 'center' }}>\n\t\t\t\t<Button variant=\"outline-primary\" onClick={handleAppeal} style={{ margin: '10px' }}>\n\t\t\t\t  <FaRegPaperPlane /> Appeal\n\t\t\t\t</Button>\n\t\t\t\t<Button variant=\"outline-success\" onClick={handleEditDocument} style={{ margin: '10px' }}>\n\t\t\t\t  <FaBriefcase /> Edit Document\n\t\t\t\t</Button>\n\t\t\t\t<Button variant=\"outline-info\" onClick={handleNewDocument} style={{ margin: '10px' }}>\n\t\t\t\t  <FaFile /> New Document\n\t\t\t\t</Button>\n\t\t\t  </Modal.Body>\n\t\t\t</Modal>\n\t\t  ) : (\n\t\t\t<Modal\n\t\t\t  style={{ color: \"#050505\" }}\n\t\t\t  show={showTextEditor}\n\t\t\t  onHide={handleClose}\n\t\t\t  backdrop=\"static\"\n\t\t\t  size=\"xl\"\n\t\t\t  centered\n\t\t\t>\n\t\t\t  <Modal.Body style={{ height: '60vh' }}>\n\t\t\t\t<div style={{ display: 'flex', flexDirection: 'row', height: '100%' }}>\n\t\t\t\t  <div style={{ flex: 2, borderRight: '1px solid #ccc', paddingRight: '20px', overflowY: 'auto' }}>\n\t\t\t\t\t<h4>Highlights</h4>\n\t\t\t\t\t{state.highlightTextsForEditor && state.highlightTextsForEditor.length > 0 ? (\n\t\t\t\t\t  state.highlightTextsForEditor.map((highlight, index) => (\n\t\t\t\t\t\t<div key={index} style={{ padding: '10px', margin: '5px 0' }}>\n\t\t\t\t\t\t  <strong>{highlight.commentText}</strong>\n\t\t\t\t\t\t  <p>{highlight.contentText}</p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t  ))\n\t\t\t\t\t) : (\n\t\t\t\t\t  <div>No highlights to show</div>\n\t\t\t\t\t)}\n\t\t\t\t  </div>\n\t\t\t\t  <div style={{ flex: 7, marginRight: '20px' }} ref={wrapperRef}></div>\n\t\t\t\t  <div style={{ flex: 3, borderLeft: '1px solid #ccc', paddingLeft: '20px', overflowY: 'auto' }}>\n\t\t\t\t\t<h4>Recommendations</h4>\n\t\t\t\t\t<div style={{ display: 'flex', flexDirection: 'column-reverse' }}>\n\t\t\t\t\t  {openaiResponses.map((response, index) => (\n\t\t\t\t\t\t<div key={index} style={{ border: '1px solid #ccc', padding: '10px', margin: '5px 0', display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\n\t\t\t\t\t\t  <span>{response}</span>\n\t\t\t\t\t\t  <Button variant=\"outline-primary\" onClick={() => handleCopyToClipboard(response)}>Insert</Button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t  ))}\n\t\t\t\t\t</div>\n\t\t\t\t  </div>\n\t\t\t\t</div>\n\t\t\t  </Modal.Body>\n\t\t\t  <Modal.Footer>\n\t\t\t\t<Button variant=\"secondary\" onClick={handleClose}>Close</Button>\n\t\t\t\t<Button variant=\"primary\" onClick={handleNoteSave}>Save</Button>\n\t\t\t  </Modal.Footer>\n\t\t\t</Modal>\n\t\t  )}\n\t\t</React.Fragment>\n\t  );\n\t\t\t\t\t  }"]},"metadata":{},"sourceType":"module"}