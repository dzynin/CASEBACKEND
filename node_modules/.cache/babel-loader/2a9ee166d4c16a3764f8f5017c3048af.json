{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n    return extendStatics(d, b);\n  };\n  return function (d, b) {\n    extendStatics(d, b);\n    function __() {\n      this.constructor = d;\n    }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function step(result) {\n      result.done ? resolve(result.value) : new P(function (resolve) {\n        resolve(result.value);\n      }).then(fulfilled, rejected);\n    }\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\nvar __generator = this && this.__generator || function (thisArg, body) {\n  var _ = {\n      label: 0,\n      sent: function () {\n        if (t[0] & 1) throw t[1];\n        return t[1];\n      },\n      trys: [],\n      ops: []\n    },\n    f,\n    y,\n    t,\n    g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n    while (_) try {\n      if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n      if (y = 0, t) op = [op[0] & 2, t.value];\n      switch (op[0]) {\n        case 0:\n        case 1:\n          t = op;\n          break;\n        case 4:\n          _.label++;\n          return {\n            value: op[1],\n            done: false\n          };\n        case 5:\n          _.label++;\n          y = op[1];\n          op = [0];\n          continue;\n        case 7:\n          op = _.ops.pop();\n          _.trys.pop();\n          continue;\n        default:\n          if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n            _ = 0;\n            continue;\n          }\n          if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n            _.label = op[1];\n            break;\n          }\n          if (op[0] === 6 && _.label < t[1]) {\n            _.label = t[1];\n            t = op;\n            break;\n          }\n          if (t && _.label < t[2]) {\n            _.label = t[2];\n            _.ops.push(op);\n            break;\n          }\n          if (t[2]) _.ops.pop();\n          _.trys.pop();\n          continue;\n      }\n      op = body.call(thisArg, _);\n    } catch (e) {\n      op = [6, e];\n      y = 0;\n    } finally {\n      f = t = 0;\n    }\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n};\n/* eslint-disable */\nimport { Dictionary } from '../../base/dictionary';\nimport { WAbstractList } from '../list/abstract-list';\nimport { WLevelOverride } from '../list/level-override';\nimport { WSectionFormat, WCharacterFormat, WParagraphFormat, WStyles, WColumnFormat } from '../format/index';\nimport { Layout } from './layout';\nimport { Renderer } from './render';\nimport { createElement, Browser, L10n } from '@syncfusion/ej2-base';\nimport { Page, Rect, Widget, ListTextElementBox, ParagraphWidget, HeaderFooterWidget, Padding, DropDownFormField, TextFormField, CheckBoxFormField, ShapeElementBox, TextFrame, Footnote, FootnoteElementBox, FootNoteWidget, TextElementBox, ShapeBase, ImageElementBox } from './page';\nimport { BodyWidget, LineWidget, TableWidget, TableRowWidget } from './page';\nimport { HelperMethods, Point } from '../editor/editor-helper';\nimport { TextHelper } from './text-helper';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { CommentReviewPane } from '../index';\nimport { Zoom } from './zooming';\nimport { Dialog, createSpinner, showSpinner, hideSpinner } from '@syncfusion/ej2-popups';\nimport { beforePaneSwitchEvent, keyDownEvent, beforeFormFieldFillEvent, afterFormFieldFillEvent } from '../../base/index';\nimport { RestrictEditing } from '../restrict-editing/restrict-editing-pane';\nimport { FormFieldPopUp } from '../dialogs/form-field-popup';\nimport { TrackChangesPane } from '../track-changes/track-changes-pane';\nimport { Themes } from '../themes/themes';\nimport { beforeAutoResize, internalAutoResize } from '../../base/constants';\nimport { incrementalOps } from '../../base/index';\n/**\n * @private\n */\nvar DocumentHelper = /** @class */function () {\n  //#endregion\n  function DocumentHelper(owner) {\n    var _this = this;\n    /**\n     * @private\n     */\n    this.isCompleted = true;\n    /**\n     * @private\n     */\n    this.isSelectionCompleted = true;\n    /**\n     * @private\n     */\n    this.scrollbarWidth = 0;\n    /**\n     * @private\n     */\n    this.isWebPrinting = false;\n    /**\n     * @private\n     */\n    this.isHeaderFooter = false;\n    /**\n     * @private\n     */\n    this.currentPage = undefined;\n    this.selectionStartPageIn = undefined;\n    this.selectionEndPageIn = undefined;\n    /**\n     * @private\n     */\n    this.fieldStacks = [];\n    /**\n     * @private\n     */\n    this.showRevision = false;\n    /**\n     * @private\n     */\n    this.splittedCellWidgets = [];\n    /**\n     * @private\n     */\n    this.tableLefts = [];\n    /**\n     * @private\n     */\n    this.tapCount = 0;\n    this.timer = -1;\n    this.isTimerStarted = false;\n    /**\n     * @private\n     */\n    this.isFirstLineFitInShiftWidgets = false;\n    /**\n     * @private\n     */\n    this.preZoomFactor = 0;\n    /**\n     * @private\n     */\n    this.preDifference = -1;\n    /**\n     * @private\n     */\n    this.isDragging = false;\n    /**\n     * @private\n     */\n    this.fieldEndParagraph = undefined;\n    /**\n     * @private\n     */\n    this.fieldToLayout = undefined;\n    /**\n     * @private\n     */\n    this.backgroundColor = '#FFFFFF';\n    // Event\n    /**\n     * @private\n     */\n    this.isMouseDown = false;\n    this.isMouseEntered = false;\n    this.scrollMoveTimer = 0;\n    /**\n     * @private\n     */\n    this.isSelectionChangedOnMouseMoved = false;\n    /**\n     * @private\n     */\n    this.isControlPressed = false;\n    /**\n     * @private\n     */\n    this.isTouchInput = false;\n    /**\n     * @private\n     */\n    this.isTouchMoved = false;\n    /**\n     * @private\n     */\n    this.useTouchSelectionMark = false;\n    /**\n     * @private\n     */\n    this.touchDownOnSelectionMark = 0;\n    /**\n     * @private\n     */\n    this.isComposingIME = false;\n    /**\n     * @private\n     */\n    this.lastComposedText = '';\n    /**\n     * @private\n     */\n    this.isCompositionStart = false;\n    /**\n     * @private\n     */\n    this.isCompositionUpdated = false;\n    /**\n     * @private\n     */\n    this.isCompositionCanceled = false;\n    /**\n     * @private\n     */\n    this.isCompositionEnd = false;\n    /**\n     * @private\n     */\n    this.prefix = '';\n    /**\n     * @private\n     */\n    this.suffix = '';\n    /**\n     * @private\n     */\n    this.fields = [];\n    /**\n     * @private\n     */\n    this.heightInfoCollection = {};\n    /**\n     * @private\n     */\n    this.defaultTabWidth = 36;\n    /**\n     * @private\n     */\n    this.dontUseHtmlParagraphAutoSpacing = false;\n    /**\n     * @private\n     */\n    this.allowSpaceOfSameStyleInTable = false;\n    /**\n     * @private\n     */\n    this.alignTablesRowByRow = false;\n    /**\n     * @private\n     */\n    this.compatibilityMode = 'Word2013';\n    /**\n     * @private\n     */\n    this.lists = [];\n    /**\n     * @private\n     */\n    this.comments = [];\n    /**\n     * @private\n     */\n    this.authors = new Dictionary();\n    /**\n     * @private\n     */\n    this.revisionsInternal = new Dictionary();\n    /**\n     * @private\n     */\n    this.commentUserOptionId = 1;\n    /**\n     * @private\n     */\n    this.abstractLists = [];\n    /**\n     * @private\n     */\n    this.styles = new WStyles();\n    /**\n     * @private\n     */\n    this.stylesMap = new Dictionary();\n    /**\n     * @private\n     */\n    this.preDefinedStyles = undefined;\n    /**\n     * @private\n     */\n    this.isRowOrCellResizing = false;\n    /**\n     * @private\n     */\n    this.endBookmarksUpdated = [];\n    /**\n     * @private\n     */\n    this.formFields = [];\n    this.isMouseDownInFooterRegion = false;\n    this.pageFitTypeIn = 'None';\n    /**\n     * @private\n     */\n    this.fieldCollection = [];\n    /**\n     * @private\n     */\n    this.isPageField = false;\n    /**\n     * @private\n     */\n    this.mouseDownOffset = new Point(0, 0);\n    this.zoomFactorInternal = 1;\n    /**\n     * If movecaretposition is 1, Home key is pressed\n     * If moveCaretPosition is 2, End key is pressed\n     *\n     * @private\n     */\n    this.moveCaretPosition = 0;\n    /**\n     * @private\n     */\n    this.isTextInput = false;\n    /**\n     * @private\n     */\n    this.isScrollHandler = false;\n    /**\n     * @private\n     */\n    this.triggerElementsOnLoading = false;\n    /**\n     * @private\n     */\n    this.triggerSpellCheck = false;\n    //Document Protection Properties Starts\n    /**\n     * preserve the format\n     *\n     * @private\n     */\n    this.restrictFormatting = false;\n    /**\n     * preserve the document protection type either readonly or no protection\n     *\n     * @private\n     */\n    this.protectionType = 'NoProtection';\n    /**\n     * Preserve the password protection is enforced or not\n     *\n     * @private\n     */\n    this.isDocumentProtected = false;\n    /**\n     * preserve the hash value of password\n     *\n     * @private\n     */\n    this.hashValue = '';\n    /**\n     * @private\n     */\n    this.saltValue = '';\n    /**\n     * @private\n     */\n    this.userCollection = [];\n    /**\n     * @private\n     */\n    this.cachedPages = [];\n    /**\n     * @private\n     */\n    this.skipScrollToPosition = false;\n    /**\n     * @private\n     */\n    this.isIosDevice = false;\n    /**\n     * @private\n     */\n    this.isMobileDevice = false;\n    /**\n     * @private\n     */\n    this.isFormFilling = false;\n    /**\n     * @private\n     */\n    this.fontSubstitutionTable = undefined;\n    /**\n     * @private\n     */\n    this.themes = new Themes();\n    /**\n     * @private\n     */\n    this.hasThemes = false;\n    /**\n     * @private\n     */\n    this.footnotes = new Footnote();\n    /**\n     * @private\n     */\n    this.endnotes = new Footnote();\n    /**\n     * @private\n     */\n    this.isFootnoteWidget = false;\n    /**\n     * @private\n     */\n    this.isDragStarted = false;\n    /**\n     * @private\n     */\n    this.isMouseDownInSelection = false;\n    /**\n     * @private\n     */\n    this.isBookmarkInserted = true;\n    this.isAutoResizeCanStart = false;\n    this.isRestartNumbering = false;\n    /**\n     * @private\n     * @param {TextEvent} event - Specifies text event.\n     * @returns {void}\n     */\n    this.onTextInput = function (event) {\n      if (!_this.isComposingIME) {\n        event.preventDefault();\n        var text = event.data;\n        _this.owner.editorModule.handleTextInput(text);\n      }\n    };\n    //#region Composition Event\n    /**\n     * Fires when composition starts.\n     *\n     * @private\n     * @returns {void}\n     */\n    this.compositionStart = function () {\n      if (!Browser.isDevice && !_this.owner.isReadOnlyMode) {\n        _this.isComposingIME = true;\n        _this.positionEditableTarget();\n        if (_this.owner.editorHistoryModule) {\n          _this.owner.editorModule.initComplexHistory('IMEInput');\n        }\n      }\n      _this.isCompositionStart = true;\n    };\n    /**\n     * Fires on every input during composition.\n     *\n     * @private\n     * @returns {void}\n     */\n    this.compositionUpdated = function () {\n      if (_this.isComposingIME && !_this.owner.isReadOnlyMode) {\n        setTimeout(function () {\n          _this.owner.editorModule.insertIMEText(_this.getEditableDivTextContent(), true);\n        }, 0);\n      }\n      _this.isCompositionUpdated = true;\n    };\n    /**\n     * Fires when user selects a character/word and finalizes the input.\n     *\n     * @private\n     * @param {CompositionEvent} event - Specifies text compisition event.\n     * @returns {void}\n     */\n    this.compositionEnd = function (event) {\n      if (_this.isComposingIME && !_this.owner.isReadOnlyMode) {\n        var text = _this.getEditableDivTextContent();\n        if (text !== '') {\n          _this.owner.editorModule.insertIMEText(text, false);\n        }\n        _this.isComposingIME = false;\n        _this.lastComposedText = '';\n        _this.iframe.setAttribute('style', 'pointer-events:none;position:absolute;left:' + _this.owner.viewer.containerLeft + 'px;top:' + _this.owner.viewer.containerTop + 'px;outline:none;background-color:transparent;width:0px;height:0px;overflow:hidden');\n        _this.editableDiv.innerHTML = '';\n        if (_this.owner.editorHistoryModule) {\n          if (text !== '') {\n            _this.owner.editorModule.isSkipOperationsBuild = _this.owner.enableCollaborativeEditing;\n          }\n          _this.owner.editorHistoryModule.updateComplexHistory();\n          if (text === '') {\n            //When the composition in live. The Undo operation will terminate the composition and empty text will be return from text box.\n            //At that time the the history should be updated. Undo the operation and clear the redo stack. This undo operation will not be saved for redo operation.\n            _this.owner.editorModule.isSkipOperationsBuild = _this.owner.enableCollaborativeEditing;\n            _this.owner.editorHistoryModule.undo();\n            _this.owner.editorHistoryModule.redoStack.pop();\n          }\n          _this.owner.editorModule.isSkipOperationsBuild = false;\n        }\n      }\n      event.preventDefault();\n      _this.isCompositionUpdated = false;\n      _this.isCompositionEnd = true;\n    };\n    /* eslint-disable @typescript-eslint/no-explicit-any */\n    this.onImageResizer = function (args) {\n      if (!isNullOrUndefined(_this.owner) && !isNullOrUndefined(_this.owner.imageResizerModule) && _this.owner.imageResizerModule.isImageResizerVisible && _this.owner.imageResizerModule.isImageResizing) {\n        if (args instanceof MouseEvent) {\n          _this.onMouseUpInternal(args);\n        } else if (args instanceof TouchEvent) {\n          _this.onTouchUpInternal(args);\n        }\n      }\n      if (_this.scrollMoveTimer) {\n        _this.isMouseEntered = true;\n        clearInterval(_this.scrollMoveTimer);\n      }\n    };\n    /* eslint-enable @typescript-eslint/no-explicit-any */\n    /**\n     * @private\n     * @param {KeyboardEvent} event - Specifies keyboard event\n     * @returns {void}\n     */\n    this.onKeyPressInternal = function (event) {\n      var key = event.which || event.keyCode;\n      _this.triggerElementsOnLoading = false;\n      var ctrl = event.ctrlKey || event.metaKey ? true : key === 17 ? true : false; // ctrl detection\n      var alt = event.altKey ? event.altKey : key === 18 ? true : false; // alt key detection\n      if (Browser.isIE && alt && ctrl) {\n        ctrl = false;\n      }\n      // tslint:disable-next-line:max-line-length\n      if (ctrl && event.key === 'v' || ctrl && event.key === 'a' || (ctrl || _this.isControlPressed && Browser.isIE) && event.key === 'p') {\n        if (Browser.isIE) {\n          _this.isControlPressed = false;\n        }\n        return;\n      }\n      if (!_this.owner.isReadOnlyMode || _this.selection && _this.selection.isInlineFormFillMode()) {\n        var key_1 = event.keyCode || event.charCode;\n        var char = '';\n        if (key_1) {\n          char = String.fromCharCode(key_1);\n        } else if (event.key) {\n          char = event.key;\n        }\n        if (char !== ' ' && char !== '\\r' && char !== '\\b' && char !== String.fromCharCode(27) && !ctrl) {\n          _this.owner.editorModule.handleTextInput(char);\n        } else if (char === ' ') {\n          _this.triggerSpellCheck = true;\n          _this.owner.editorModule.handleTextInput(' ');\n          _this.triggerSpellCheck = false;\n        }\n        event.preventDefault();\n      }\n      _this.owner.focusIn();\n    };\n    /**\n     * @private\n     * @param {KeyboardEvent} event - Specifies keyboard event\n     * @returns {void}\n     */\n    this.onTextInputInternal = function (event) {\n      if (!_this.owner.isReadOnlyMode) {\n        _this.owner.editorModule.onTextInputInternal();\n      } else {\n        _this.editableDiv.innerText = '';\n      }\n    };\n    /**\n     * Fired on paste.\n     *\n     * @private\n     * @param {ClipboardEvent} event - Specifies clipboard event.\n     * @returns {void}\n     */\n    this.onPaste = function (event) {\n      if (!_this.owner.isReadOnlyMode && _this.owner.editorModule.canEditContentControl || _this.selection.isInlineFormFillMode()) {\n        _this.owner.editorModule.pasteInternal(event);\n      }\n      _this.editableDiv.innerText = '';\n      event.preventDefault();\n    };\n    /**\n     * Fires when editable div loses focus.\n     *\n     * @private\n     * @returns {void}\n     */\n    this.onFocusOut = function () {\n      if (!isNullOrUndefined(_this.selection)) {\n        if (_this.owner.contextMenuModule && _this.owner.contextMenuModule.contextMenuInstance && _this.owner.contextMenuModule.contextMenuInstance.element.style.display === 'block') {\n          return;\n        }\n        _this.selection.hideCaret();\n      }\n    };\n    /**\n     * Updates focus to editor area.\n     *\n     * @private\n     * @returns {void}\n     */\n    this.updateFocus = function () {\n      if (_this.owner.enableCollaborativeEditing && _this.owner.editorModule.isRemoteAction) {\n        return;\n      }\n      if (!isNullOrUndefined(_this.currentSelectedComment) && !_this.owner.commentReviewPane.commentPane.isEditMode) {\n        if (_this.owner.commentReviewPane && _this.owner.commentReviewPane.commentPane.isEditMode) {\n          _this.owner.commentReviewPane.commentPane.selectComment(_this.currentSelectedComment);\n        }\n        _this.selection.hideCaret();\n        return;\n      }\n      if (_this.selection && !(_this.isMobileDevice && _this.owner.isReadOnly)) {\n        if (navigator !== undefined && !Browser.isDevice && !Browser.isIE && !navigator.userAgent.match('Edge') && !isNullOrUndefined(_this.iframe)) {\n          _this.iframe.focus();\n        }\n        if (!isNullOrUndefined(_this.editableDiv)) {\n          _this.editableDiv.focus();\n        }\n        _this.selection.showCaret();\n      }\n    };\n    /**\n     * Fires on scrolling.\n     *\n     * @returns {void}\n     */\n    this.scrollHandler = function () {\n      if (_this.scrollTimer) {\n        clearTimeout(_this.scrollTimer);\n      }\n      _this.clearContent();\n      _this.isScrollHandler = true;\n      if (!Browser.isDevice && !_this.isComposingIME) {\n        _this.iframe.style.top = _this.owner.viewer.containerTop + 'px';\n        _this.iframe.style.left = _this.owner.viewer.containerLeft + 'px';\n      }\n      if (_this.owner.hRuler) {\n        var hRuler = document.getElementById(_this.owner.element.id + '_hRulerBottom');\n        hRuler.style.top = _this.viewerContainer.scrollTop + 'px';\n        var markIndicator = document.getElementById(_this.owner.element.id + '_markIndicator');\n        if (markIndicator) {\n          markIndicator.style.top = _this.viewerContainer.scrollTop + 'px';\n        }\n      }\n      if (_this.owner.vRuler) {\n        var vRuler = document.getElementById(_this.owner.element.id + '_vRulerBottom');\n        vRuler.style.left = _this.viewerContainer.scrollLeft + 'px';\n        var markIndicator = document.getElementById(_this.owner.element.id + '_markIndicator');\n        if (markIndicator) {\n          markIndicator.style.left = _this.viewerContainer.scrollLeft + 'px';\n        }\n      }\n      if (_this.owner.rulerHelper && !isNullOrUndefined(_this.owner.rulerHelper.vRulerBottom)) {\n        _this.owner.rulerHelper.vRulerBottom.style.height = _this.pageContainer.offsetHeight + 'px';\n      }\n      _this.owner.viewer.updateScrollBars();\n      var vtHeight = _this.owner.viewer.containerTop + _this.visibleBounds.height - (_this.owner.viewer.padding.top + _this.owner.viewer.padding.bottom);\n      if (vtHeight > _this.pageContainer.offsetHeight) {\n        _this.viewerContainer.scrollTop = _this.owner.viewer.containerTop - (vtHeight - _this.pageContainer.offsetHeight);\n      }\n      if (_this.owner.viewer instanceof PageLayoutViewer && !isNullOrUndefined(_this.owner)) {\n        _this.owner.fireViewChange();\n      }\n      _this.isScrollHandler = false;\n      _this.scrollTimer = setTimeout(function () {\n        if (!_this.isScrollHandler && !isNullOrUndefined(_this.owner) && _this.owner.isSpellCheck) {\n          _this.isScrollToSpellCheck = true;\n          _this.owner.viewer.updateScrollBars();\n        }\n      }, 200);\n    };\n    /**\n     * Fires when the window gets resized.\n     *\n     * @private\n     * @returns {void}\n     */\n    this.onWindowResize = function () {\n      if (_this.resizeTimer) {\n        clearTimeout(_this.resizeTimer);\n      }\n      _this.resizeTimer = setTimeout(function () {\n        if (!isNullOrUndefined(_this.owner) && !isNullOrUndefined(_this.owner.element)) {\n          _this.updateViewerSize();\n          if (_this.owner.rulerHelper && _this.owner.documentEditorSettings && _this.owner.documentEditorSettings.showRuler) {\n            _this.owner.rulerHelper.updateRuler(_this.owner, true);\n          }\n          if (_this.owner.enableCollaborativeEditing && _this.owner.collaborativeEditingHandlerModule) {\n            _this.owner.collaborativeEditingHandlerModule.updateCaretPosition();\n          }\n          _this.clearContent();\n          _this.owner.viewer.updateScrollBars();\n          if (!isNullOrUndefined(_this.selection)) {\n            _this.selection.updateCaretPosition();\n          }\n          _this.updateTouchMarkPosition();\n          if (_this.owner.contextMenuModule && _this.owner.contextMenuModule.contextMenuInstance) {\n            _this.owner.contextMenuModule.contextMenuInstance.close();\n          }\n          if (_this.resizeTimer) {\n            clearTimeout(_this.resizeTimer);\n          }\n        }\n      }, 200);\n    };\n    /**\n     * @private\n     * @param {MouseEvent} event - Specified mouse event.\n     * @returns {void}\n     */\n    this.onContextMenu = function (event) {\n      if (_this.owner.contextMenuModule) {\n        if (_this.isMouseDown) {\n          _this.isMouseDown = false;\n        }\n        _this.owner.contextMenuModule.onContextMenuInternal(event);\n        _this.updateFocus();\n      }\n    };\n    /**\n     * Called on mouse down.\n     *\n     * @private\n     * @param {MouseEvent} event - Specifies mouse event.\n     * @returns {void}\n     */\n    this.onMouseDownInternal = function (event) {\n      var target = event.target;\n      _this.owner.focusIn();\n      if (!isNullOrUndefined(target) && target !== _this.viewerContainer || _this.owner.isTableMarkerDragging || _this.isTouchInput || event.offsetX > _this.visibleBounds.width - (_this.visibleBounds.width - _this.viewerContainer.clientWidth) || event.offsetY > _this.visibleBounds.height - (_this.visibleBounds.height - _this.viewerContainer.clientHeight)) {\n        return;\n      }\n      _this.isFootnoteWidget = false;\n      if (!isNullOrUndefined(_this.selection)) {\n        _this.updateCursor(event);\n        if (_this.formFillPopup) {\n          _this.formFillPopup.hidePopup();\n        }\n        if (_this.isLeftButtonPressed(event) && !_this.owner.isReadOnlyMode && _this.owner.enableImageResizerMode && !isNullOrUndefined(_this.owner.imageResizerModule.selectedResizeElement)) {\n          if (_this.selection.isInShape) {\n            var textFram = _this.owner.selectionModule.getCurrentTextFrame();\n            var shape = textFram.containerShape;\n            _this.selection.selectShape(shape);\n          }\n          _this.owner.imageResizerModule.isImageResizing = true;\n        }\n        event.preventDefault();\n        if (!_this.isTouchInput) {\n          _this.selection.hideCaret();\n        }\n        var cursorPoint = new Point(event.offsetX, event.offsetY);\n        var touchPoint = _this.owner.viewer.findFocusedPage(cursorPoint, true, true);\n        _this.mouseDownOffset.x = touchPoint.x;\n        _this.mouseDownOffset.y = touchPoint.y;\n        _this.isMouseDownInFooterRegion = _this.selection.isCursorInsidePageRect(cursorPoint, _this.currentPage) && _this.selection.isCursorInFooterRegion(cursorPoint, _this.currentPage);\n        _this.isSelectionChangedOnMouseMoved = false;\n        if (!_this.owner.isReadOnlyMode && (_this.owner.editorModule.tableResize.isInCellResizerArea(touchPoint) || _this.owner.editorModule.tableResize.isInRowResizerArea(touchPoint))) {\n          _this.selection.hideCaret();\n          _this.isMouseDown = true;\n          _this.isSelectionChangedOnMouseMoved = false;\n          if (_this.isLeftButtonPressed(event)) {\n            _this.owner.editorModule.tableResize.startingPoint.x = touchPoint.x;\n            _this.owner.editorModule.tableResize.startingPoint.y = touchPoint.y;\n            _this.owner.editorModule.tableResize.handleResize(touchPoint);\n          }\n          return;\n        }\n        if (event.ctrlKey) {\n          _this.isControlPressed = true;\n        }\n        if (_this.owner.selectionModule.isEmpty) {\n          _this.useTouchSelectionMark = false;\n        }\n        var widget = _this.getLineWidget(touchPoint);\n        if (event.which === 3 && !_this.owner.selectionModule.isEmpty && _this.selection.checkCursorIsInSelection(widget, touchPoint)) {\n          event.preventDefault();\n          return;\n        }\n        if (_this.owner && _this.owner.documentEditorSettings && _this.owner.documentEditorSettings.allowDragAndDrop && !_this.owner.selectionModule.isEmpty && _this.selection.checkCursorIsInSelection(widget, touchPoint)) {\n          _this.isMouseDownInSelection = true;\n        }\n        _this.isTouchInput = false;\n        _this.isMouseDown = true;\n        _this.updateFocus();\n        /* eslint-disable @typescript-eslint/indent */\n        _this.timer = setTimeout(function () {\n          _this.tapCount++;\n          if (_this.tapCount > 1) {\n            _this.tapCount = 1;\n          }\n          if (!_this.isScrollHandler && !isNullOrUndefined(_this.owner) && _this.owner.isSpellCheck) {\n            _this.isScrollToSpellCheck = true;\n            _this.owner.viewer.updateScrollBars();\n          }\n        }, 100);\n      }\n    };\n    /**\n     * Called on mouse move.\n     *\n     * @private\n     * @param {MouseEvent} event - Specified mouse event.\n     * @returns {void}\n     */\n    this.onMouseMoveInternal = function (event) {\n      if (!isNullOrUndefined(event.target) && event.target !== _this.viewerContainer || _this.owner.isTableMarkerDragging) {\n        return;\n      }\n      event.preventDefault();\n      if (!isNullOrUndefined(_this.selection)) {\n        //For image Resizing\n        if (!_this.owner.isReadOnlyMode && _this.owner.enableImageResizerMode && _this.owner.imageResizerModule.isImageResizing) {\n          if (!_this.owner.imageResizerModule.isImageMoveToNextPage) {\n            _this.owner.imageResizerModule.handleImageResizingOnMouse(event);\n          }\n          return;\n        }\n        var cursorPoint = new Point(event.offsetX, event.offsetY);\n        var touchPoint = _this.owner.viewer.findFocusedPage(cursorPoint, !_this.owner.enableHeaderAndFooter);\n        var widget = _this.getLineWidget(touchPoint);\n        if (_this.isMouseDown) {\n          if (!isNullOrUndefined(_this.currentPage)) {\n            var xPosition = touchPoint.x;\n            var yPosition = touchPoint.y;\n            if (!_this.owner.isReadOnlyMode && _this.isRowOrCellResizing) {\n              var table = _this.owner.editorModule.tableResize.currentResizingTable;\n              var startPosition = _this.selection.setPositionForBlock(table, true);\n              var endPosition = _this.selection.setPositionForBlock(table, false);\n              if (!_this.owner.documentHelper.isDocumentProtected || _this.selection.checkSelectionIsAtEditRegion(startPosition, endPosition)) {\n                _this.owner.editorModule.tableResize.handleResizing(touchPoint);\n              }\n            } else {\n              if (!_this.isDragStarted && _this.isMouseDownInSelection && _this.isLeftButtonPressed(event) && !_this.owner.selectionModule.isEmpty && _this.selection.checkCursorIsInSelection(widget, touchPoint) || !_this.owner.isReadOnlyMode && _this.owner.enableImageResizerMode && !_this.isDragStarted && _this.isLeftButtonPressed(event) && !_this.owner.selectionModule.isEmpty && !isNullOrUndefined(widget) && _this.owner.imageResizerModule.selectedImageWidget.containsKey(widget) && !_this.owner.imageResizerModule.isImageResizing) {\n                _this.isDragStarted = true;\n                _this.isMouseDownInSelection = false;\n                if (_this.selection.isForward) {\n                  _this.dragStartParaInfo = _this.selection.getParagraphInfo(_this.selection.start);\n                  _this.dragEndParaInfo = _this.selection.getParagraphInfo(_this.selection.end);\n                } else {\n                  _this.dragStartParaInfo = _this.selection.getParagraphInfo(_this.selection.end);\n                  _this.dragEndParaInfo = _this.selection.getParagraphInfo(_this.selection.start);\n                }\n                _this.selection.caret.classList.remove(\"e-de-cursor-animation\");\n              }\n              if (!(_this.isTouchInput || _this.isSelectionChangedOnMouseMoved || _this.touchDownOnSelectionMark > 0 || _this.isDragStarted)) {\n                _this.updateTextPositionForSelection(touchPoint, 1);\n              }\n              if (_this.isLeftButtonPressed(event) && !_this.isDragStarted) {\n                event.preventDefault();\n                var touchY = yPosition;\n                var textPosition = _this.owner.selectionModule.end;\n                var touchPoint_1 = new Point(xPosition, touchY);\n                if (!_this.owner.enableImageResizerMode || !_this.owner.imageResizerModule.isImageResizerVisible || _this.owner.imageResizerModule.isShapeResize) {\n                  _this.isCompleted = false;\n                  _this.owner.selectionModule.moveTextPosition(touchPoint_1, textPosition);\n                }\n                _this.isSelectionChangedOnMouseMoved = true;\n              }\n              if (_this.isDragStarted && _this.isLeftButtonPressed(event)) {\n                _this.autoScrollOnSelection(cursorPoint);\n                _this.selection.updateTextPosition(widget, touchPoint);\n              }\n            }\n          }\n          _this.selection.checkForCursorVisibility();\n        }\n        if (!_this.isRowOrCellResizing && !_this.isSelectionChangedOnMouseMoved) {\n          _this.updateCursor(event);\n        }\n        if (_this.isRowOrCellResizing) {\n          _this.selection.hideCaret();\n        }\n      }\n    };\n    /**\n     * @private\n     * @param {MouseEvent} event - Specifies mouse event\n     * @returns {void}\n     */\n    this.onMouseLeaveInternal = function (event) {\n      event.preventDefault();\n      var cursorPoint = new Point(event.offsetX, event.offsetY);\n      if (_this.isMouseDown) {\n        var viewerTop = _this.viewerContainer.scrollTop;\n        clearInterval(_this.scrollMoveTimer);\n        if (event.offsetY + viewerTop > viewerTop) {\n          _this.scrollMoveTimer = setInterval(function () {\n            _this.scrollForwardOnSelection(cursorPoint);\n          }, 100);\n        } else {\n          _this.scrollMoveTimer = setInterval(function () {\n            _this.scrollBackwardOnSelection(cursorPoint);\n          }, 100);\n        }\n        if (_this.isMouseEntered) {\n          _this.isMouseEntered = false;\n        }\n      }\n      if (_this.isDragStarted) {\n        _this.selection.hideCaret();\n        if (_this.scrollMoveTimer) {\n          clearInterval(_this.scrollMoveTimer);\n          _this.scrollMoveTimer = 0;\n        }\n      }\n    };\n    /**\n     * @private\n     * @returns {void}\n     */\n    this.onMouseEnterInternal = function (event) {\n      if (!_this.isMouseEntered) {\n        _this.owner.viewer.updateScrollBars();\n      }\n      _this.isMouseEntered = true;\n      if (_this.scrollMoveTimer) {\n        clearInterval(_this.scrollMoveTimer);\n      }\n      if (!_this.isLeftButtonPressed(event) && _this.isDragStarted) {\n        if (!_this.selection.caret.classList.contains(\"e-de-cursor-animation\")) {\n          _this.selection.caret.classList.add(\"e-de-cursor-animation\");\n        }\n        _this.isDragStarted = false;\n      }\n      if (!_this.isLeftButtonPressed(event) && _this.isMouseDown) {\n        _this.onMouseUpInternal(event);\n      }\n    };\n    /**\n     * Fired on double tap.\n     *\n     * @private\n     * @param {MouseEvent} event - Specifies mouse event.\n     * @returns {void}\n     */\n    this.onDoubleTap = function (event) {\n      _this.owner.focusIn();\n      if (!isNullOrUndefined(event.target) && event.target !== _this.viewerContainer) {\n        return;\n      }\n      if (!isNullOrUndefined(_this.selection)) {\n        _this.isTouchInput = false;\n        var cursorPoint = new Point(event.offsetX, event.offsetY);\n        var touchPoint = _this.owner.viewer.findFocusedPage(cursorPoint, true);\n        if (_this.selection.checkAndEnableHeaderFooter(cursorPoint, _this.owner.viewer.findFocusedPage(cursorPoint, true))) {\n          return;\n        }\n        var widget = _this.getLineWidget(touchPoint);\n        var formField = _this.selection.getHyperLinkFieldInCurrentSelection(widget, touchPoint, true);\n        if (isNullOrUndefined(formField)) {\n          formField = _this.selection.getCurrentFormField();\n        }\n        if (!_this.isDocumentProtected && _this.owner.enableFormField && !_this.owner.isReadOnlyMode) {\n          var formatType = _this.selection.getFormFieldType(formField);\n          if (formatType) {\n            if (formatType.toString() !== '') {\n              _this.selection.selectField(formField);\n            }\n            switch (formatType) {\n              case 'Text':\n                _this.owner.textFormFieldDialogModule.show();\n                break;\n              case 'CheckBox':\n                _this.owner.checkBoxFormFieldDialogModule.show();\n                break;\n              case 'DropDown':\n                _this.owner.dropDownFormFieldDialogModule.show();\n                break;\n            }\n          }\n        } else if (_this.isDocumentProtected && formField && formField.formFieldData instanceof TextFormField && formField.formFieldData.type === 'Text') {\n          _this.selection.selectField();\n        }\n        var startPosition = _this.selection.start.clone();\n        var endPosition = _this.selection.end.clone();\n        var inlineObj = startPosition.currentWidget.getInline(startPosition.offset, 0);\n        var inline = inlineObj.element;\n        if (_this.owner.layoutType === 'Pages') {\n          if (inline instanceof FootnoteElementBox) {\n            if (inline.footnoteType === 'Footnote') {\n              var footnotes = _this.currentPage.footnoteWidget;\n              var i = void 0;\n              for (i = 0; i <= footnotes.bodyWidgets.length; i++) {\n                var footnoteText = footnotes.bodyWidgets[i].footNoteReference;\n                if (inline.text === footnoteText.text) {\n                  break;\n                }\n              }\n              startPosition.setPositionParagraph(footnotes.bodyWidgets[i].childWidgets[0].childWidgets[0], 0);\n              endPosition.setPositionParagraph(footnotes.bodyWidgets[i].childWidgets[0].childWidgets[0], 0);\n              _this.selection.selectRange(startPosition, endPosition);\n            } else {\n              var endnotes = _this.pages[_this.pages.length - 1].endnoteWidget;\n              var i = void 0;\n              if (!isNullOrUndefined(endnotes)) {\n                for (i = 0; i <= endnotes.childWidgets.length; i++) {\n                  var endnoteText = endnotes.bodyWidgets[i].footNoteReference;\n                  if (inline.text === endnoteText.text) {\n                    break;\n                  }\n                }\n              }\n              startPosition.setPositionParagraph(endnotes.bodyWidgets[i].childWidgets[0].childWidgets[0], 0);\n              endPosition.setPositionParagraph(endnotes.bodyWidgets[i].childWidgets[0].childWidgets[0], 0);\n              _this.selection.selectRange(startPosition, endPosition);\n            }\n          } else {\n            if (inline instanceof TextElementBox && (_this.selection.isinEndnote || _this.selection.isinFootnote)) {\n              _this.selection.footnoteReferenceElement(startPosition, endPosition, inline);\n            }\n          }\n        }\n        if (_this.selection.isEmpty && !isNullOrUndefined(_this.currentPage) && !isNullOrUndefined(_this.owner.selectionModule.start)) {\n          _this.owner.selectionModule.selectCurrentWord();\n          _this.selection.checkForCursorVisibility();\n          _this.tapCount = 2;\n        }\n      }\n    };\n    /**\n     * Called on mouse up.\n     *\n     * @private\n     * @param {MouseEvent} event - Specifies mouse event.\n     * @return {void}\n     */\n    /* eslint-disable  */\n    this.onMouseUpInternal = function (event) {\n      if (!isNullOrUndefined(event.target) && event.target !== _this.viewerContainer || _this.owner.isTableMarkerDragging) {\n        return;\n      }\n      event.preventDefault();\n      _this.isListTextSelected = false;\n      var cursorPoint = new Point(event.offsetX, event.offsetY);\n      var touchPoint = _this.owner.viewer.findFocusedPage(cursorPoint, true);\n      if (!isNullOrUndefined(_this.selection)) {\n        var tapCount = 1;\n        if (!Browser.isIE) {\n          if (event.detail > 2) {\n            tapCount = event.detail;\n          }\n        } else {\n          tapCount = _this.tapCount;\n        }\n        if (_this.isRowOrCellResizing) {\n          _this.owner.editorModule.tableResize.updateResizingHistory(touchPoint);\n        }\n        if (_this.isMouseDown && !_this.isSelectionChangedOnMouseMoved && !isNullOrUndefined(_this.currentPage) && !isNullOrUndefined(_this.owner.selectionModule.start) && (!_this.owner.enableImageResizerMode || !_this.owner.imageResizerModule.isImageResizing)) {\n          if (_this.touchDownOnSelectionMark === 0 && !_this.isRowOrCellResizing) {\n            var isShiftKeyPressed = event.shiftKey;\n            if (isShiftKeyPressed) {\n              var textPosition = _this.owner.selectionModule.end;\n              _this.owner.selectionModule.moveTextPosition(touchPoint, textPosition);\n            } else {\n              _this.updateTextPositionForSelection(touchPoint, tapCount);\n            }\n            if (Browser.isIE && tapCount === 2) {\n              _this.selection.checkAndEnableHeaderFooter(cursorPoint, touchPoint);\n            }\n          }\n          _this.selection.checkForCursorVisibility();\n          if (!isNullOrUndefined(_this.currentSelectedComment) && _this.owner.commentReviewPane && !_this.owner.commentReviewPane.commentPane.isEditMode) {\n            _this.currentSelectedComment = undefined;\n          }\n        }\n        var isCtrlkeyPressed = _this.isIosDevice ? event.metaKey : event.ctrlKey;\n        if (!isNullOrUndefined(_this.currentPage) && !isNullOrUndefined(_this.owner.selectionModule.start) && (_this.owner.selectionModule.isEmpty || _this.owner.selectionModule.isImageSelected) && (isCtrlkeyPressed && _this.owner.useCtrlClickToFollowHyperlink || !_this.owner.useCtrlClickToFollowHyperlink) && _this.isLeftButtonPressed(event) === true) {\n          _this.selection.navigateHyperLinkOnEvent(touchPoint, false);\n        }\n        if (_this.isMouseDown && _this.isLeftButtonPressed(event) && _this.isDocumentProtected && _this.protectionType === 'FormFieldsOnly' && _this.selection) {\n          var widget = _this.getLineWidget(touchPoint);\n          var formField = _this.selection.getHyperLinkFieldInCurrentSelection(widget, touchPoint, true);\n          if (isNullOrUndefined(formField)) {\n            formField = _this.selection.getCurrentFormField(true);\n          }\n          if (formField && formField.formFieldData && formField.formFieldData.enabled && !_this.selection.isInlineFormFillMode(formField)) {\n            var data = {\n              'fieldName': formField.formFieldData.name\n            };\n            if (formField.formFieldData instanceof TextFormField) {\n              data.value = formField.resultText;\n            } else if (formField.formFieldData instanceof CheckBoxFormField) {\n              data.value = formField.formFieldData.checked;\n            } else {\n              data.value = formField.formFieldData.selectedIndex;\n            }\n            data.isCanceled = false;\n            if (_this.owner.documentEditorSettings.formFieldSettings.formFillingMode === 'Popup' && _this.selection.previousSelectedFormField !== _this.selection.getCurrentFormField()) {\n              _this.owner.trigger(beforeFormFieldFillEvent, data);\n            } else {\n              _this.owner.trigger(beforeFormFieldFillEvent, data);\n            }\n            if (!data.isCanceled) {\n              if (_this.owner.documentEditorSettings.formFieldSettings.formFillingMode === 'Popup' && !(formField.formFieldData instanceof CheckBoxFormField) || formField.formFieldData instanceof TextFormField && !(formField.formFieldData.type === 'Text') || formField.formFieldData instanceof DropDownFormField) {\n                _this.formFillPopup.showPopUp(formField);\n              } else {\n                _this.owner.editorModule.toggleCheckBoxFormField(formField);\n                data.value = formField.formFieldData.checked;\n                data.isCanceled = false;\n                _this.owner.trigger(afterFormFieldFillEvent, data);\n              }\n            }\n          }\n          if (!formField && _this.isFormFillProtectedMode) {\n            _this.selection.navigateToNextFormField();\n          }\n        } else if (_this.isMouseDown) {\n          if (_this.formFields.length > 0) {\n            var formField = _this.selection.getCurrentFormField(true);\n            if (formField && formField.formFieldData instanceof TextFormField) {\n              _this.selection.selectField();\n            } else if (_this.isLeftButtonPressed(event) && formField && formField.formFieldData instanceof DropDownFormField) {\n              var offset = formField.line.getOffset(formField, 0);\n              var point = _this.selection.getPhysicalPositionInternal(formField.line, offset, false);\n              _this.selection.selectInternal(formField.line, formField, 0, point);\n            }\n          }\n          if (_this.isSelectionChangedOnMouseMoved) {\n            _this.selection.fireSelectionChanged(true);\n          }\n        }\n        if (!_this.owner.isReadOnlyMode && _this.isSelectionInListText(touchPoint)) {\n          _this.selection.selectListText();\n        }\n        if (!_this.owner.isReadOnlyMode && _this.owner.enableImageResizerMode && _this.owner.imageResizerModule.isImageResizing) {\n          _this.owner.imageResizerModule.mouseUpInternal();\n          _this.scrollToPosition(_this.owner.selectionModule.start, _this.owner.selectionModule.end);\n          _this.owner.imageResizerModule.isImageResizing = false;\n        }\n        if (_this.owner.enableImageResizerMode && _this.owner.imageResizerModule.isImageResizerVisible && !isNullOrUndefined(_this.selection.caret)) {\n          _this.selection.caret.style.display = 'none';\n        }\n        if (_this.isDragStarted) {\n          _this.isDragging = true;\n          _this.moveSelectedContent();\n          _this.isDragging = false;\n        }\n        if (_this.isMouseDown) {\n          _this.updateFocus();\n        }\n        _this.isMouseDownInSelection = false;\n        _this.isMouseDown = false;\n        _this.isFootnoteWidget = false;\n        _this.isSelectionChangedOnMouseMoved = false;\n        _this.isTouchInput = false;\n        _this.useTouchSelectionMark = true;\n        _this.isControlPressed = false;\n        if (_this.isListTextSelected) {\n          _this.selection.hideCaret();\n        }\n        if (_this.owner.enableImageResizerMode) {\n          var imageResizer = _this.owner.imageResizerModule;\n          imageResizer.isImageResizing = false;\n          imageResizer.isImageMoveToNextPage = false;\n          imageResizer.leftValue = undefined;\n          imageResizer.topValue = undefined;\n        }\n        _this.isMouseDownInFooterRegion = false;\n      }\n      if (_this.selection) {\n        _this.selection.isCellPrevSelected = false;\n      }\n    };\n    /**\n     * Fired on touch start.\n     *\n     * @private\n     * @param {TouchEvent} event - Specifies touch event.\n     * @returns {void}\n     */\n    this.onTouchStartInternal = function (event) {\n      if (_this.selection) {\n        _this.isTouchMoved = false;\n        _this.isCompositionStart = false;\n        _this.isCompositionEnd = false;\n        _this.isCompositionUpdated = false;\n        _this.isCompositionCanceled = true;\n        _this.isTouchInput = true;\n        if (_this.isTimerStarted) {\n          if (_this.tapCount === 1) {\n            _this.tapCount = 2;\n          } else {\n            _this.tapCount = 3;\n            _this.isTimerStarted = false;\n          }\n        } else {\n          _this.isTimerStarted = true;\n          _this.tapCount = 1;\n        }\n        if (event.touches.length === 1) {\n          _this.zoomX = event.touches[0].clientX;\n          _this.zoomY = event.touches[0].clientY;\n          if (_this.owner.selectionModule.isEmpty) {\n            _this.useTouchSelectionMark = false;\n          }\n          _this.isMouseDown = true;\n          _this.isSelectionChangedOnMouseMoved = false;\n          var point = void 0;\n          if (_this.isMouseDown) {\n            point = _this.getTouchOffsetValue(event);\n          }\n          point = _this.owner.viewer.findFocusedPage(point, true, true);\n          if (_this.owner.enableImageResizerMode) {\n            var resizeObj = _this.owner.imageResizerModule.getImagePointOnTouch(point);\n            _this.owner.imageResizerModule.selectedResizeElement = resizeObj.selectedElement;\n          }\n          if (_this.owner.enableImageResizerMode && !isNullOrUndefined(_this.owner.imageResizerModule.selectedResizeElement)) {\n            _this.owner.imageResizerModule.isImageResizing = true;\n          }\n          if (Browser.isDevice) {\n            _this.editableDiv.contentEditable = _this.owner.isReadOnlyMode ? 'false' : 'true';\n          }\n          var x = _this.owner.selectionModule.end.location.x;\n          var y = _this.selection.getCaretBottom(_this.owner.selectionModule.end, _this.owner.selectionModule.isEmpty) + 9;\n          //TouchDownOnSelectionMark will be 2 when touch end is pressed\n          _this.touchDownOnSelectionMark = (point.y <= y && point.y >= y - 20 || point.y >= y && point.y <= y + 20) && (point.x <= x && point.x >= x - 20 || point.x >= x && point.x <= x + 20) ? 1 : 0;\n          if (!_this.owner.selectionModule.isEmpty && _this.touchDownOnSelectionMark === 0) {\n            x = _this.owner.selectionModule.start.location.x;\n            y = _this.selection.getCaretBottom(_this.owner.selectionModule.start, false) + 9;\n            //TouchDownOnSelectionMark will be 1 when touch start is pressed\n            _this.touchDownOnSelectionMark = (point.y <= y && point.y >= y - 20 || point.y >= y && point.y <= y + 20) && (point.x <= x && point.x >= x - 20 || point.x >= x && point.x <= x + 20) ? 2 : 0;\n          }\n        }\n        if (!isNullOrUndefined(_this.owner.contextMenuModule) && _this.owner.contextMenuModule.contextMenuInstance) {\n          _this.owner.contextMenuModule.contextMenuInstance.close();\n        }\n        if (_this.touchDownOnSelectionMark || event.touches.length > 1) {\n          event.preventDefault();\n        }\n        _this.longTouchTimer = setTimeout(_this.onLongTouch, 500, event);\n        _this.timer = setTimeout(function () {\n          _this.isTimerStarted = false;\n        }, 200);\n        _this.owner.focusIn();\n      }\n    };\n    /**\n     * Fired on long touch\n     *\n     * @private\n     * @param {TouchEvent} event - Specifies touch event.\n     * @returns {void}\n     */\n    this.onLongTouch = function (event) {\n      if (isNullOrUndefined(_this.owner) || isNullOrUndefined(_this.viewerContainer) || _this.isTouchMoved || event.touches.length !== 1) {\n        return;\n      }\n      var point = _this.getTouchOffsetValue(event);\n      var pointRelToPage = _this.owner.viewer.findFocusedPage(point, true);\n      var selStart = _this.selection.start;\n      var selEnd = _this.selection.end;\n      var updateSel = false;\n      if (!_this.selection.isForward) {\n        selStart = _this.selection.end;\n        selEnd = _this.selection.start;\n      }\n      var selStartPt = selStart.location;\n      var selEndPt = selEnd.location;\n      if (selStart.currentWidget !== selEnd.currentWidget) {\n        updateSel = !(pointRelToPage.x >= selStartPt.x && pointRelToPage.x <= selEndPt.x) && !(pointRelToPage.y >= selStartPt.y && pointRelToPage.y <= selEndPt.y);\n      } else {\n        updateSel = !(pointRelToPage.x >= selStartPt.x && pointRelToPage.x <= selEndPt.x) || !(pointRelToPage.y >= selStartPt.y && pointRelToPage.y <= selEndPt.y);\n      }\n      if (event.changedTouches.length === 1 && updateSel) {\n        _this.updateSelectionOnTouch(point, pointRelToPage);\n        _this.isMouseDown = false;\n        _this.touchDownOnSelectionMark = 0;\n        _this.useTouchSelectionMark = true;\n        _this.isSelectionChangedOnMouseMoved = false;\n      }\n      if (_this.selection.isEmpty) {\n        _this.selection.selectCurrentWord();\n      }\n      if (!isNullOrUndefined(_this.owner.contextMenuModule) && _this.owner.contextMenuModule.contextMenuInstance) {\n        _this.owner.contextMenuModule.onContextMenuInternal(event);\n      }\n    };\n    /**\n     *\n     * @private\n     * @param {TouchEvent} event - Specifies touch event.\n     * @returns {void}\n     */\n    this.onTouchMoveInternal = function (event) {\n      _this.isTouchMoved = true;\n      var touch = event.touches;\n      var cursorPoint;\n      if (!isNullOrUndefined(_this.selection)) {\n        if (_this.owner.editorModule && _this.owner.enableImageResizerMode && _this.owner.imageResizerModule.isImageResizing) {\n          event.preventDefault();\n          if (!_this.owner.imageResizerModule.isImageMoveToNextPage) {\n            _this.owner.imageResizerModule.handleImageResizingOnTouch(event);\n            _this.selection.caret.style.display = 'none';\n          }\n          return;\n        }\n        if (_this.isMouseDown) {\n          cursorPoint = _this.getTouchOffsetValue(event);\n          var touchPoint = _this.owner.viewer.findFocusedPage(cursorPoint, true);\n          if (_this.touchDownOnSelectionMark > 0 /*|| !this.useTouchSelectionMark*/) {\n            _this.isCompleted = false;\n            event.preventDefault();\n            var touchY = touchPoint.y;\n            var textPosition = _this.owner.selectionModule.end;\n            var touchPointer = void 0;\n            if (touchPoint.y <= 26) {\n              touchY -= touchPoint.y < 0 ? 0 : touchPoint.y + 0.5;\n            } else {\n              touchY -= 36.5;\n            }\n            textPosition = _this.touchDownOnSelectionMark === 2 ? _this.selection.start : _this.selection.end;\n            touchPoint = new Point(touchPoint.x, touchY);\n            _this.owner.selectionModule.moveTextPosition(touchPoint, textPosition);\n            _this.isSelectionChangedOnMouseMoved = true;\n          }\n          _this.selection.checkForCursorVisibility();\n          _this.updateTouchMarkPosition();\n        }\n      }\n      if (touch.length > 1) {\n        event.preventDefault();\n        _this.isMouseDown = false;\n        _this.zoomX = (touch[0].clientX + touch[1].clientX) / 2;\n        _this.zoomY = (touch[0].clientY + touch[1].clientY) / 2;\n        var currentDiff = Math.sqrt(Math.pow(touch[0].clientX - touch[1].clientX, 2) + Math.pow(touch[0].clientY - touch[1].clientY, 2));\n        if (_this.preDifference > -1) {\n          if (currentDiff > _this.preDifference) {\n            _this.onPinchOutInternal(event);\n          } else if (currentDiff < _this.preDifference) {\n            _this.onPinchInInternal(event);\n          }\n        } else if (_this.zoomFactor < 2) {\n          if (_this.preDifference !== -1) {\n            if (currentDiff > _this.preDifference) {\n              _this.onPinchInInternal(event);\n            }\n          }\n        } else if (_this.preDifference === -1) {\n          if (_this.zoomFactor > 2) {\n            if (currentDiff > _this.preDifference) {\n              _this.onPinchInInternal(event);\n            }\n          }\n        }\n        _this.preDifference = currentDiff;\n      }\n      if (_this.longTouchTimer) {\n        clearTimeout(_this.longTouchTimer);\n        _this.longTouchTimer = undefined;\n      }\n    };\n    /**\n     * Fired on touch up.\n     *\n     * @private\n     * @param {TouchEvent} event - Specifies touch event.\n     * @returns {void}\n     */\n    this.onTouchUpInternal = function (event) {\n      if (!isNullOrUndefined(_this.selection)) {\n        var point = _this.getTouchOffsetValue(event);\n        var touchPoint = _this.owner.viewer.findFocusedPage(point, true);\n        if (event.changedTouches.length === 1) {\n          if (!_this.isTouchMoved || _this.owner.enableImageResizerMode && _this.owner.imageResizerModule.isImageResizing) {\n            _this.updateSelectionOnTouch(point, touchPoint);\n            if (!isNullOrUndefined(_this.currentPage) && !isNullOrUndefined(_this.selection.start) && !_this.isSelectionChangedOnMouseMoved && (_this.selection.isEmpty || _this.selection.isImageField() && (!_this.owner.enableImageResizerMode || _this.owner.enableImageResizerMode && !_this.owner.imageResizerModule.isImageResizing))) {\n              _this.selection.navigateHyperLinkOnEvent(touchPoint, true);\n            }\n          }\n          if (_this.isSelectionChangedOnMouseMoved) {\n            _this.selection.fireSelectionChanged(true);\n          }\n          _this.isMouseDown = false;\n          _this.touchDownOnSelectionMark = 0;\n          _this.useTouchSelectionMark = true;\n          _this.isSelectionChangedOnMouseMoved = false;\n        }\n        if (_this.owner.enableImageResizerMode && _this.owner.imageResizerModule.isImageResizing) {\n          _this.owner.imageResizerModule.mouseUpInternal();\n          _this.owner.imageResizerModule.isImageResizing = false;\n          _this.owner.imageResizerModule.isImageMoveToNextPage = false;\n          _this.scrollToPosition(_this.owner.selectionModule.start, _this.owner.selectionModule.end);\n        }\n        if (_this.owner.enableImageResizerMode && _this.owner.imageResizerModule.isImageResizerVisible && _this.isTouchInput) {\n          _this.touchStart.style.display = 'none';\n          _this.touchEnd.style.display = 'none';\n        }\n        // if (!this.owner.isReadOnlyMode && this.isSelectionInListText(touchPoint)) {\n        //     this.selection.selectListText();\n        // }\n        event.preventDefault();\n      }\n      _this.preDifference = -1;\n      _this.isTouchInput = false;\n      if (_this.longTouchTimer) {\n        clearTimeout(_this.longTouchTimer);\n        _this.longTouchTimer = undefined;\n      }\n      if (!_this.isTimerStarted) {\n        _this.tapCount = 1;\n      }\n      if (_this.isListTextSelected) {\n        _this.selection.hideCaret();\n      }\n      _this.owner.focusIn();\n    };\n    /**\n     * Fired on keyup event.\n     *\n     * @private\n     * @param {KeyboardEvent} event - Specifies keyboard event.\n     * @returns {void}\n     */\n    this.onKeyUpInternal = function (event) {\n      if (Browser.isDevice && event.target === _this.editableDiv) {\n        if (window.getSelection().anchorOffset !== _this.prefix.length) {\n          _this.selection.setEditableDivCaretPosition(_this.editableDiv.innerText.length);\n        }\n      }\n      if (event.ctrlKey || event.keyCode === 17 || event.which === 17) {\n        _this.isControlPressed = false;\n      }\n    };\n    /**\n     * Fired on keydown.\n     *\n     * @private\n     * @param {KeyboardEvent} event - Specifies keyboard event.\n     * @returns {void}\n     */\n    this.onKeyDownInternal = function (event) {\n      if (!isNullOrUndefined(event.target) && event.target !== _this.editableDiv) {\n        return;\n      }\n      _this.owner.focusIn();\n      var isHandled = false;\n      var keyEventArgs = {\n        'event': event,\n        'isHandled': false,\n        source: _this.owner\n      };\n      _this.owner.trigger(keyDownEvent, keyEventArgs);\n      if (keyEventArgs.isHandled) {\n        return;\n      }\n      var key = event.which || event.keyCode;\n      var ctrl = event.ctrlKey || event.metaKey ? true : key === 17 ? true : false; // ctrl detection       \n      var shift = event.shiftKey ? event.shiftKey : key === 16 ? true : false; // Shift Key detection        \n      var alt = event.altKey ? event.altKey : key === 18 ? true : false; // alt key detection\n      if (ctrl && !shift && !alt) {\n        switch (key) {\n          case 80:\n            event.preventDefault();\n            _this.owner.print();\n            isHandled = true;\n            break;\n          case 83:\n            event.preventDefault();\n            _this.owner.save(_this.owner.documentName === '' ? 'sample' : _this.owner.documentName, 'Sfdt');\n            isHandled = true;\n            break;\n        }\n      }\n      if (!isHandled && !isNullOrUndefined(_this.selection)) {\n        _this.selection.onKeyDownInternal(event, ctrl, shift, alt);\n      }\n      if (isHandled) {\n        event.preventDefault();\n      }\n      _this.timer = setTimeout(function () {\n        if (!_this.isScrollHandler && !isNullOrUndefined(_this.owner) && _this.owner.isSpellCheck) {\n          _this.isScrollToSpellCheck = true;\n          _this.owner.viewer.updateScrollBars();\n        }\n      }, 100);\n    };\n    this.owner = owner;\n    this.pages = [];\n    this.lists = [];\n    this.abstractLists = [];\n    this.render = new Renderer(this);\n    this.characterFormat = new WCharacterFormat(this);\n    this.themeFontLanguage = new WCharacterFormat(this);\n    this.paragraphFormat = new WParagraphFormat(this);\n    this.renderedLists = new Dictionary();\n    this.renderedLevelOverrides = [];\n    this.headersFooters = [];\n    this.styles = new WStyles();\n    this.stylesMap = new Dictionary();\n    if (this.owner) {\n      this.L10n = new L10n('documenteditor', this.owner.defaultLocale);\n      this.L10n.setLocale(this.owner.locale);\n    }\n    this.preDefinedStyles = new Dictionary();\n    this.initalizeStyles();\n    this.bookmarks = new Dictionary();\n    this.editRanges = new Dictionary();\n    this.isIosDevice = typeof window !== 'undefined' ? /Mac|iPad|iPod/i.test(navigator.userAgent) : false;\n    this.isMobileDevice = typeof window !== 'undefined' ? /Android|Windows Phone|webOS/i.test(navigator.userAgent) : false;\n    this.formFillPopup = new FormFieldPopUp(this.owner);\n    this.customXmlData = new Dictionary();\n    this.fontSubstitutionTable = new Dictionary();\n    this.contentControlCollection = [];\n    this.footnoteCollection = [];\n    this.endnoteCollection = [];\n    this.themes = new Themes();\n    this.images = new Dictionary();\n  }\n  Object.defineProperty(DocumentHelper.prototype, \"visibleBounds\", {\n    /**\n     * Gets visible bounds.\n     *\n     * @private\n     * @returns {Rect} - Returns visible bounds.\n     */\n    get: function () {\n      return this.visibleBoundsIn;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(DocumentHelper.prototype, \"viewer\", {\n    /**\n     * @private\n     */\n    get: function () {\n      return this.owner.viewer;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(DocumentHelper.prototype, \"containerCanvas\", {\n    //Document Protection Properties Ends\n    //#region Properties\n    /**\n     * Gets container canvas.\n     *\n     * @private\n     * @returns {HTMLCanvasElement} - Returns page canvas.\n     */\n    get: function () {\n      if (isNullOrUndefined(this.containerCanvasIn)) {\n        this.containerCanvasIn = document.createElement('canvas');\n        this.containerCanvasIn.getContext('2d').save();\n      }\n      if (!isNullOrUndefined(this.pageContainer) && this.containerCanvasIn.parentElement !== this.pageContainer) {\n        this.pageContainer.appendChild(this.containerCanvasIn);\n      }\n      return this.containerCanvasIn;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  /**\n   * @private\n   * @param {string} text - Specifies the text string.\n   */\n  DocumentHelper.prototype.openTextFile = function (text) {\n    this.layout.isTextFormat = true;\n    var arr = [];\n    text = text.replace(/\\r\\n/g, '\\n');\n    arr = text.split('\\n');\n    var widget = [];\n    var bodyWidget = new BodyWidget();\n    bodyWidget.sectionFormat = new WSectionFormat(bodyWidget);\n    bodyWidget.childWidgets = widget;\n    var paragraph1 = new ParagraphWidget();\n    var line1 = new LineWidget(paragraph1);\n    for (var i = 0; i < arr.length; i++) {\n      if (i === arr.length - 1 && arr[i].length === 0) {\n        paragraph1.childWidgets.push(line1);\n        paragraph1.containerWidget = bodyWidget;\n        bodyWidget.childWidgets.push(paragraph1);\n        continue;\n      }\n      var paragraph = new ParagraphWidget();\n      var line = new LineWidget(paragraph);\n      if (arr[i].length > 0) {\n        var singleLineLength = 90;\n        if (arr[i].length > singleLineLength) {\n          var start = 0;\n          var increment = singleLineLength;\n          var split = void 0;\n          var lineLength = arr[i].length / singleLineLength + 1;\n          var count = 0;\n          while (count < lineLength) {\n            if (lineLength - 1 != count) {\n              split = arr[i].substring(start, increment);\n            } else {\n              increment = arr[i].length % singleLineLength;\n              split = arr[i].substring(start, increment);\n            }\n            var textElement = new TextElementBox();\n            textElement.text = split;\n            line.children.push(textElement);\n            textElement.line = line;\n            count++;\n            increment += singleLineLength;\n            start += singleLineLength;\n          }\n        } else {\n          var textElement = new TextElementBox();\n          textElement.text = arr[i];\n          line.children.push(textElement);\n          textElement.line = line;\n        }\n      }\n      paragraph.childWidgets.push(line);\n      paragraph.containerWidget = bodyWidget;\n      bodyWidget.childWidgets.push(paragraph);\n    }\n    this.onDocumentChanged([bodyWidget]);\n    this.layout.isTextFormat = false;\n  };\n  Object.defineProperty(DocumentHelper.prototype, \"selectionCanvas\", {\n    /**\n     * Gets selection canvas.\n     *\n     * @private\n     * @returns {HTMLCanvasElement} - Returns selection canvas.\n     */\n    get: function () {\n      if (isNullOrUndefined(this.selectionCanvasIn)) {\n        this.selectionCanvasIn = document.createElement('canvas');\n        this.selectionCanvas.getContext('2d').save();\n      }\n      if (!isNullOrUndefined(this.pageContainer) && this.selectionCanvasIn.parentElement !== this.pageContainer) {\n        this.pageContainer.appendChild(this.selectionCanvasIn);\n      }\n      return this.selectionCanvasIn;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(DocumentHelper.prototype, \"containerContext\", {\n    /**\n     * Gets container context.\n     *\n     * @private\n     * @returns {CanvasRenderingContext2D} - Returns page canvas context.\n     */\n    get: function () {\n      return this.containerCanvas.getContext('2d');\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(DocumentHelper.prototype, \"selectionContext\", {\n    /**\n     * Gets selection context.\n     *\n     * @private\n     * @returns {CanvasRenderingContext2D} - Returns selection canvas context.\n     */\n    get: function () {\n      return this.selectionCanvas.getContext('2d');\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(DocumentHelper.prototype, \"currentRenderingPage\", {\n    /**\n     * Gets the current rendering page.\n     *\n     * @returns {Page} - Returns current rendering page.\n     */\n    get: function () {\n      if (this.pages.length === 0) {\n        return undefined;\n      }\n      return this.pages[this.pages.length - 1];\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(DocumentHelper.prototype, \"zoomFactor\", {\n    /**\n     * Gets or sets zoom factor.\n     *\n     * @private\n     * @returns {number} - Returns zoom factor value.\n     */\n    get: function () {\n      return this.zoomFactorInternal;\n    },\n    set: function (value) {\n      if (this.zoomFactorInternal !== value) {\n        this.preZoomFactor = this.zoomFactor;\n        this.zoomFactorInternal = value;\n        this.zoomModule.setZoomFactor();\n        this.owner.zoomFactor = value;\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(DocumentHelper.prototype, \"selection\", {\n    /**\n     * Gets the selection.\n     *\n     * @private\n     * @returns {Selection} - Returns selection module.\n     */\n    get: function () {\n      return this.owner.selectionModule;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(DocumentHelper.prototype, \"selectionStartPage\", {\n    /**\n     * Gets or sets selection start page.\n     *\n     * @private\n     * @returns {Page} - Return selection start page.\n     */\n    get: function () {\n      return this.selectionStartPageIn;\n    },\n    set: function (value) {\n      this.selectionStartPageIn = value;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(DocumentHelper.prototype, \"selectionEndPage\", {\n    /**\n     * Gets or sets selection end page.\n     *\n     * @private\n     * @returns {Page} - Return selection end page.\n     */\n    get: function () {\n      return this.selectionEndPageIn;\n    },\n    set: function (value) {\n      this.selectionEndPageIn = value;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(DocumentHelper.prototype, \"dialog\", {\n    /**\n     * Gets the initialized default dialog.\n     *\n     * @private\n     * @returns {Dialog} - Returns dialog instance.\n     */\n    get: function () {\n      if (!this.dialogInternal) {\n        this.initDialog(this.owner.enableRtl);\n      }\n      return this.dialogInternal;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(DocumentHelper.prototype, \"dialog2\", {\n    /**\n     * Gets the initialized default dialog.\n     *\n     * @private\n     * @returns {Dialog} - Returns dialog instance.\n     */\n    get: function () {\n      if (!this.dialogInternal2) {\n        this.initDialog2(this.owner.enableRtl);\n      }\n      return this.dialogInternal2;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(DocumentHelper.prototype, \"dialog3\", {\n    /**\n     * Gets the initialized default dialog.\n     *\n     * @private\n     * @returns {Dialog} - Returns dialog instance.\n     */\n    get: function () {\n      if (!this.dialogInternal3) {\n        this.initDialog3(this.owner.enableRtl);\n      }\n      return this.dialogInternal3;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(DocumentHelper.prototype, \"currentSelectedComment\", {\n    /**\n     * @private\n     * @returns {void}\n     */\n    get: function () {\n      return this.currentSelectedCommentInternal;\n    },\n    set: function (value) {\n      if (this.owner && this.owner.commentReviewPane) {\n        this.owner.commentReviewPane.previousSelectedComment = this.currentSelectedCommentInternal;\n      }\n      this.currentSelectedCommentInternal = value;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(DocumentHelper.prototype, \"currentSelectedRevision\", {\n    /**\n     * @private\n     * @returns {void}\n     */\n    get: function () {\n      return this.currentSelectedRevisionInternal;\n    },\n    set: function (value) {\n      // if (this.owner && this.owner.commentReviewPane) {\n      //     this.owner.commentReviewPane.previousSelectedComment = this.currentSelectedCommentInternal;\n      // }\n      this.currentSelectedRevisionInternal = value;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(DocumentHelper.prototype, \"isInlineFormFillProtectedMode\", {\n    /**\n     * @private\n     * @returns {void}\n     */\n    get: function () {\n      return this.isFormFillProtectedMode && this.owner.documentEditorSettings.formFieldSettings.formFillingMode === 'Inline';\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(DocumentHelper.prototype, \"isFormFillProtectedMode\", {\n    /**\n     * @private\n     * @returns {void}\n     */\n    get: function () {\n      return this.isDocumentProtected && this.protectionType === 'FormFieldsOnly';\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(DocumentHelper.prototype, \"isCommentOnlyMode\", {\n    /**\n     * @private\n     * @returns {Boolean}\n     */\n    get: function () {\n      return this.isDocumentProtected && this.protectionType === 'CommentsOnly';\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(DocumentHelper.prototype, \"isTrackedOnlyMode\", {\n    get: function () {\n      return this.isDocumentProtected && this.protectionType === 'RevisionsOnly';\n    },\n    enumerable: true,\n    configurable: true\n  });\n  DocumentHelper.prototype.initalizeStyles = function () {\n    this.preDefinedStyles.add('Normal', '{\"type\":\"Paragraph\",\"name\":\"Normal\",\"next\":\"Normal\"}');\n    this.preDefinedStyles.add('Heading 1', '{\"type\":\"Paragraph\",\"name\":\"Heading 1\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"link\":\"Heading 1 Char\",\"characterFormat\":{\"fontSize\":16.0,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"},\"paragraphFormat\":{\"leftIndent\":0.0,\"rightIndent\":0.0,\"firstLineIndent\":0.0,\"beforeSpacing\":12.0,\"afterSpacing\":0.0,\"lineSpacing\":1.0791666507720947,\"lineSpacingType\":\"Multiple\",\"textAlignment\":\"Left\",\"outlineLevel\":\"Level1\"}}');\n    this.preDefinedStyles.add('Heading 2', '{\"type\":\"Paragraph\",\"name\":\"Heading 2\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"link\":\"Heading 2 Char\",\"characterFormat\":{\"fontSize\":13.0,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"},\"paragraphFormat\":{\"leftIndent\":0.0,\"rightIndent\":0.0,\"firstLineIndent\":0.0,\"beforeSpacing\":2.0,\"afterSpacing\":0.0,\"lineSpacing\":1.0791666507720947,\"lineSpacingType\":\"Multiple\",\"textAlignment\":\"Left\",\"outlineLevel\":\"Level2\"}}');\n    this.preDefinedStyles.add('Heading 3', '{\"type\":\"Paragraph\",\"name\":\"Heading 3\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"link\":\"Heading 3 Char\",\"characterFormat\":{\"fontSize\":12.0,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#1F3763\"},\"paragraphFormat\":{\"leftIndent\":0.0,\"rightIndent\":0.0,\"firstLineIndent\":0.0,\"beforeSpacing\":2.0,\"afterSpacing\":0.0,\"lineSpacing\":1.0791666507720947,\"lineSpacingType\":\"Multiple\",\"textAlignment\":\"Left\",\"outlineLevel\":\"Level3\"}}');\n    this.preDefinedStyles.add('Heading 4', '{\"type\":\"Paragraph\",\"name\":\"Heading 4\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"link\":\"Heading 4 Char\",\"characterFormat\":{\"italic\":true,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"},\"paragraphFormat\":{\"leftIndent\":0.0,\"rightIndent\":0.0,\"firstLineIndent\":0.0,\"beforeSpacing\":2.0,\"afterSpacing\":0.0,\"lineSpacing\":1.0791666507720947,\"lineSpacingType\":\"Multiple\",\"textAlignment\":\"Left\",\"outlineLevel\":\"Level4\"}}');\n    this.preDefinedStyles.add('Heading 5', '{\"type\":\"Paragraph\",\"name\":\"Heading 5\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"link\":\"Heading 5 Char\",\"characterFormat\":{\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"},\"paragraphFormat\":{\"leftIndent\":0.0,\"rightIndent\":0.0,\"firstLineIndent\":0.0,\"beforeSpacing\":2.0,\"afterSpacing\":0.0,\"lineSpacing\":1.0791666507720947,\"lineSpacingType\":\"Multiple\",\"textAlignment\":\"Left\",\"outlineLevel\":\"Level5\"}}');\n    this.preDefinedStyles.add('Heading 6', '{\"type\":\"Paragraph\",\"name\":\"Heading 6\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"link\":\"Heading 6 Char\",\"characterFormat\":{\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#1F3763\"},\"paragraphFormat\":{\"leftIndent\":0.0,\"rightIndent\":0.0,\"firstLineIndent\":0.0,\"beforeSpacing\":2.0,\"afterSpacing\":0.0,\"lineSpacing\":1.0791666507720947,\"lineSpacingType\":\"Multiple\",\"textAlignment\":\"Left\",\"outlineLevel\":\"Level6\"}}');\n    this.preDefinedStyles.add('Heading 7', '{\"type\":\"Paragraph\",\"name\":\"Heading 7\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"link\":\"Heading 7 Char\",\"characterFormat\":{\"italic\":true,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#1F3763\"},\"paragraphFormat\":{\"leftIndent\":0.0,\"rightIndent\":0.0,\"firstLineIndent\":0.0,\"beforeSpacing\":2.0,\"afterSpacing\":0.0,\"lineSpacing\":1.0791666507720947,\"lineSpacingType\":\"Multiple\",\"textAlignment\":\"Left\",\"outlineLevel\":\"Level7\"}}');\n    this.preDefinedStyles.add('Heading 8', '{\"type\":\"Paragraph\",\"name\":\"Heading 8\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"link\":\"Heading 8 Char\",\"characterFormat\":{\"fontSize\":10.5,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#333333\"},\"paragraphFormat\":{\"leftIndent\":0.0,\"rightIndent\":0.0,\"firstLineIndent\":0.0,\"beforeSpacing\":2.0,\"afterSpacing\":0.0,\"lineSpacing\":1.0791666507720947,\"lineSpacingType\":\"Multiple\",\"textAlignment\":\"Left\",\"outlineLevel\":\"Level8\"}}');\n    this.preDefinedStyles.add('Heading 9', '{\"type\":\"Paragraph\",\"name\":\"Heading 9\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"link\":\"Heading 9 Char\",\"characterFormat\":{\"fontSize\":10.5,\"italic\":true,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#333333\"},\"paragraphFormat\":{\"leftIndent\":0.0,\"rightIndent\":0.0,\"firstLineIndent\":0.0,\"beforeSpacing\":2.0,\"afterSpacing\":0.0,\"lineSpacing\":1.0791666507720947,\"lineSpacingType\":\"Multiple\",\"textAlignment\":\"Left\",\"outlineLevel\":\"Level9\"}}');\n    this.preDefinedStyles.add('Default Paragraph Font', '{\"type\":\"Character\",\"name\":\"Default Paragraph Font\"}');\n    this.preDefinedStyles.add('Heading 1 Char', '{\"type\":\"Character\",\"name\":\"Heading 1 Char\",\"basedOn\":\"Default Paragraph Font\",\"characterFormat\":{\"fontSize\":16.0,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"}}');\n    this.preDefinedStyles.add('Heading 2 Char', '{\"type\":\"Character\",\"name\":\"Heading 2 Char\",\"basedOn\":\"Default Paragraph Font\",\"characterFormat\":{\"fontSize\":13.0,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"}}');\n    this.preDefinedStyles.add('Heading 3 Char', '{\"type\":\"Character\",\"name\":\"Heading 3 Char\",\"basedOn\":\"Default Paragraph Font\",\"characterFormat\":{\"fontSize\":12.0,\"fontFamily\":\"Calibri Light\",\"fontColor\": \"#1F3763\"}}');\n    this.preDefinedStyles.add('Heading 4 Char', '{\"type\":\"Character\",\"name\":\"Heading 4 Char\",\"basedOn\":\"Default Paragraph Font\",\"characterFormat\":{\"italic\":true,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"}}');\n    this.preDefinedStyles.add('Heading 5 Char', '{\"type\":\"Character\",\"name\":\"Heading 5 Char\",\"basedOn\":\"Default Paragraph Font\",\"characterFormat\":{\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"}}');\n    this.preDefinedStyles.add('Heading 6 Char', '{\"type\":\"Character\",\"name\":\"Heading 6 Char\",\"basedOn\":\"Default Paragraph Font\",\"characterFormat\":{\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#1F3763\"}}');\n    this.preDefinedStyles.add('Heading 7 Char', '{\"type\":\"Character\",\"name\":\"Heading 7 Char\",\"basedOn\":\"Default Paragraph Font\",\"characterFormat\":{\"italic\":true,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#1F3763\"}}');\n    this.preDefinedStyles.add('Heading 8 Char', '{\"type\":\"Character\",\"name\":\"Heading 8 Char\",\"basedOn\":\"Default Paragraph Font\",\"characterFormat\":{\"fontSize\":10.5,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#333333\"}}');\n    this.preDefinedStyles.add('Heading 9 Char', '{\"type\":\"Character\",\"name\":\"Heading 9 Char\",\"basedOn\":\"Default Paragraph Font\",\"characterFormat\":{\"fontSize\":10.5,\"italic\":true,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#333333\"}}');\n    this.preDefinedStyles.add('Hyperlink', '{\"type\":\"Character\",\"name\":\"Hyperlink\",\"basedOn\":\"Default Paragraph Font\",\"next\":\"Normal\",\"characterFormat\":{\"fontColor\":\"#0563C1\",\"underline\": \"Single\"}}');\n    this.preDefinedStyles.add('TOC 1', '{\"type\":\"Paragraph\",\"name\":\"TOC 1\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"afterSpacing\":5.0}}');\n    this.preDefinedStyles.add('TOC 2', '{\"type\":\"Paragraph\",\"name\":\"TOC 2\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :11.0,\"afterSpacing\":5.0}}');\n    this.preDefinedStyles.add('TOC 3', '{\"type\":\"Paragraph\",\"name\":\"TOC 3\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :22.0,\"afterSpacing\":5.0}}');\n    this.preDefinedStyles.add('TOC 4', '{\"type\":\"Paragraph\",\"name\":\"TOC 4\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :33.0,\"afterSpacing\":5.0}}');\n    this.preDefinedStyles.add('TOC 5', '{\"type\":\"Paragraph\",\"name\":\"TOC 5\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :44.0,\"afterSpacing\":5.0}}');\n    this.preDefinedStyles.add('TOC 6', '{\"type\":\"Paragraph\",\"name\":\"TOC 6\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :55.0,\"afterSpacing\":5.0}}');\n    this.preDefinedStyles.add('TOC 7', '{\"type\":\"Paragraph\",\"name\":\"TOC 7\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :66.0,\"afterSpacing\":5.0}}');\n    this.preDefinedStyles.add('TOC 8', '{\"type\":\"Paragraph\",\"name\":\"TOC 8\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :77.0,\"afterSpacing\":5.0}}');\n    this.preDefinedStyles.add('TOC 9', '{\"type\":\"Paragraph\",\"name\":\"TOC 9\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :88.0,\"afterSpacing\":5.0}}');\n    this.preDefinedStyles.add('Header', '{\"type\":\"Paragraph\",\"name\":\"Header\",\"basedOn\":\"Normal\",\"next\":\"Header\",\"paragraphFormat\":{\"afterSpacing\":0,\"lineSpacing\":1,\"lineSpacingType\":\"Multiple\"}}');\n    this.preDefinedStyles.add('Footer', '{\"type\":\"Paragraph\",\"name\":\"Footer\",\"basedOn\":\"Normal\",\"next\":\"Footer\",\"paragraphFormat\":{\"afterSpacing\":0,\"lineSpacing\":1,\"lineSpacingType\":\"Multiple\"}}');\n  };\n  /**\n   * @private\n   * @returns {void}\n   */\n  DocumentHelper.prototype.clearDocumentItems = function () {\n    if (this.owner.editorModule) {\n      this.owner.editorModule.clear();\n    }\n    if (this.owner.searchModule) {\n      this.owner.searchModule.clearSearchHighlight();\n    }\n    if (this.owner.selectionModule) {\n      this.owner.selectionModule.clear();\n    }\n    this.editRanges.clear();\n    this.headersFooters = [];\n    this.fields = [];\n    this.formFields = [];\n    this.currentSelectedComment = undefined;\n    this.currentSelectedRevision = undefined;\n    for (var i = 0; i < this.comments.length; i++) {\n      var commentStart = this.comments[i].commentStart;\n      if (commentStart) {\n        commentStart.destroy();\n      }\n    }\n    this.comments = [];\n    this.bookmarks.clear();\n    this.endBookmarksUpdated = [];\n    this.styles.clear();\n    this.stylesMap.clear();\n    if (this.pages && this.pages.length > 0) {\n      for (var i = 0; i < this.pages.length; i++) {\n        var page = this.pages[i];\n        page.componentDestroy();\n      }\n      this.pages = [];\n    }\n    this.authors.clear();\n    this.revisionsInternal.clear();\n    this.owner.revisions.clear();\n    this.characterFormat.clearFormat();\n    this.themeFontLanguage.clearFormat();\n    this.paragraphFormat.clearFormat();\n    if (this.owner.trackChangesPane) {\n      this.owner.trackChangesPane.clear();\n    }\n    this.setDefaultCharacterValue(this.characterFormat);\n    this.setDefaultParagraphValue(this.paragraphFormat);\n    if (this.owner.commentReviewPane) {\n      this.owner.commentReviewPane.clear();\n    }\n    this.isHeaderFooter = false;\n    this.defaultTabWidth = 36;\n    this.isDocumentProtected = false;\n    this.protectionType = 'NoProtection';\n    this.restrictFormatting = false;\n    this.hashValue = '';\n    this.saltValue = '';\n    this.userCollection = [];\n    if (this.formFillPopup) {\n      this.formFillPopup.hidePopup();\n    }\n    this.customXmlData.clear();\n    this.fontSubstitutionTable.clear();\n    this.images.clear();\n    this.contentControlCollection = [];\n    this.backgroundColor = '#FFFFFF';\n    this.endnotes.clear();\n    this.footnotes.clear();\n    this.footnoteCollection = [];\n    this.endnoteCollection = [];\n    if (this.lists && this.lists.length > 0) {\n      for (var i = 0; i < this.lists.length; i++) {\n        var list = this.lists[i];\n        list.clear();\n      }\n    }\n    this.lists = [];\n    this.abstractLists = [];\n    this.themes = new Themes();\n    this.hasThemes = false;\n    this.isRestartNumbering = false;\n  };\n  /**\n   * @private\n   * @returns {void}\n   */\n  DocumentHelper.prototype.setDefaultDocumentFormat = function () {\n    this.owner.parser.parseCharacterFormat(0, this.owner.characterFormat, this.characterFormat);\n    this.owner.parser.parseParagraphFormat(0, this.owner.paragraphFormat, this.paragraphFormat);\n  };\n  DocumentHelper.prototype.setDefaultCharacterValue = function (characterFormat) {\n    characterFormat.bold = false;\n    characterFormat.italic = false;\n    characterFormat.fontFamily = 'Calibri';\n    characterFormat.fontSize = 11;\n    characterFormat.underline = 'None';\n    characterFormat.strikethrough = 'None';\n    characterFormat.fontSizeBidi = 11;\n    characterFormat.fontFamilyBidi = 'Calibri';\n    characterFormat.baselineAlignment = 'Normal';\n    characterFormat.highlightColor = 'NoColor';\n    characterFormat.allCaps = false;\n  };\n  DocumentHelper.prototype.setDefaultParagraphValue = function (paragraphFormat) {\n    paragraphFormat.leftIndent = 0;\n    paragraphFormat.rightIndent = 0;\n    paragraphFormat.firstLineIndent = 0;\n    paragraphFormat.textAlignment = 'Left';\n    paragraphFormat.beforeSpacing = 0;\n    paragraphFormat.afterSpacing = 0;\n    paragraphFormat.lineSpacing = 1;\n    paragraphFormat.lineSpacingType = 'Multiple';\n    paragraphFormat.bidi = false;\n    paragraphFormat.keepWithNext = false;\n    paragraphFormat.keepLinesTogether = false;\n    paragraphFormat.widowControl = true;\n    paragraphFormat.outlineLevel = 'BodyText';\n  };\n  /**\n   * @private\n   * @param {number} id - Specfies abstract list id.\n   * @returns {WAbstractList} - Returns abstract list.\n   */\n  DocumentHelper.prototype.getAbstractListById = function (id, isNsid) {\n    if (isNullOrUndefined(this.abstractLists)) {\n      return undefined;\n    }\n    for (var i = 0; i < this.abstractLists.length; i++) {\n      var abstractList = this.abstractLists[i];\n      if (!isNullOrUndefined(abstractList)) {\n        if (isNsid && abstractList.nsid === id) {\n          return abstractList;\n        } else if (abstractList.abstractListId === id) {\n          return abstractList;\n        }\n      }\n    }\n    return undefined;\n  };\n  /**\n   * @private\n   * @param {number} id - Specfies list id.\n   * @returns {WAbstractList} - Returns list.\n   */\n  DocumentHelper.prototype.getListById = function (id, isNsid) {\n    if (isNullOrUndefined(this.lists)) {\n      return undefined;\n    }\n    for (var i = 0; i < this.lists.length; i++) {\n      var list = this.lists[i];\n      if (!isNullOrUndefined(list)) {\n        if (isNsid && list.nsid === id) {\n          return list;\n        } else if (list.listId === id) {\n          return list;\n        }\n      }\n    }\n    return undefined;\n  };\n  /**\n   * @private\n   * @param {WListLevel} listLevel - Specfies list level.\n   * @returns {number} - Returns list level number.\n   */\n  DocumentHelper.getListLevelNumber = function (listLevel) {\n    if (listLevel.ownerBase instanceof WLevelOverride) {\n      return listLevel.ownerBase.levelNumber;\n    } else if (listLevel.ownerBase instanceof WAbstractList && !isNullOrUndefined(listLevel.ownerBase.levels)) {\n      return listLevel.ownerBase.levels.indexOf(listLevel);\n    } else {\n      return -1;\n    }\n  };\n  /**\n  * @private\n  * @param {ImageElementBox} image - Specfies image.\n  * @returns {number} - Returns base64string.\n  */\n  DocumentHelper.prototype.getImageString = function (image) {\n    var base64ImageString = this.images.get(parseInt(image.imageString));\n    var imageStr;\n    if (image.isMetaFile && HelperMethods.formatClippedString(base64ImageString[0]).extension !== \".svg\") {\n      imageStr = base64ImageString[1];\n    } else if (HelperMethods.formatClippedString(base64ImageString[0]).extension === \".tif\") {\n      imageStr = base64ImageString[1];\n    } else {\n      imageStr = base64ImageString[0];\n    }\n    return imageStr;\n  };\n  /**\n   * @private\n   * @param {ImageElementBox} image - Specfies image.\n   * @returns {number} - Returns key for specific image.\n   */\n  DocumentHelper.prototype.addBase64StringInCollection = function (image) {\n    return __awaiter(this, void 0, void 0, function () {\n      var key, addToCollection, base64ImageString, i, index, imageStringCol;\n      return __generator(this, function (_a) {\n        key = this.images.length;\n        addToCollection = true;\n        base64ImageString = [];\n        for (i = 0; i < this.images.length; i++) {\n          index = this.images.keys[parseInt(i.toString(), 10)];\n          imageStringCol = this.images.get(index);\n          if (image.isMetaFile && image.metaFileImageString === imageStringCol[0]) {\n            key = index;\n            addToCollection = false;\n            break;\n          } else if (image.imageString === imageStringCol[0]) {\n            key = index;\n            addToCollection = false;\n            break;\n          }\n        }\n        if (addToCollection) {\n          if (image.isMetaFile) {\n            base64ImageString.push(image.metaFileImageString);\n            base64ImageString.push(image.imageString === \"\" ? image.metaFileImageString : image.imageString);\n          } else {\n            base64ImageString.push(image.imageString);\n          }\n          this.images.add(this.images.length, base64ImageString);\n        }\n        if (image.isMetaFile) {\n          image.metaFileImageString = key.toString();\n        }\n        image.imageString = key.toString();\n        return [2 /*return*/];\n      });\n    });\n  };\n  /**\n   * Gets the bookmarks.\n   *\n   * @private\n   * @param {boolean} includeHidden - Include hidden bookmark.\n   * @returns {string[]} - Returns bookmars present in current document.\n   */\n  DocumentHelper.prototype.getBookmarks = function (includeHidden) {\n    var bookmarks = [];\n    for (var i = 0; i < this.bookmarks.keys.length; i++) {\n      var bookmark = this.bookmarks.keys[i];\n      if (includeHidden || bookmark.indexOf('_') !== 0) {\n        bookmarks.push(bookmark);\n      }\n    }\n    return bookmarks;\n  };\n  DocumentHelper.prototype.selectComment = function (comment) {\n    var _this = this;\n    if (this.owner.selectionModule && this.owner.commentReviewPane) {\n      this.owner.showComments = true;\n      setTimeout(function () {\n        if (_this.owner && _this.owner.selectionModule) {\n          _this.owner.selectionModule.selectComment(comment);\n        }\n      });\n    }\n  };\n  DocumentHelper.prototype.showComments = function (show) {\n    if (this.owner && show && this.owner.enableComment) {\n      var eventArgs = {\n        type: 'Comment'\n      };\n      this.owner.trigger(beforePaneSwitchEvent, eventArgs);\n    }\n    this.owner.commentReviewPane.reviewTab.hideTab(0, false);\n    this.owner.commentReviewPane.reviewTab.hideTab(1, false);\n    this.owner.commentReviewPane.showHidePane(show && this.owner.enableComment, 'Comments');\n  };\n  DocumentHelper.prototype.showRevisions = function (show) {\n    var isCommentTabVisible = false;\n    this.showRevision = show;\n    if (this.owner && show) {\n      var eventArgs = {\n        type: 'comment'\n      };\n      this.owner.trigger(beforePaneSwitchEvent, eventArgs);\n    }\n    if (!show && this.owner.showComments) {\n      this.owner.commentReviewPane.reviewTab.hideTab(0, false);\n      this.owner.commentReviewPane.showHidePane(true, 'Comments');\n    } else {\n      this.owner.commentReviewPane.showHidePane(show, 'Changes');\n      if (!this.owner.enableComment) {\n        isCommentTabVisible = true;\n      }\n      // this.owner.commentReviewPane.reviewTab.hideTab(0, isCommentTabVisible);\n      this.showRevision = false;\n    }\n    if (show) {\n      this.owner.trackChangesPane.enableDisableButton(!this.owner.isReadOnly && !this.isDocumentProtected);\n    }\n  };\n  /**\n   * Initializes components.\n   *\n   * @private\n   * @returns {void}\n   */\n  DocumentHelper.prototype.initializeComponents = function () {\n    var element = this.owner.element;\n    if (isNullOrUndefined(element)) {\n      return;\n    }\n    //let viewer: LayoutViewer = this;\n    this.optionsPaneContainer = createElement('div', {\n      className: 'e-documenteditor-optionspane'\n    });\n    this.optionsPaneContainer.contentEditable = 'false';\n    element.appendChild(this.optionsPaneContainer);\n    var isRtl = this.owner.enableRtl;\n    var viewerContainerStyle;\n    if (isRtl) {\n      viewerContainerStyle = 'direction:ltr;';\n    }\n    this.viewerContainer = createElement('div', {\n      id: this.owner.containerId + '_viewerContainer'\n    });\n    this.viewerContainer.style.cssText = 'position:relative;backgroundColor:#FBFBFB;overflow:auto;' + viewerContainerStyle;\n    this.optionsPaneContainer.appendChild(this.viewerContainer);\n    this.viewerContainer.tabIndex = -1;\n    this.viewerContainer.style.outline = 'none';\n    this.pageContainer = createElement('div', {\n      id: this.owner.containerId + '_pageContainer',\n      className: 'e-de-background'\n    });\n    this.viewerContainer.appendChild(this.pageContainer);\n    this.pageContainer.style.top = '0px';\n    this.pageContainer.style.left = '0px';\n    this.pageContainer.style.position = 'relative';\n    this.pageContainer.style.pointerEvents = 'none';\n    if (Browser.isDevice) {\n      this.createEditableDiv(element);\n    } else {\n      this.createEditableIFrame();\n    }\n    if (this.owner.enableImageResizerMode) {\n      this.owner.imageResizerModule.initializeImageResizer();\n    }\n    this.updateViewerSizeInternal(element);\n    this.layout = new Layout(this);\n    this.textHelper = new TextHelper(this);\n    this.zoomModule = new Zoom(this);\n    this.initTouchEllipse();\n    this.wireEvent();\n    this.restrictEditingPane = new RestrictEditing(this);\n    this.owner.commentReviewPane = new CommentReviewPane(this.owner);\n    this.owner.trackChangesPane = new TrackChangesPane(this.owner, this.owner.commentReviewPane);\n    createSpinner({\n      target: this.owner.element,\n      cssClass: 'e-spin-overlay'\n    });\n  };\n  DocumentHelper.prototype.measureScrollbarWidth = function (element) {\n    var parentDiv = document.createElement('div');\n    parentDiv.setAttribute('style', 'visibility:hidden;overflow:scroll');\n    element.appendChild(parentDiv);\n    var childDiv = document.createElement('div');\n    parentDiv.appendChild(childDiv);\n    this.scrollbarWidth = parentDiv.getBoundingClientRect().width - childDiv.getBoundingClientRect().width;\n    parentDiv.parentNode.removeChild(parentDiv);\n  };\n  DocumentHelper.prototype.createEditableDiv = function (element) {\n    this.editableDiv = document.createElement('div');\n    this.editableDiv.contentEditable = this.owner.isReadOnlyMode ? 'false' : 'true';\n    this.editableDiv.style.position = 'fixed';\n    this.editableDiv.style.left = '-150em';\n    this.editableDiv.style.width = '100%';\n    this.editableDiv.style.height = '100%';\n    this.editableDiv.id = element.id + '_editableDiv';\n    document.body.appendChild(this.editableDiv);\n  };\n  DocumentHelper.prototype.createEditableIFrame = function () {\n    this.iframe = createElement('iframe', {\n      attrs: {\n        'scrolling': 'no',\n        'title': 'Document Editor',\n        'style': 'pointer-events:none;position:absolute;left:0px;top:0px;outline:none;background-color:transparent;width:0px;height:0px;overflow:hidden',\n        'tabindex': \"0\"\n      },\n      className: 'e-de-text-target'\n    });\n    this.viewerContainer.appendChild(this.iframe);\n    this.initIframeContent();\n  };\n  DocumentHelper.prototype.initIframeContent = function () {\n    var style = 'background-color:transparent;width:100%;height:100%;padding: 0px; margin: 0px;';\n    var innerHtml = '<!DOCTYPE html>' + '<html lang=\"' + this.owner.locale + '\"><head></head>' + '<body spellcheck=\"false\" style=' + style + ' >' + '<div contenteditable=\"true\" style=' + style + '></div>' + '</body>' + '</html>';\n    if (!isNullOrUndefined(this.iframe.contentDocument)) {\n      this.iframe.contentDocument.open();\n      this.iframe.contentDocument.write(innerHtml);\n      this.iframe.contentDocument.close();\n      this.editableDiv = this.iframe.contentDocument.body.children[0];\n    }\n  };\n  /**\n   * Wires events and methods.\n   *\n   * @returns {void}\n   */\n  DocumentHelper.prototype.wireEvent = function () {\n    if (!isNullOrUndefined(this.owner.selectionModule)) {\n      this.selection.initCaret();\n    }\n    this.wireInputEvents();\n    if (!isNullOrUndefined(this.iframe)) {\n      this.iframe.addEventListener('load', this.onIframeLoad.bind(this));\n    }\n    this.viewerContainer.addEventListener('scroll', this.scrollHandler);\n    this.viewerContainer.addEventListener('mousedown', this.onMouseDownInternal);\n    this.viewerContainer.addEventListener('keydown', this.onKeyDownInternal);\n    this.viewerContainer.addEventListener('mousemove', this.onMouseMoveInternal);\n    this.viewerContainer.addEventListener('mouseleave', this.onMouseLeaveInternal);\n    this.viewerContainer.addEventListener('mouseenter', this.onMouseEnterInternal);\n    this.viewerContainer.addEventListener('contextmenu', this.onContextMenu);\n    this.viewerContainer.addEventListener('dblclick', this.onDoubleTap);\n    this.viewerContainer.addEventListener('mouseup', this.onMouseUpInternal);\n    window.addEventListener('resize', this.onWindowResize);\n    window.addEventListener('keyup', this.onKeyUpInternal);\n    window.addEventListener('mouseup', this.onImageResizer);\n    window.addEventListener('touchend', this.onImageResizer);\n    this.viewerContainer.addEventListener('touchstart', this.onTouchStartInternal);\n    this.viewerContainer.addEventListener('touchmove', this.onTouchMoveInternal);\n    this.viewerContainer.addEventListener('touchend', this.onTouchUpInternal);\n    if (navigator !== undefined && navigator.userAgent.match('Firefox')) {\n      this.viewerContainer.addEventListener('DOMMouseScroll', this.zoomModule.onMouseWheelInternal);\n    }\n    this.viewerContainer.addEventListener('mousewheel', this.zoomModule.onMouseWheelInternal);\n    this.editableDiv.addEventListener('focus', this.updateFocus);\n  };\n  DocumentHelper.prototype.wireInputEvents = function () {\n    if (isNullOrUndefined(this.editableDiv)) {\n      return;\n    }\n    this.editableDiv.addEventListener('paste', this.onPaste);\n    if (!Browser.isDevice) {\n      this.editableDiv.addEventListener('keypress', this.onKeyPressInternal);\n      if (Browser.info.name === 'chrome') {\n        this.editableDiv.addEventListener('textInput', this.onTextInput);\n      }\n    } else {\n      this.editableDiv.addEventListener('input', this.onTextInputInternal);\n    }\n    this.editableDiv.addEventListener('blur', this.onFocusOut);\n    this.editableDiv.addEventListener('keydown', this.onKeyDownInternal);\n    this.editableDiv.addEventListener('compositionstart', this.compositionStart);\n    this.editableDiv.addEventListener('compositionupdate', this.compositionUpdated);\n    this.editableDiv.addEventListener('compositionend', this.compositionEnd);\n  };\n  DocumentHelper.prototype.onIframeLoad = function () {\n    if (!isNullOrUndefined(this.iframe) && this.iframe.contentDocument.body.children.length === 0) {\n      this.initIframeContent();\n      this.wireInputEvents();\n    }\n  };\n  DocumentHelper.prototype.getEditableDivTextContent = function () {\n    return this.editableDiv.textContent;\n  };\n  DocumentHelper.prototype.updateAuthorIdentity = function () {\n    var revisions = this.owner.revisions.changes;\n    for (var i = 0; i < revisions.length; i++) {\n      this.getAuthorColor(revisions[i].author);\n    }\n  };\n  DocumentHelper.prototype.getAvatar = function (userInfo, userName, comment, revision) {\n    var author;\n    var userinitial;\n    if (!isNullOrUndefined(comment)) {\n      author = comment.author;\n      userinitial = comment.initial;\n    } else {\n      author = revision.author;\n    }\n    if (!isNullOrUndefined(author)) {\n      var avatarDiv = createElement('div', {\n        className: 'e-de-cmt-avatar'\n      });\n      var avatar = createElement('div', {\n        className: 'e-de-ff-cmt-avatar'\n      });\n      avatar.style.backgroundColor = this.owner.documentHelper.getAuthorColor(author);\n      if (userinitial === '' || isNullOrUndefined(userinitial)) {\n        var authorName = author.split(' ');\n        var initial = authorName[0].charAt(0);\n        if (authorName.length > 1 && authorName[authorName.length - 1] !== '') {\n          initial += authorName[authorName.length - 1][0];\n        }\n        avatar.innerText = initial.toUpperCase();\n      } else {\n        if (userinitial.length > 2) {\n          avatar.innerText = userinitial.substring(0, 2);\n        } else {\n          avatar.innerText = userinitial;\n        }\n      }\n      avatarDiv.appendChild(avatar);\n      avatarDiv.appendChild(userName);\n      userInfo.appendChild(avatarDiv);\n    }\n  };\n  /**\n   * @private\n   * @param {string} author - Specifies author name.\n   * @returns {string} - Return autor color.\n   */\n  DocumentHelper.prototype.getAuthorColor = function (author) {\n    if (this.authors.containsKey(author)) {\n      return this.authors.get(author);\n    }\n    var color;\n    if (this.authors.length === 0) {\n      color = '#b5082e'; //dark red\n    } else {\n      color = this.generateRandomColor();\n    }\n    this.authors.add(author, color);\n    return color;\n  };\n  DocumentHelper.prototype.generateRandomColor = function () {\n    var userColors = ['#b5082e', '#2e97d3', '#bb00ff', '#f37e43', '#03a60b', '#881824', '#e09a2b', '#50565e']; //dark grey\n    return userColors[this.authors.length % 8];\n  };\n  /**\n   * @private\n   * @returns {void}\n   */\n  DocumentHelper.prototype.positionEditableTarget = function () {\n    var point = this.selection.getRect(this.selection.start);\n    var page = this.selection.getSelectionPage(this.selection.start);\n    // const caretInfo: CaretHeightInfo = this.selection.updateCaretSize(this.owner.selection.start);\n    var sectionFormat = page.bodyWidgets[0].sectionFormat;\n    var left = page.boundingRectangle.x + HelperMethods.convertPointToPixel(sectionFormat.leftMargin) * this.zoomFactor;\n    var top = point.y;\n    var pageWidth = sectionFormat.pageWidth - sectionFormat.leftMargin - sectionFormat.rightMargin;\n    var iframeStyle = 'left:' + left + 'px;';\n    iframeStyle += 'top:' + top + 'px;';\n    iframeStyle += 'width:' + HelperMethods.convertPointToPixel(pageWidth) * this.zoomFactor + 'px;';\n    iframeStyle += 'height:250px;outline-style:none;position:absolute';\n    this.iframe.setAttribute('style', iframeStyle);\n    var style = 'background-color:transparent;width:100%;height:250px;padding: 0px; margin: 0px;';\n    style += 'text-indent:' + (point.x - left) + 'px;';\n    style += 'color:transparent;pointer-events:none;outline-style:none;';\n    style += 'font-size:' + HelperMethods.convertPointToPixel(this.selection.characterFormat.fontSize) * this.zoomFactor + 'px;';\n    style += 'font-family' + this.selection.characterFormat.fontFamily + ';';\n    style += 'overflow:hidden;text-decoration:none;white-space:normal;';\n    this.editableDiv.setAttribute('style', style);\n  };\n  DocumentHelper.prototype.initDialog = function (isRtl) {\n    if (!this.dialogInternal) {\n      this.dialogTarget1 = createElement('div', {\n        className: 'e-de-dlg-target'\n      });\n      this.dialogTarget1.contentEditable = 'false';\n      document.body.appendChild(this.dialogTarget1);\n      if (isRtl) {\n        this.dialogTarget1.classList.add('e-de-rtl');\n      }\n      this.dialogInternal = new Dialog({\n        target: this.owner.documentEditorSettings.popupTarget,\n        showCloseIcon: true,\n        allowDragging: true,\n        enableRtl: isRtl,\n        visible: false,\n        width: '1px',\n        isModal: true,\n        position: {\n          X: 'center',\n          Y: 'center'\n        },\n        zIndex: this.owner.zIndex + 20,\n        animationSettings: {\n          effect: 'None'\n        }\n      });\n      this.dialogInternal.isStringTemplate = true;\n      this.dialogInternal.open = this.selection.hideCaret;\n      this.dialogInternal.beforeClose = this.updateFocus;\n      this.dialogInternal.appendTo(this.dialogTarget1);\n    }\n  };\n  DocumentHelper.prototype.initDialog3 = function (isRtl) {\n    if (!this.dialogInternal3) {\n      this.dialogTarget3 = createElement('div', {\n        className: 'e-de-dlg-target'\n      });\n      this.dialogTarget3.contentEditable = 'false';\n      document.body.appendChild(this.dialogTarget3);\n      if (isRtl) {\n        this.dialogTarget3.classList.add('e-de-rtl');\n      }\n      this.dialogInternal3 = new Dialog({\n        target: this.owner.documentEditorSettings.popupTarget,\n        showCloseIcon: true,\n        allowDragging: true,\n        enableRtl: isRtl,\n        visible: false,\n        width: '1px',\n        isModal: true,\n        position: {\n          X: 'center',\n          Y: 'center'\n        },\n        zIndex: this.owner.zIndex,\n        animationSettings: {\n          effect: 'None'\n        }\n      });\n      this.dialogInternal3.isStringTemplate = true;\n      this.dialogInternal3.open = this.selection.hideCaret;\n      this.dialogInternal3.beforeClose = this.updateFocus;\n      this.dialogInternal3.appendTo(this.dialogTarget3);\n    }\n  };\n  DocumentHelper.prototype.hideDialog = function () {\n    this.dialog.hide();\n    this.updateFocus();\n  };\n  DocumentHelper.prototype.initDialog2 = function (isRtl) {\n    if (!this.dialogInternal2) {\n      this.dialogTarget2 = createElement('div', {\n        className: 'e-de-dlg-target'\n      });\n      this.dialogTarget2.contentEditable = 'false';\n      document.body.appendChild(this.dialogTarget2);\n      if (isRtl) {\n        this.dialogTarget2.classList.add('e-de-rtl');\n      }\n      this.dialogInternal2 = new Dialog({\n        target: this.owner.documentEditorSettings.popupTarget,\n        showCloseIcon: true,\n        allowDragging: true,\n        enableRtl: isRtl,\n        visible: false,\n        width: '1px',\n        isModal: true,\n        position: {\n          X: 'center',\n          Y: 'Top'\n        },\n        zIndex: this.owner.zIndex + 10\n      });\n      this.dialogInternal2.isStringTemplate = true;\n      this.dialogInternal2.appendTo(this.dialogTarget2);\n    }\n  };\n  DocumentHelper.prototype.getBase64 = function (base64String, width, height) {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        return [2 /*return*/, new Promise(function (resolve, reject) {\n          var imageString = '';\n          var drawImage = new Image();\n          drawImage.onload = function () {\n            var displayPixelRatio = Math.max(1, window.devicePixelRatio || 1);\n            var draw = document.createElement('canvas');\n            draw.width = width * displayPixelRatio;\n            draw.height = height * displayPixelRatio;\n            var context = draw.getContext('2d');\n            context.scale(displayPixelRatio, displayPixelRatio);\n            context.drawImage(drawImage, 0, 0, width, height);\n            imageString = draw.toDataURL('image/png', 1);\n            resolve(imageString);\n          };\n          if (base64String && (HelperMethods.startsWith(base64String, 'http://') || HelperMethods.startsWith(base64String, 'https://'))) {\n            fetch(base64String).then(function (response) {\n              return response.blob();\n            }).then(function (blob) {\n              return new Promise(function (resolve, reject) {\n                var reader = new FileReader();\n                reader.onloadend = function () {\n                  return resolve(reader.result);\n                };\n                reader.onerror = reject;\n                reader.readAsDataURL(blob);\n              });\n            }).then(function (dataUrl) {\n              // The dataUrl will be a base64-encoded string\n              drawImage.src = dataUrl;\n              // console.log(base64String);\n            });\n          }\n        })];\n      });\n    });\n  };\n  /**\n   * Clears the context.\n   *\n   * @private\n   * @returns {void}\n   */\n  DocumentHelper.prototype.clearContent = function () {\n    this.containerContext.clearRect(0, 0, this.containerCanvas.width, this.containerCanvas.height);\n    this.selectionContext.clearRect(0, 0, this.selectionCanvas.width, this.selectionCanvas.height);\n    // Hide comment mark\n    if (this.pageContainer) {\n      var commentMarkElement = this.pageContainer.getElementsByClassName('e-de-cmt-mark');\n      for (var i = 0; i < commentMarkElement.length; i++) {\n        commentMarkElement[i].style.display = 'none';\n      }\n    }\n    if (this.pageContainer) {\n      var editRangeStart = this.pageContainer.getElementsByClassName('e-de-lock-mark');\n      for (var i = 0; i < editRangeStart.length; i++) {\n        editRangeStart[i].style.display = 'none';\n      }\n    }\n  };\n  /**\n   * Fired when the document gets changed.\n   *\n   * @private\n   * @param {BodyWidget[]} sections - Specified document content.\n   * @returns {void}\n   */\n  DocumentHelper.prototype.onDocumentChanged = function (sections, iOps) {\n    var _this = this;\n    this.clearContent();\n    if (this.owner.editorModule) {\n      this.owner.editorModule.tocStyles = {};\n      this.owner.editorModule.tocBookmarkId = 0;\n    }\n    this.heightInfoCollection = {};\n    this.owner.isDocumentLoaded = false;\n    this.viewer.columnLayoutArea.clear();\n    this.layout.isDocumentContainsRtl = false;\n    this.layout.isMultiColumnDoc = false;\n    this.updateAuthorIdentity();\n    for (var i = 0; i < this.pages.length; i++) {\n      for (var j = 0; j < this.pages[i].bodyWidgets.length; j++) {\n        this.pages[i].bodyWidgets[j].destroy();\n      }\n    }\n    this.pages = [];\n    if (!isNullOrUndefined(this.renderedLists)) {\n      this.renderedLists.clear();\n    }\n    if (!isNullOrUndefined(this.renderedLevelOverrides)) {\n      this.renderedLevelOverrides = [];\n    }\n    if (!isNullOrUndefined(this.owner.editorHistoryModule)) {\n      this.owner.editorHistoryModule.destroy();\n    }\n    this.owner.isDocumentLoaded = true;\n    this.layout.isInitialLoad = true;\n    this.layout.footHeight = 0;\n    this.layout.footnoteHeight = 0;\n    this.layout.layoutItems(sections, false);\n    if (this.owner.selectionModule) {\n      this.selection.previousSelectedFormField = undefined;\n      if (this.formFields.length > 0) {\n        this.owner.selectionModule.highlightFormFields();\n      }\n      this.owner.selectionModule.editRangeCollection = [];\n      this.owner.selectionModule.selectRange(this.owner.documentStart, this.owner.documentStart);\n      if (this.isDocumentProtected && this.protectionType == 'FormFieldsOnly') {\n        this.owner.selectionModule.navigateToNextFormField();\n      }\n      if (this.isDocumentProtected) {\n        this.restrictEditingPane.showHideRestrictPane(true);\n      }\n    }\n    if (!isNullOrUndefined(iOps) && this.owner.editorModule) {\n      this.owner.editorModule.intializeDefaultStyles();\n    }\n    if (this.owner.enableCollaborativeEditing && this.owner.collaborativeEditingHandlerModule && this.owner.enableEditor) {\n      this.owner.editorModule.isRemoteAction = true;\n      this.owner.editorModule.isIncrementalSave = true;\n      if (iOps && !isNullOrUndefined(iOps[incrementalOps[0]]) && !isNullOrUndefined(iOps[incrementalOps[0]].length > 0)) {\n        for (var k = 0; k < iOps[incrementalOps[0]].length; k++) {\n          this.owner.collaborativeEditingHandlerModule.applyRemoteAction('action', iOps[incrementalOps[0]][k]);\n        }\n      }\n      this.owner.editorModule.isRemoteAction = false;\n      this.owner.editorModule.isIncrementalSave = false;\n      this.owner.selectionModule.selectRange(this.owner.documentStart, this.owner.documentStart);\n    }\n    if (this.owner.optionsPaneModule) {\n      this.owner.optionsPaneModule.showHideOptionsPane(false);\n    }\n    if (this.restrictEditingPane.restrictPane && !this.isDocumentProtected) {\n      this.restrictEditingPane.showHideRestrictPane(false);\n    }\n    if (!isNullOrUndefined(this.owner.selectionModule) && this.owner.selectionModule.isViewPasteOptions) {\n      this.owner.selectionModule.isViewPasteOptions = false;\n      this.owner.selectionModule.showHidePasteOptions(undefined, undefined);\n    }\n    this.owner.fireDocumentChange();\n    this.owner.showHideRulers();\n    setTimeout(function () {\n      if (!isNullOrUndefined(_this.owner) && _this.owner.showRevisions) {\n        _this.showRevisions(true);\n      }\n    });\n  };\n  /**\n   * Initialize touch ellipse.\n   *\n   * @returns {void}\n   */\n  DocumentHelper.prototype.initTouchEllipse = function () {\n    var style = 'height: 30px;width: 30px;position: absolute;background-color: transparent;margin: 0px;padding: 0px;z-index:5';\n    var ellipse = ' height: 12px;width: 12px;border-radius: 50%;background-color: white;position: absolute;margin: 0px 6px 0px 6px;border-width: 2px;border-style: solid;border-color: #000000;box-sizing: unset;';\n    this.touchStart = createElement('div', {\n      className: 'e-touch-ellipse',\n      styles: style\n    });\n    var start = createElement('div', {\n      styles: ellipse\n    });\n    this.touchEnd = createElement('div', {\n      className: 'e-touch-ellipse',\n      styles: style\n    });\n    this.touchStart.style.display = 'none';\n    var end = createElement('div', {\n      styles: ellipse\n    });\n    this.touchStart.appendChild(start);\n    this.touchEnd.appendChild(end);\n    this.touchEnd.style.display = 'none';\n    this.viewerContainer.appendChild(this.touchStart);\n    this.viewerContainer.appendChild(this.touchEnd);\n  };\n  /**\n   * Updates touch mark position.\n   *\n   * @private\n   * @returns {void}\n   */\n  DocumentHelper.prototype.updateTouchMarkPosition = function () {\n    if (this.touchStart.style.display !== 'none' && !isNullOrUndefined(this.selection)) {\n      if (!this.selection.isEmpty) {\n        var y = this.selection.getCaretBottom(this.selection.start, false);\n        var page = this.selection.getPage(this.selection.start.paragraph);\n        var pageTop = page.boundingRectangle.y - this.owner.viewer.pageGap * (this.pages.indexOf(page) + 1) * this.zoomFactor + this.owner.viewer.pageGap * (this.pages.indexOf(page) + 1);\n        this.touchStart.style.left = page.boundingRectangle.x + (Math.round(this.selection.start.location.x) * this.zoomFactor - 14) + 'px';\n        this.touchStart.style.top = pageTop + y * this.zoomFactor + 'px';\n        if (!this.selection.isEmpty) {\n          y = this.selection.getCaretBottom(this.selection.end, false);\n          page = this.selection.getPage(this.selection.end.paragraph);\n        }\n        this.touchEnd.style.left = page.boundingRectangle.x + (Math.round(this.selection.end.location.x) * this.zoomFactor - 14) + 'px';\n        this.touchEnd.style.top = pageTop + y * this.zoomFactor + 'px';\n      } else {\n        this.selection.updateCaretPosition();\n      }\n    }\n  };\n  DocumentHelper.prototype.autoScrollOnSelection = function (cursorPoint) {\n    var _this = this;\n    //Auto scroll when mouse moved hold on the edge of the viewer container.\n    if (this.scrollMoveTimer && (cursorPoint.y <= 0 || cursorPoint.y > 50 || cursorPoint.y < this.viewerContainer.offsetHeight - 50)) {\n      clearInterval(this.scrollMoveTimer);\n      this.scrollMoveTimer = 0;\n    } else if (cursorPoint.y < 60) {\n      clearInterval(this.scrollMoveTimer);\n      //Scroll up\n      this.scrollMoveTimer = setInterval(function () {\n        _this.viewerContainer.scrollTop -= 20;\n        setTimeout(function () {\n          var touchPoint = _this.owner.viewer.findFocusedPage(cursorPoint, !_this.owner.enableHeaderAndFooter);\n          var widget = _this.getLineWidget(touchPoint);\n          _this.selection.updateTextPosition(widget, touchPoint);\n        }, 200);\n      }, 200);\n    } else if (cursorPoint.y > this.viewerContainer.offsetHeight - 70) {\n      clearInterval(this.scrollMoveTimer);\n      //Scroll down\n      this.scrollMoveTimer = setInterval(function () {\n        _this.viewerContainer.scrollTop += 20;\n        setTimeout(function () {\n          var touchPoint = _this.owner.viewer.findFocusedPage(cursorPoint, !_this.owner.enableHeaderAndFooter);\n          var widget = _this.getLineWidget(touchPoint);\n          _this.selection.updateTextPosition(widget, touchPoint);\n        }, 200);\n      }, 200);\n    }\n  };\n  DocumentHelper.prototype.scrollForwardOnSelection = function (cursorPoint) {\n    if (this.viewerContainer) {\n      this.viewerContainer.scrollTop = this.viewerContainer.scrollTop + 200;\n      var touchPoint = this.owner.viewer.findFocusedPage(cursorPoint, !this.owner.enableHeaderAndFooter);\n      var textPosition = this.owner.selectionModule.end;\n      if (!this.owner.enableImageResizerMode || !this.owner.imageResizerModule.isImageResizerVisible || this.owner.imageResizerModule.isShapeResize) {\n        this.skipScrollToPosition = true;\n        this.owner.selectionModule.moveTextPosition(touchPoint, textPosition, true);\n      }\n    }\n  };\n  DocumentHelper.prototype.scrollBackwardOnSelection = function (cursorPoint) {\n    this.viewerContainer.scrollTop = this.viewerContainer.scrollTop - 200;\n    var touchPoint = this.owner.viewer.findFocusedPage(cursorPoint, !this.owner.enableHeaderAndFooter);\n    var textPosition = this.owner.selectionModule.end;\n    if (!this.owner.enableImageResizerMode || !this.owner.imageResizerModule.isImageResizerVisible || this.owner.imageResizerModule.isShapeResize) {\n      this.skipScrollToPosition = true;\n      this.owner.selectionModule.moveTextPosition(touchPoint, textPosition, true);\n    }\n  };\n  DocumentHelper.prototype.moveSelectedContent = function () {\n    this.isDragStarted = false;\n    var info = this.owner.editor.getSelectionInfo(true);\n    info = this.owner.selection.updateSelectionInfo(info);\n    var start = this.selection.getTextPosBasedOnLogicalIndex(info.start);\n    var end = this.selection.getTextPosBasedOnLogicalIndex(info.end);\n    var dropSelectionStartParaInfo = this.selection.getParagraphInfo(start);\n    var dropSelectionEndParaInfo = this.selection.getParagraphInfo(end);\n    var dropSelectionStartParaIndex = this.selection.getHierarchicalIndex(dropSelectionStartParaInfo.paragraph, dropSelectionStartParaInfo.offset.toString());\n    var dropSelectionEndParaIndex = this.selection.getHierarchicalIndex(dropSelectionEndParaInfo.paragraph, dropSelectionEndParaInfo.offset.toString());\n    var dropSelectionStartPos = this.selection.getTextPosBasedOnLogicalIndex(dropSelectionStartParaIndex);\n    var dropSelectionEndPos = this.selection.getTextPosBasedOnLogicalIndex(dropSelectionEndParaIndex);\n    var dragOnSelectionStartParaIndex = this.selection.getHierarchicalIndex(this.dragStartParaInfo.paragraph, this.dragStartParaInfo.offset.toString());\n    var dragOnSelectionEndParaIndex = this.selection.getHierarchicalIndex(this.dragEndParaInfo.paragraph, this.dragEndParaInfo.offset.toString());\n    var dragOnSelectionStartPos = this.selection.getTextPosBasedOnLogicalIndex(dragOnSelectionStartParaIndex);\n    var dragOnSelectionEndPos = this.selection.getTextPosBasedOnLogicalIndex(dragOnSelectionEndParaIndex);\n    if (dropSelectionStartPos.isExistBefore(dragOnSelectionStartPos) || dropSelectionEndPos.isExistAfter(dragOnSelectionEndPos)) {\n      this.owner.editorModule.initComplexHistory('DragAndDropContent');\n      this.selection.start = dragOnSelectionStartPos;\n      this.selection.end = dragOnSelectionEndPos;\n      var isEnableLocalPasteTrue = this.owner.enableLocalPaste;\n      if (!isEnableLocalPasteTrue) {\n        this.owner.enableLocalPaste = true;\n      }\n      var dropExtraOffset = this.dragEndParaInfo.paragraph.getLength();\n      var hasNewLineChar = false;\n      if (dropExtraOffset < this.dragEndParaInfo.offset || !this.dragStartParaInfo.paragraph.equals(this.dragEndParaInfo.paragraph)) {\n        hasNewLineChar = true;\n      }\n      this.owner.editorModule.cut();\n      if (this.dragEndParaInfo.paragraph.equals(dropSelectionStartParaInfo.paragraph) && this.dragEndParaInfo.offset < dropSelectionStartParaInfo.offset && !this.owner.enableTrackChanges) {\n        dropExtraOffset -= this.dragEndParaInfo.paragraph.getLength();\n        dropSelectionStartParaInfo.offset -= dropExtraOffset;\n        dropSelectionEndParaInfo.offset -= dropExtraOffset;\n        dropSelectionStartParaIndex = this.selection.getHierarchicalIndex(dropSelectionStartParaInfo.paragraph, dropSelectionStartParaInfo.offset.toString());\n        dropSelectionEndParaIndex = this.selection.getHierarchicalIndex(dropSelectionEndParaInfo.paragraph, dropSelectionEndParaInfo.offset.toString());\n      }\n      if (!hasNewLineChar || !this.dragEndParaInfo.paragraph.equals(dropSelectionEndParaInfo.paragraph)) {\n        dropSelectionStartParaIndex = this.selection.getHierarchicalIndex(dropSelectionStartParaInfo.paragraph, dropSelectionStartParaInfo.offset.toString());\n        dropSelectionEndParaIndex = this.selection.getHierarchicalIndex(dropSelectionEndParaInfo.paragraph, dropSelectionEndParaInfo.offset.toString());\n      }\n      dropSelectionStartPos = this.selection.getTextPosBasedOnLogicalIndex(dropSelectionStartParaIndex);\n      dropSelectionEndPos = this.selection.getTextPosBasedOnLogicalIndex(dropSelectionEndParaIndex);\n      this.selection.start = dropSelectionStartPos;\n      this.selection.end = dropSelectionEndPos;\n      this.owner.editorModule.copiedTextContent = '';\n      this.owner.editorModule.paste();\n      if (!isEnableLocalPasteTrue) {\n        this.owner.enableLocalPaste = false;\n      }\n      this.owner.editorHistoryModule.updateComplexHistory();\n    } else {\n      this.owner.selectionModule.selectPosition(dragOnSelectionStartPos, dragOnSelectionEndPos);\n    }\n    this.dragStartParaInfo = undefined;\n    this.dragEndParaInfo = undefined;\n    this.selection.caret.classList.add(\"e-de-cursor-animation\");\n  };\n  DocumentHelper.prototype.isSelectionInListText = function (cursorPoint) {\n    var widget = this.getLineWidget(cursorPoint);\n    if (!isNullOrUndefined(widget) && widget.children[0] instanceof ListTextElementBox) {\n      var left = this.getLeftValue(widget);\n      var width = widget.children[0].width;\n      var height = widget.children[0].height;\n      if (this.isInsideRect(left, widget.paragraph.y, width, height, cursorPoint)) {\n        this.selectionLineWidget = widget;\n        return true;\n      }\n    }\n    return false;\n  };\n  DocumentHelper.prototype.isInShapeBorder = function (floatElement, cursorPoint) {\n    if (!isNullOrUndefined(floatElement)) {\n      var width = floatElement.width;\n      var height = floatElement.height;\n      if (this.isInsideRect(floatElement.x - floatElement.margin.left, floatElement.y - floatElement.margin.top, width, height, cursorPoint)) {\n        // this.selectionLineWidget = this.getLineWidget(cursorPoint);\n        if (floatElement instanceof ImageElementBox) {\n          return true;\n        } else if (floatElement instanceof ShapeElementBox) {\n          var lineWidth = floatElement.lineFormat.weight;\n          if (!this.isInsideRect(floatElement.x + lineWidth, floatElement.y + lineWidth + floatElement.textFrame.marginTop, width - lineWidth * 2, height - (lineWidth * 2 + floatElement.textFrame.marginTop + floatElement.textFrame.marginBottom), cursorPoint)) {\n            return true;\n          }\n        }\n      }\n    }\n    return false;\n  };\n  /**\n   * Check whether touch point is inside the rectangle or not.\n   *\n   * @private\n   * @param {number} x - Specifies left position.\n   * @param {number} y - Specifies top position.\n   * @param {number} width - Specifies width.\n   * @param {number} height - Specifies height\n   * @param {Point} touchPoint - Specifies the point to check.\n   * @returns {boolean} - Return true if points intersect.\n   */\n  DocumentHelper.prototype.isInsideRect = function (x, y, width, height, touchPoint) {\n    if (touchPoint.x > x && touchPoint.x <= x + width && touchPoint.y > y && touchPoint.y <= y + height) {\n      return true;\n    }\n    return false;\n  };\n  DocumentHelper.prototype.getLeftValue = function (widget) {\n    var left = widget.paragraph.x;\n    var paragraphFormat = widget.paragraph.paragraphFormat;\n    if (this.selection.isParagraphFirstLine(widget)) {\n      if (paragraphFormat.textAlignment === 'Right') {\n        left -= HelperMethods.convertPointToPixel(paragraphFormat.firstLineIndent);\n        left -= HelperMethods.convertPointToPixel(paragraphFormat.leftIndent);\n      } else {\n        left += HelperMethods.convertPointToPixel(paragraphFormat.firstLineIndent);\n      }\n    }\n    var element = widget.children[0];\n    if (element instanceof ListTextElementBox) {\n      left += element.margin.left;\n    }\n    return left;\n  };\n  /**\n   * Checks whether left mouse button is pressed or not.\n   *\n   * @param {MouseEvent} event - Specifies mouse event.\n   * @returns {boolean} - Returns true if left mouse button is clicked.\n   */\n  DocumentHelper.prototype.isLeftButtonPressed = function (event) {\n    this.isTouchInput = false;\n    var button = event.which || event.button;\n    return button === 1;\n  };\n  DocumentHelper.prototype.updateSelectionOnTouch = function (point, touchPoint) {\n    this.zoomX = undefined;\n    this.zoomY = undefined;\n    if (this.isMouseDown && !this.isSelectionChangedOnMouseMoved && !isNullOrUndefined(this.currentPage) && !isNullOrUndefined(this.owner.selectionModule.start)) {\n      if (!isNullOrUndefined(this.currentSelectedComment) && this.owner.commentReviewPane && !this.owner.commentReviewPane.commentPane.isEditMode) {\n        this.currentSelectedComment = undefined;\n      }\n      if (this.touchDownOnSelectionMark === 0) {\n        this.updateTextPositionForSelection(new Point(touchPoint.x, touchPoint.y), this.tapCount);\n        if (this.tapCount === 2) {\n          this.selection.checkAndEnableHeaderFooter(point, touchPoint);\n        }\n      }\n      if (this.owner.selectionModule.isEmpty) {\n        this.selection.updateCaretPosition();\n      }\n      this.selection.checkForCursorVisibility();\n    }\n  };\n  /**\n   * Gets touch offset value.\n   *\n   * @private\n   * @param {TouchEvent} event - Specifies touch event\n   * @returns {Point}  - Returns modified touch offset\n   */\n  DocumentHelper.prototype.getTouchOffsetValue = function (event) {\n    var targetElement = this.viewerContainer;\n    var offset = targetElement.getBoundingClientRect();\n    var touchOffsetValues = event.touches[0];\n    if (isNullOrUndefined(touchOffsetValues)) {\n      touchOffsetValues = event.changedTouches[0];\n    }\n    var offsetX = touchOffsetValues.clientX - offset.left;\n    var offsetY = touchOffsetValues.clientY - offset.top;\n    return new Point(offsetX, offsetY);\n  };\n  /**\n   * Fired on pinch zoom in.\n   *\n   * @private\n   * @param {TouchEvent} event - Specifies touch event\n   * @returns {void}\n   */\n  DocumentHelper.prototype.onPinchInInternal = function (event) {\n    this.preZoomFactor = this.zoomFactor;\n    var updatedZoomFactor = this.zoomFactor - 0.01;\n    if (updatedZoomFactor < 5 && updatedZoomFactor > 2) {\n      updatedZoomFactor = updatedZoomFactor - 0.01;\n    }\n    if (updatedZoomFactor < 0.1) {\n      updatedZoomFactor = 0.1;\n    }\n    this.zoomFactor = updatedZoomFactor;\n  };\n  DocumentHelper.prototype.onPinchOutInternal = function (event) {\n    this.preZoomFactor = this.zoomFactor;\n    var updatedZoomFactor = this.zoomFactor + 0.01;\n    if (updatedZoomFactor > 2) {\n      updatedZoomFactor = updatedZoomFactor + 0.01;\n    }\n    if (updatedZoomFactor > 5) {\n      updatedZoomFactor = 5;\n    }\n    this.zoomFactor = updatedZoomFactor;\n  };\n  DocumentHelper.prototype.getPageWidth = function (page) {\n    var width = page.boundingRectangle.width;\n    return width;\n  };\n  /**\n   * Removes specified page.\n   * @private\n   * @param {Page} page - Specifies page to remove\n   * @returns {void}\n   */\n  DocumentHelper.prototype.removePage = function (page) {\n    if (this.currentPage === page) {\n      this.currentPage = undefined;\n    }\n    if (page.headerWidgetIn) {\n      page.headerWidgetIn.page = undefined;\n    }\n    if (page.footerWidgetIn) {\n      page.footerWidgetIn.page = undefined;\n    }\n    if (page.headerWidget) {\n      page.headerWidget.page = undefined;\n    }\n    if (page.footerWidget) {\n      page.footerWidget.page = undefined;\n    }\n    var index = this.pages.indexOf(page);\n    if (index > -1) {\n      this.pages.splice(index, 1);\n    }\n    //this.removeRenderedPages();\n    if (!isNullOrUndefined(this.owner.viewer.visiblePages)) {\n      if (this.owner.viewer.visiblePages.indexOf(page) > -1) {\n        var pageIndex = this.owner.viewer.visiblePages.indexOf(page);\n        this.owner.viewer.visiblePages.splice(pageIndex, 1);\n      }\n    }\n    //(viewer as PageLayoutViewer).visiblePages.remove(page);\n    var height = 0;\n    for (var i = 0; i < this.pages.length; i++) {\n      height = height + this.pages[i].boundingRectangle.height;\n    }\n    //Updates the vertical height.\n    height -= page.boundingRectangle.height + 20;\n    //ToDo:Update horizontal width, if removed page has max width.\n    var top = 20;\n    if (index > 0) {\n      top += this.pages[index - 1].boundingRectangle.bottom;\n    }\n    if (index !== -1) {\n      for (var i = index; i < this.pages.length; i++) {\n        //Update bounding rectangle of next pages in collection.\n        page = this.pages[i];\n        page.boundingRectangle = new Rect(page.boundingRectangle.x, top, page.boundingRectangle.width, page.boundingRectangle.height);\n        top = page.boundingRectangle.bottom + 20;\n        if (!isNullOrUndefined(page.bodyWidgets[0].firstChild) && !(page.bodyWidgets[0].firstChild instanceof TableWidget && page.bodyWidgets[0].firstChild.header)) {\n          page.repeatHeaderRowTableWidget = false;\n        }\n      }\n    }\n  };\n  // private removeRenderedPages(): void {\n  //     for (let i: number = 0; i < this.pages.length; i++) {\n  //         this.clearContainer(this.pages[i]);\n  //     }\n  // }\n  /**\n   * Updates viewer size on window resize.\n   *\n   * @private\n   * @returns {void}\n   */\n  DocumentHelper.prototype.updateViewerSize = function () {\n    var _this = this;\n    var element = this.owner.getDocumentEditorElement();\n    this.updateViewerSizeInternal(element);\n    this.owner.viewer.updateScrollBars();\n    if (this.owner.viewer instanceof WebLayoutViewer && !isNullOrUndefined(this.owner) && !isNullOrUndefined(element)) {\n      if (this.resizerTimer) {\n        clearTimeout(this.resizerTimer);\n      }\n      /* eslint-disable @typescript-eslint/indent */\n      this.resizerTimer = setTimeout(function () {\n        if (!isNullOrUndefined(_this.owner)) {\n          var currentVisibleWidth = void 0;\n          if (!isNullOrUndefined(_this.visibleBounds)) {\n            currentVisibleWidth = _this.visibleBounds.width;\n          } else {\n            currentVisibleWidth = 0;\n          }\n          if (isNullOrUndefined(_this.owner.viewer.preVisibleWidth)) {\n            _this.owner.viewer.preVisibleWidth = 0;\n          }\n          if (!isNullOrUndefined(_this.visibleBounds) && currentVisibleWidth !== _this.owner.viewer.preVisibleWidth) {\n            _this.owner.editorModule.layoutWholeDocument();\n            _this.owner.viewer.preVisibleWidth = currentVisibleWidth;\n          }\n          if (_this.resizerTimer) {\n            clearTimeout(_this.resizerTimer);\n          }\n        }\n      }, 50);\n    }\n    if (!isNullOrUndefined(this.selection)) {\n      this.selection.updateCaretPosition();\n    }\n    // if(!isNullOrUndefined(this.owner) && (!isNullOrUndefined(this.owner.hRuler && !isNullOrUndefined(this.owner.vRuler))))\n    // {\n    //      updateRuler(this.owner);\n    // }\n  };\n  /**\n   * @private\n   */\n  DocumentHelper.prototype.triggerAutoResizeInterval = function () {\n    var _this = this;\n    var timer = 0;\n    var element = this.owner.element;\n    var args = {\n      cancel: false\n    };\n    this.owner.notify(beforeAutoResize, args);\n    if (!isNullOrUndefined(args.element)) {\n      element = args.element;\n    }\n    element.style.visibility = 'hidden';\n    showSpinner(element);\n    var counter = 0;\n    var internal = this.owner.documentEditorSettings.autoResizeSettings.interval;\n    if (this.isAutoResizeCanStart) {\n      timer = setInterval(function () {\n        counter++;\n        var tempRect = _this.owner.element.getBoundingClientRect();\n        if (tempRect.width !== 0 && tempRect.height !== 0) {\n          _this.isAutoResizeCanStart = false;\n          var args_1 = {\n            cancel: false\n          };\n          _this.owner.notify(internalAutoResize, args_1);\n          clearInterval(timer);\n          if (!args_1.cancel) {\n            _this.owner.resize();\n          }\n          hideSpinner(element);\n          element.style.visibility = 'visible';\n        } else if (counter > _this.owner.documentEditorSettings.autoResizeSettings.iterationCount) {\n          clearInterval(timer);\n          hideSpinner(element);\n          element.style.visibility = 'visible';\n        }\n      }, internal);\n    } else {\n      hideSpinner(element);\n      element.style.visibility = 'visible';\n    }\n  };\n  DocumentHelper.prototype.updateViewerSizeInternal = function (element) {\n    if (!isNullOrUndefined(element)) {\n      var rect = element.getBoundingClientRect();\n      if (rect.width === 0 && rect.height === 0) {\n        this.isAutoResizeCanStart = true;\n      } else {\n        this.isAutoResizeCanStart = false;\n      }\n      var width = 0;\n      var height = 0;\n      height = rect.height > 0 ? rect.height : 200;\n      var restrictPaneRect = this.restrictEditingPane && this.restrictEditingPane.isShowRestrictPane ? this.restrictEditingPane.restrictPane.getBoundingClientRect() : undefined;\n      var optionsRect = this.owner.optionsPaneModule && this.owner.optionsPaneModule.isOptionsPaneShow ? this.owner.optionsPaneModule.optionsPane.getBoundingClientRect() : undefined;\n      var commentPane = this.owner.commentReviewPane && this.owner.commentReviewPane.parentPaneElement ? this.owner.commentReviewPane.parentPaneElement.getBoundingClientRect() : undefined;\n      if (restrictPaneRect || optionsRect || commentPane) {\n        var paneWidth = restrictPaneRect ? restrictPaneRect.width : 0;\n        paneWidth += optionsRect ? optionsRect.width : 0;\n        paneWidth += commentPane ? commentPane.width : 0;\n        width = rect.width - paneWidth > 0 ? rect.width - paneWidth : 200;\n      } else {\n        width = rect.width > 0 ? rect.width : 200;\n      }\n      this.viewerContainer.style.height = height.toString() + 'px';\n      this.viewerContainer.style.width = Math.ceil(width) + 'px';\n      this.visibleBoundsIn = new Rect(0, 0, width, height);\n      this.containerCanvas.width = width;\n      this.containerCanvas.height = height;\n      this.selectionCanvas.width = width;\n      this.selectionCanvas.height = height;\n      this.measureScrollbarWidth(element);\n    }\n  };\n  /**\n   * Inserts page in specified index.\n   *\n   * @private\n   * @param {number} index - Specifes index to insert page\n   * @param {Page} page - Page to insert.\n   * @returns {void}\n   */\n  DocumentHelper.prototype.insertPage = function (index, page) {\n    if (this.pages.indexOf(page) > -1) {\n      this.pages.splice(this.pages.indexOf(page), 1);\n    }\n    this.pages.splice(index, 0, page);\n    var top = 20;\n    if (index > 0) {\n      top += this.pages[index - 1].boundingRectangle.bottom;\n    }\n    for (var i = index; i < this.pages.length; i++) {\n      //Update bounding rectangle of next pages in collection.\n      page = this.pages[i];\n      page.boundingRectangle = new Rect(page.boundingRectangle.x, top, page.boundingRectangle.width, page.boundingRectangle.height);\n      top = page.boundingRectangle.bottom + 20;\n    }\n  };\n  DocumentHelper.prototype.updateTextPositionForSelection = function (cursorPoint, tapCount) {\n    var widget = this.getLineWidget(cursorPoint);\n    if (!isNullOrUndefined(widget)) {\n      this.selection.updateTextPosition(widget, cursorPoint);\n    }\n    if (tapCount > 1) {\n      this.isMouseDown = false;\n      this.useTouchSelectionMark = false;\n      if (this.pages.length === 0) {\n        return;\n      }\n      //Double tap/triple tap selection\n      if (!isNullOrUndefined(this.currentPage) && !isNullOrUndefined(this.owner.selectionModule.start)) {\n        if (tapCount % 2 === 0) {\n          this.owner.selectionModule.selectCurrentWord();\n        } else if (!this.isDragStarted) {\n          this.owner.selectionModule.selectParagraph();\n        }\n      }\n    }\n  };\n  DocumentHelper.prototype.scrollToPosition = function (startPosition, endPosition, skipCursorUpdate, isBookmark) {\n    if (this.skipScrollToPosition || this.isWebPrinting || this.owner.editorModule && this.owner.editorModule.isRemoteAction) {\n      this.skipScrollToPosition = false;\n      return;\n    }\n    if (this.owner.enableImageResizerMode && this.owner.imageResizerModule.isImageResizing || this.isMouseDownInFooterRegion || this.isRowOrCellResizing) {\n      return;\n    }\n    var lineWidget = this.selection.getLineWidgetInternal(endPosition.currentWidget, endPosition.offset, true);\n    if (isNullOrUndefined(lineWidget)) {\n      return;\n    }\n    var top = this.selection.getTop(lineWidget);\n    if (this.isMouseDown) {\n      var prevLineWidget = this.selection.getLineWidgetInternal(endPosition.currentWidget, endPosition.offset, false);\n      var prevTop = this.selection.getTop(prevLineWidget);\n      if (prevLineWidget !== lineWidget && endPosition.location.y >= prevTop) {\n        lineWidget = prevLineWidget;\n      }\n    }\n    var height = lineWidget.height;\n    //Gets current page.\n    var endPage = this.selection.getPage(lineWidget.paragraph);\n    this.currentPage = endPage;\n    var x = 0;\n    var y = 0;\n    var horizontalWidth = 0;\n    var isPageLayout = this.owner.viewer instanceof PageLayoutViewer;\n    var pageLayout = this.owner.viewer;\n    if (isNullOrUndefined(endPage)) {\n      return;\n    }\n    var pageWidth = endPage.boundingRectangle.width;\n    x = (this.visibleBounds.width - pageWidth * this.zoomFactor) / 2;\n    if (x < 30) {\n      x = 30;\n    }\n    y = endPage.boundingRectangle.y * this.zoomFactor + (this.pages.indexOf(endPage) + 1) * this.owner.viewer.pageGap * (1 - this.zoomFactor);\n    var scrollTop = this.owner.viewer.containerTop;\n    var scrollLeft = this.owner.viewer.containerLeft;\n    var pageHeight = this.visibleBounds.height;\n    var caretInfo = this.selection.updateCaretSize(this.owner.selectionModule.end, true);\n    var topMargin = caretInfo.topMargin;\n    var caretHeight = caretInfo.height;\n    x += endPosition.location.x * this.zoomFactor;\n    y += (endPosition.location.y + topMargin) * this.zoomFactor;\n    if (!isBookmark) {\n      //vertical scroll bar update\n      if (scrollTop + 20 > y) {\n        this.viewerContainer.scrollTop = y - 10;\n      } else if (scrollTop + pageHeight < y + caretHeight) {\n        this.viewerContainer.scrollTop = y + caretHeight - pageHeight + 10;\n      }\n    } else {\n      // As per MS Word behaviour, update vertical scroll bar using static value while navigate bookmark\n      this.viewerContainer.scrollTop = y - 96;\n    }\n    if (!skipCursorUpdate) {\n      this.selection.updateCaretToPage(startPosition, endPage);\n    }\n    var scrollBarWidth = this.viewerContainer.offsetWidth - this.viewerContainer.clientWidth;\n    if (scrollLeft > x) {\n      this.viewerContainer.scrollLeft = x - this.pageContainer.offsetWidth / 100 * 20;\n    } else if (scrollLeft + this.visibleBounds.width < x + scrollBarWidth) {\n      this.viewerContainer.scrollLeft = scrollLeft + this.pageContainer.offsetWidth / 100 * 15 + scrollBarWidth;\n      while (x < this.owner.viewer.containerWidth && this.viewerContainer.scrollLeft + this.visibleBounds.width < x + scrollBarWidth) {\n        this.viewerContainer.scrollLeft = this.viewerContainer.scrollLeft + this.pageContainer.offsetWidth / 100 * 15 + scrollBarWidth;\n      }\n    }\n  };\n  DocumentHelper.prototype.getLineWidget = function (cursorPoint) {\n    return this.getLineWidgetInternal(cursorPoint, false);\n  };\n  DocumentHelper.prototype.getLineWidgetInternal = function (cursorPoint, isMouseDragged) {\n    var widget = undefined;\n    if (!isNullOrUndefined(this.currentPage)) {\n      var childWidgets = void 0;\n      if (this.owner.enableHeaderAndFooter) {\n        var page = this.currentPage;\n        var pageBottom = page.boundingRectangle.height;\n        var headerHeight = Math.max(page.headerWidget.y + page.headerWidget.height, HelperMethods.convertPointToPixel(page.bodyWidgets[0].sectionFormat.topMargin)) * this.zoomFactor;\n        var footerDistance = HelperMethods.convertPointToPixel(page.bodyWidgets[0].sectionFormat.footerDistance);\n        var footerHeight = page.boundingRectangle.height - Math.max(page.footerWidget.height + footerDistance, footerDistance * 2);\n        if (isMouseDragged) {\n          if (this.isBlockInHeader(this.selection.start.paragraph)) {\n            childWidgets = this.currentPage.headerWidget;\n          } else {\n            childWidgets = this.currentPage.footerWidget;\n          }\n        } else {\n          if (cursorPoint.y <= pageBottom && cursorPoint.y >= footerHeight) {\n            childWidgets = this.currentPage.footerWidget;\n          } else if (cursorPoint.y >= 0 && cursorPoint.y <= headerHeight) {\n            childWidgets = this.currentPage.headerWidget;\n          }\n        }\n        if (isNullOrUndefined(childWidgets)) {\n          return undefined;\n        }\n        var shapeElementInfo = this.checkFloatingItems(childWidgets, cursorPoint, isMouseDragged);\n        if (shapeElementInfo.isShapeSelected) {\n          if (shapeElementInfo.isInShapeBorder) {\n            return shapeElementInfo.element.line;\n          }\n          return this.selection.getLineWidgetBodyWidget(shapeElementInfo.element.textFrame, cursorPoint);\n        } else {\n          return this.selection.getLineWidgetBodyWidget(childWidgets, cursorPoint);\n        }\n      } else {\n        var shapeInfo = undefined;\n        var behindShapeInfo = undefined;\n        for (var i = 0; i < this.currentPage.bodyWidgets.length; i++) {\n          var bodyWidget = this.currentPage.bodyWidgets[i];\n          shapeInfo = this.checkFloatingItems(bodyWidget, cursorPoint, isMouseDragged, false);\n          behindShapeInfo = this.checkFloatingItems(bodyWidget, cursorPoint, isMouseDragged, true);\n          if (shapeInfo.isShapeSelected || behindShapeInfo.isShapeSelected) {\n            break;\n          }\n        }\n        if (shapeInfo.isShapeSelected && !this.isEmptyShape(shapeInfo)) {\n          if (shapeInfo.isInShapeBorder) {\n            return shapeInfo.element.line;\n          }\n          if (shapeInfo.element instanceof ShapeElementBox) {\n            widget = this.selection.getLineWidgetBodyWidget(shapeInfo.element.textFrame, cursorPoint);\n          }\n        } else if (isMouseDragged && this.isFootnoteWidget) {\n          if (this.selection.start.paragraph.bodyWidget.footNoteReference !== undefined && this.selection.start.paragraph.bodyWidget.containerWidget instanceof FootNoteWidget && this.selection.start.paragraph.bodyWidget.containerWidget.footNoteType === 'Footnote') {\n            return this.selection.getLineWidgetBodyWidget(this.currentPage.footnoteWidget, cursorPoint);\n          } else if (this.selection.start.paragraph.bodyWidget.footNoteReference !== undefined && this.selection.start.paragraph.bodyWidget.containerWidget instanceof FootNoteWidget && this.selection.start.paragraph.bodyWidget.containerWidget.footNoteType === 'Endnote') {\n            return this.selection.getLineWidgetBodyWidget(this.currentPage.endnoteWidget, cursorPoint);\n          }\n        } else {\n          if (!isMouseDragged && this.currentPage.footnoteWidget && this.isInFootnoteWidget(this.currentPage.footnoteWidget, cursorPoint)) {\n            widget = this.selection.getLineWidgetBodyWidget(this.currentPage.footnoteWidget, cursorPoint);\n            if (widget) {\n              this.isFootnoteWidget = true;\n            }\n          } else if (!isMouseDragged && this.currentPage.endnoteWidget && this.isInFootnoteWidget(this.currentPage.endnoteWidget, cursorPoint)) {\n            widget = this.selection.getLineWidgetBodyWidget(this.currentPage.endnoteWidget, cursorPoint);\n            if (widget) {\n              this.isFootnoteWidget = true;\n            }\n          } else {\n            for (var i_1 = 0; i_1 < this.currentPage.bodyWidgets.length; i_1++) {\n              var bodyWidget_1 = this.currentPage.bodyWidgets[i_1];\n              if (i_1 < this.currentPage.bodyWidgets.length - 1) {\n                if (cursorPoint.x <= bodyWidget_1.x + bodyWidget_1.width) {\n                  //let isGetFirstChild: boolean = i === this.currentPage.bodyWidgets.length - 1;\n                  widget = this.selection.getLineWidgetBodyWidget(bodyWidget_1, cursorPoint, true);\n                  if (!isNullOrUndefined(widget) && widget.paragraph.y <= cursorPoint.y && widget.paragraph.y + widget.paragraph.height >= cursorPoint.y) {\n                    this.isFootnoteWidget = false;\n                    break;\n                  }\n                }\n              }\n              if (cursorPoint.x > bodyWidget_1.x + bodyWidget_1.width && this.layout.getNextWidgetHeight(bodyWidget_1) >= cursorPoint.y && bodyWidget_1.y <= cursorPoint.y) {\n                if (isNullOrUndefined(bodyWidget_1.nextRenderedWidget) || !(this.layout.getNextWidgetHeight(bodyWidget_1.nextRenderedWidget) >= cursorPoint.y && bodyWidget_1.nextRenderedWidget.y <= cursorPoint.y)) {\n                  widget = this.selection.getLineWidgetBodyWidget(bodyWidget_1, cursorPoint, true);\n                  if (!isNullOrUndefined(widget) && widget.paragraph.y <= cursorPoint.y && widget.paragraph.y + widget.paragraph.height >= cursorPoint.y) {\n                    this.isFootnoteWidget = false;\n                    break;\n                  }\n                }\n              }\n              if (i_1 == this.currentPage.bodyWidgets.length - 1) {\n                widget = this.selection.getLineWidgetBodyWidget(bodyWidget_1, cursorPoint, true);\n                if (!isNullOrUndefined(widget) && widget.paragraph.y <= cursorPoint.y && widget.paragraph.y + widget.paragraph.height >= cursorPoint.y) {\n                  this.isFootnoteWidget = false;\n                  break;\n                }\n              }\n              if (cursorPoint.x < bodyWidget_1.x && i_1 < this.currentPage.bodyWidgets.length - 1) {\n                widget = this.selection.getLineWidgetBodyWidget(bodyWidget_1, cursorPoint, true);\n                if (!isNullOrUndefined(widget) && widget.paragraph.y <= cursorPoint.y && widget.paragraph.y + widget.paragraph.height >= cursorPoint.y) {\n                  this.isFootnoteWidget = false;\n                  break;\n                } else if (!isNullOrUndefined(widget) && i_1 === this.currentPage.bodyWidgets.length - 1) {\n                  this.isFootnoteWidget = false;\n                  break;\n                }\n              }\n            }\n          }\n          var inlineShapeInfo = this.checkInlineShapeItems(widget, cursorPoint, isMouseDragged);\n          if (inlineShapeInfo.isShapeSelected) {\n            if (inlineShapeInfo.isInShapeBorder) {\n              return inlineShapeInfo.element.line;\n            }\n            if (inlineShapeInfo.element instanceof ShapeElementBox) {\n              widget = this.selection.getLineWidgetBodyWidget(inlineShapeInfo.element.textFrame, cursorPoint);\n            }\n          } else if (!this.checkPointIsInLine(widget, cursorPoint) && behindShapeInfo.isShapeSelected) {\n            if (behindShapeInfo.isInShapeBorder) {\n              return behindShapeInfo.element.line;\n            }\n            if (behindShapeInfo.element instanceof ShapeElementBox) {\n              widget = this.selection.getLineWidgetBodyWidget(behindShapeInfo.element.textFrame, cursorPoint);\n            }\n          }\n        }\n      }\n    }\n    return widget;\n  };\n  DocumentHelper.prototype.checkInlineShapeItems = function (widget, cursorPoint, isMouseDragged) {\n    var isInShape = false;\n    var isInShapeBorder = false;\n    var floatingElement;\n    var selectionInShape = this.selection.isInShape;\n    var isMouseDraggedInShape = isMouseDragged && selectionInShape;\n    if (!isNullOrUndefined(widget) && widget.children.length > 0) {\n      if (isMouseDraggedInShape) {\n        var textFrame = this.owner.selectionModule.getCurrentTextFrame();\n        if (textFrame) {\n          floatingElement = textFrame.containerShape;\n          isInShape = true;\n        }\n      } else {\n        for (var i = 0; i < widget.children.length; i++) {\n          if (!(widget.children[i] instanceof ShapeElementBox && widget.children[i].textWrappingStyle === 'Inline')) {\n            continue;\n          }\n          floatingElement = widget.children[i];\n          if (cursorPoint.x < floatingElement.x + floatingElement.margin.left + floatingElement.width && cursorPoint.x > floatingElement.x && cursorPoint.y < floatingElement.y + floatingElement.margin.top + floatingElement.height && cursorPoint.y > floatingElement.y) {\n            isInShape = true;\n            if (this.isInShapeBorder(floatingElement, cursorPoint)) {\n              isInShapeBorder = true;\n            }\n            break;\n          }\n        }\n        if (isMouseDragged && !selectionInShape) {\n          isInShape = false;\n        }\n      }\n    }\n    return {\n      'element': floatingElement,\n      'caretPosition': cursorPoint,\n      'isInShapeBorder': isInShapeBorder,\n      'isShapeSelected': isInShape\n    };\n  };\n  /**\n   * @private\n   */\n  DocumentHelper.prototype.checkPointIsInLine = function (widget, cursorPoint) {\n    if (!isNullOrUndefined(widget) && widget.children.length > 0) {\n      var element = void 0;\n      var left = widget.paragraph.x;\n      var top_1 = this.selection.getTop(widget);\n      for (var i = widget.children.indexOf(widget.children[0]); i < widget.children.length; i++) {\n        element = widget.children[i];\n        if (element instanceof ShapeBase && element.textWrappingStyle !== 'Inline') {\n          continue;\n        }\n        if (cursorPoint.x < left + element.margin.left + element.width + element.padding.left && cursorPoint.x > left && cursorPoint.y < top_1 + widget.height && cursorPoint.y > top_1) {\n          return true;\n        }\n        left += element.margin.left + element.width + element.padding.left;\n      }\n    }\n    return false;\n  };\n  DocumentHelper.prototype.isInFootnoteWidget = function (footnoteWidget, point) {\n    for (var i = 0; i < footnoteWidget.bodyWidgets.length; i++) {\n      for (var j = 0; j < footnoteWidget.bodyWidgets[i].childWidgets.length; j++) {\n        var childWidget = footnoteWidget.bodyWidgets[i].childWidgets[j];\n        if (childWidget instanceof Widget && childWidget.y <= point.y && childWidget.y + childWidget.height >= point.y) {\n          return true;\n        }\n      }\n    }\n    return false;\n  };\n  DocumentHelper.prototype.checkFloatingItems = function (blockContainer, cursorPoint, isMouseDragged, isBehind) {\n    var isInShape = false;\n    var isInShapeBorder = false;\n    var floatElement;\n    var selectionInShape = this.selection.isInShape;\n    var isMouseDraggedInShape = isMouseDragged && selectionInShape;\n    if (blockContainer.floatingElements.length > 0) {\n      var page = this.currentPage;\n      /* eslint-disable */\n      blockContainer.floatingElements.sort(function (a, b) {\n        if (a instanceof TableWidget || b instanceof TableWidget) {\n          return 0;\n        } else {\n          return a.zOrderPosition - b.zOrderPosition;\n        }\n      });\n      if (isMouseDraggedInShape) {\n        var textFrame = this.owner.selectionModule.getCurrentTextFrame();\n        if (textFrame) {\n          floatElement = textFrame.containerShape;\n          isInShape = true;\n        }\n      } else {\n        for (var i = blockContainer.floatingElements.length - 1; i >= 0; i--) {\n          if (blockContainer.floatingElements[i] instanceof TableWidget || (!isNullOrUndefined(isBehind) && isBehind ? blockContainer.floatingElements[i].textWrappingStyle !== 'Behind' : blockContainer.floatingElements[i].textWrappingStyle === 'Behind')) {\n            continue;\n          }\n          floatElement = blockContainer.floatingElements[i];\n          if (cursorPoint.x < floatElement.x + floatElement.margin.left + floatElement.width && cursorPoint.x > floatElement.x && cursorPoint.y < floatElement.y + floatElement.margin.top + floatElement.height && cursorPoint.y > floatElement.y) {\n            isInShape = true;\n            if (this.isInShapeBorder(floatElement, cursorPoint)) {\n              isInShapeBorder = true;\n            }\n            break;\n          }\n        }\n        if (isMouseDragged && !selectionInShape) {\n          isInShape = false;\n        }\n      }\n    }\n    return {\n      'element': floatElement,\n      'caretPosition': cursorPoint,\n      'isShapeSelected': isInShape,\n      'isInShapeBorder': isInShapeBorder\n    };\n  };\n  DocumentHelper.prototype.isBlockInHeader = function (block) {\n    while (!(block.containerWidget instanceof HeaderFooterWidget)) {\n      if (!block.containerWidget) {\n        return false;\n      }\n      block = block.containerWidget;\n      if (block instanceof TextFrame) {\n        block = block.containerShape.paragraph;\n      }\n    }\n    return block.containerWidget.headerFooterType.indexOf('Header') !== -1;\n  };\n  DocumentHelper.prototype.clearSelectionHighlight = function () {\n    var canClear = true;\n    canClear = !this.isControlPressed || !this.isMouseDown;\n    // if (this.owner.selection.selectionRanges.length > 0 && canClear) {\n    if (this.owner.selectionModule.clearSelectionHighlightInSelectedWidgets()) {\n      this.selectionContext.clearRect(0, 0, this.selectionCanvas.width, this.selectionCanvas.height);\n    }\n    // } else if (!isNullOrUndefined(this.owner.selection.currentSelectionRange) && this.isMouseDown) {\n    //     this.owner.selection.currentSelectionRange.clearSelectionHighlight();\n    // }\n    //this.renderVisiblePages();\n  };\n  /**\n   * @private\n   * @returns {void}\n   */\n  DocumentHelper.prototype.removeEmptyPages = function () {\n    var scrollToLastPage = false;\n    var pageIndex = this.selection.startPage - 1;\n    for (var j = 0; j < this.pages.length; j++) {\n      var page = this.pages[j];\n      for (var i = 0; i < page.bodyWidgets.length; i++) {\n        if (page.bodyWidgets.length === 0 || page.bodyWidgets[i].childWidgets.length === 0) {\n          if (page.bodyWidgets.length >= 1) {\n            var startindex = page.bodyWidgets.indexOf(page.bodyWidgets[i]);\n            page.bodyWidgets.splice(startindex, 1);\n            i--;\n          }\n        }\n      }\n      if (page.bodyWidgets.length <= 0) {\n        if (j === this.pages.length - 1 && this.owner.viewer instanceof PageLayoutViewer && this.owner.viewer.visiblePages.indexOf(this.pages[j]) !== -1) {\n          scrollToLastPage = true;\n        }\n        this.removePage(this.pages[j]);\n        j--;\n      }\n    }\n    if (!isNullOrUndefined(this.pages[pageIndex])) {\n      var page = this.pages[pageIndex];\n      if (page.headerWidget) {\n        page.headerWidget.page = page;\n      }\n      if (page.footerWidget) {\n        page.footerWidget.page = page;\n      }\n    }\n    if (scrollToLastPage) {\n      this.scrollToBottom();\n    }\n  };\n  /**\n   * @private\n   * @returns {void}\n   */\n  DocumentHelper.prototype.scrollToBottom = function () {\n    if (this.selection.start.paragraph && this.selection.start.paragraph.bodyWidget) {\n      var page = this.selection.start.paragraph.bodyWidget.page;\n      var containerHeight = this.visibleBounds.height;\n      this.viewerContainer.scrollTop = page.boundingRectangle.bottom - containerHeight;\n    }\n  };\n  DocumentHelper.prototype.getFieldResult = function (fieldBegin, page) {\n    if (!isNullOrUndefined(page) && !isNullOrUndefined(this.selection) && !isNullOrUndefined(fieldBegin)) {\n      var fieldCode = this.selection.getFieldCode(fieldBegin);\n      var fieldCodes = fieldCode.split('\\*');\n      var fieldCategory = fieldCodes[0].replace(/[^\\w\\s]/gi, '').trim().toLowerCase();\n      var fieldPattern = '';\n      if (fieldCodes.length > 1) {\n        if (fieldCodes[1] !== ' MERGEFORMAT') {\n          fieldPattern = fieldCodes[1].replace(/[^\\w\\s]/gi, '').trim();\n        }\n      }\n      if (fieldPattern == '') {\n        fieldPattern = page.bodyWidgets[0].sectionFormat.pageNumberStyle;\n      }\n      if (fieldCategory.indexOf(' ') !== -1) {\n        fieldCategory = fieldCategory.split(' ')[0];\n      }\n      switch (fieldCategory) {\n        case 'page':\n          if (page.bodyWidgets[0].sectionFormat.restartPageNumbering && page.sectionIndex !== 0) {\n            var currentSectionIndex_1 = page.sectionIndex;\n            var previousPage = page.previousPage;\n            this.isRestartNumbering = true;\n            if (currentSectionIndex_1 !== previousPage.sectionIndex && previousPage.bodyWidgets[previousPage.bodyWidgets.length - 1].sectionIndex !== currentSectionIndex_1) {\n              page.currentPageNum = page.bodyWidgets[0].sectionFormat.pageStartingNumber;\n              return this.getFieldText(fieldPattern, page.currentPageNum);\n            }\n            if (previousPage.currentPageNum === 1 && currentSectionIndex_1 !== previousPage.sectionIndex) {\n              previousPage.currentPageNum = page.bodyWidgets[0].sectionFormat.pageStartingNumber;\n            }\n            page.currentPageNum = previousPage.currentPageNum + 1;\n            return this.getFieldText(fieldPattern, page.currentPageNum);\n          } else if (page.bodyWidgets[0].sectionFormat.restartPageNumbering && page.sectionIndex === 0) {\n            page.currentPageNum = page.bodyWidgets[0].sectionFormat.pageStartingNumber + page.index;\n            return this.getFieldText(fieldPattern, page.currentPageNum);\n          }\n          if (!isNullOrUndefined(page.previousPage) && (page.previousPage.bodyWidgets[0].sectionFormat.restartPageNumbering && page.previousPage.currentPageNum === 1 || this.isRestartNumbering && page.previousPage.currentPageNum !== 1)) {\n            if (page.previousPage.bodyWidgets[0].sectionFormat.restartPageNumbering) {\n              this.isRestartNumbering = true;\n            }\n            page.currentPageNum = page.previousPage.currentPageNum + 1;\n          } else {\n            page.currentPageNum = page.index + 1;\n          }\n          return this.getFieldText(fieldPattern, page.currentPageNum);\n        case 'numpages':\n          return this.getFieldText(fieldPattern, page.documentHelper.pages.length);\n        case 'sectionpages':\n          var currentSectionIndex = page.sectionIndex;\n          var currentPageCount = 0;\n          for (var i = 0; i < page.documentHelper.pages.length; i++) {\n            if (page.documentHelper.pages[i].sectionIndex === currentSectionIndex) {\n              currentPageCount++;\n            } else if (currentPageCount !== 0) {\n              break;\n            }\n          }\n          return this.getFieldText(fieldPattern, currentPageCount);\n        default:\n          break;\n      }\n    }\n    return '';\n  };\n  DocumentHelper.prototype.getFieldText = function (pattern, value) {\n    switch (pattern) {\n      case 'ALPHABETIC':\n        return this.layout.getAsLetter(value).toUpperCase();\n      case 'alphabetic':\n        return this.layout.getAsLetter(value).toLowerCase();\n      case 'roman':\n        return this.layout.getAsRoman(value).toLowerCase();\n      case 'ROMAN':\n        return this.layout.getAsRoman(value).toUpperCase();\n      case 'RomanUpper':\n        return this.layout.getAsRoman(value).toUpperCase();\n      case 'RomanLower':\n        return this.layout.getAsRoman(value).toLowerCase();\n      case 'LetterUpper':\n        return this.layout.getAsLetter(value).toUpperCase();\n      case 'LetterLower':\n        return this.layout.getAsLetter(value).toLowerCase();\n      default:\n        return value.toString();\n    }\n  };\n  DocumentHelper.prototype.isEmptyShape = function (shape) {\n    var isEmpty = true;\n    if (shape.element instanceof ImageElementBox) {\n      return isEmpty;\n    }\n    var textFrame = shape.element.textFrame;\n    if (textFrame.childWidgets.length === 0) {\n      return isEmpty;\n    } else {\n      return false;\n    }\n  };\n  /**\n   * Destroys the internal objects maintained for control.\n   *\n   * @returns {void}\n   */\n  DocumentHelper.prototype.destroy = function () {\n    if (!isNullOrUndefined(this.owner)) {\n      this.unWireEvent();\n    }\n    if (this.styles) {\n      this.styles.destroy();\n      this.styles = undefined;\n    }\n    if (this.stylesMap) {\n      this.stylesMap.destroy();\n      this.stylesMap = undefined;\n    }\n    if (this.characterFormat) {\n      this.characterFormat.destroy();\n      this.characterFormat = undefined;\n    }\n    if (this.themeFontLanguage) {\n      this.themeFontLanguage.destroy();\n      this.themeFontLanguage = undefined;\n    }\n    if (this.paragraphFormat) {\n      this.paragraphFormat.destroy();\n      this.paragraphFormat = undefined;\n    }\n    if (this.pages && this.pages.length > 0) {\n      for (var i = 0; i < this.pages.length; i++) {\n        var page = this.pages[i];\n        page.componentDestroy();\n      }\n      this.pages = [];\n    }\n    this.pages = undefined;\n    if (this.lists && this.lists.length > 0) {\n      for (var i = 0; i < this.lists.length; i++) {\n        var list = this.lists[i];\n        list.destroy();\n      }\n      this.lists = [];\n    }\n    this.lists = undefined;\n    if (this.formFillPopup) {\n      this.formFillPopup.destroy();\n      this.formFillPopup = undefined;\n    }\n    this.L10n = undefined;\n    this.currentPage = undefined;\n    this.selectionStartPageIn = undefined;\n    this.selectionEndPageIn = undefined;\n    this.fieldStacks = [];\n    this.fieldStacks = undefined;\n    this.splittedCellWidgets = [];\n    this.splittedCellWidgets = undefined;\n    this.fields = [];\n    this.fields = undefined;\n    this.abstractLists = [];\n    this.abstractLists = undefined;\n    if (!isNullOrUndefined(this.owner)) {\n      this.renderedLists.destroy();\n    }\n    this.renderedLists = undefined;\n    if (!isNullOrUndefined(this.owner)) {\n      this.authors.destroy();\n    }\n    this.authors = undefined;\n    if (!isNullOrUndefined(this.owner)) {\n      this.revisionsInternal.destroy();\n    }\n    this.revisionsInternal = undefined;\n    if (!isNullOrUndefined(this.owner)) {\n      this.preDefinedStyles.destroy();\n    }\n    this.preDefinedStyles = undefined;\n    if (!isNullOrUndefined(this.owner)) {\n      this.bookmarks.destroy();\n    }\n    this.bookmarks = undefined;\n    if (!isNullOrUndefined(this.owner)) {\n      this.editRanges.destroy();\n    }\n    this.editRanges = undefined;\n    if (!isNullOrUndefined(this.owner)) {\n      this.customXmlData.destroy();\n    }\n    if (!isNullOrUndefined(this.owner)) {\n      this.images.destroy();\n    }\n    if (!isNullOrUndefined(this.owner)) {\n      this.fontSubstitutionTable.destroy();\n    }\n    this.fontSubstitutionTable = undefined;\n    this.customXmlData = undefined;\n    this.images = undefined;\n    this.blockToShift = undefined;\n    this.cachedPages = [];\n    this.cachedPages = undefined;\n    if (this.comments && this.comments.length > 0) {\n      for (var i = 0; i < this.comments.length; i++) {\n        var comment = this.comments[i];\n        comment.destroy();\n      }\n      this.comments = [];\n    }\n    this.comments = undefined;\n    this.compositionEnd = undefined;\n    this.compositionStart = undefined;\n    this.compositionUpdated = undefined;\n    this.contentControlCollection = [];\n    this.contentControlCollection = undefined;\n    this.renderedLevelOverrides = [];\n    this.renderedLevelOverrides = undefined;\n    this.headersFooters = [];\n    this.headersFooters = undefined;\n    this.listParagraphs = [];\n    this.listParagraphs = undefined;\n    this.formFields = [];\n    this.formFields = undefined;\n    this.fieldCollection = [];\n    this.fieldCollection = undefined;\n    this.userCollection = [];\n    this.userCollection = undefined;\n    if (this.footnotes) {\n      this.footnotes.componentDestroy();\n      this.footnotes = undefined;\n    }\n    if (this.endnotes) {\n      this.endnotes.componentDestroy();\n      this.endnotes = undefined;\n    }\n    if (this.zoomModule) {\n      this.zoomModule.destroy();\n      this.zoomModule = undefined;\n    }\n    this.footnoteCollection = [];\n    this.footnoteCollection = undefined;\n    this.endnoteCollection = [];\n    this.endnoteCollection = undefined;\n    if (this.restrictEditingPane) {\n      this.restrictEditingPane.destroy();\n      this.restrictEditingPane = undefined;\n    }\n    if (this.layout) {\n      this.layout.destroy();\n    }\n    this.layout = undefined;\n    if (!isNullOrUndefined(this.render)) {\n      this.render.destroy();\n    }\n    this.render = undefined;\n    if (this.dialogInternal) {\n      this.dialogInternal.destroy();\n    }\n    this.dialogInternal = undefined;\n    if (this.dialogInternal2) {\n      this.dialogInternal2.destroy();\n      this.dialogInternal2 = undefined;\n    }\n    if (this.dialogInternal3) {\n      this.dialogInternal3.destroy();\n      this.dialogInternal3 = undefined;\n    }\n    if (this.dialogTarget1 && this.dialogTarget1.parentElement) {\n      this.dialogTarget1.parentElement.removeChild(this.dialogTarget1);\n    }\n    this.dialogTarget1 = undefined;\n    if (this.dialogTarget2 && this.dialogTarget2.parentElement) {\n      this.dialogTarget2.parentElement.removeChild(this.dialogTarget2);\n    }\n    this.dialogTarget2 = undefined;\n    if (this.dialogTarget3 && this.dialogTarget3.parentElement) {\n      this.dialogTarget3.parentElement.removeChild(this.dialogTarget3);\n    }\n    this.dialogTarget3 = undefined;\n    if (!isNullOrUndefined(this.touchStart)) {\n      this.touchStart.innerHTML = '';\n      if (!isNullOrUndefined(this.touchStart.parentElement)) {\n        this.touchStart.parentElement.removeChild(this.touchStart);\n      }\n    }\n    this.touchStart = undefined;\n    if (this.textHelper) {\n      this.textHelper.destroy();\n    }\n    this.textHelper = undefined;\n    if (!isNullOrUndefined(this.touchEnd)) {\n      this.touchEnd.innerHTML = '';\n      if (!isNullOrUndefined(this.touchEnd.parentElement)) {\n        this.touchEnd.parentElement.removeChild(this.touchEnd);\n      }\n    }\n    this.touchEnd = undefined;\n    if (!isNullOrUndefined(this.containerCanvasIn)) {\n      this.containerCanvasIn.innerHTML = '';\n      if (!isNullOrUndefined(this.containerCanvasIn.parentElement)) {\n        this.containerCanvasIn.parentElement.removeChild(this.containerCanvasIn);\n      }\n    }\n    this.containerCanvasIn = undefined;\n    if (!isNullOrUndefined(this.selectionCanvasIn)) {\n      this.selectionCanvasIn.innerHTML = '';\n      if (!isNullOrUndefined(this.selectionCanvasIn.parentElement)) {\n        this.selectionCanvasIn.parentElement.removeChild(this.selectionCanvasIn);\n      }\n    }\n    this.selectionCanvasIn = undefined;\n    if (!isNullOrUndefined(this.editableDiv)) {\n      this.editableDiv.innerHTML = '';\n      if (!isNullOrUndefined(this.editableDiv.parentElement)) {\n        this.editableDiv.parentElement.removeChild(this.editableDiv);\n      }\n    }\n    this.editableDiv = undefined;\n    if (!isNullOrUndefined(this.pageContainer)) {\n      this.pageContainer.innerHTML = '';\n      if (!isNullOrUndefined(this.pageContainer.parentElement)) {\n        this.pageContainer.parentElement.removeChild(this.pageContainer);\n      }\n    }\n    this.pageContainer = undefined;\n    if (!isNullOrUndefined(this.viewerContainer)) {\n      this.viewerContainer.innerHTML = '';\n      if (!isNullOrUndefined(this.viewerContainer.parentElement)) {\n        this.viewerContainer.parentElement.removeChild(this.viewerContainer);\n      }\n    }\n    if (!isNullOrUndefined(this.iframe)) {\n      this.iframe.innerHTML = '';\n      if (!isNullOrUndefined(this.iframe.parentElement)) {\n        this.iframe.parentElement.removeChild(this.iframe);\n      }\n      this.iframe = undefined;\n    }\n    if (this.optionsPaneContainer) {\n      this.optionsPaneContainer.innerHTML = '';\n      if (!isNullOrUndefined(this.optionsPaneContainer.parentElement)) {\n        this.optionsPaneContainer.parentElement.removeChild(this.optionsPaneContainer);\n      }\n    }\n    this.optionsPaneContainer = undefined;\n    this.visibleBoundsIn = undefined;\n    this.mouseDownOffset = undefined;\n    this.viewerContainer = undefined;\n    this.currentPage = undefined;\n    this.selectionStartPageIn = undefined;\n    this.selectionEndPageIn = undefined;\n    this.currentSelectedCommentInternal = undefined;\n    this.currentSelectedRevisionInternal = undefined;\n    this.owner = undefined;\n    this.heightInfoCollection = undefined;\n    this.isRestartNumbering = false;\n  };\n  /**\n   * Un-Wires events and methods\n   *\n   * @returns {void}\n   */\n  DocumentHelper.prototype.unWireEvent = function () {\n    this.viewerContainer.removeEventListener('scroll', this.scrollHandler);\n    this.viewerContainer.removeEventListener('mousedown', this.onMouseDownInternal);\n    this.viewerContainer.removeEventListener('mousemove', this.onMouseMoveInternal);\n    if (!Browser.isDevice) {\n      this.editableDiv.removeEventListener('keypress', this.onKeyPressInternal);\n      if (Browser.info.name === 'chrome') {\n        this.editableDiv.removeEventListener('textInput', this.onTextInput);\n      }\n    } else {\n      this.editableDiv.removeEventListener('input', this.onTextInputInternal);\n    }\n    this.editableDiv.removeEventListener('paste', this.onPaste);\n    this.viewerContainer.removeEventListener('contextmenu', this.onContextMenu);\n    this.editableDiv.removeEventListener('blur', this.onFocusOut);\n    this.editableDiv.removeEventListener('keydown', this.onKeyDownInternal);\n    this.editableDiv.removeEventListener('compositionstart', this.compositionStart);\n    this.editableDiv.removeEventListener('compositionupdate', this.compositionUpdated);\n    this.editableDiv.removeEventListener('compositionend', this.compositionEnd);\n    this.viewerContainer.removeEventListener('mouseup', this.onMouseUpInternal);\n    if (!isNullOrUndefined(this.iframe)) {\n      this.iframe.removeEventListener('load', this.onIframeLoad);\n    }\n    this.viewerContainer.removeEventListener('dblclick', this.onDoubleTap);\n    window.removeEventListener('resize', this.onWindowResize);\n    window.removeEventListener('keyup', this.onKeyUpInternal);\n    window.removeEventListener('mouseup', this.onImageResizer);\n    window.removeEventListener('touchend', this.onImageResizer);\n    if (navigator !== undefined && navigator.userAgent.match('Firefox')) {\n      this.viewerContainer.removeEventListener('DOMMouseScroll', this.zoomModule.onMouseWheelInternal);\n    }\n    this.viewerContainer.removeEventListener('mousewheel', this.zoomModule.onMouseWheelInternal);\n  };\n  DocumentHelper.prototype.updateCursor = function (event) {\n    var hyperlinkField = undefined;\n    var footnoteElement = undefined;\n    var div = this.viewerContainer;\n    var point = new Point(event.offsetX, event.offsetY);\n    var touchPoint = this.owner.viewer.findFocusedPage(point, true);\n    var widget = this.getLineWidget(touchPoint);\n    var widgetInfo;\n    var left;\n    var top;\n    var editor = !this.owner.isReadOnlyMode ? this.owner.editorModule : undefined;\n    var isRowResize = editor ? editor.tableResize.isInRowResizerArea(touchPoint) : false;\n    var isCellResize = editor ? editor.tableResize.isInCellResizerArea(touchPoint) : false;\n    var floatItemInfo = this.selection.checkAllFloatingElements(widget, touchPoint);\n    var resizePosition = '';\n    if (this.owner.enableImageResizerMode) {\n      var resizeObj = this.owner.imageResizerModule.getImagePoint(touchPoint);\n      this.owner.imageResizerModule.selectedResizeElement = resizeObj.selectedElement;\n      resizePosition = resizeObj.resizePosition;\n    }\n    var lineLeft = 0;\n    var formField = undefined;\n    var referenceField = undefined;\n    var isInInline = this.checkPointIsInLine(widget, touchPoint);\n    if (!isNullOrUndefined(widget)) {\n      lineLeft = this.selection.getLineStartLeft(widget);\n      hyperlinkField = this.selection.getHyperLinkFieldInCurrentSelection(widget, touchPoint);\n      if (isNullOrUndefined(hyperlinkField)) {\n        formField = this.selection.getHyperLinkFieldInCurrentSelection(widget, touchPoint, true);\n      }\n      if (!isNullOrUndefined(hyperlinkField)) {\n        var code = this.selection.getFieldCode(hyperlinkField);\n        if (code.toLowerCase().indexOf('ref ') === 0 && !code.match('\\\\h')) {\n          hyperlinkField = undefined;\n        }\n      }\n      widgetInfo = this.selection.updateTextPositionIn(widget, undefined, 0, touchPoint, true);\n      left = this.selection.getLeft(widget);\n      top = this.selection.getTop(widget);\n      if (isNullOrUndefined(hyperlinkField) && !isNullOrUndefined(formField) && this.isDocumentProtected && this.protectionType === 'FormFieldsOnly' && !this.isFormFilling) {\n        this.selection.setHyperlinkContentToToolTip(formField, widget, touchPoint.x, true);\n      } else {\n        this.selection.setHyperlinkContentToToolTip(hyperlinkField, widget, touchPoint.x, false);\n      }\n      if (formField) {\n        var isInlineFormFillMode = formField.formFieldData instanceof TextFormField && formField.formFieldData.type === 'Text';\n        if (this.owner.documentEditorSettings.formFieldSettings.formFillingMode === 'Inline' && isInlineFormFillMode) {\n          //Update text cursor in text form field.\n          formField = undefined;\n        }\n      }\n      if (this.owner.enableLockAndEdit) {\n        var isLocked = false;\n        var block = widget.paragraph;\n        if (block.isInsideTable) {\n          block = this.layout.getParentTable(block);\n        }\n        if (block.locked && block.lockedBy !== this.owner.currentUser) {\n          isLocked = true;\n        }\n        var sectionFormat = widget.paragraph.bodyWidget.sectionFormat;\n        var pageWidth = sectionFormat.pageWidth - sectionFormat.rightMargin - sectionFormat.leftMargin;\n        pageWidth = HelperMethods.convertPointToPixel(pageWidth) * this.zoomFactor;\n        if (this.viewer instanceof WebLayoutViewer) {\n          pageWidth = (this.visibleBounds.width - this.viewer.padding.right * 5) / this.zoomFactor;\n        }\n        if (isLocked && touchPoint.x >= lineLeft && touchPoint.x < lineLeft + pageWidth) {\n          this.selection.setLockInfoTooptip(widget, touchPoint.x, block.lockedBy);\n        } else {\n          this.selection.setLockInfoTooptip(undefined, touchPoint.x, '');\n        }\n      }\n    }\n    if (!isNullOrUndefined(widget)) {\n      if (isNullOrUndefined(footnoteElement) && this.owner.layoutType == 'Pages') {\n        footnoteElement = this.selection.getFootNoteElementInCurrentSelection(widget, touchPoint);\n        if (footnoteElement instanceof FootnoteElementBox) {\n          this.selection.setFootnoteContentToToolTip(footnoteElement, widget, touchPoint.x);\n        }\n      }\n    }\n    var isCtrlkeyPressed = this.isIosDevice ? event.metaKey : event.ctrlKey;\n    if (!isNullOrUndefined(hyperlinkField) && (isCtrlkeyPressed && this.owner.useCtrlClickToFollowHyperlink || !this.owner.useCtrlClickToFollowHyperlink) || formField) {\n      if (!isNullOrUndefined(formField)) {\n        if (this.isFormFillProtectedMode) {\n          div.style.cursor = 'default';\n        }\n      } else {\n        div.style.cursor = 'pointer';\n      }\n      return;\n    } else if (touchPoint.x >= lineLeft && event.offsetX < this.visibleBounds.width - (this.visibleBounds.width - this.viewerContainer.clientWidth) && event.offsetY < this.visibleBounds.height - (this.visibleBounds.height - this.viewerContainer.clientHeight)) {\n      if (this.selection.isEmpty) {\n        div.style.cursor = 'text';\n      } else {\n        div.style.cursor = this.selection.checkCursorIsInSelection(widget, touchPoint) ? 'default' : 'text';\n      }\n    } else {\n      div.style.cursor = 'default';\n    }\n    if (!isNullOrUndefined(resizePosition) && resizePosition !== '') {\n      if (!this.owner.imageResizerModule.isShapeResize || this.owner.imageResizerModule.isShapeResize && resizePosition !== 'move') {\n        div.style.cursor = resizePosition;\n      }\n    } else if (!isNullOrUndefined(widgetInfo) && widgetInfo.isImageSelected && left < touchPoint.x && top < touchPoint.y && left + widget.width > touchPoint.x && top + widget.height > touchPoint.y) {\n      div.style.cursor = 'move';\n    }\n    if (isRowResize) {\n      div.style.cursor = 'row-resize';\n    } else if (isCellResize) {\n      div.style.cursor = 'col-resize';\n    }\n    if (floatItemInfo.isInShapeBorder && !isInInline) {\n      div.style.cursor = 'all-scroll';\n    }\n  };\n  /**\n   * @private\n   */\n  DocumentHelper.prototype.updateDialogTabHeight = function (dialogElement, targetElement) {\n    var header = dialogElement.getElementsByClassName('e-dlg-header-content')[0];\n    var contentElement = dialogElement.getElementsByClassName('e-dlg-content')[0];\n    var footer = dialogElement.getElementsByClassName('e-footer-content')[0];\n    var contentStyle = getComputedStyle(contentElement);\n    var dialogStyle = getComputedStyle(dialogElement);\n    var paddingTop = parseInt(contentStyle.paddingTop, 10);\n    var paddingBottom = parseInt(contentStyle.paddingBottom, 10);\n    var paddingVertical = (isNaN(paddingTop) ? 0 : paddingTop) + (isNaN(paddingBottom) ? 0 : paddingBottom);\n    var borderTop = parseInt(dialogStyle.borderTop, 10);\n    var borderBottom = parseInt(dialogStyle.borderBottom, 10);\n    var borderVertical = (isNaN(borderTop) ? 0 : borderTop) + (isNaN(borderBottom) ? 0 : borderBottom);\n    var contentHeight = dialogElement.offsetHeight - (header.offsetHeight + footer.offsetHeight + paddingVertical + borderVertical);\n    targetElement.style.height = contentHeight + 'px';\n    var paddingLeft = parseInt(contentStyle.paddingLeft, 10);\n    var paddingRight = parseInt(contentStyle.paddingRight, 10);\n    var paddingHorizontal = (isNaN(paddingLeft) ? 0 : paddingLeft) + (isNaN(paddingRight) ? 0 : paddingRight);\n    var borderLeft = parseInt(dialogStyle.borderLeft, 10);\n    var borderRight = parseInt(dialogStyle.borderRight, 10);\n    var borderHorizontal = (isNaN(borderLeft) ? 0 : borderLeft) + (isNaN(borderRight) ? 0 : borderRight);\n    var contentWidth = dialogElement.offsetWidth - (paddingHorizontal + borderHorizontal);\n    return contentWidth;\n  };\n  /**\n   *\n   * @private\n   */\n  DocumentHelper.prototype.canRenderBorder = function (paragraph) {\n    var skipTopBorder = false;\n    var skipBottomBorder = false;\n    var isSamePreviousBorder;\n    var isSameNextBorder;\n    var isSameTopBorder;\n    var isSameBottomBorder;\n    var isSameLeftBorder;\n    var isSameRightBorder;\n    var previousBlock = paragraph.previousRenderedWidget;\n    var nextBlock = paragraph.nextRenderedWidget;\n    var paragraphX = this.getParagraphLeftPosition(paragraph);\n    var previousBlockX = 0;\n    var nextBlockX = 0;\n    if (!isNullOrUndefined(previousBlock) && previousBlock instanceof ParagraphWidget) {\n      previousBlockX = this.getParagraphLeftPosition(previousBlock);\n    }\n    if (!isNullOrUndefined(nextBlock) && nextBlock instanceof ParagraphWidget) {\n      nextBlockX = this.getParagraphLeftPosition(nextBlock);\n    }\n    if (!isNullOrUndefined(previousBlock) && previousBlock instanceof ParagraphWidget && paragraphX === previousBlockX) {\n      isSameTopBorder = this.checkEqualBorder(paragraph.paragraphFormat.borders.top, previousBlock.paragraphFormat.borders.top);\n      isSameBottomBorder = this.checkEqualBorder(paragraph.paragraphFormat.borders.bottom, previousBlock.paragraphFormat.borders.bottom);\n      isSameLeftBorder = this.checkEqualBorder(paragraph.paragraphFormat.borders.left, previousBlock.paragraphFormat.borders.left);\n      isSameRightBorder = this.checkEqualBorder(paragraph.paragraphFormat.borders.right, previousBlock.paragraphFormat.borders.right);\n      if (isSameTopBorder && isSameBottomBorder && isSameLeftBorder && isSameRightBorder && !isNullOrUndefined(previousBlock.paragraphFormat.borders.horizontal) && previousBlock.paragraphFormat.borders.horizontal.lineStyle === 'None') {\n        skipTopBorder = true;\n      }\n    }\n    if (!isNullOrUndefined(nextBlock) && nextBlock instanceof ParagraphWidget && (paragraphX === nextBlockX || this.owner.documentHelper.layout.isInitialLoad && this.skipBottomBorder(paragraph, nextBlock))) {\n      isSameTopBorder = this.checkEqualBorder(paragraph.paragraphFormat.borders.top, nextBlock.paragraphFormat.borders.top);\n      isSameBottomBorder = this.checkEqualBorder(paragraph.paragraphFormat.borders.bottom, nextBlock.paragraphFormat.borders.bottom);\n      isSameLeftBorder = this.checkEqualBorder(paragraph.paragraphFormat.borders.left, nextBlock.paragraphFormat.borders.left);\n      isSameRightBorder = this.checkEqualBorder(paragraph.paragraphFormat.borders.right, nextBlock.paragraphFormat.borders.right);\n      if (isSameBottomBorder && isSameTopBorder && isSameLeftBorder && isSameRightBorder) {\n        skipBottomBorder = true;\n      }\n    }\n    return {\n      'skipTopBorder': skipTopBorder,\n      'skipBottomBorder': skipBottomBorder\n    };\n  };\n  DocumentHelper.prototype.checkEqualBorder = function (source, dest) {\n    if (!isNullOrUndefined(source) && !isNullOrUndefined(dest)) {\n      return source.isEqualFormat(dest);\n    } else {\n      if (isNullOrUndefined(source) && isNullOrUndefined(dest)) {\n        return true;\n      } else {\n        return false;\n      }\n    }\n  };\n  /**\n  * @private\n  */\n  DocumentHelper.prototype.getParagraphLeftPosition = function (paragraphWidget) {\n    var hangingIndent = 0;\n    var startX = 0;\n    if (paragraphWidget.paragraphFormat.firstLineIndent < 0) {\n      hangingIndent = HelperMethods.convertPointToPixel(Math.abs(paragraphWidget.paragraphFormat.firstLineIndent));\n      hangingIndent = parseFloat(hangingIndent.toFixed(5));\n    }\n    if (paragraphWidget.isEmpty() && (paragraphWidget.paragraphFormat.textAlignment !== 'Left' && paragraphWidget.paragraphFormat.textAlignment !== 'Justify' || paragraphWidget.paragraphFormat.textAlignment === 'Justify' && paragraphWidget.paragraphFormat.bidi)) {\n      startX = paragraphWidget.clientX > hangingIndent ? paragraphWidget.clientX - hangingIndent : paragraphWidget.clientX;\n      return startX;\n    } else {\n      startX = paragraphWidget.x > hangingIndent ? paragraphWidget.x - hangingIndent : paragraphWidget.x;\n      return startX;\n    }\n  };\n  /**\n  * @private\n  */\n  DocumentHelper.prototype.skipBottomBorder = function (paragraph, nextWidget) {\n    var currentIndent = 0;\n    var previousIndent = 0;\n    if (paragraph.paragraphFormat.leftIndent === nextWidget.paragraphFormat.leftIndent) {\n      return true;\n    } else {\n      currentIndent = paragraph.paragraphFormat.firstLineIndent < 0 ? Math.abs(paragraph.paragraphFormat.firstLineIndent) : 0;\n      previousIndent = nextWidget.paragraphFormat.firstLineIndent < 0 ? Math.abs(nextWidget.paragraphFormat.firstLineIndent) : 0;\n      currentIndent = paragraph.paragraphFormat.leftIndent > currentIndent ? paragraph.paragraphFormat.leftIndent - currentIndent : 0;\n      previousIndent = nextWidget.paragraphFormat.leftIndent > previousIndent ? nextWidget.paragraphFormat.leftIndent - previousIndent : 0;\n      if (currentIndent === previousIndent) {\n        return true;\n      } else {\n        return false;\n      }\n    }\n  };\n  /**\n   * @private\n   */\n  DocumentHelper.prototype.isPageInVisibleBound = function (page, pageTop) {\n    var height = this.visibleBounds.height;\n    var vertical = this.viewerContainer.scrollTop;\n    var pageH = page.boundingRectangle.height * this.zoomFactor;\n    var isTopFit = pageTop >= vertical && pageTop <= vertical + height;\n    var isBottomFit = pageTop + pageH >= vertical && pageTop + pageH <= vertical + height;\n    var isMiddleFit = pageTop <= vertical && pageTop + pageH >= vertical + height;\n    return isTopFit || isBottomFit || isMiddleFit;\n  };\n  /**\n   * Get first paragraph in cell\n   *\n   * @private\n   * @returns {ParagraphWidget}\n   */\n  DocumentHelper.prototype.getFirstParagraphInCell = function (cell) {\n    var firstBlock = cell.childWidgets[0];\n    if (firstBlock instanceof ParagraphWidget) {\n      return firstBlock;\n    } else {\n      return this.getFirstParagraphInFirstCell(firstBlock);\n    }\n  };\n  /**\n   * Get first paragraph in first cell\n   *\n   * @private\n   * @returns {TableWidget}\n   */\n  DocumentHelper.prototype.getFirstParagraphInFirstCell = function (table) {\n    if (!isNullOrUndefined(table.childWidgets) && table.childWidgets.length > 0) {\n      var firstRow = table.childWidgets[0];\n      var cell = firstRow.childWidgets[0];\n      var block = cell.childWidgets[0];\n      return this.getFirstParagraphBlock(block);\n    }\n    return undefined;\n  };\n  /**\n   * Get last paragraph in last cell\n   *\n   * @private\n   * @returns {ParagraphWidget}\n   */\n  DocumentHelper.prototype.getLastParagraphInLastCell = function (table) {\n    if (!isNullOrUndefined(table.childWidgets) && table.childWidgets.length > 0) {\n      var lastrow = table.lastChild;\n      var lastcell = lastrow.lastChild;\n      var lastBlock = lastcell.lastChild;\n      return this.getLastParagraphBlock(lastBlock);\n    }\n    return undefined;\n  };\n  /**\n   * Get first paragraph in block\n   *\n   * @private\n   * @returns {ParagraphWidget}\n   */\n  DocumentHelper.prototype.getFirstParagraphBlock = function (block) {\n    if (block instanceof ParagraphWidget) {\n      return block;\n    } else if (block instanceof TableWidget) {\n      return this.getFirstParagraphInFirstCell(block);\n    }\n    return undefined;\n  };\n  /**\n   * Get last paragraph in block\n   *\n   * @private\n   * @returns {ParagraphWidget}\n   */\n  DocumentHelper.prototype.getLastParagraphBlock = function (block) {\n    if (block instanceof ParagraphWidget) {\n      return block;\n    } else if (block instanceof TableWidget) {\n      return this.getLastParagraphInLastCell(block);\n    }\n    return undefined;\n  };\n  /**\n   * Get last paragraph in first row\n   *\n   * @private\n   * @returns {ParagraphWidget}\n   */\n  DocumentHelper.prototype.getLastParagraphInFirstRow = function (table) {\n    if (table.childWidgets.length > 0) {\n      var row = table.firstChild;\n      var lastcell = row.lastChild;\n      var lastBlock = lastcell.lastChild;\n      return this.getLastParagraphBlock(lastBlock);\n    }\n    return undefined;\n  };\n  /**\n   * Get first paragraph in last row\n   *\n   * @private\n   */\n  DocumentHelper.prototype.getFirstParagraphInLastRow = function (table) {\n    if (table.childWidgets.length > 0) {\n      var lastRow = table.childWidgets[table.childWidgets.length - 1];\n      var lastCell = lastRow.childWidgets[0];\n      var lastBlock = lastCell.childWidgets[0];\n      return this.getFirstParagraphBlock(lastBlock);\n    }\n    return undefined;\n  };\n  /**\n   * Add the given WStyle Object ot stylesMap Dictionary\n   *\n   * @private\n   */\n  /* eslint-disable  */\n  DocumentHelper.prototype.addToStylesMap = function (style) {\n    var returnStyle = {};\n    var returnStyleObject = {};\n    var paraIcon = 'e-list-icon e-de-listview-icon e-de-e-paragraph-style-mark e-icons';\n    var charIcon = 'e-list-icon e-de-listview-icon e-de-e-character-style-mark e-icons';\n    var linkedIcon = 'e-list-icon e-de-listview-icon e-de-e-linked-style-mark e-icons';\n    // StyleName for the dropDownItem\n    if (!isNullOrUndefined(style)) {\n      var styleName = this.owner ? this.L10n.getConstant(style.name) : style.name;\n      returnStyle.StyleName = styleName === '' ? style.name : styleName;\n      if (style.type == \"Paragraph\") {\n        returnStyleObject.paragraphFormat = {};\n        HelperMethods.writeParagraphFormat(returnStyleObject.paragraphFormat, true, style.paragraphFormat);\n      }\n      returnStyleObject.characterFormat = {};\n      HelperMethods.writeCharacterFormat(returnStyleObject.characterFormat, true, style.characterFormat);\n      // CSS Style for dropDownItem\n      returnStyle.Style = this.parseStyle(JSON.stringify(returnStyleObject));\n      // Setting type for segregating and adding iconcss\n      if (!isNullOrUndefined(style.type)) {\n        returnStyle.type = style.type;\n        if (returnStyle.type == \"Paragraph\" && !isNullOrUndefined(style.link)) {\n          returnStyle.type = \"Linked\";\n        }\n      }\n      // Adding IconCss to the dropDownItem\n      if (returnStyle.type == \"Paragraph\") {\n        returnStyle.IconClass = paraIcon;\n      } else if (returnStyle.type == \"Character\") {\n        returnStyle.IconClass = charIcon;\n      } else {\n        returnStyle.IconClass = linkedIcon;\n      }\n      if (this.stylesMap.get(returnStyle.type)) {\n        this.stylesMap.get(returnStyle.type).push(returnStyle);\n      } else {\n        this.stylesMap.add(returnStyle.type, [returnStyle]);\n      }\n    }\n  };\n  DocumentHelper.prototype.parseStyle = function (style) {\n    var domStyle = '';\n    var styleObj = JSON.parse(style);\n    var textDecoration = '';\n    if (!isNullOrUndefined(styleObj.characterFormat.baselineAlignment) && styleObj.characterFormat.baselineAlignment !== 'Normal') {\n      var vAlign = '';\n      switch (styleObj.characterFormat.baselineAlignment) {\n        case 'Superscript':\n          vAlign = 'super';\n          break;\n        case 'Subscript':\n          vAlign = 'sub';\n          break;\n      }\n      if (vAlign.length > 1) {\n        domStyle += 'vertical-align:' + vAlign + ';';\n      }\n    }\n    if (!isNullOrUndefined(styleObj.characterFormat.underline) && styleObj.characterFormat.underline !== 'None') {\n      textDecoration += 'underline ';\n    }\n    if (!isNullOrUndefined(styleObj.characterFormat.strikethrough) && styleObj.characterFormat.strikethrough !== 'None') {\n      textDecoration += 'line-through ';\n    }\n    if (!isNullOrUndefined(styleObj.characterFormat.fontSize)) {\n      domStyle += 'font-size:' + styleObj.characterFormat.fontSize + 'px;';\n    }\n    if (!isNullOrUndefined(styleObj.characterFormat.fontFamily)) {\n      domStyle += 'font-family:' + styleObj.characterFormat.fontFamily + ';';\n    }\n    if (!isNullOrUndefined(styleObj.characterFormat.bold) && styleObj.characterFormat.bold) {\n      domStyle += 'font-weight:bold;';\n    }\n    if (!isNullOrUndefined(styleObj.characterFormat.italic) && styleObj.characterFormat.italic) {\n      domStyle += 'font-style:italic;';\n    }\n    // if (!isNullOrUndefined(styleObj.characterFormat.fontColor)) {\n    //     domStyle += 'color: ' + styleObj.characterFormat.fontColor + ';';\n    // }\n    if (textDecoration.length > 1) {\n      domStyle += 'text-decoration:' + textDecoration + ';';\n    }\n    return domStyle;\n  };\n  return DocumentHelper;\n}();\nexport { DocumentHelper };\n/**\n * @private\n */\nvar LayoutViewer = /** @class */function () {\n  function LayoutViewer(owner) {\n    /**\n     * @private\n     */\n    this.visiblePages = [];\n    /**\n     * @private\n     */\n    this.padding = new Padding(10, 10, 30, 10);\n    /**\n     * @private\n     */\n    this.textWrap = true;\n    /**\n     * @private\n     */\n    this.pageFitTypeIn = 'None';\n    /**\n     * @private\n     */\n    this.containerTop = 0;\n    /**\n     * @private\n     */\n    this.containerWidth = 0;\n    /**\n     * @private\n     */\n    this.containerLeft = 0;\n    this.owner = owner;\n    this.columnLayoutArea = new ColumnLayout(this);\n  }\n  Object.defineProperty(LayoutViewer.prototype, \"documentHelper\", {\n    get: function () {\n      return this.owner.documentHelper;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(LayoutViewer.prototype, \"pageFitType\", {\n    /**\n     * Gets or sets page fit type.\n     * @private\n     */\n    get: function () {\n      return this.pageFitTypeIn;\n    },\n    set: function (value) {\n      this.pageFitTypeIn = value;\n      this.onPageFitTypeChanged(this.pageFitTypeIn);\n    },\n    enumerable: true,\n    configurable: true\n  });\n  LayoutViewer.prototype.updateClientArea = function (bodyWidget, page, isReLayout) {\n    var sectionFormat;\n    if (!isNullOrUndefined(bodyWidget)) {\n      sectionFormat = bodyWidget.sectionFormat;\n      this.columnLayoutArea.setColumns(sectionFormat);\n    }\n    var width = 0;\n    var height = 0;\n    if (this instanceof WebLayoutViewer) {\n      var top_2 = 0;\n      width = (this.documentHelper.visibleBounds.width - this.padding.right * 4 - this.padding.left * 2) / this.documentHelper.zoomFactor;\n      if (width < 0) {\n        width = 0;\n      }\n      height = Number.POSITIVE_INFINITY;\n      this.clientArea = new Rect(this.padding.left / this.documentHelper.zoomFactor, top_2, width, height);\n      this.clientActiveArea = new Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n    } else {\n      var top_3 = 0;\n      var headerDistance = 48;\n      var footerDistance = 48;\n      var pageHeight = HelperMethods.convertPointToPixel(sectionFormat.pageHeight);\n      var bottomMargin = HelperMethods.convertPointToPixel(sectionFormat.bottomMargin);\n      if (!isNullOrUndefined(sectionFormat)) {\n        top_3 = HelperMethods.convertPointToPixel(sectionFormat.topMargin);\n        headerDistance = HelperMethods.convertPointToPixel(sectionFormat.headerDistance);\n        footerDistance = HelperMethods.convertPointToPixel(sectionFormat.footerDistance);\n      }\n      var isEmptyWidget = false;\n      if (!isNullOrUndefined(page.headerWidget)) {\n        isEmptyWidget = page.headerWidget.isEmpty;\n        if (top_3 >= 0) {\n          if (!isEmptyWidget || isEmptyWidget && this.owner.enableHeaderAndFooter) {\n            top_3 = Math.min(Math.max(headerDistance + page.headerWidget.height, top_3), pageHeight / 100 * 40);\n          }\n        } else {\n          top_3 = Math.abs(top_3);\n        }\n      }\n      var bottom = 0.667 + bottomMargin;\n      if (!isNullOrUndefined(page.footerWidget)) {\n        isEmptyWidget = page.footerWidget.isEmpty;\n        var footnoteHeight = !isNullOrUndefined(page.footnoteWidget) ? page.footnoteWidget.height : 0;\n        footnoteHeight = Math.min(footnoteHeight, (pageHeight - top_3 - bottom) / 100 * 90);\n        if (bottom >= 0) {\n          if (!isEmptyWidget || isEmptyWidget && this.owner.enableHeaderAndFooter) {\n            bottom = 0.667 + Math.min(pageHeight / 100 * 40, Math.max(footerDistance + page.footerWidget.height, bottomMargin));\n          }\n        } else {\n          bottom = Math.abs(bottom);\n        }\n        bottom += footnoteHeight;\n      }\n      if (!isNullOrUndefined(sectionFormat)) {\n        width = HelperMethods.convertPointToPixel(sectionFormat.pageWidth - sectionFormat.leftMargin - sectionFormat.rightMargin);\n        height = pageHeight - top_3 - bottom;\n      }\n      if (width < 0) {\n        width = 0;\n      }\n      var clientArea = new Rect(HelperMethods.convertPointToPixel(sectionFormat.leftMargin), top_3, width, pageHeight - top_3 - bottom);\n      if (page.footnoteWidget && isReLayout && !this.documentHelper.owner.editorModule.isFootNote) {\n        if (page.footnoteWidget.y !== 0 && this.clientArea.y + this.clientArea.height > page.footnoteWidget.y) {\n          var sub = this.clientArea.y + this.clientArea.height - page.footnoteWidget.y;\n          this.clientArea.height -= sub / 2;\n        }\n      }\n      if (bodyWidget.page.bodyWidgets[0].columnIndex !== 0) {\n        this.owner.editorModule.updateColumnIndex(bodyWidget, false);\n      }\n      this.setClientArea(bodyWidget, clientArea);\n      this.clientActiveArea = new Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n    }\n  };\n  LayoutViewer.prototype.setClientArea = function (bodyWidget, clientArea) {\n    this.clientArea = this.columnLayoutArea.getColumnBoundsByBodyWidget(bodyWidget, clientArea);\n    bodyWidget.x = this.clientArea.x;\n    bodyWidget.width = this.clientArea.width;\n  };\n  LayoutViewer.prototype.updateClientAreaTopOrLeft = function (tableWidget, beforeLayout) {\n    if (beforeLayout) {\n      this.clientActiveArea.y = this.clientActiveArea.y + tableWidget.topBorderWidth;\n      this.clientActiveArea.x = this.clientActiveArea.x + tableWidget.leftBorderWidth;\n    }\n  };\n  LayoutViewer.prototype.updateClientAreaForTable = function (tableWidget) {\n    this.clientActiveArea.x = this.clientArea.x = tableWidget.x;\n    this.clientActiveArea.width = this.clientArea.width = tableWidget.width;\n  };\n  LayoutViewer.prototype.updateClientAreaForRow = function (row, beforeLayout) {\n    var tableWidget = row.ownerTable;\n    if (beforeLayout) {} else {\n      this.clientActiveArea.x = this.clientArea.x = tableWidget.x;\n      this.clientActiveArea.width = this.clientArea.width = tableWidget.width;\n      this.clientArea = new Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n      this.clientActiveArea = new Rect(this.clientActiveArea.x, this.clientActiveArea.y, this.clientActiveArea.width, this.clientActiveArea.height);\n    }\n  };\n  LayoutViewer.prototype.updateClientAreaForCell = function (cell, beforeLayout) {\n    var rowWidget = cell.ownerRow;\n    var cellWidget = cell;\n    if (beforeLayout) {\n      this.clientActiveArea.x = this.clientArea.x = cellWidget.x;\n      this.clientActiveArea.y = cellWidget.y;\n      this.clientActiveArea.width = this.clientArea.width = cellWidget.width > 0 ? cellWidget.width : 0;\n      if (this instanceof PageLayoutViewer) {\n        this.clientActiveArea.height = Number.POSITIVE_INFINITY;\n      }\n      this.clientArea = new Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n      this.clientActiveArea = new Rect(this.clientActiveArea.x, this.clientActiveArea.y, this.clientActiveArea.width, this.clientActiveArea.height);\n    } else {\n      this.clientActiveArea.x = this.clientArea.x = cellWidget.x + cellWidget.width + cellWidget.margin.right;\n      if (rowWidget.x + rowWidget.width - this.clientArea.x < 0) {\n        this.clientActiveArea.width = this.clientArea.width = 0;\n      } else {\n        this.clientActiveArea.width = this.clientArea.width = rowWidget.x + rowWidget.width - this.clientArea.x;\n      }\n      this.clientActiveArea.y = cellWidget.y - cellWidget.margin.top - HelperMethods.convertPointToPixel(cell.ownerTable.tableFormat.cellSpacing);\n      if (!cell.ownerTable.isInsideTable) {\n        this.clientActiveArea.height = this.clientArea.bottom - rowWidget.y > 0 ? this.clientArea.bottom - rowWidget.y : 0;\n        if (!cell.ownerTable.wrapTextAround && this.documentHelper.layout.existFootnoteHeight > 0) {\n          var updateHeight = this.clientActiveArea.height - this.documentHelper.layout.existFootnoteHeight;\n          this.clientActiveArea.height = updateHeight < 0 ? 0 : updateHeight;\n        }\n      }\n      this.clientArea = new Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n      this.clientActiveArea = new Rect(this.clientActiveArea.x, this.clientActiveArea.y, this.clientActiveArea.width, this.clientActiveArea.height);\n    }\n  };\n  LayoutViewer.prototype.updateClientAreaForTextBoxShape = function (textBox, beforeLayout, shiftNextWidget) {\n    if (textBox.textWrappingStyle === 'Inline' && !shiftNextWidget) {\n      textBox.y = this.clientActiveArea.y;\n      textBox.x = this.clientActiveArea.x;\n    }\n    if (beforeLayout) {\n      var marginLeft = HelperMethods.convertPointToPixel(textBox.textFrame.marginLeft);\n      var marginRight = HelperMethods.convertPointToPixel(textBox.textFrame.marginRight);\n      var marginTop = HelperMethods.convertPointToPixel(textBox.textFrame.marginTop);\n      var marginBottom = HelperMethods.convertPointToPixel(textBox.textFrame.marginBottom);\n      var width = textBox.width;\n      var height = Number.POSITIVE_INFINITY;\n      this.clientArea = new Rect(textBox.x + marginLeft, textBox.y + marginTop, width - marginLeft - marginRight, height - marginTop - marginBottom);\n      this.clientActiveArea = new Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n    }\n  };\n  LayoutViewer.prototype.updateClientAreaByWidgetFootNote = function (widget) {\n    this.clientArea.x = widget.x;\n    this.clientArea.y = widget.y;\n    this.clientActiveArea.x = widget.x;\n    this.clientActiveArea.y = widget.y;\n  };\n  /**\n   * @private\n   */\n  LayoutViewer.prototype.updateClientAreaForTextWrap = function (area) {\n    this.clientActiveArea = new Rect(area.x, area.y, area.width, area.height);\n  };\n  LayoutViewer.prototype.updateBoundsBasedOnTextWrap = function (bottom) {\n    var diff = bottom - this.clientActiveArea.y;\n    this.clientActiveArea.y = bottom;\n    this.clientActiveArea.height = this.clientActiveArea.height - diff;\n  };\n  LayoutViewer.prototype.updateBoundsBasedOnTextWrapTable = function (bottom) {\n    var diff = bottom - this.clientArea.y;\n    this.clientArea.y = bottom;\n    this.clientArea.height = this.clientArea.height - diff;\n    this.clientActiveArea = new Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n  };\n  LayoutViewer.prototype.updateClientAreaByWidget = function (widget) {\n    this.clientArea.x = widget.x;\n    this.clientArea.y = widget.y;\n    this.clientActiveArea.x = widget.x;\n    this.clientActiveArea.y = widget.y;\n  };\n  LayoutViewer.prototype.updateClientAreaLocation = function (widget, area) {\n    widget.x = area.x;\n    widget.y = area.y;\n    widget.width = area.width;\n  };\n  LayoutViewer.prototype.updateClientAreaForBlock = function (block, beforeLayout, tableCollection, updateYPosition, updateXPosition) {\n    var leftIndent = HelperMethods.convertPointToPixel(block.leftIndent);\n    var rightIndent = HelperMethods.convertPointToPixel(block.rightIndent);\n    var bidi = block.bidi;\n    var width = 0;\n    if (beforeLayout) {\n      if (block instanceof TableWidget && tableCollection) {\n        var tableWidget = tableCollection[0];\n        if (block.bodyWidget.sectionFormat.columns.length <= 1) {\n          this.clientActiveArea.x = this.clientArea.x = tableWidget.x;\n          this.clientActiveArea.width = this.clientArea.width = tableWidget.width;\n        }\n        //Updates the location of last item.\n        tableWidget = tableCollection[tableCollection.length - 1];\n        tableWidget.x = this.clientActiveArea.x;\n        tableWidget.y = this.clientActiveArea.y;\n      } else {\n        if (block instanceof TableWidget && !isNullOrUndefined(block.tableFormat)) {\n          if (!block.isGridUpdated) {\n            block.buildTableColumns();\n            block.isGridUpdated = true;\n          }\n          var tableAlignment = this.tableAlignmentForBidi(block, bidi);\n          if (tableAlignment !== 'Left') {\n            var tableWidth = 0;\n            // If the grid is calculated, we can direclty get the width from the grid.\n            // Otherwise, calculate the width.\n            tableWidth = HelperMethods.convertPointToPixel(block.tableHolder.getTotalWidth(0));\n            tableWidth = tableWidth === 0 ? block.tableHolder.tableWidth === 0 ? block.getTableClientWidth(block.getOwnerWidth(false)) : block.tableHolder.tableWidth : tableWidth;\n            // Fore resizing table, the tableholder table width taken for updated width. \n            // Since, the columns will be cleared if we performed resizing.\n            if (this.owner.editorModule && this.owner.editorModule.tableResize.currentResizingTable === block && this.owner.editorModule.tableResize.resizerPosition === 0) {\n              tableWidth = HelperMethods.convertPointToPixel(block.tableHolder.tableWidth);\n            }\n            if (tableAlignment === 'Center') {\n              if (!this.documentHelper.isRowOrCellResizing) {\n                tableWidth = block.getTableCellWidth();\n              }\n              leftIndent = (this.clientArea.width - tableWidth) / 2;\n            } else {\n              leftIndent = this.clientArea.width - tableWidth;\n            }\n            if (bidi) {\n              leftIndent = leftIndent - HelperMethods.convertPointToPixel(block.leftIndent);\n              rightIndent = leftIndent;\n            }\n            if (!block.isInsideTable) {\n              //leftIndent = (block.tableFormat.horizontalPositionAbs === 'Left') ? block.tableFormat.horizontalPosition : leftIndent;\n            }\n            this.documentHelper.tableLefts.push(leftIndent);\n          }\n        }\n        width = this.clientArea.width - (leftIndent + HelperMethods.convertPointToPixel(block.rightIndent));\n        var x = this.clientArea.x + (bidi ? rightIndent : leftIndent);\n        width = width > 0 ? width : 0;\n        this.clientActiveArea.x = this.clientArea.x = x;\n        this.clientActiveArea.width = this.clientArea.width = width;\n        if (updateYPosition) {\n          this.updateParagraphYPositionBasedonTextWrap(block, new Rect(this.clientActiveArea.x, this.clientActiveArea.y, this.clientActiveArea.width, this.clientActiveArea.height));\n        }\n        if (updateXPosition) {\n          if (block instanceof ParagraphWidget) {\n            this.updateParagraphXPositionBasedOnTextWrap(block);\n          } else {\n            this.updateTableXPositionBasedOnTextWrap(block);\n          }\n        }\n      }\n    } else {\n      // Clears table left for table with right or center alignment.\n      if (block instanceof TableWidget && !isNullOrUndefined(block.tableFormat)) {\n        var tableAlignment = this.tableAlignmentForBidi(block, bidi);\n        if (!block.isGridUpdated) {\n          block.buildTableColumns();\n          block.isGridUpdated = true;\n        }\n        if (tableAlignment !== 'Left' && this.documentHelper.tableLefts.length > 0) {\n          leftIndent = this.documentHelper.tableLefts.pop();\n          if (bidi) {\n            rightIndent = leftIndent;\n          }\n        }\n      }\n      width = this.clientArea.width + leftIndent + HelperMethods.convertPointToPixel(block.rightIndent);\n      var x = this.clientArea.x - (bidi ? rightIndent : leftIndent);\n      width = width > 0 ? width : 0;\n      this.clientActiveArea.x = this.clientArea.x = x;\n      this.clientActiveArea.width = this.clientArea.width = width;\n    }\n    this.clientArea = new Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n    this.clientActiveArea = new Rect(this.clientActiveArea.x, this.clientActiveArea.y, this.clientActiveArea.width, this.clientActiveArea.height);\n  };\n  LayoutViewer.prototype.updateParagraphYPositionBasedonTextWrap = function (block, rect) {\n    var bodyWidget = block.bodyWidget;\n    var clientLayoutArea = this.clientActiveArea;\n    if (bodyWidget && bodyWidget.floatingElements.length > 0 && block instanceof ParagraphWidget && !(block.containerWidget instanceof TextFrame) && !block.isInsideTable && !(block.containerWidget instanceof FootNoteWidget)) {\n      var isWord2013 = this.documentHelper.compatibilityMode === 'Word2013';\n      var paragraph = block;\n      var isEmptyPara = paragraph.isEmpty();\n      var paragraphHeight = paragraph.height;\n      if (paragraphHeight === 0) {\n        paragraphHeight = this.documentHelper.textHelper.getParagraphMarkSize(paragraph.characterFormat).Height;\n      }\n      //Update Layout area based on text wrap\n      if (!paragraph.isInHeaderFooter || paragraph.isInsideTable || isWord2013) {\n        var yposition = rect.y;\n        // As per Microsoft Word behavior, need to update bottom position of first inline item to floating item bottom,\n        // when first inline item of page intersects in-between two adjacent floating items parallel in vertical\n        // for Word document lower than Microsoft Word 2013 version.\n        // To do: Currently this behavior handled for bottom position update based on Y position,\n        // need to handle this behavior for bottom position update based on X position in UpdateParagraphXPositionBasedOnTextWrap method.\n        var isFirstItemBottomPositionUpdated = false;\n        //Need to handle sorting floating items.\n        // Sort based on Y position\n        bodyWidget.floatingElements.sort(function (a, b) {\n          return a.y - b.y;\n        });\n        // Sort based on X position\n        bodyWidget.floatingElements.sort(function (a, b) {\n          return a.x - b.x;\n        });\n        var previousItem = paragraph.previousRenderedWidget;\n        if (previousItem && previousItem instanceof TableWidget && previousItem.wrapTextAround && !isEmptyPara && !paragraph.isContainsShapeAlone() && isWord2013 && rect.y < previousItem.y) {\n          rect.y = previousItem.y;\n        }\n        for (var i = 0; i < bodyWidget.floatingElements.length; i++) {\n          var floatingItem = bodyWidget.floatingElements[i];\n          var isInsideHeaderFooter = false;\n          if (floatingItem instanceof ShapeBase) {\n            isInsideHeaderFooter = floatingItem.paragraph.isInHeaderFooter;\n          } else {\n            isInsideHeaderFooter = floatingItem.bodyWidget instanceof HeaderFooterWidget ? true : false;\n          }\n          if (paragraph.isInsideTable) {\n            if (floatingItem instanceof TableWidget && !floatingItem.isInsideTable) {\n              continue;\n            }\n          }\n          var textWrappingBounds = this.getTextWrappingBound(floatingItem);\n          var textWrappingStyle = floatingItem instanceof TableWidget ? 'Square' : floatingItem.textWrappingStyle;\n          var textWrappingType = floatingItem instanceof TableWidget ? 'Both' : floatingItem.textWrappingType;\n          var minimumWidthRequired = 24;\n          if (!(clientLayoutArea.x > textWrappingBounds.right + minimumWidthRequired || clientLayoutArea.right < textWrappingBounds.x - minimumWidthRequired)) {\n            if ((rect.y + (floatingItem instanceof TableWidget && !isEmptyPara && paragraph.floatingElements.length === 0 ? paragraphHeight : paragraph.height) > textWrappingBounds.y || isFirstItemBottomPositionUpdated) && rect.y < textWrappingBounds.bottom && textWrappingStyle !== 'Inline' && textWrappingStyle !== 'TopAndBottom' && textWrappingStyle !== 'InFrontOfText' && textWrappingStyle !== 'Behind') {\n              var rightIndent = 0;\n              var paragarphRightIndent = HelperMethods.convertPointToPixel(paragraph.paragraphFormat.rightIndent);\n              var firstLineIndent = HelperMethods.convertPointToPixel(paragraph.paragraphFormat.firstLineIndent);\n              firstLineIndent = !isEmptyPara && paragraph.childWidgets[0].isFirstLine() && firstLineIndent > 0 ? firstLineIndent : 0;\n              if (rect.x >= textWrappingBounds.x && textWrappingType !== 'Left') {\n                rightIndent = paragarphRightIndent;\n              }\n              // Gets the value from right indent when it is negative, otherwise sets the value as zero.\n              rightIndent = rightIndent < 0 ? rightIndent : 0;\n              if (rect.x < textWrappingBounds.x && rect.x > textWrappingBounds.x && textWrappingType !== 'Left') {\n                if (rect.right > textWrappingBounds.x) {\n                  rect.width = rect.width - (rect.right - textWrappingBounds.right);\n                }\n                if (rect.width < minimumWidthRequired) {\n                  //Skip to wrap the immediate paragraph of floating table based on corresponding floating table. \n                  if (isWord2013 || !(floatingItem instanceof TableWidget && previousItem === floatingItem)) {\n                    this.updateBoundsBasedOnTextWrap(textWrappingBounds.bottom);\n                    rect = this.clientActiveArea;\n                  }\n                  if ((!isEmptyPara && paragraph.childWidgets[0].isFirstLine() || isEmptyPara) && isWord2013 ? true : !isInsideHeaderFooter) {\n                    paragraph.y = this.clientActiveArea.y;\n                  }\n                } else {\n                  rect.x = textWrappingBounds.right;\n                }\n              } else if (rect.x >= textWrappingBounds.x && rect.x < textWrappingBounds.right) {\n                rect.width = rect.width - (textWrappingBounds.right - rect.x) - rightIndent;\n                //checks minimum width\n                if (rect.width < minimumWidthRequired || isFirstItemBottomPositionUpdated) {\n                  rect.width = this.clientActiveArea.right - textWrappingBounds.right - rightIndent;\n                  var isPositionsUpdated = false;\n                  if (rect.width < minimumWidthRequired || isFirstItemBottomPositionUpdated) {\n                    // If left side of floating item has minimum width to layout the paragraph, then find the minimum bottom among the floating items to the left side of current floating item.\n                    // Then update the Y position to that bottom.\n                    if (this.clientActiveArea.x + minimumWidthRequired < textWrappingBounds.x) {\n                      var tempBounds = this.getIntersectingItemBounds(bodyWidget.floatingElements, floatingItem, yposition);\n                      if (!isNullOrUndefined(tempBounds) && tempBounds.bottom <= textWrappingBounds.bottom) {\n                        this.updateBoundsBasedOnTextWrap(tempBounds.bottom);\n                        rect = this.clientActiveArea;\n                        isPositionsUpdated = true;\n                        //When we update the client area to the bottom of floating item, we also need to updtae the X position. \n                        //To-Do: Some more X position updating cases also need to handle.\n                        paragraph.x = tempBounds.x;\n                      }\n                    }\n                    // Skip to wrap the immediate paragraph of floating table based on corresponding floating table.\n                    if (isWord2013 && !isPositionsUpdated) {\n                      if (floatingItem instanceof TableWidget && previousItem === floatingItem) {\n                        this.updateBoundsBasedOnTextWrapTable(textWrappingBounds.bottom);\n                      } else {\n                        this.updateBoundsBasedOnTextWrap(textWrappingBounds.bottom);\n                      }\n                      rect = this.clientActiveArea;\n                    }\n                    if ((!isEmptyPara && paragraph.childWidgets[0].isFirstLine() || isEmptyPara) && isWord2013 ? true : !isInsideHeaderFooter) {\n                      paragraph.y = this.clientActiveArea.y;\n                    }\n                  } else {\n                    rect.x = textWrappingBounds.right;\n                  }\n                } else {\n                  rect.x = textWrappingBounds.right;\n                }\n              } else if (textWrappingBounds.x > rect.x && rect.right > textWrappingBounds.x) {\n                rect.width = textWrappingBounds.x - rect.x;\n                //checks minimum width\n                if (rect.width < minimumWidthRequired) {\n                  rect.width = this.clientActiveArea.right - textWrappingBounds.right - rightIndent;\n                  if (rect.width < minimumWidthRequired) {\n                    //Skip to wrap the immediate paragraph of floating table based on corresponding floating table. \n                    if (isWord2013 || !(floatingItem instanceof TableWidget && previousItem === floatingItem)) {\n                      this.updateBoundsBasedOnTextWrap(textWrappingBounds.bottom);\n                      rect = this.clientActiveArea;\n                    }\n                    if ((!isEmptyPara && paragraph.childWidgets[0].isFirstLine() || isEmptyPara) && isWord2013 ? true : !isInsideHeaderFooter) {\n                      paragraph.y = this.clientActiveArea.y;\n                    }\n                  } else {\n                    rect.x = textWrappingBounds.right;\n                  }\n                }\n              }\n            } else if (bodyWidget.floatingElements.length > 0 && (rect.y >= textWrappingBounds.y && rect.y < textWrappingBounds.bottom || rect.y + paragraphHeight >= textWrappingBounds.y && rect.y + paragraphHeight < textWrappingBounds.bottom) && textWrappingStyle === 'TopAndBottom') {\n              //Skip to wrap the immediate paragraph of floating table based on corresponding floating table. \n              if (isWord2013 || !(floatingItem instanceof TableWidget && previousItem === floatingItem)) {\n                this.updateBoundsBasedOnTextWrap(textWrappingBounds.bottom);\n                // Sets true to update bottom position of first inline item in page\n                // when this item's bottom position already updated based on previous floating item.\n                if (!isWord2013 && (!isEmptyPara && paragraph.childWidgets[0].isFirstLine() || isEmptyPara)) {\n                  isFirstItemBottomPositionUpdated = true;\n                }\n              }\n              if ((!isEmptyPara && paragraph.childWidgets[0].isFirstLine() || isEmptyPara) && isWord2013 ? true : !isInsideHeaderFooter) {\n                paragraph.y = this.clientActiveArea.y;\n              }\n            }\n          }\n          // //Reset the floating item bounds to original position\n          // ResetXPositionForRTLLayouting(i, ref textWrappingBounds, floatingItemXPosition);\n        }\n        //Update the wrapping difference value.\n        // if (isFirstItem && yValue < rect.Y) {\n        //     (m_lcOperator as Layouter).WrappingDifference = (float)(rect.Y - (m_lcOperator as Layouter).PageTopMargin);\n        // }\n      }\n    }\n  };\n  LayoutViewer.prototype.updateParagraphXPositionBasedOnTextWrap = function (block) {\n    // #region textwrap\n    var yValue = 0;\n    var isFirstItem = false;\n    var isWord2013 = this.documentHelper.compatibilityMode === 'Word2013';\n    var bodyWidget = block.containerWidget;\n    var clientLayoutArea = this.clientActiveArea;\n    // if (!(m_lcOperator as Layouter).IsLayoutingHeaderFooter &&\n    //     (m_lcOperator as Layouter).WrappingDifference === Number.MIN_VALUE &&\n    //     Math.round(yPosition, 2) === Math.round((m_lcOperator as Layouter).PageTopMargin, 2)) {\n    //     yValue = yPosition;\n    //     isFirstItem = true;\n    // }\n    if (this instanceof PageLayoutViewer && !isNullOrUndefined(bodyWidget) && block instanceof ParagraphWidget && !isNullOrUndefined(bodyWidget.page) && !isNullOrUndefined(bodyWidget.page.headerWidget)) {\n      var floatingItems = bodyWidget.page.headerWidget.floatingElements;\n      if (floatingItems.length > 0 && (!block.isInHeaderFooter || block.isInsideTable || isWord2013) && !(block.containerWidget instanceof FootNoteWidget) && !(block.bodyWidget instanceof TextFrame)) {\n        // const clientLayoutArea: RectangleF = (m_lcOperator as Layouter).ClientLayoutArea;\n        // clientLayoutArea.X = xPosition;\n        // clientLayoutArea.Y = yPosition;\n        //let cellPadings: number = 0;\n        var paragraph = block;\n        //if (paragraph.isInsideTable) {\n        //const cellLayoutInfo: CellLayoutInfo = ((paragraph.GetOwnerEntity() as WTableCell) as IWidget).LayoutInfo as CellLayoutInfo;\n        //cellPadings = cellLayoutInfo.Paddings.Left + cellLayoutInfo.Paddings.Right;\n        // }\n        // let defMinWidth: number = minimumWidthRequired - cellPadings;\n        // const size: SizeF = (paragraph as IWidget).LayoutInfo.Size;\n        for (var i = 0; i < floatingItems.length; i++) {\n          var floatingItem = floatingItems[i];\n          // if (paragraph.IsInCell && floatingItems[i].allowOverlap &&\n          //     (paragraph.associatedCell.ownerRow.ownerTable.tableFormat.positioning.allowOverlap) {\n          if (paragraph.isInsideTable) {\n            if (floatingItem instanceof TableWidget && !floatingItem.isInsideTable) {\n              continue;\n            }\n          }\n          // }\n          var textWrappingBounds = this.getTextWrappingBound(floatingItem);\n          var textWrappingStyle = floatingItem instanceof TableWidget ? 'Square' : floatingItem.textWrappingStyle;\n          var textWrappingType = floatingItem instanceof TableWidget ? 'Both' : floatingItem.textWrappingType;\n          //let ownerBody: BodyWidget = undefined;\n          //As per Microsoft Word behavior, when floating item and paragraph in cell means,\n          //then, wrap the bounds for the items in same cell only.                 \n          //Skip, if it is in different cell.\n          // let ownerBody: BodyWidget = undefined\n          // if (!this.isInSameTextBody(paragraph, floatingItem, ownerBody) &&\n          //     paragraph.isInsideTable && bodyWidget instanceof TableCellWidget) {\n          //     continue;\n          // }\n          // if (this.IsInFrame((m_lcOperator as Layouter).FloatingItems[i].FloatingEntity as WParagraph) &&\n          //     this.IsOwnerCellInFrame(paragraph)) {\n          //     continue;\n          // }\n          // if (paragraph.ParagraphFormat.Bidi &&\n          //     (this.IsInSameTextBody(paragraph, (m_lcOperator as Layouter).FloatingItems[i], ownerBody) &&\n          //         paragraph.IsInCell && ownerBody instanceof WTableCell)) {\n          //     this.ModifyXPositionForRTLLayouting(i, textWrappingBounds, (m_layoutArea as any).ClientArea);\n          // } else if (paragraph.ParagraphFormat.Bidi) {\n          //     this.ModifyXPositionForRTLLayouting(i, textWrappingBounds, (m_lcOperator as Layouter).ClientLayoutArea);\n          // }\n          var minimumWidthRequired = 24;\n          // if (textWrappingStyle === TextWrappingStyle.Tight || textWrappingStyle === TextWrappingStyle.Through) {\n          //     minimumWidthRequired = paragraph.Document.Settings.CompatibilityMode === CompatibilityMode.Word2013 ?\n          //         DEF_MIN_WIDTH_2013_TIGHTANDTHROW : DEF_MIN_WIDTH_TIGHTANDTHROW;\n          // }\n          // minimumWidthRequired -= cellPadings;\n          // defMinWidth = minimumWidthRequired;\n          // if (textWrappingStyle === TextWrappingStyle.Tight || textWrappingStyle === TextWrappingStyle.Through &&\n          //     (m_lcOperator as Layouter).FloatingItems[i].IsDoesNotDenotesRectangle) {\n          //     const temp: RectangleF = this.AdjustTightAndThroughBounds(\n          //         (m_lcOperator as Layouter).FloatingItems[i], clientLayoutArea, size.Height);\n          //     if (temp.X !== 0) {\n          //         textWrappingBounds = temp;\n          //         defMinWidth = size.Width;\n          //     }\n          // }\n          if (!paragraph.isInsideTable && !(clientLayoutArea.x > textWrappingBounds.right + minimumWidthRequired || clientLayoutArea.right < textWrappingBounds.x - minimumWidthRequired)) {\n            if (floatingItems.length > 0 && clientLayoutArea.y + paragraph.height > textWrappingBounds.y && clientLayoutArea.y < textWrappingBounds.bottom && textWrappingStyle !== \"Inline\" && textWrappingStyle !== \"TopAndBottom\" && textWrappingStyle !== \"InFrontOfText\" && textWrappingStyle !== \"Behind\") {\n              var rightIndent = HelperMethods.convertPointToPixel(paragraph.paragraphFormat.rightIndent);\n              if (paragraph.paragraphFormat.textAlignment != \"Left\" && clientLayoutArea.x < textWrappingBounds.x && clientLayoutArea.x + paragraph.width > textWrappingBounds.x) {\n                paragraph.x = clientLayoutArea.x;\n              } else if (clientLayoutArea.x >= textWrappingBounds.x && clientLayoutArea.x < textWrappingBounds.right && !paragraph.paragraphFormat.bidi) {\n                clientLayoutArea.width = clientLayoutArea.width - (textWrappingBounds.right - clientLayoutArea.x) - rightIndent;\n                if (clientLayoutArea.width < minimumWidthRequired) {\n                  clientLayoutArea.width = this.clientActiveArea.right - textWrappingBounds.right - rightIndent;\n                  if (clientLayoutArea.width < minimumWidthRequired) {\n                    paragraph.x = clientLayoutArea.x;\n                    clientLayoutArea.width = clientLayoutArea.width;\n                    clientLayoutArea.height = textWrappingBounds.bottom - clientLayoutArea.x;\n                    clientLayoutArea.y = textWrappingBounds.bottom;\n                  } else {\n                    clientLayoutArea.x = textWrappingBounds.right;\n                  }\n                } else if (this.documentHelper.compatibilityMode === \"Word2007\" || clientLayoutArea.y <= textWrappingBounds.bottom) {\n                  // if (this.IsNeedToUpdateParagraphYPosition(clientLayoutArea.Y, textWrappingStyle,\n                  //     paragraph, clientLayoutArea.Y + size.Height + paragraph.ParagraphFormat.AfterSpacing, textWrappingBounds.Bottom)) {\n                  //     paragraph.x = clientLayoutArea.x;\n                  //     clientLayoutArea.width = clientLayoutArea.width;\n                  //     clientLayoutArea.y = textWrappingBounds.bottom;\n                  //     clientLayoutArea.height = clientLayoutArea.height -\n                  //         (textWrappingBounds.bottom - clientLayoutArea.y);\n                  //     this.updateBoundsBasedOnTextWrap(textWrappingBounds.bottom);\n                  // } else {\n                  //const paraInfo: ParagraphLayoutInfo = paragraph.m_layoutInfo as ParagraphLayoutInfo;\n                  var leftIndent = HelperMethods.convertPointToPixel(paragraph.paragraphFormat.leftIndent);\n                  var firstLineIndent = HelperMethods.convertPointToPixel(paragraph.paragraphFormat.firstLineIndent);\n                  if (leftIndent + firstLineIndent + clientLayoutArea.x < textWrappingBounds.right) {\n                    //paragraph.x = textWrappingBounds.right;\n                    clientLayoutArea.x = textWrappingBounds.right;\n                    if (isWord2013) {\n                      //this.documentHelper.layout.IsXpositionUpated = true;\n                    }\n                  }\n                  // }\n                }\n              } else if (textWrappingBounds.x - minimumWidthRequired > clientLayoutArea.x && clientLayoutArea.right > textWrappingBounds.x || clientLayoutArea.x > textWrappingBounds.x && clientLayoutArea.x > textWrappingBounds.right) {\n                paragraph.x = clientLayoutArea.x;\n              }\n              // else if (clientLayoutArea.x > textWrappingBounds.x - minimumWidthRequired && clientLayoutArea.x < textWrappingBounds.right) {\n              //     const width: number = clientLayoutArea.width + (clientLayoutArea.x - textWrappingBounds.right);\n              //     if (width < minimumWidthRequired) {\n              //         clientLayoutArea.y = textWrappingBounds.bottom;\n              //     } else {\n              //         paragraph.x = textWrappingBounds.right;\n              //     }\n              // } \n              // else if (this.IsNeedToUpdateParagraphYPosition(clientLayoutArea.Y, textWrappingStyle,\n              //     paragraph, clientLayoutArea.Y + size.Height + paragraph.ParagraphFormat.AfterSpacing, textWrappingBounds.Bottom)) {\n              //     (paragraph.m_layoutInfo as ParagraphLayoutInfo).XPosition = clientLayoutArea.X;\n              //     clientLayoutArea.Width = (m_lcOperator as Layouter).ClientLayoutArea.Width;\n              //     clientLayoutArea.Y = textWrappingBounds.Bottom;\n              //     clientLayoutArea.Height = (m_lcOperator as Layouter).ClientLayoutArea.Height -\n              //         (textWrappingBounds.Bottom - (m_lcOperator as Layouter).ClientLayoutArea.Y);\n              //     (m_layoutArea as any).UpdateBoundsBasedOnTextWrap(textWrappingBounds.Bottom);\n              // }\n            }\n          }\n          //this.ResetXPositionForRTLLayouting(i, textWrappingBounds, floatingItemXPosition);\n        }\n      }\n      // if (m_widget instanceof WParagraph) {\n      //     const sortYPosition: FloatingItem[] = (m_lcOperator as Layouter).FloatingItems.slice(0);\n      //     FloatingItem.SortFloatingItems(sortYPosition, SortPosition.Y);\n      //     this.UpdateXYPositionBasedOnAdjacentFloatingItems(sortYPosition, clientLayoutArea, size,\n      //         m_widget as WParagraph, false);\n      // }\n      // if (isFirstItem && yValue < yPosition) {\n      //     (m_lcOperator as Layouter).WrappingDifference = yPosition - (m_lcOperator as Layouter).PageTopMargin;\n      // }\n    }\n  };\n  LayoutViewer.prototype.updateTableXPositionBasedOnTextWrap = function (block) {\n    // Get the first row width\n    var firstRowWidth = HelperMethods.convertPointToPixel(block.childWidgets[0].getFirstRowWidth());\n    var bodyWidget = block.bodyWidget;\n    if (this instanceof PageLayoutViewer && !isNullOrUndefined(bodyWidget) && !isNullOrUndefined(bodyWidget.page) && !isNullOrUndefined(bodyWidget.page.headerWidget)) {\n      var floatingItems = bodyWidget.page.headerWidget.floatingElements;\n      // textwrap\n      // Update Layout area based on text wrap and ignore the yposition update while \n      // wrapping bounds already added to the collection\n      if (floatingItems.length > 0 && (!block.isInHeaderFooter || !block.isInsideTable || this.documentHelper.compatibilityMode === 'Word2013') && !(block.containerWidget instanceof TextFrame)) {\n        var rect = this.clientActiveArea;\n        //let wrapItemIndex: number = -1;\n        // sort the list items based on y position,\n        // Call Sort on the list. This will use the  \n        // default comparer, which is the Compare method  \n        // implemented on FloatingItem.\n        //FloatingItem.sortFloatingItems(this.m_lcOperator.floatingItems, SortPosition.Y);\n        for (var i = 0; i < floatingItems.length; i++) {\n          var floatingItem = floatingItems[i];\n          var textWrappingBounds = this.getTextWrappingBound(floatingItem);\n          var textWrappingStyle = floatingItem instanceof TableWidget ? 'Square' : floatingItem.textWrappingStyle;\n          var allowOverlap = floatingItem instanceof TableWidget ? floatingItem.positioning.allowOverlap : floatingItem.allowOverlap;\n          // if (this.isAdjustTightAndThroughBounds(textWrappingStyle, i)) {\n          //     let temp: RectangleF = this.adjustTightAndThroughBounds(this.m_lcOperator.floatingItems[i], rect, size.height);\n          //     textWrappingBounds = temp;\n          // }\n          // let ownerBody: WTextBody = null;\n          // // As per Microsoft Word behavior, when floating item and table in cell means,\n          // // then, wrap the bounds for the items in same cell only.                 \n          // // Skip, if it is in different cell.\n          // if (!this.isInSameTextBody(this.m_table, this.m_lcOperator.floatingItems[i], ownerBody)\n          //     && this.m_table.isInCell && ownerBody instanceof WTableCell)\n          //     continue;\n          // // Skip if the current table is in different frame\n          // if (this.isInFrame(this.m_lcOperator.floatingItems[i].floatingEntity as WParagraph) && this.m_table.isFrame)\n          //     continue;\n          // // Adjusts the text wrapping bounds based on distance from text values when floating table intersects with another floating item.\n          // textWrappingBounds = this.adjustTextWrappingBounds(this.m_lcOperator.floatingItems[i], clientLayoutArea, size,\n          //     wrapItemIndex, i, rect, textWrappingBounds, textWrappingStyle, allowOverlap);\n          var minimumWidthRequired = 24;\n          var paragarph = this.documentHelper.getFirstParagraphInFirstCell(block);\n          var height = this.documentHelper.textHelper.getParagraphMarkSize(paragarph.characterFormat).Height;\n          var rowHeight = block.childWidgets[0] instanceof TableRowWidget ? block.childWidgets[0].height : 0;\n          if (rowHeight > height) {\n            height = rowHeight;\n          }\n          var width = HelperMethods.convertPointToPixel(block.getTableClientWidth(block.getContainerWidth()));\n          if (!(this.clientArea.x > textWrappingBounds.right + minimumWidthRequired || this.clientArea.right < textWrappingBounds.x - minimumWidthRequired)) {\n            if (this.isFloatingItemIntersect(block, rect, textWrappingBounds, textWrappingStyle, allowOverlap, height, width)) {\n              if (rect.x >= textWrappingBounds.x && rect.x < textWrappingBounds.right) {\n                rect.width = rect.width - (textWrappingBounds.right - rect.x);\n                //checks minimum width\n                if (rect.width < minimumWidthRequired || rect.width < firstRowWidth && firstRowWidth > 0) {\n                  rect.width = this.clientActiveArea.right - textWrappingBounds.right;\n                  //Check if the client active area width is lesser than table width to update the y position\n                  if (rect.width < minimumWidthRequired || rect.width < firstRowWidth && firstRowWidth > 0 && this.clientArea.right <= firstRowWidth + textWrappingBounds.right) {\n                    //When the table y position is lesser than the text wrapping bottom position then \n                    //difference of these two should be subtracted from the table client height instead of the floating item height.\n                    var remainingHeightOfFloatingItem = textWrappingBounds.bottom > rect.y ? textWrappingBounds.bottom - rect.y : 0;\n                    rect.y = textWrappingBounds.bottom;\n                    rect.width = this.clientArea.width;\n                    rect.height = rect.height - remainingHeightOfFloatingItem;\n                    this.updateClientAreaForTextWrap(rect);\n                  } else {\n                    rect.x = textWrappingBounds.right;\n                    // if (textWrappingStyle == TextWrappingStyle.Through\n                    //     && this.m_lcOperator.floatingItems[i].isDoesNotDenotesRectangle) {\n                    //     textWrappingBounds = this.adjustTightAndThroughBounds(this.m_lcOperator.floatingItems[i], rect, size.height);\n                    //     if (textWrappingBounds.x != 0)\n                    //         rect.width = textWrappingBounds.x - rect.x;\n                    // }\n                    this.updateClientAreaForTextWrap(rect);\n                  }\n                } else {\n                  rect.x = textWrappingBounds.right;\n                  // if (textWrappingStyle == TextWrappingStyle.Through\n                  //     && this.m_lcOperator.floatingItems[i].isDoesNotDenotesRectangle) {\n                  //     textWrappingBounds = this.adjustTightAndThroughBounds(this.m_lcOperator.floatingItems[i], rect, size.height);\n                  //     if (textWrappingBounds.x != 0)\n                  //         rect.width = textWrappingBounds.x - rect.x;\n                  // }\n                  this.updateClientAreaForTextWrap(rect);\n                }\n              }\n              // else if ((rect.right - textWrappingBounds.right) > 0\n              //     && (rect.right - textWrappingBounds.right) < rect.width\n              //     && (rect.y >= textWrappingBounds.y\n              //         || (rect.y + size.height) >= textWrappingBounds.y)) {\n              //     //If the table is intersect with  another floating item from the top ,then we need to consider distance from text with respect to relative margin position.\n              //     if (rect.x < textWrappingBounds.x && rect.right > textWrappingBounds.x) {\n              //         if (this.m_table.tableFormat.positioning.horizPositionAbs == HorizontalPosition.Left)\n              //             rect.x += this.m_table.tableFormat.positioning.distanceFromLeft;\n              //         else if (this.m_table.tableFormat.positioning.horizPositionAbs == HorizontalPosition.Right)\n              //             rect.x -= this.m_table.tableFormat.positioning.distanceFromRight;\n              //     }\n              //     //When the table y position is lesser than the text wrapping bottom position then \n              //     //difference of these two should be subtracted from the table client height instead of the floating item height.\n              //     let remainingHeightOfFloatingItem = (textWrappingBounds.bottom > rect.y) ? textWrappingBounds.bottom - rect.y : 0;\n              //     rect.y = textWrappingBounds.bottom;\n              //     rect.height = rect.height - remainingHeightOfFloatingItem;\n              //     this.createLayoutArea(rect);\n              // }\n              // else if (textWrappingBounds.x > rect.x && rect.right > textWrappingBounds.x) {\n              //     rect.width = textWrappingBounds.x - rect.x;\n              //     //checks minimum width\n              //     if (rect.width < DEF_MIN_WIDTH || (rect.width < firstRowWidth && firstRowWidth > 0)) {\n              //         rect.width = this.m_layoutArea.clientActiveArea.right - textWrappingBounds.right;\n              //         if (rect.width < DEF_MIN_WIDTH || (rect.width < firstRowWidth && firstRowWidth > 0)) {\n              //             //Check if the client active area width is greater than table width to update the x position\n              //             if (this.m_layoutArea.clientArea.right < this.m_lcOperator.clientLayoutArea.right\n              //                 && textWrappingBounds.right < this.m_lcOperator.clientLayoutArea.right\n              //                 && this.m_lcOperator.clientLayoutArea.right - textWrappingBounds.right > DEF_MIN_WIDTH\n              //                 && Math.round(this.m_layoutArea.clientActiveArea.width, 2) > Math.round(firstRowWidth, 2)) {\n              //                 rect.width = this.m_lcOperator.clientLayoutArea.right - textWrappingBounds.right;\n              //                 rect.x = textWrappingBounds.right;\n              //                 if (textWrappingStyle == TextWrappingStyle.Through\n              //                     && this.m_lcOperator.floatingItems[i].isDoesNotDenotesRectangle) {\n              //                     textWrappingBounds = this.adjustTightAndThroughBounds(this.m_lcOperator.floatingItems[i], rect, size.height);\n              //                     if (textWrappingBounds.x != 0)\n              //                         rect.width = textWrappingBounds.x - rect.x;\n              //                 }\n              //             }\n              //             else {\n              //                 //When the table y position is lesser than the text wrapping bottom position then \n              //                 //difference of these two should be subtracted from the table client height instead of the floating item height.\n              //                 let remainingHeightOfFloatingItem = (textWrappingBounds.bottom > rect.y) ? textWrappingBounds.bottom - rect.y : 0;\n              //                 rect.y = textWrappingBounds.bottom;\n              //                 rect.height = rect.height - remainingHeightOfFloatingItem;\n              //             }\n              //             this.createLayoutArea(rect);\n              //         }\n              //     }\n              //     else\n              //         this.createLayoutArea(rect);\n              // }\n              // else if (rect.x > textWrappingBounds.x && rect.x > textWrappingBounds.right) {\n              //     rect.width = this.m_layoutArea.clientArea.width;\n              //     this.createLayoutArea(rect);\n              // }\n              // else if (rect.x > textWrappingBounds.x && rect.x < textWrappingBounds.right) {\n              //     rect.width = rect.width - (textWrappingBounds.right - rect.x);\n              //     rect.x = textWrappingBounds.right;\n              //     if (textWrappingStyle == TextWrappingStyle.Through\n              //         && this.m_lcOperator.floatingItems[i].isDoesNotDenotesRectangle) {\n              //         textWrappingBounds = this.adjustTightAndThroughBounds(this.m_lcOperator.floatingItems[i], rect, size.height);\n              //         if (textWrappingBounds.x != 0)\n              //             rect.width = textWrappingBounds.x - rect.x;\n              //     }\n              //     this.createLayoutArea(rect);\n              // }\n            }\n          }\n        }\n      }\n    }\n  };\n  LayoutViewer.prototype.isFloatingItemIntersect = function (table, rect, textWrappingBounds, textWrappingStyle, allowOverlap, height, width) {\n    return (Math.round(rect.y + height) >= Math.round(textWrappingBounds.y) && Math.round(rect.y) < Math.round(textWrappingBounds.bottom)\n    //Checks whether the bottom of the table intersects with floating item.\n    || Math.round(rect.y + height) <= Math.round(textWrappingBounds.bottom) && Math.round(rect.y + height) >= Math.round(textWrappingBounds.y)) && textWrappingStyle !== \"Inline\" && textWrappingStyle !== \"TopAndBottom\" && textWrappingStyle !== \"InFrontOfText\" && textWrappingStyle !== \"Behind\" && !(allowOverlap && table.tableFormat !== null && table.wrapTextAround && table.positioning.allowOverlap);\n  };\n  LayoutViewer.prototype.getIntersectingItemBounds = function (floatingElements, intersectedfloatingItem, yPosition) {\n    var floatingItem = this.getMinBottomFloatingItem(floatingElements, this.getIntersectingFloatingItems(floatingElements, intersectedfloatingItem, yPosition));\n    if (!isNullOrUndefined(floatingItem)) {\n      var floatingItemBound = this.getTextWrappingBound(floatingItem);\n      return floatingItemBound;\n    }\n    return undefined;\n  };\n  LayoutViewer.prototype.getMinBottomFloatingItem = function (floatingElements, fItems) {\n    var minBottomItemIndex = -1;\n    var minBottom = Number.MAX_VALUE;\n    var skippedCount = 0;\n    // Sort based on X position\n    floatingElements.sort(function (a, b) {\n      return a.x - b.x;\n    });\n    for (var i = 0; i < fItems.length; i++) {\n      var floatingItem = floatingElements[i];\n      var item = this.getTextWrappingBound(floatingItem);\n      if (minBottom > item.bottom) {\n        // Need to ignore if floating items preserved in same frame.\n        if (floatingItem && fItems.indexOf(floatingItem) + 1 < fItems.length) {\n          skippedCount++;\n        } else {\n          minBottom = item.bottom;\n          minBottomItemIndex = fItems.indexOf(floatingItem);\n        }\n      }\n    }\n    //If floating item which has minimum bottom is first item (no items preserved left side of this item).\n    //Then return current item Other cases need to handle.\n    return minBottomItemIndex - skippedCount == 0 ? fItems[minBottomItemIndex] : null;\n  };\n  LayoutViewer.prototype.getIntersectingFloatingItems = function (floatingElements, intersectedfloatingItem, yPosition) {\n    var fItems = [];\n    //Get all the items which preserved left side of the current floating item.\n    for (var i = 0; i < floatingElements.length; i++) {\n      {\n        var floatingItem = floatingElements[i];\n        var itemTextWrapBound = this.getTextWrappingBound(floatingItem);\n        var intersectItemTextWrapBound = this.getTextWrappingBound(intersectedfloatingItem);\n        if (yPosition <= itemTextWrapBound.bottom && intersectItemTextWrapBound.bottom >= itemTextWrapBound.bottom && itemTextWrapBound.right > this.clientActiveArea.x && itemTextWrapBound.x < intersectItemTextWrapBound.x) fItems.push(floatingItem);\n      }\n    }\n    return fItems;\n  };\n  LayoutViewer.prototype.getTextWrappingBound = function (floatingItem) {\n    var distanceLeft = 0;\n    var distanceTop = 0;\n    var distanceRight = 0;\n    var distanceBottom = 0;\n    var width = 0;\n    if (floatingItem instanceof ShapeBase) {\n      distanceLeft = floatingItem.distanceLeft;\n      distanceTop = floatingItem.distanceTop;\n      distanceRight = floatingItem.distanceRight;\n      distanceBottom = floatingItem.distanceBottom;\n      width = floatingItem.width;\n    } else {\n      width = floatingItem.getTableCellWidth();\n      distanceLeft = floatingItem.positioning.distanceLeft;\n      distanceTop = floatingItem.positioning.distanceTop;\n      distanceRight = floatingItem.positioning.distanceRight;\n      distanceBottom = floatingItem.positioning.distanceBottom;\n    }\n    var textWrappingBounds = new Rect(floatingItem.x - distanceLeft, floatingItem.y - distanceTop, width + distanceLeft + distanceRight, floatingItem.height + distanceTop + distanceBottom);\n    return textWrappingBounds;\n  };\n  LayoutViewer.prototype.tableAlignmentForBidi = function (block, bidi) {\n    var tableAlignment = block.tableFormat.tableAlignment;\n    if (bidi) {\n      if (tableAlignment === 'Left') {\n        tableAlignment = 'Right';\n      } else if (tableAlignment === 'Right') {\n        tableAlignment = 'Left';\n      }\n    }\n    return tableAlignment;\n  };\n  LayoutViewer.prototype.cutFromLeft = function (x) {\n    if (x < this.clientActiveArea.x) {\n      x = this.clientActiveArea.x;\n    }\n    if (x > this.clientActiveArea.right && this.textWrap) {\n      x = this.clientActiveArea.right;\n    }\n    this.clientActiveArea.width = this.clientActiveArea.right > x ? this.clientActiveArea.right - x : 0;\n    this.clientActiveArea.x = x;\n  };\n  LayoutViewer.prototype.cutFromTop = function (y) {\n    if (y < this.clientActiveArea.y) {\n      y = this.clientActiveArea.y;\n    }\n    if (y > this.clientActiveArea.bottom) {\n      y = this.clientActiveArea.bottom;\n    }\n    this.clientActiveArea.height = this.clientActiveArea.bottom - y;\n    this.clientActiveArea.x = this.clientArea.x;\n    this.clientActiveArea.width = this.clientArea.width;\n    this.clientActiveArea.y = y;\n  };\n  LayoutViewer.prototype.updateClientWidth = function (width) {\n    this.clientActiveArea.x -= width;\n    if (this.clientActiveArea.width + width > 0) {\n      this.clientActiveArea.width += width;\n    } else {\n      this.clientActiveArea.width = 0;\n    }\n  };\n  LayoutViewer.prototype.findFocusedPage = function (currentPoint, updateCurrentPage, updateHeaderFooterPage) {\n    var point = new Point(currentPoint.x, currentPoint.y);\n    point.x += this.documentHelper.viewerContainer.scrollLeft;\n    point.y += this.documentHelper.viewerContainer.scrollTop;\n    for (var i = 0; i < this.documentHelper.pages.length; i++) {\n      var page = this.documentHelper.pages[i];\n      var pageTop = (page.boundingRectangle.y - this.pageGap * (i + 1)) * this.documentHelper.zoomFactor + this.pageGap * (i + 1);\n      var pageHeight = page.boundingRectangle.height * this.documentHelper.zoomFactor + this.pageGap;\n      var pageLeft = page.boundingRectangle.x;\n      var pageRight = void 0;\n      if (this instanceof PageLayoutViewer) {\n        pageRight = (page.boundingRectangle.right - pageLeft) * this.documentHelper.zoomFactor + pageLeft;\n      } else {\n        pageRight = page.boundingRectangle.right + pageLeft;\n      }\n      if (pageTop <= point.y && pageTop + pageHeight >= point.y) {\n        if (updateCurrentPage) {\n          this.documentHelper.currentPage = page;\n          if (updateHeaderFooterPage) {\n            if (!isNullOrUndefined(page.headerWidget)) {\n              page.headerWidget.page = page;\n            }\n            if (!isNullOrUndefined(page.footerWidget)) {\n              page.footerWidget.page = page;\n            }\n          }\n        }\n        point.y = (point.y - pageTop) / this.documentHelper.zoomFactor;\n        if (point.x > pageRight) {\n          point.x = page.boundingRectangle.right;\n        } else if (point.x < pageLeft) {\n          point.x = 0;\n        } else {\n          point.x = (point.x - pageLeft) / this.documentHelper.zoomFactor;\n        }\n        return point;\n      }\n    }\n    return point;\n  };\n  LayoutViewer.prototype.getPageHeightAndWidth = function (height, width, viewerWidth, viewerHeight) {\n    height = 0;\n    for (var i = 0; i < this.documentHelper.pages.length; i++) {\n      height = height + this.documentHelper.pages[i].boundingRectangle.height;\n    }\n    width = 0;\n    for (var i = 0; i < this.documentHelper.pages.length; i++) {\n      if (width < this.documentHelper.pages[i].boundingRectangle.width) {\n        width = this.documentHelper.pages[i].boundingRectangle.width;\n      }\n    }\n    //this.documentHelper.visibleBoundsIn = new Rect(0, 0, width, height);\n    viewerWidth = this.documentHelper.visibleBounds.width;\n    viewerHeight = this.documentHelper.visibleBounds.height;\n    return {\n      'height': height,\n      'width': width,\n      'viewerWidth': viewerWidth,\n      'viewerHeight': viewerHeight\n    };\n  };\n  LayoutViewer.prototype.renderVisiblePages = function () {\n    if (isNullOrUndefined(this.visiblePages) || this.visiblePages.length < 1) {\n      return;\n    }\n    this.documentHelper.clearContent();\n    for (var i = 0; i < this.visiblePages.length; i++) {\n      var page = this.visiblePages[i];\n      var width = page.boundingRectangle.width * this.documentHelper.zoomFactor;\n      var height = page.boundingRectangle.height * this.documentHelper.zoomFactor;\n      var x = page.boundingRectangle.x;\n      var y = (page.boundingRectangle.y - this.pageGap * (i + 1)) * this.documentHelper.zoomFactor + this.pageGap * (i + 1);\n      this.owner.viewer.renderPage(page, x, y, width, height);\n    }\n  };\n  /* eslint-disable  */\n  LayoutViewer.prototype.handleZoom = function () {\n    var prevScaleFactor = this.documentHelper.preZoomFactor;\n    var page = null;\n    var verticalHeight = 0;\n    var scrollToPosition = false;\n    if (this.documentHelper.selection && isNullOrUndefined(this.documentHelper.zoomX && isNullOrUndefined(this.documentHelper.zoomY))) {\n      var x = 0;\n      var y = 0;\n      var endPage = this.documentHelper.selection.getPage(this.documentHelper.selection.end.currentWidget.paragraph);\n      x = (this.documentHelper.visibleBounds.width - endPage.boundingRectangle.width * prevScaleFactor) / 2;\n      if (x < 30) {\n        x = 30;\n      }\n      y = endPage.boundingRectangle.y * prevScaleFactor + (this.documentHelper.pages.indexOf(endPage) + 1) * this.pageGap * (1 - prevScaleFactor);\n      var caretInfo = this.documentHelper.selection.updateCaretSize(this.owner.selectionModule.end, true);\n      var topMargin = caretInfo.topMargin;\n      var caretHeight = caretInfo.height;\n      x += this.documentHelper.selection.end.location.x * prevScaleFactor;\n      y += (this.documentHelper.selection.end.location.y + topMargin) * prevScaleFactor;\n      if (x >= this.containerLeft && x <= this.documentHelper.visibleBounds.width && y >= this.containerTop && y <= this.containerTop + this.documentHelper.visibleBounds.height) {\n        scrollToPosition = true;\n      }\n    }\n    for (var i = 0; i < this.documentHelper.pages.length; i++) {\n      verticalHeight = verticalHeight + this.documentHelper.pages[i].boundingRectangle.height;\n    }\n    var horizontalWidth = 0;\n    for (var i = 0; i < this.documentHelper.pages.length; i++) {\n      if (horizontalWidth < this.documentHelper.pages[i].boundingRectangle.width) {\n        horizontalWidth = this.documentHelper.pages[i].boundingRectangle.width;\n      }\n    }\n    var height = verticalHeight * this.documentHelper.zoomFactor + (this.documentHelper.pages.length + 1) * this.pageGap * (1 - this.documentHelper.zoomFactor) - this.documentHelper.visibleBounds.height;\n    var horWidth = horizontalWidth * this.documentHelper.zoomFactor - this.documentHelper.visibleBounds.width;\n    if (this.documentHelper.visibleBounds.width - horizontalWidth * this.documentHelper.zoomFactor < 60) {\n      horWidth += 60;\n    }\n    //Update Vertical Scroll bar\n    if (height > 0) {\n      var value = this.containerTop;\n      if (this.visiblePages.length > 0) {\n        page = this.visiblePages[0];\n        var prevPageTop = (page.boundingRectangle.y - (page.index + 1) * this.pageGap) * prevScaleFactor + (page.index + 1) * this.pageGap;\n        var zoomY = this.documentHelper.zoomY;\n        if (isNullOrUndefined) {\n          zoomY = this.documentHelper.visibleBounds.height / 2;\n        }\n        var prevY = value + zoomY;\n        while (prevY > prevPageTop + page.boundingRectangle.height * prevScaleFactor) {\n          var pageIndex = page.index + 1;\n          if (pageIndex === this.documentHelper.pages.length) {\n            break;\n          }\n          page = this.documentHelper.pages[pageIndex];\n          prevPageTop = (page.boundingRectangle.y - (page.index + 1) * this.pageGap) * prevScaleFactor + (page.index + 1) * this.pageGap;\n        }\n        var currentY = (page.boundingRectangle.y - (page.index + 1) * this.pageGap) * this.documentHelper.zoomFactor + (page.index + 1) * this.pageGap + (prevY - prevPageTop < 0 ? prevY - prevPageTop : (prevY - prevPageTop) * (this.documentHelper.zoomFactor / prevScaleFactor));\n        value = currentY - zoomY;\n        zoomY = this.documentHelper.visibleBounds.height / 2;\n      }\n      this.documentHelper.viewerContainer.scrollTop = value;\n    } else {\n      this.documentHelper.viewerContainer.scrollTop = 0;\n    }\n    // update Horizontal Scroll Bar\n    if (horWidth > 0) {\n      var value = this.containerLeft;\n      if (this.visiblePages.length > 0) {\n        if (page === null) {\n          page = this.visiblePages[0];\n        }\n        var zoomX = this.documentHelper.zoomX;\n        if (isNullOrUndefined(zoomX)) {\n          zoomX = this.documentHelper.visibleBounds.width / 2;\n        }\n        var prevValue = page.boundingRectangle.width * prevScaleFactor / page.boundingRectangle.width;\n        var prevX = value + zoomX;\n        var currentX = page.boundingRectangle.x + (prevX - page.boundingRectangle.x < 0 ? prevX - page.boundingRectangle.x : (prevX - page.boundingRectangle.x) * (this.documentHelper.zoomFactor / prevValue));\n        value = currentX - zoomX;\n        zoomX = this.documentHelper.visibleBounds.width / 2;\n      }\n      this.documentHelper.viewerContainer.scrollLeft = value;\n    } else {\n      this.documentHelper.viewerContainer.scrollLeft = 0;\n    }\n    this.updateScrollBars();\n    if (scrollToPosition) {\n      this.documentHelper.scrollToPosition(this.documentHelper.selection.start, this.documentHelper.selection.end);\n    }\n    if (this instanceof WebLayoutViewer) {\n      this.owner.editorModule.layoutWholeDocument();\n    }\n  };\n  LayoutViewer.prototype.updateCanvasWidthAndHeight = function (viewerWidth, viewerHeight, containerHeight, containerWidth, width, height) {\n    if (this instanceof PageLayoutViewer) {\n      if (this.documentHelper.visibleBounds.width !== this.documentHelper.viewerContainer.clientWidth) {\n        viewerWidth -= this.documentHelper.visibleBounds.width - this.documentHelper.viewerContainer.clientWidth;\n      } else if (containerHeight > viewerHeight) {\n        viewerWidth -= this.documentHelper.viewerContainer.offsetWidth - this.documentHelper.viewerContainer.clientWidth;\n      }\n    } else {\n      if (containerHeight > viewerHeight) {\n        viewerWidth -= this.documentHelper.scrollbarWidth;\n        containerWidth -= this.documentHelper.scrollbarWidth;\n      }\n    }\n    if (containerWidth > viewerWidth) {\n      viewerHeight -= this.documentHelper.scrollbarWidth;\n    }\n    width = containerWidth > viewerWidth ? containerWidth : viewerWidth;\n    height = containerHeight > viewerHeight ? containerHeight : viewerHeight;\n    if (parseInt(this.documentHelper.pageContainer.style.width.replace('px', ''), 10) !== width || parseInt(this.documentHelper.pageContainer.style.height.replace('px', ''), 10) !== width) {\n      this.documentHelper.pageContainer.style.width = width.toString() + 'px';\n      this.documentHelper.pageContainer.style.height = height.toString() + 'px';\n    }\n    // if (!isNullOrUndefined(this.selection) && !this.selection.isEmpty) {\n    //     this.selectionContext.clearRect(0, 0, this.selectionCanvas.width, this.selectionCanvas.height);\n    var displayPixelRatio = Math.max(1, window.devicePixelRatio || 1);\n    if (this.documentHelper.containerCanvas.width !== Math.floor(viewerWidth * displayPixelRatio) || this.documentHelper.containerCanvas.height !== Math.floor(viewerHeight * displayPixelRatio)) {\n      this.documentHelper.containerCanvas.width = viewerWidth * displayPixelRatio;\n      this.documentHelper.containerCanvas.height = viewerHeight * displayPixelRatio;\n      this.documentHelper.containerCanvas.style.width = viewerWidth + 'px';\n      this.documentHelper.containerCanvas.style.height = viewerHeight + 'px';\n      this.documentHelper.containerContext.scale(displayPixelRatio, displayPixelRatio);\n      this.documentHelper.selectionCanvas.width = viewerWidth * displayPixelRatio;\n      this.documentHelper.selectionCanvas.height = viewerHeight * displayPixelRatio;\n      this.documentHelper.selectionCanvas.style.width = viewerWidth + 'px';\n      this.documentHelper.selectionCanvas.style.height = viewerHeight + 'px';\n      this.documentHelper.selectionContext.scale(displayPixelRatio, displayPixelRatio);\n    }\n    return {\n      'height': height,\n      'width': width,\n      'viewerWidth': viewerWidth,\n      'viewerHeight': viewerHeight,\n      'containerHeight': containerHeight,\n      'containerWidth': containerWidth\n    };\n  };\n  LayoutViewer.prototype.updateScrollBarPosition = function (containerWidth, containerHeight, viewerWidth, viewerHeight, width, height) {\n    this.owner.viewer.containerTop = this.documentHelper.viewerContainer.scrollTop;\n    this.owner.viewer.containerWidth = containerWidth;\n    this.documentHelper.containerCanvas.style.position = 'absolute';\n    this.documentHelper.containerCanvas.style.top = this.owner.viewer.containerTop.toString() + 'px';\n    this.documentHelper.selectionCanvas.style.position = 'absolute';\n    this.documentHelper.selectionCanvas.style.top = this.owner.viewer.containerTop.toString() + 'px';\n    this.owner.viewer.containerLeft = this.documentHelper.viewerContainer.scrollLeft;\n    this.documentHelper.containerCanvas.style.left = this.owner.viewer.containerLeft + 'px';\n    this.documentHelper.selectionCanvas.style.left = this.owner.viewer.containerLeft + 'px';\n  };\n  LayoutViewer.prototype.destroy = function () {\n    this.clientArea = undefined;\n    this.clientActiveArea = undefined;\n  };\n  /**\n   * Disposes the internal objects which are maintained.\n   * @private\n   */\n  LayoutViewer.prototype.componentDestroy = function () {\n    this.clientArea = undefined;\n    this.clientActiveArea = undefined;\n    this.owner = undefined;\n  };\n  return LayoutViewer;\n}();\nexport { LayoutViewer };\n/**\n * @private\n */\nvar PageLayoutViewer = /** @class */function (_super) {\n  __extends(PageLayoutViewer, _super);\n  /**\n   * Initialize the constructor of PageLayoutViewer\n   */\n  function PageLayoutViewer(owner) {\n    var _this = _super.call(this, owner) || this;\n    _this.pageLeft = 30;\n    // if (isNullOrUndefined(owner) || isNullOrUndefined(owner.element)) {\n    //     return;\n    // }\n    _this.owner = owner;\n    return _this;\n  }\n  Object.defineProperty(PageLayoutViewer.prototype, \"pageGap\", {\n    /**\n     * @private\n     */\n    get: function () {\n      return this.owner.pageGap;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(PageLayoutViewer.prototype, \"documentHelper\", {\n    get: function () {\n      return this.owner.documentHelper;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  PageLayoutViewer.prototype.createNewPage = function (section, index) {\n    var viewer = this;\n    var yPos = this.pageGap;\n    if (this.documentHelper.pages.length > 0) {\n      yPos = this.documentHelper.pages[this.documentHelper.pages.length - 1].boundingRectangle.bottom + this.pageGap;\n    }\n    var page = new Page(this.documentHelper);\n    this.updatePageBoundingRectangle(section, page, yPos);\n    if (isNullOrUndefined(index)) {\n      this.documentHelper.pages.push(page);\n    } else {\n      this.documentHelper.pages.splice(index, 0, page);\n    }\n    page.bodyWidgets.push(section);\n    page.bodyWidgets[page.bodyWidgets.length - 1].page = page;\n    this.updateClientArea(section, page);\n    this.documentHelper.layout.layoutHeaderFooter(section, viewer, page);\n    this.updateClientArea(section, page);\n    this.documentHelper.layout.footnoteHeight = 0;\n    return page;\n  };\n  PageLayoutViewer.prototype.updatePageBoundingRectangle = function (section, page, yPosition) {\n    //page.viewer = this;\n    var pageWidth = !isNullOrUndefined(section.sectionFormat) ? HelperMethods.convertPointToPixel(section.sectionFormat.pageWidth) : 816;\n    var pageHeight = !isNullOrUndefined(section.sectionFormat) ? HelperMethods.convertPointToPixel(section.sectionFormat.pageHeight) : 1056;\n    var xPos = (this.documentHelper.visibleBounds.width - pageWidth * this.documentHelper.zoomFactor) / 2;\n    if (xPos < this.pageLeft) {\n      xPos = this.pageLeft;\n    }\n    page.boundingRectangle = new Rect(xPos, yPosition, pageWidth, pageHeight);\n  };\n  PageLayoutViewer.prototype.onPageFitTypeChanged = function (pageFitType) {\n    var width = this.documentHelper.visibleBounds.width;\n    var height = this.documentHelper.visibleBounds.height;\n    var section = this.visiblePages[0].bodyWidgets[0];\n    var pageWidth = HelperMethods.convertPointToPixel(section.sectionFormat.pageWidth);\n    var pageHeight = HelperMethods.convertPointToPixel(section.sectionFormat.pageHeight);\n    switch (pageFitType) {\n      case 'FitOnePage':\n        if (height > 0 && pageHeight > 0) {\n          var zoomFactor = (this.documentHelper.visibleBounds.height - 2 * this.pageGap - (this.pageGap - 2)) / pageHeight;\n          if (zoomFactor === this.documentHelper.zoomFactor) {\n            if (!isNullOrUndefined(this.owner.selectionModule) && !isNullOrUndefined(this.owner.selectionModule.start) && !isNullOrUndefined(this.owner.selectionModule.end)) {\n              this.documentHelper.scrollToPosition(this.owner.selectionModule.start, this.owner.selectionModule.end);\n            }\n          } else {\n            this.documentHelper.zoomFactor = zoomFactor;\n          }\n        }\n        break;\n      case 'FitPageWidth':\n        if (width > 0 && pageWidth > 0) {\n          this.documentHelper.zoomFactor = (this.documentHelper.visibleBounds.width - 80) / pageWidth;\n        }\n        break;\n      default:\n        this.documentHelper.zoomFactor = 100 / 100;\n        break;\n    }\n  };\n  PageLayoutViewer.prototype.getCurrentPageHeaderFooter = function (section, isHeader) {\n    return this.getCurrentHeaderFooter(this.getHeaderFooterType(section, isHeader), section.index);\n  };\n  PageLayoutViewer.prototype.getHeaderFooterType = function (section, isHeader) {\n    var type;\n    type = isHeader ? 'OddHeader' : 'OddFooter';\n    var page = section.page;\n    if (section.sectionFormat.differentFirstPage && (isNullOrUndefined(page.previousPage) || !isNullOrUndefined(page.previousPage) && page.sectionIndex !== page.previousPage.sectionIndex && page.previousPage.bodyWidgets[page.previousPage.bodyWidgets.length - 1].sectionIndex !== page.bodyWidgets[0].sectionIndex)) {\n      type = isHeader ? 'FirstPageHeader' : 'FirstPageFooter';\n    } else if (section.sectionFormat.differentOddAndEvenPages && (page.index + 1) % 2 === 0) {\n      type = isHeader ? 'EvenHeader' : 'EvenFooter';\n    }\n    return type;\n  };\n  PageLayoutViewer.prototype.getCurrentHeaderFooter = function (type, sectionIndex) {\n    if (this.documentHelper.headersFooters[sectionIndex]) {\n      var index = this.getHeaderFooter(type);\n      var headerFooter = this.documentHelper.headersFooters[sectionIndex][index];\n      if (!headerFooter) {\n        var currentSecIndex = sectionIndex > 0 ? sectionIndex - 1 : sectionIndex;\n        while (!headerFooter && currentSecIndex !== -1) {\n          headerFooter = this.documentHelper.headersFooters[currentSecIndex][index];\n          currentSecIndex--;\n        }\n        if (!headerFooter) {\n          headerFooter = this.createHeaderFooterWidget(type);\n          headerFooter.isEmpty = true;\n        }\n        if (sectionIndex == 0) {\n          this.documentHelper.headersFooters[sectionIndex][index] = headerFooter;\n        }\n      }\n      return headerFooter;\n    } else if (sectionIndex > 0) {\n      return this.getCurrentHeaderFooter(type, sectionIndex - 1);\n    }\n    return undefined;\n  };\n  PageLayoutViewer.prototype.createHeaderFooterWidget = function (type) {\n    var headerFooter = new HeaderFooterWidget(type);\n    var paragraph = new ParagraphWidget();\n    paragraph.childWidgets.push(new LineWidget(paragraph));\n    var style;\n    if (type.indexOf('Header') !== -1) {\n      style = this.documentHelper.styles.findByName('Header');\n    } else {\n      style = this.documentHelper.styles.findByName('Footer');\n    }\n    paragraph.paragraphFormat.baseStyle = style;\n    paragraph.paragraphFormat.listFormat.baseStyle = style;\n    headerFooter.childWidgets.push(paragraph);\n    paragraph.containerWidget = headerFooter;\n    return headerFooter;\n  };\n  PageLayoutViewer.prototype.getHeaderFooter = function (type) {\n    switch (type) {\n      case 'OddHeader':\n        return 0;\n      case 'OddFooter':\n        return 1;\n      case 'EvenHeader':\n        return 2;\n      case 'EvenFooter':\n        return 3;\n      case 'FirstPageHeader':\n        return 4;\n      case 'FirstPageFooter':\n        return 5;\n    }\n  };\n  PageLayoutViewer.prototype.updateHFClientArea = function (sectionFormat, isHeader) {\n    var width = HelperMethods.convertPointToPixel(sectionFormat.pageWidth - sectionFormat.leftMargin - sectionFormat.rightMargin);\n    if (width < 0) {\n      width = 0;\n    }\n    if (isHeader) {\n      this.clientArea = new Rect(HelperMethods.convertPointToPixel(sectionFormat.leftMargin), HelperMethods.convertPointToPixel(sectionFormat.headerDistance), width, Number.POSITIVE_INFINITY);\n    } else {\n      this.clientArea = new Rect(HelperMethods.convertPointToPixel(sectionFormat.leftMargin), HelperMethods.convertPointToPixel(sectionFormat.pageHeight - sectionFormat.footerDistance), width, Number.POSITIVE_INFINITY);\n    }\n    this.clientActiveArea = new Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n  };\n  PageLayoutViewer.prototype.updateHeaderFooterClientAreaWithTop = function (sectionFormat, isHeader, page) {\n    this.updateHFClientArea(sectionFormat, isHeader);\n    if (!isHeader) {\n      if (page.footerWidget.y < this.clientActiveArea.y) {\n        this.clientActiveArea.y = page.footerWidget.y;\n        this.clientActiveArea.height = Number.POSITIVE_INFINITY;\n      }\n    }\n  };\n  PageLayoutViewer.prototype.updateFootnoteClientArea = function (sectionFormat, footnote, footNoteType, para) {\n    var width = HelperMethods.convertPointToPixel(sectionFormat.pageWidth - sectionFormat.leftMargin - sectionFormat.rightMargin);\n    var left = HelperMethods.convertPointToPixel(sectionFormat.leftMargin);\n    var bottomMargin = HelperMethods.convertPointToPixel(sectionFormat.bottomMargin);\n    var footerDistance = HelperMethods.convertPointToPixel(sectionFormat.footerDistance);\n    var top = HelperMethods.convertPointToPixel(sectionFormat.pageHeight) - Math.max(footerDistance + footnote.page.footerWidget.height, bottomMargin);\n    this.clientArea = new Rect(left, top, width, Number.POSITIVE_INFINITY);\n    this.clientActiveArea = new Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, Number.POSITIVE_INFINITY);\n  };\n  PageLayoutViewer.prototype.scrollToPage = function (pageIndex) {\n    var top = 0;\n    for (var i = 0; i < this.documentHelper.pages.length; i++) {\n      top = this.documentHelper.pages[i].boundingRectangle.y - this.pageGap / 2;\n      if (i === pageIndex) {\n        break;\n      }\n    }\n    this.documentHelper.viewerContainer.scrollTop = top;\n    this.updateScrollBars();\n  };\n  PageLayoutViewer.prototype.updateScrollBars = function () {\n    var updatePositionObj;\n    updatePositionObj = this.getPageHeightAndWidth(0, 0, 0, 0);\n    var containerWidth = updatePositionObj.width * this.documentHelper.zoomFactor + this.pageLeft * 2;\n    var containerHeight = updatePositionObj.height * this.documentHelper.zoomFactor + (this.documentHelper.pages.length + 1) * this.pageGap;\n    var updateObj;\n    updateObj = this.updateCanvasWidthAndHeight(updatePositionObj.viewerWidth, updatePositionObj.viewerHeight, containerHeight, containerWidth, updatePositionObj.width, updatePositionObj.height);\n    containerHeight = updateObj.containerHeight;\n    containerWidth = updateObj.containerWidth;\n    this.documentHelper.containerContext.globalAlpha = 1;\n    this.documentHelper.selectionContext.globalAlpha = 0.4;\n    for (var i = 0; i < this.documentHelper.pages.length; i++) {\n      var left = (updateObj.width - this.documentHelper.pages[i].boundingRectangle.width * this.documentHelper.zoomFactor) / 2;\n      if (left > this.pageLeft) {\n        this.documentHelper.pages[i].boundingRectangle = new Rect(left, this.documentHelper.pages[i].boundingRectangle.y, this.documentHelper.pages[i].boundingRectangle.width, this.documentHelper.pages[i].boundingRectangle.height);\n      } else {\n        this.documentHelper.pages[i].boundingRectangle = new Rect(this.pageLeft, this.documentHelper.pages[i].boundingRectangle.y, this.documentHelper.pages[i].boundingRectangle.width, this.documentHelper.pages[i].boundingRectangle.height);\n      }\n    }\n    this.updateScrollBarPosition(containerWidth, containerHeight, updateObj.viewerWidth, updateObj.viewerHeight, updateObj.width, updateObj.height);\n    this.updateVisiblePages();\n    this.documentHelper.isScrollToSpellCheck = false;\n  };\n  PageLayoutViewer.prototype.updateVisiblePages = function () {\n    // Clears the container first.\n    this.visiblePages = [];\n    for (var i = 0; i < this.documentHelper.pages.length; i++) {\n      var page = this.documentHelper.pages[i];\n      var y = (page.boundingRectangle.y - this.pageGap * (i + 1)) * this.documentHelper.zoomFactor + this.pageGap * (i + 1);\n      var left = page.boundingRectangle.x;\n      //UI Virtualization\n      if (this.documentHelper.isPageInVisibleBound(page, y)) {\n        this.addVisiblePage(page, left, y);\n      }\n    }\n  };\n  PageLayoutViewer.prototype.addVisiblePage = function (page, x, y) {\n    var _this = this;\n    var width = page.boundingRectangle.width * this.documentHelper.zoomFactor;\n    var height = page.boundingRectangle.height * this.documentHelper.zoomFactor;\n    if (this.owner.enableImageResizerMode && this.owner.imageResizerModule.currentPage !== undefined && this.owner.imageResizerModule.currentPage === page && this.owner.imageResizerModule.isImageResizerVisible) {\n      this.owner.imageResizerModule.setImageResizerPositions(x, y, width, height);\n    }\n    this.visiblePages.push(page);\n    if (this.documentHelper.owner.isSpellCheck && this.documentHelper.owner.spellCheckerModule.enableOptimizedSpellCheck && (this.owner.documentHelper.triggerElementsOnLoading || this.owner.documentHelper.isScrollHandler) && (this.documentHelper.cachedPages.indexOf(page.index) < 0 || this.owner.editorModule.isPasteContentCheck)) {\n      this.owner.documentHelper.cachedPages.push(page.index);\n      var content = void 0;\n      if (this.owner.editorModule.isPasteContentCheck) {\n        content = !isNullOrUndefined(this.owner.editorModule.copiedTextContent) ? this.owner.editorModule.copiedTextContent : '';\n      } else {\n        content = this.documentHelper.owner.spellCheckerModule.getPageContent(page);\n      }\n      if (content.trim().length > 0) {\n        page.allowNextPageRendering = false;\n        if (!isNullOrUndefined(this.owner) && !isNullOrUndefined(this.owner.spellCheckerModule)) {\n          this.owner.spellCheckerModule.updateUniqueWords(HelperMethods.getSpellCheckData(content));\n        }\n        /* eslint-disable @typescript-eslint/no-explicit-any */\n        this.owner.spellCheckerModule.callSpellChecker(this.owner.spellCheckerModule.languageID, content, true, false, false, true).then(function (data) {\n          /* eslint-disable @typescript-eslint/no-explicit-any */\n          var jsonObject = JSON.parse(data);\n          if (!isNullOrUndefined(_this.owner) && !isNullOrUndefined(_this.owner.spellCheckerModule)) {\n            _this.owner.spellCheckerModule.updateUniqueWords(jsonObject.SpellCollection);\n          }\n          page.allowNextPageRendering = true;\n          _this.documentHelper.triggerElementsOnLoading = true;\n          _this.documentHelper.triggerSpellCheck = true;\n          _this.documentHelper.triggerElementsOnLoading = true;\n          _this.renderPage(page, x, y, width, height);\n          _this.documentHelper.triggerSpellCheck = false;\n          _this.documentHelper.triggerElementsOnLoading = false;\n        });\n      } else {\n        this.renderPage(page, x, y, width, height);\n      }\n    } else {\n      this.renderPage(page, x, y, width, height);\n    }\n  };\n  PageLayoutViewer.prototype.renderPage = function (page, x, y, width, height) {\n    this.documentHelper.render.renderWidgets(page, x - this.owner.viewer.containerLeft, y - this.owner.viewer.containerTop, width, height);\n  };\n  return PageLayoutViewer;\n}(LayoutViewer);\nexport { PageLayoutViewer };\nvar WebLayoutViewer = /** @class */function (_super) {\n  __extends(WebLayoutViewer, _super);\n  function WebLayoutViewer(owner) {\n    var _this = _super.call(this, owner) || this;\n    /**\n     * @private\n     */\n    _this.visiblePages = [];\n    /* if (isNullOrUndefined(owner) || isNullOrUndefined(owner.element)) {\n         return;\n     }*/\n    _this.owner = owner;\n    return _this;\n  }\n  Object.defineProperty(WebLayoutViewer.prototype, \"documentHelper\", {\n    get: function () {\n      return this.owner.documentHelper;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(WebLayoutViewer.prototype, \"pageGap\", {\n    /**\n     * @private\n     */\n    get: function () {\n      return 0;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  /**\n   * Creates new page.\n   * @private\n   */\n  WebLayoutViewer.prototype.createNewPage = function (section, index) {\n    var page;\n    var yPos = 0;\n    var x = 10;\n    if (this.documentHelper.pages.length > 0) {\n      yPos = this.documentHelper.pages[this.documentHelper.pages.length - 1].boundingRectangle.bottom;\n    }\n    page = new Page(this.documentHelper);\n    if (this.documentHelper.pages.length === 0) {\n      page.boundingRectangle = new Rect(x, yPos, this.documentHelper.visibleBounds.width, this.documentHelper.visibleBounds.height);\n    } else {\n      page.boundingRectangle = new Rect(x, yPos - 20, this.documentHelper.visibleBounds.width, this.documentHelper.visibleBounds.height);\n    }\n    this.documentHelper.pages.push(page);\n    this.updateClientArea(undefined, page);\n    page.bodyWidgets.push(section);\n    page.bodyWidgets[page.bodyWidgets.length - 1].page = page;\n    return page;\n  };\n  WebLayoutViewer.prototype.onPageFitTypeChanged = function (pageFitType) {\n    this.documentHelper.zoomFactor = 1;\n  };\n  WebLayoutViewer.prototype.scrollToPage = function (pageIndex) {\n    this.updateScrollBars();\n  };\n  WebLayoutViewer.prototype.getContentHeight = function () {\n    var height = 0;\n    for (var i = 0; i < this.documentHelper.pages.length; i++) {\n      var page = this.documentHelper.pages[i];\n      if (i === 0) {\n        height += this.padding.top;\n        page.boundingRectangle.y = this.padding.top;\n      } else {\n        page.boundingRectangle.y = this.documentHelper.pages[i - 1].boundingRectangle.bottom;\n      }\n      page.boundingRectangle.height = page.bodyWidgets[0].height;\n      height += page.bodyWidgets[0].height;\n      if (i === this.documentHelper.pages.length - 1) {\n        height += this.padding.bottom;\n      }\n    }\n    return height;\n  };\n  /**\n   * @private\n   */\n  WebLayoutViewer.prototype.getContentWidth = function () {\n    var width = this.documentHelper.visibleBounds.width;\n    var currentWidth = width;\n    for (var i = 0; i < this.documentHelper.pages.length; i++) {\n      var page = this.documentHelper.pages[i];\n      for (var j = 0; j < page.bodyWidgets[0].childWidgets.length; j++) {\n        if (page.bodyWidgets[0].childWidgets[j] instanceof TableWidget) {\n          var tableWidget = page.bodyWidgets[0].childWidgets[j];\n          var tableWidth = HelperMethods.convertPointToPixel(tableWidget.getTableWidth()) * this.documentHelper.zoomFactor + this.padding.left * 4 + this.padding.right * 4 + page.boundingRectangle.x;\n          if (currentWidth < tableWidth) {\n            width = tableWidth;\n            currentWidth = tableWidth;\n          }\n        }\n      }\n      page.boundingRectangle.width = width;\n    }\n    return width;\n  };\n  WebLayoutViewer.prototype.updateScrollBars = function () {\n    var updatePositionObj;\n    updatePositionObj = this.getPageHeightAndWidth(0, 0, 0, 0);\n    var containerWidth = this.getContentWidth() * this.documentHelper.zoomFactor + this.padding.left + this.padding.right;\n    var containerHeight = this.getContentHeight() * this.documentHelper.zoomFactor + this.padding.top + this.padding.bottom;\n    var updateObj;\n    updateObj = this.updateCanvasWidthAndHeight(updatePositionObj.viewerWidth, updatePositionObj.viewerHeight, containerHeight, containerWidth, updatePositionObj.width, updatePositionObj.height);\n    this.documentHelper.containerContext.globalAlpha = 1;\n    this.documentHelper.selectionContext.globalAlpha = 0.4;\n    this.updateScrollBarPosition(containerWidth, containerHeight, updateObj.viewerWidth, updateObj.viewerHeight, updateObj.width, updateObj.height);\n    this.updateVisiblePages();\n    this.documentHelper.isScrollToSpellCheck = false;\n  };\n  WebLayoutViewer.prototype.updateVisiblePages = function () {\n    this.visiblePages = [];\n    var page;\n    var y;\n    var height = this.documentHelper.visibleBounds.height;\n    var vertical = this.documentHelper.viewerContainer.scrollTop;\n    for (var i = 0; i < this.documentHelper.pages.length; i++) {\n      page = this.documentHelper.pages[i];\n      y = page.boundingRectangle.y * this.documentHelper.zoomFactor;\n      var pageH = page.boundingRectangle.height * this.documentHelper.zoomFactor;\n      var isTopFit = y >= vertical && y <= vertical + height;\n      var isBottomFit = y + pageH >= vertical && y + pageH <= vertical + height;\n      var isMiddleFit = y <= vertical && y + pageH >= vertical + height;\n      //UI Virtualization\n      if (isTopFit || isBottomFit || isMiddleFit) {\n        this.addVisiblePage(page, this.padding.left, y);\n      }\n    }\n  };\n  WebLayoutViewer.prototype.addVisiblePage = function (page, x, y) {\n    var _this = this;\n    var width = this.getContentWidth();\n    var height = this.getContentHeight() * this.documentHelper.zoomFactor + this.padding.top + this.padding.bottom;\n    if (this.owner.enableImageResizerMode && this.owner.imageResizerModule.currentPage !== undefined && this.owner.imageResizerModule.currentPage === page && this.owner.imageResizerModule.isImageResizerVisible) {\n      this.owner.imageResizerModule.setImageResizerPositions(x, y, width, height);\n    }\n    this.visiblePages.push(page);\n    if (this.documentHelper.owner.isSpellCheck && this.documentHelper.owner.spellCheckerModule.enableOptimizedSpellCheck && (this.owner.documentHelper.triggerElementsOnLoading || this.owner.documentHelper.isScrollHandler) && (this.documentHelper.cachedPages.indexOf(page.index) < 0 || this.owner.editorModule.isPasteContentCheck)) {\n      this.owner.documentHelper.cachedPages.push(page.index);\n      var contentlen = void 0;\n      if (this.owner.editorModule.isPasteContentCheck) {\n        contentlen = !isNullOrUndefined(this.owner.editorModule.copiedTextContent) ? this.owner.editorModule.copiedTextContent : '';\n      } else {\n        contentlen = this.documentHelper.owner.spellCheckerModule.getPageContent(page);\n      }\n      if (contentlen.trim().length > 0) {\n        page.allowNextPageRendering = false;\n        if (!isNullOrUndefined(this.owner) && !isNullOrUndefined(this.owner.spellCheckerModule)) {\n          this.owner.spellCheckerModule.updateUniqueWords(HelperMethods.getSpellCheckData(contentlen));\n        }\n        /* eslint-disable @typescript-eslint/no-explicit-any */\n        this.owner.spellCheckerModule.callSpellChecker(this.owner.spellCheckerModule.languageID, contentlen, true, false, false, true).then(function (data) {\n          /* eslint-disable @typescript-eslint/no-explicit-any */\n          var jsonObj = JSON.parse(data);\n          if (!isNullOrUndefined(_this.owner) && !isNullOrUndefined(_this.owner.spellCheckerModule)) {\n            _this.owner.spellCheckerModule.updateUniqueWords(jsonObj.SpellCollection);\n          }\n          page.allowNextPageRendering = true;\n          _this.owner.documentHelper.triggerSpellCheck = true;\n          _this.owner.documentHelper.triggerElementsOnLoading = true;\n          _this.renderPage(page, x, y, width, height);\n          _this.owner.documentHelper.triggerSpellCheck = false;\n          _this.owner.documentHelper.triggerElementsOnLoading = false;\n        });\n      } else {\n        this.renderPage(page, x, y, width, height);\n      }\n    } else {\n      this.renderPage(page, x, y, width, height);\n    }\n  };\n  /**\n   * @private\n   */\n  WebLayoutViewer.prototype.renderPage = function (page, x, y, width, height) {\n    this.documentHelper.render.renderWidgets(page, x - this.owner.viewer.containerLeft, y - this.owner.viewer.containerTop, width, height);\n  };\n  return WebLayoutViewer;\n}(LayoutViewer);\nexport { WebLayoutViewer };\n/**\n * @private\n */\nvar ColumnLayout = /** @class */function () {\n  /**\n   * Initialize the constructor of Column Layout Settings\n   */\n  function ColumnLayout(viewer) {\n    this.viewerIn = viewer;\n    this.clear();\n  }\n  Object.defineProperty(ColumnLayout.prototype, \"currentIndex\", {\n    get: function () {\n      return this.currentIndexIn;\n    },\n    set: function (value) {\n      if (value >= 0) {\n        this.currentIndexIn = value;\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(ColumnLayout.prototype, \"columnCount\", {\n    get: function () {\n      var colCount;\n      if (!isNullOrUndefined(this.columnIn)) {\n        colCount = this.numberOfColumnsIn;\n      }\n      colCount = colCount > 0 ? colCount : 1;\n      return colCount;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  /**\n   * @private\n   * @param sectionFormat\n   */\n  ColumnLayout.prototype.setColumns = function (sectionFormat) {\n    this.pageWidth = HelperMethods.convertPointToPixel(sectionFormat.pageWidth - sectionFormat.leftMargin - sectionFormat.rightMargin);\n    this.numberOfColumnsIn = sectionFormat.numberOfColumns;\n    if (!isNullOrUndefined(sectionFormat.columns)) {\n      var columns = sectionFormat.columns;\n      var columnList = [];\n      for (var i = 0; i < sectionFormat.numberOfColumns; i++) {\n        var space = this.defaultSpaceIn;\n        var width = 0;\n        if (!isNullOrUndefined(columns) && columns.length > 0) {\n          space = columns[i].space;\n          width = columns[i].width;\n        }\n        var col = this.getColumnObj(width, space, sectionFormat.numberOfColumns, sectionFormat.equalWidth);\n        col.index = i;\n        columnList.push(col);\n      }\n      this.columnIn = columnList;\n    }\n  };\n  /**\n   * @private\n   */\n  ColumnLayout.prototype.clear = function () {\n    this.currentIndexIn = 0;\n    this.defaultSpaceIn = 36;\n    this.columnIn = null;\n    this.pageWidth = 0;\n  };\n  ColumnLayout.prototype.reset = function () {\n    this.currentIndex = 0;\n  };\n  /**\n   * @private\n   * @param bodyWidget\n   * @param clientArea\n   * @returns\n   */\n  ColumnLayout.prototype.getColumnBounds = function (bodyWidget, clientArea) {\n    var colIndex = this.currentIndexIn;\n    return this.getColumnBoundsByIndex(colIndex, clientArea);\n  };\n  /**\n   * @private\n   * @param bodyWidget\n   * @param clientArea\n   * @returns\n   */\n  ColumnLayout.prototype.getColumnBoundsByBodyWidget = function (bodyWidget, clientArea) {\n    var colIndex = bodyWidget.columnIndex;\n    return this.getColumnBoundsByIndex(colIndex, clientArea);\n  };\n  /**\n   * @private\n   * @param bodyWidget\n   * @param clientArea\n   * @returns\n   */\n  ColumnLayout.prototype.getNextColumnByBodyWidget = function (bodyWidget) {\n    var colIndex = bodyWidget.columnIndex;\n    var nextColumn = this.getColumnByIndex(colIndex + 1);\n    return nextColumn;\n  };\n  ColumnLayout.prototype.getColumnByIndex = function (index) {\n    if (index >= 0 && index < this.columnCount && !isNullOrUndefined(this.columnIn) && this.columnIn.length > 0) {\n      return this.columnIn[index];\n    }\n    return undefined;\n  };\n  ColumnLayout.prototype.getColumnObj = function (colWidth, colSpace, noOfCols, isEqualWidth) {\n    var totalSpace = (noOfCols - 1) * colSpace;\n    var colObj = new WColumnFormat();\n    if ((isEqualWidth || colWidth === 0) && !isNullOrUndefined(this.pageWidth)) {\n      colWidth = (this.pageWidth - totalSpace) / noOfCols;\n    }\n    colObj.width = colWidth;\n    colObj.space = colSpace;\n    return colObj;\n  };\n  ColumnLayout.prototype.getColumnBoundsByIndex = function (colIndex, clientArea) {\n    var colRect = new Rect(clientArea.x, clientArea.y, clientArea.width, clientArea.height);\n    if (colIndex >= 0 && this.columnIn.length > 0) {\n      var curColumn = void 0;\n      var prevColumn = void 0;\n      if (!isNullOrUndefined(this.columnIn[colIndex])) {\n        curColumn = this.getColumnByIndex(colIndex);\n        colRect.width = curColumn.width;\n        for (var i = 0; i < colIndex; i++) {\n          prevColumn = this.columnIn[i];\n          colRect.x += prevColumn.width;\n          colRect.x += prevColumn.space;\n        }\n      }\n    }\n    return colRect;\n  };\n  return ColumnLayout;\n}();\nexport { ColumnLayout };","map":{"version":3,"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","apply","__generator","body","_","label","sent","t","trys","ops","f","y","g","verb","Symbol","iterator","n","v","op","TypeError","call","pop","length","push","Dictionary","WAbstractList","WLevelOverride","WSectionFormat","WCharacterFormat","WParagraphFormat","WStyles","WColumnFormat","Layout","Renderer","createElement","Browser","L10n","Page","Rect","Widget","ListTextElementBox","ParagraphWidget","HeaderFooterWidget","Padding","DropDownFormField","TextFormField","CheckBoxFormField","ShapeElementBox","TextFrame","Footnote","FootnoteElementBox","FootNoteWidget","TextElementBox","ShapeBase","ImageElementBox","BodyWidget","LineWidget","TableWidget","TableRowWidget","HelperMethods","Point","TextHelper","isNullOrUndefined","CommentReviewPane","Zoom","Dialog","createSpinner","showSpinner","hideSpinner","beforePaneSwitchEvent","keyDownEvent","beforeFormFieldFillEvent","afterFormFieldFillEvent","RestrictEditing","FormFieldPopUp","TrackChangesPane","Themes","beforeAutoResize","internalAutoResize","incrementalOps","DocumentHelper","owner","_this","isCompleted","isSelectionCompleted","scrollbarWidth","isWebPrinting","isHeaderFooter","currentPage","undefined","selectionStartPageIn","selectionEndPageIn","fieldStacks","showRevision","splittedCellWidgets","tableLefts","tapCount","timer","isTimerStarted","isFirstLineFitInShiftWidgets","preZoomFactor","preDifference","isDragging","fieldEndParagraph","fieldToLayout","backgroundColor","isMouseDown","isMouseEntered","scrollMoveTimer","isSelectionChangedOnMouseMoved","isControlPressed","isTouchInput","isTouchMoved","useTouchSelectionMark","touchDownOnSelectionMark","isComposingIME","lastComposedText","isCompositionStart","isCompositionUpdated","isCompositionCanceled","isCompositionEnd","prefix","suffix","fields","heightInfoCollection","defaultTabWidth","dontUseHtmlParagraphAutoSpacing","allowSpaceOfSameStyleInTable","alignTablesRowByRow","compatibilityMode","lists","comments","authors","revisionsInternal","commentUserOptionId","abstractLists","styles","stylesMap","preDefinedStyles","isRowOrCellResizing","endBookmarksUpdated","formFields","isMouseDownInFooterRegion","pageFitTypeIn","fieldCollection","isPageField","mouseDownOffset","zoomFactorInternal","moveCaretPosition","isTextInput","isScrollHandler","triggerElementsOnLoading","triggerSpellCheck","restrictFormatting","protectionType","isDocumentProtected","hashValue","saltValue","userCollection","cachedPages","skipScrollToPosition","isIosDevice","isMobileDevice","isFormFilling","fontSubstitutionTable","themes","hasThemes","footnotes","endnotes","isFootnoteWidget","isDragStarted","isMouseDownInSelection","isBookmarkInserted","isAutoResizeCanStart","isRestartNumbering","onTextInput","event","preventDefault","text","data","editorModule","handleTextInput","compositionStart","isDevice","isReadOnlyMode","positionEditableTarget","editorHistoryModule","initComplexHistory","compositionUpdated","setTimeout","insertIMEText","getEditableDivTextContent","compositionEnd","iframe","setAttribute","viewer","containerLeft","containerTop","editableDiv","innerHTML","isSkipOperationsBuild","enableCollaborativeEditing","updateComplexHistory","undo","redoStack","onImageResizer","args","imageResizerModule","isImageResizerVisible","isImageResizing","MouseEvent","onMouseUpInternal","TouchEvent","onTouchUpInternal","clearInterval","onKeyPressInternal","key","which","keyCode","ctrl","ctrlKey","metaKey","alt","altKey","isIE","selection","isInlineFormFillMode","key_1","charCode","char","String","fromCharCode","focusIn","onTextInputInternal","innerText","onPaste","canEditContentControl","pasteInternal","onFocusOut","contextMenuModule","contextMenuInstance","element","style","display","hideCaret","updateFocus","isRemoteAction","currentSelectedComment","commentReviewPane","commentPane","isEditMode","selectComment","isReadOnly","navigator","userAgent","match","focus","showCaret","scrollHandler","scrollTimer","clearTimeout","clearContent","top","left","hRuler","document","getElementById","id","viewerContainer","scrollTop","markIndicator","vRuler","scrollLeft","rulerHelper","vRulerBottom","height","pageContainer","offsetHeight","updateScrollBars","vtHeight","visibleBounds","padding","bottom","PageLayoutViewer","fireViewChange","isSpellCheck","isScrollToSpellCheck","onWindowResize","resizeTimer","updateViewerSize","documentEditorSettings","showRuler","updateRuler","collaborativeEditingHandlerModule","updateCaretPosition","updateTouchMarkPosition","close","onContextMenu","onContextMenuInternal","onMouseDownInternal","target","isTableMarkerDragging","offsetX","width","clientWidth","offsetY","clientHeight","updateCursor","formFillPopup","hidePopup","isLeftButtonPressed","enableImageResizerMode","selectedResizeElement","isInShape","textFram","selectionModule","getCurrentTextFrame","shape","containerShape","selectShape","cursorPoint","touchPoint","findFocusedPage","x","isCursorInsidePageRect","isCursorInFooterRegion","tableResize","isInCellResizerArea","isInRowResizerArea","startingPoint","handleResize","isEmpty","widget","getLineWidget","checkCursorIsInSelection","allowDragAndDrop","onMouseMoveInternal","isImageMoveToNextPage","handleImageResizingOnMouse","enableHeaderAndFooter","xPosition","yPosition","table","currentResizingTable","startPosition","setPositionForBlock","endPosition","documentHelper","checkSelectionIsAtEditRegion","handleResizing","selectedImageWidget","containsKey","isForward","dragStartParaInfo","getParagraphInfo","start","dragEndParaInfo","end","caret","classList","remove","updateTextPositionForSelection","touchY","textPosition","touchPoint_1","isShapeResize","moveTextPosition","autoScrollOnSelection","updateTextPosition","checkForCursorVisibility","onMouseLeaveInternal","viewerTop","setInterval","scrollForwardOnSelection","scrollBackwardOnSelection","onMouseEnterInternal","contains","add","onDoubleTap","checkAndEnableHeaderFooter","formField","getHyperLinkFieldInCurrentSelection","getCurrentFormField","enableFormField","formatType","getFormFieldType","toString","selectField","textFormFieldDialogModule","show","checkBoxFormFieldDialogModule","dropDownFormFieldDialogModule","formFieldData","type","clone","inlineObj","currentWidget","getInline","offset","inline","layoutType","footnoteType","footnoteWidget","i","bodyWidgets","footnoteText","footNoteReference","setPositionParagraph","childWidgets","selectRange","pages","endnoteWidget","endnoteText","isinEndnote","isinFootnote","footnoteReferenceElement","selectCurrentWord","isListTextSelected","detail","updateResizingHistory","isShiftKeyPressed","shiftKey","isCtrlkeyPressed","isImageSelected","useCtrlClickToFollowHyperlink","navigateHyperLinkOnEvent","enabled","name","resultText","checked","selectedIndex","isCanceled","formFieldSettings","formFillingMode","previousSelectedFormField","trigger","showPopUp","toggleCheckBoxFormField","isFormFillProtectedMode","navigateToNextFormField","line","getOffset","point","getPhysicalPositionInternal","selectInternal","fireSelectionChanged","isSelectionInListText","selectListText","mouseUpInternal","scrollToPosition","moveSelectedContent","imageResizer","leftValue","topValue","isCellPrevSelected","onTouchStartInternal","touches","zoomX","clientX","zoomY","clientY","getTouchOffsetValue","resizeObj","getImagePointOnTouch","selectedElement","contentEditable","location","getCaretBottom","longTouchTimer","onLongTouch","pointRelToPage","selStart","selEnd","updateSel","selStartPt","selEndPt","changedTouches","updateSelectionOnTouch","onTouchMoveInternal","touch","handleImageResizingOnTouch","touchPointer","currentDiff","Math","sqrt","pow","onPinchOutInternal","onPinchInInternal","zoomFactor","isImageField","touchStart","touchEnd","onKeyUpInternal","window","getSelection","anchorOffset","setEditableDivCaretPosition","onKeyDownInternal","isHandled","keyEventArgs","source","shift","print","save","documentName","render","characterFormat","themeFontLanguage","paragraphFormat","renderedLists","renderedLevelOverrides","headersFooters","defaultLocale","setLocale","locale","initalizeStyles","bookmarks","editRanges","test","customXmlData","contentControlCollection","footnoteCollection","endnoteCollection","images","defineProperty","get","visibleBoundsIn","enumerable","configurable","containerCanvasIn","getContext","parentElement","appendChild","openTextFile","layout","isTextFormat","arr","replace","split","bodyWidget","sectionFormat","paragraph1","line1","containerWidget","paragraph","singleLineLength","increment","lineLength","count","substring","textElement","children","onDocumentChanged","selectionCanvasIn","selectionCanvas","containerCanvas","set","zoomModule","setZoomFactor","dialogInternal","initDialog","enableRtl","dialogInternal2","initDialog2","dialogInternal3","initDialog3","currentSelectedCommentInternal","previousSelectedComment","currentSelectedRevisionInternal","clearDocumentItems","clear","searchModule","clearSearchHighlight","currentSelectedRevision","commentStart","destroy","page","componentDestroy","revisions","clearFormat","trackChangesPane","setDefaultCharacterValue","setDefaultParagraphValue","list","setDefaultDocumentFormat","parser","parseCharacterFormat","parseParagraphFormat","bold","italic","fontFamily","fontSize","underline","strikethrough","fontSizeBidi","fontFamilyBidi","baselineAlignment","highlightColor","allCaps","leftIndent","rightIndent","firstLineIndent","textAlignment","beforeSpacing","afterSpacing","lineSpacing","lineSpacingType","bidi","keepWithNext","keepLinesTogether","widowControl","outlineLevel","getAbstractListById","isNsid","abstractList","nsid","abstractListId","getListById","listId","getListLevelNumber","listLevel","ownerBase","levelNumber","levels","indexOf","getImageString","image","base64ImageString","parseInt","imageString","imageStr","isMetaFile","formatClippedString","extension","addBase64StringInCollection","addToCollection","index","imageStringCol","_a","keys","metaFileImageString","getBookmarks","includeHidden","bookmark","comment","showComments","enableComment","eventArgs","reviewTab","hideTab","showHidePane","showRevisions","isCommentTabVisible","enableDisableButton","initializeComponents","optionsPaneContainer","className","isRtl","viewerContainerStyle","containerId","cssText","tabIndex","outline","position","pointerEvents","createEditableDiv","createEditableIFrame","initializeImageResizer","updateViewerSizeInternal","textHelper","initTouchEllipse","wireEvent","restrictEditingPane","cssClass","measureScrollbarWidth","parentDiv","childDiv","getBoundingClientRect","parentNode","removeChild","attrs","initIframeContent","innerHtml","contentDocument","open","write","initCaret","wireInputEvents","addEventListener","onIframeLoad","bind","onMouseWheelInternal","info","textContent","updateAuthorIdentity","changes","getAuthorColor","author","getAvatar","userInfo","userName","revision","userinitial","initial","avatarDiv","avatar","authorName","charAt","toUpperCase","color","generateRandomColor","userColors","getRect","getSelectionPage","boundingRectangle","convertPointToPixel","leftMargin","pageWidth","rightMargin","iframeStyle","dialogTarget1","popupTarget","showCloseIcon","allowDragging","visible","isModal","X","Y","zIndex","animationSettings","effect","isStringTemplate","beforeClose","appendTo","dialogTarget3","hideDialog","dialog","hide","dialogTarget2","getBase64","base64String","drawImage","Image","onload","displayPixelRatio","max","devicePixelRatio","draw","context","scale","toDataURL","startsWith","fetch","response","blob","reader","FileReader","onloadend","onerror","readAsDataURL","dataUrl","src","containerContext","clearRect","selectionContext","commentMarkElement","getElementsByClassName","editRangeStart","sections","iOps","tocStyles","tocBookmarkId","isDocumentLoaded","columnLayoutArea","isDocumentContainsRtl","isMultiColumnDoc","j","isInitialLoad","footHeight","footnoteHeight","layoutItems","highlightFormFields","editRangeCollection","documentStart","showHideRestrictPane","intializeDefaultStyles","enableEditor","isIncrementalSave","k","applyRemoteAction","optionsPaneModule","showHideOptionsPane","restrictPane","isViewPasteOptions","showHidePasteOptions","fireDocumentChange","showHideRulers","ellipse","getPage","pageTop","pageGap","round","editor","getSelectionInfo","updateSelectionInfo","getTextPosBasedOnLogicalIndex","dropSelectionStartParaInfo","dropSelectionEndParaInfo","dropSelectionStartParaIndex","getHierarchicalIndex","dropSelectionEndParaIndex","dropSelectionStartPos","dropSelectionEndPos","dragOnSelectionStartParaIndex","dragOnSelectionEndParaIndex","dragOnSelectionStartPos","dragOnSelectionEndPos","isExistBefore","isExistAfter","isEnableLocalPasteTrue","enableLocalPaste","dropExtraOffset","getLength","hasNewLineChar","equals","cut","enableTrackChanges","copiedTextContent","paste","selectPosition","getLeftValue","isInsideRect","selectionLineWidget","isInShapeBorder","floatElement","margin","lineWidth","lineFormat","weight","textFrame","marginTop","marginBottom","isParagraphFirstLine","button","targetElement","touchOffsetValues","updatedZoomFactor","getPageWidth","removePage","headerWidgetIn","footerWidgetIn","headerWidget","footerWidget","splice","visiblePages","pageIndex","firstChild","header","repeatHeaderRowTableWidget","getDocumentEditorElement","WebLayoutViewer","resizerTimer","currentVisibleWidth","preVisibleWidth","layoutWholeDocument","triggerAutoResizeInterval","cancel","notify","visibility","counter","internal","autoResizeSettings","interval","tempRect","args_1","resize","iterationCount","rect","restrictPaneRect","isShowRestrictPane","optionsRect","isOptionsPaneShow","optionsPane","parentPaneElement","paneWidth","ceil","insertPage","selectParagraph","skipCursorUpdate","isBookmark","lineWidget","getLineWidgetInternal","getTop","prevLineWidget","prevTop","endPage","horizontalWidth","isPageLayout","pageLayout","pageHeight","caretInfo","updateCaretSize","topMargin","caretHeight","updateCaretToPage","scrollBarWidth","offsetWidth","containerWidth","isMouseDragged","pageBottom","headerHeight","footerDistance","footerHeight","isBlockInHeader","shapeElementInfo","checkFloatingItems","isShapeSelected","getLineWidgetBodyWidget","shapeInfo","behindShapeInfo","isEmptyShape","footNoteType","isInFootnoteWidget","i_1","bodyWidget_1","getNextWidgetHeight","nextRenderedWidget","inlineShapeInfo","checkInlineShapeItems","checkPointIsInLine","floatingElement","selectionInShape","isMouseDraggedInShape","textWrappingStyle","top_1","childWidget","blockContainer","isBehind","floatingElements","sort","a","zOrderPosition","block","headerFooterType","clearSelectionHighlight","canClear","clearSelectionHighlightInSelectedWidgets","removeEmptyPages","scrollToLastPage","startPage","startindex","scrollToBottom","containerHeight","getFieldResult","fieldBegin","fieldCode","getFieldCode","fieldCodes","fieldCategory","trim","toLowerCase","fieldPattern","pageNumberStyle","restartPageNumbering","sectionIndex","currentSectionIndex_1","previousPage","currentPageNum","pageStartingNumber","getFieldText","currentSectionIndex","currentPageCount","pattern","getAsLetter","getAsRoman","unWireEvent","blockToShift","listParagraphs","removeEventListener","hyperlinkField","footnoteElement","div","widgetInfo","isRowResize","isCellResize","floatItemInfo","checkAllFloatingElements","resizePosition","getImagePoint","lineLeft","referenceField","isInInline","getLineStartLeft","code","updateTextPositionIn","getLeft","setHyperlinkContentToToolTip","enableLockAndEdit","isLocked","isInsideTable","getParentTable","locked","lockedBy","currentUser","right","setLockInfoTooptip","getFootNoteElementInCurrentSelection","setFootnoteContentToToolTip","cursor","updateDialogTabHeight","dialogElement","contentElement","footer","contentStyle","getComputedStyle","dialogStyle","paddingTop","paddingBottom","paddingVertical","isNaN","borderTop","borderBottom","borderVertical","contentHeight","paddingLeft","paddingRight","paddingHorizontal","borderLeft","borderRight","borderHorizontal","contentWidth","canRenderBorder","skipTopBorder","skipBottomBorder","isSamePreviousBorder","isSameNextBorder","isSameTopBorder","isSameBottomBorder","isSameLeftBorder","isSameRightBorder","previousBlock","previousRenderedWidget","nextBlock","paragraphX","getParagraphLeftPosition","previousBlockX","nextBlockX","checkEqualBorder","borders","horizontal","lineStyle","dest","isEqualFormat","paragraphWidget","hangingIndent","startX","abs","parseFloat","toFixed","nextWidget","currentIndent","previousIndent","isPageInVisibleBound","vertical","pageH","isTopFit","isBottomFit","isMiddleFit","getFirstParagraphInCell","cell","firstBlock","getFirstParagraphInFirstCell","firstRow","getFirstParagraphBlock","getLastParagraphInLastCell","lastrow","lastChild","lastcell","lastBlock","getLastParagraphBlock","getLastParagraphInFirstRow","row","getFirstParagraphInLastRow","lastRow","lastCell","addToStylesMap","returnStyle","returnStyleObject","paraIcon","charIcon","linkedIcon","styleName","getConstant","StyleName","writeParagraphFormat","writeCharacterFormat","Style","parseStyle","JSON","stringify","link","IconClass","domStyle","styleObj","parse","textDecoration","vAlign","LayoutViewer","textWrap","ColumnLayout","onPageFitTypeChanged","updateClientArea","isReLayout","setColumns","top_2","Number","POSITIVE_INFINITY","clientArea","clientActiveArea","top_3","headerDistance","bottomMargin","isEmptyWidget","min","isFootNote","sub","columnIndex","updateColumnIndex","setClientArea","getColumnBoundsByBodyWidget","updateClientAreaTopOrLeft","tableWidget","beforeLayout","topBorderWidth","leftBorderWidth","updateClientAreaForTable","updateClientAreaForRow","ownerTable","updateClientAreaForCell","rowWidget","ownerRow","cellWidget","tableFormat","cellSpacing","wrapTextAround","existFootnoteHeight","updateHeight","updateClientAreaForTextBoxShape","textBox","shiftNextWidget","marginLeft","marginRight","updateClientAreaByWidgetFootNote","updateClientAreaForTextWrap","area","updateBoundsBasedOnTextWrap","diff","updateBoundsBasedOnTextWrapTable","updateClientAreaByWidget","updateClientAreaLocation","updateClientAreaForBlock","tableCollection","updateYPosition","updateXPosition","columns","isGridUpdated","buildTableColumns","tableAlignment","tableAlignmentForBidi","tableWidth","tableHolder","getTotalWidth","getTableClientWidth","getOwnerWidth","resizerPosition","getTableCellWidth","updateParagraphYPositionBasedonTextWrap","updateParagraphXPositionBasedOnTextWrap","updateTableXPositionBasedOnTextWrap","clientLayoutArea","isWord2013","isEmptyPara","paragraphHeight","getParagraphMarkSize","Height","isInHeaderFooter","yposition","isFirstItemBottomPositionUpdated","previousItem","isContainsShapeAlone","floatingItem","isInsideHeaderFooter","textWrappingBounds","getTextWrappingBound","textWrappingType","minimumWidthRequired","paragarphRightIndent","isFirstLine","isPositionsUpdated","tempBounds","getIntersectingItemBounds","yValue","isFirstItem","floatingItems","firstRowWidth","getFirstRowWidth","allowOverlap","positioning","paragarph","rowHeight","getContainerWidth","isFloatingItemIntersect","remainingHeightOfFloatingItem","intersectedfloatingItem","getMinBottomFloatingItem","getIntersectingFloatingItems","floatingItemBound","fItems","minBottomItemIndex","minBottom","MAX_VALUE","skippedCount","item","itemTextWrapBound","intersectItemTextWrapBound","distanceLeft","distanceTop","distanceRight","distanceBottom","cutFromLeft","cutFromTop","updateClientWidth","currentPoint","updateCurrentPage","updateHeaderFooterPage","pageLeft","pageRight","getPageHeightAndWidth","viewerWidth","viewerHeight","renderVisiblePages","renderPage","handleZoom","prevScaleFactor","verticalHeight","horWidth","prevPageTop","prevY","currentY","prevValue","prevX","currentX","updateCanvasWidthAndHeight","floor","updateScrollBarPosition","_super","createNewPage","section","yPos","updatePageBoundingRectangle","layoutHeaderFooter","xPos","pageFitType","getCurrentPageHeaderFooter","isHeader","getCurrentHeaderFooter","getHeaderFooterType","differentFirstPage","differentOddAndEvenPages","getHeaderFooter","headerFooter","currentSecIndex","createHeaderFooterWidget","findByName","baseStyle","listFormat","updateHFClientArea","updateHeaderFooterClientAreaWithTop","updateFootnoteClientArea","footnote","para","scrollToPage","updatePositionObj","updateObj","globalAlpha","updateVisiblePages","addVisiblePage","setImageResizerPositions","spellCheckerModule","enableOptimizedSpellCheck","isPasteContentCheck","content","getPageContent","allowNextPageRendering","updateUniqueWords","getSpellCheckData","callSpellChecker","languageID","jsonObject","SpellCollection","renderWidgets","getContentHeight","getContentWidth","currentWidth","getTableWidth","contentlen","jsonObj","viewerIn","currentIndexIn","colCount","columnIn","numberOfColumnsIn","numberOfColumns","columnList","space","defaultSpaceIn","col","getColumnObj","equalWidth","reset","currentIndex","getColumnBounds","colIndex","getColumnBoundsByIndex","getNextColumnByBodyWidget","nextColumn","getColumnByIndex","columnCount","colWidth","colSpace","noOfCols","isEqualWidth","totalSpace","colObj","colRect","curColumn","prevColumn"],"sources":["/home/taymur/Documents/legal2/DATA/Highlight/newmerged/CASEFRONTt/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/viewer/viewer.js"],"sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\n/* eslint-disable */\nimport { Dictionary } from '../../base/dictionary';\nimport { WAbstractList } from '../list/abstract-list';\nimport { WLevelOverride } from '../list/level-override';\nimport { WSectionFormat, WCharacterFormat, WParagraphFormat, WStyles, WColumnFormat } from '../format/index';\nimport { Layout } from './layout';\nimport { Renderer } from './render';\nimport { createElement, Browser, L10n } from '@syncfusion/ej2-base';\nimport { Page, Rect, Widget, ListTextElementBox, ParagraphWidget, HeaderFooterWidget, Padding, DropDownFormField, TextFormField, CheckBoxFormField, ShapeElementBox, TextFrame, Footnote, FootnoteElementBox, FootNoteWidget, TextElementBox, ShapeBase, ImageElementBox } from './page';\nimport { BodyWidget, LineWidget, TableWidget, TableRowWidget } from './page';\nimport { HelperMethods, Point } from '../editor/editor-helper';\nimport { TextHelper } from './text-helper';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { CommentReviewPane } from '../index';\nimport { Zoom } from './zooming';\nimport { Dialog, createSpinner, showSpinner, hideSpinner } from '@syncfusion/ej2-popups';\nimport { beforePaneSwitchEvent, keyDownEvent, beforeFormFieldFillEvent, afterFormFieldFillEvent } from '../../base/index';\nimport { RestrictEditing } from '../restrict-editing/restrict-editing-pane';\nimport { FormFieldPopUp } from '../dialogs/form-field-popup';\nimport { TrackChangesPane } from '../track-changes/track-changes-pane';\nimport { Themes } from '../themes/themes';\nimport { beforeAutoResize, internalAutoResize } from '../../base/constants';\nimport { incrementalOps } from '../../base/index';\n/**\n * @private\n */\nvar DocumentHelper = /** @class */ (function () {\n    //#endregion\n    function DocumentHelper(owner) {\n        var _this = this;\n        /**\n         * @private\n         */\n        this.isCompleted = true;\n        /**\n         * @private\n         */\n        this.isSelectionCompleted = true;\n        /**\n         * @private\n         */\n        this.scrollbarWidth = 0;\n        /**\n         * @private\n         */\n        this.isWebPrinting = false;\n        /**\n         * @private\n         */\n        this.isHeaderFooter = false;\n        /**\n         * @private\n         */\n        this.currentPage = undefined;\n        this.selectionStartPageIn = undefined;\n        this.selectionEndPageIn = undefined;\n        /**\n         * @private\n         */\n        this.fieldStacks = [];\n        /**\n         * @private\n         */\n        this.showRevision = false;\n        /**\n         * @private\n         */\n        this.splittedCellWidgets = [];\n        /**\n         * @private\n         */\n        this.tableLefts = [];\n        /**\n         * @private\n         */\n        this.tapCount = 0;\n        this.timer = -1;\n        this.isTimerStarted = false;\n        /**\n         * @private\n         */\n        this.isFirstLineFitInShiftWidgets = false;\n        /**\n         * @private\n         */\n        this.preZoomFactor = 0;\n        /**\n         * @private\n         */\n        this.preDifference = -1;\n        /**\n         * @private\n         */\n        this.isDragging = false;\n        /**\n         * @private\n         */\n        this.fieldEndParagraph = undefined;\n        /**\n         * @private\n         */\n        this.fieldToLayout = undefined;\n        /**\n         * @private\n         */\n        this.backgroundColor = '#FFFFFF';\n        // Event\n        /**\n         * @private\n         */\n        this.isMouseDown = false;\n        this.isMouseEntered = false;\n        this.scrollMoveTimer = 0;\n        /**\n         * @private\n         */\n        this.isSelectionChangedOnMouseMoved = false;\n        /**\n         * @private\n         */\n        this.isControlPressed = false;\n        /**\n         * @private\n         */\n        this.isTouchInput = false;\n        /**\n         * @private\n         */\n        this.isTouchMoved = false;\n        /**\n         * @private\n         */\n        this.useTouchSelectionMark = false;\n        /**\n         * @private\n         */\n        this.touchDownOnSelectionMark = 0;\n        /**\n         * @private\n         */\n        this.isComposingIME = false;\n        /**\n         * @private\n         */\n        this.lastComposedText = '';\n        /**\n         * @private\n         */\n        this.isCompositionStart = false;\n        /**\n         * @private\n         */\n        this.isCompositionUpdated = false;\n        /**\n         * @private\n         */\n        this.isCompositionCanceled = false;\n        /**\n         * @private\n         */\n        this.isCompositionEnd = false;\n        /**\n         * @private\n         */\n        this.prefix = '';\n        /**\n         * @private\n         */\n        this.suffix = '';\n        /**\n         * @private\n         */\n        this.fields = [];\n        /**\n         * @private\n         */\n        this.heightInfoCollection = {};\n        /**\n         * @private\n         */\n        this.defaultTabWidth = 36;\n        /**\n         * @private\n         */\n        this.dontUseHtmlParagraphAutoSpacing = false;\n        /**\n         * @private\n         */\n        this.allowSpaceOfSameStyleInTable = false;\n        /**\n         * @private\n         */\n        this.alignTablesRowByRow = false;\n        /**\n         * @private\n         */\n        this.compatibilityMode = 'Word2013';\n        /**\n         * @private\n         */\n        this.lists = [];\n        /**\n         * @private\n         */\n        this.comments = [];\n        /**\n         * @private\n         */\n        this.authors = new Dictionary();\n        /**\n         * @private\n         */\n        this.revisionsInternal = new Dictionary();\n        /**\n         * @private\n         */\n        this.commentUserOptionId = 1;\n        /**\n         * @private\n         */\n        this.abstractLists = [];\n        /**\n         * @private\n         */\n        this.styles = new WStyles();\n        /**\n         * @private\n         */\n        this.stylesMap = new Dictionary();\n        /**\n         * @private\n         */\n        this.preDefinedStyles = undefined;\n        /**\n         * @private\n         */\n        this.isRowOrCellResizing = false;\n        /**\n         * @private\n         */\n        this.endBookmarksUpdated = [];\n        /**\n         * @private\n         */\n        this.formFields = [];\n        this.isMouseDownInFooterRegion = false;\n        this.pageFitTypeIn = 'None';\n        /**\n         * @private\n         */\n        this.fieldCollection = [];\n        /**\n         * @private\n         */\n        this.isPageField = false;\n        /**\n         * @private\n         */\n        this.mouseDownOffset = new Point(0, 0);\n        this.zoomFactorInternal = 1;\n        /**\n         * If movecaretposition is 1, Home key is pressed\n         * If moveCaretPosition is 2, End key is pressed\n         *\n         * @private\n         */\n        this.moveCaretPosition = 0;\n        /**\n         * @private\n         */\n        this.isTextInput = false;\n        /**\n         * @private\n         */\n        this.isScrollHandler = false;\n        /**\n         * @private\n         */\n        this.triggerElementsOnLoading = false;\n        /**\n         * @private\n         */\n        this.triggerSpellCheck = false;\n        //Document Protection Properties Starts\n        /**\n         * preserve the format\n         *\n         * @private\n         */\n        this.restrictFormatting = false;\n        /**\n         * preserve the document protection type either readonly or no protection\n         *\n         * @private\n         */\n        this.protectionType = 'NoProtection';\n        /**\n         * Preserve the password protection is enforced or not\n         *\n         * @private\n         */\n        this.isDocumentProtected = false;\n        /**\n         * preserve the hash value of password\n         *\n         * @private\n         */\n        this.hashValue = '';\n        /**\n         * @private\n         */\n        this.saltValue = '';\n        /**\n         * @private\n         */\n        this.userCollection = [];\n        /**\n         * @private\n         */\n        this.cachedPages = [];\n        /**\n         * @private\n         */\n        this.skipScrollToPosition = false;\n        /**\n         * @private\n         */\n        this.isIosDevice = false;\n        /**\n         * @private\n         */\n        this.isMobileDevice = false;\n        /**\n         * @private\n         */\n        this.isFormFilling = false;\n        /**\n         * @private\n         */\n        this.fontSubstitutionTable = undefined;\n        /**\n         * @private\n         */\n        this.themes = new Themes();\n        /**\n         * @private\n         */\n        this.hasThemes = false;\n        /**\n         * @private\n         */\n        this.footnotes = new Footnote();\n        /**\n         * @private\n         */\n        this.endnotes = new Footnote();\n        /**\n         * @private\n         */\n        this.isFootnoteWidget = false;\n        /**\n         * @private\n         */\n        this.isDragStarted = false;\n        /**\n         * @private\n         */\n        this.isMouseDownInSelection = false;\n        /**\n         * @private\n         */\n        this.isBookmarkInserted = true;\n        this.isAutoResizeCanStart = false;\n        this.isRestartNumbering = false;\n        /**\n         * @private\n         * @param {TextEvent} event - Specifies text event.\n         * @returns {void}\n         */\n        this.onTextInput = function (event) {\n            if (!_this.isComposingIME) {\n                event.preventDefault();\n                var text = event.data;\n                _this.owner.editorModule.handleTextInput(text);\n            }\n        };\n        //#region Composition Event\n        /**\n         * Fires when composition starts.\n         *\n         * @private\n         * @returns {void}\n         */\n        this.compositionStart = function () {\n            if (!Browser.isDevice && !_this.owner.isReadOnlyMode) {\n                _this.isComposingIME = true;\n                _this.positionEditableTarget();\n                if (_this.owner.editorHistoryModule) {\n                    _this.owner.editorModule.initComplexHistory('IMEInput');\n                }\n            }\n            _this.isCompositionStart = true;\n        };\n        /**\n         * Fires on every input during composition.\n         *\n         * @private\n         * @returns {void}\n         */\n        this.compositionUpdated = function () {\n            if (_this.isComposingIME && !_this.owner.isReadOnlyMode) {\n                setTimeout(function () {\n                    _this.owner.editorModule.insertIMEText(_this.getEditableDivTextContent(), true);\n                }, 0);\n            }\n            _this.isCompositionUpdated = true;\n        };\n        /**\n         * Fires when user selects a character/word and finalizes the input.\n         *\n         * @private\n         * @param {CompositionEvent} event - Specifies text compisition event.\n         * @returns {void}\n         */\n        this.compositionEnd = function (event) {\n            if (_this.isComposingIME && !_this.owner.isReadOnlyMode) {\n                var text = _this.getEditableDivTextContent();\n                if (text !== '') {\n                    _this.owner.editorModule.insertIMEText(text, false);\n                }\n                _this.isComposingIME = false;\n                _this.lastComposedText = '';\n                _this.iframe.setAttribute('style', 'pointer-events:none;position:absolute;left:' + _this.owner.viewer.containerLeft + 'px;top:' + _this.owner.viewer.containerTop + 'px;outline:none;background-color:transparent;width:0px;height:0px;overflow:hidden');\n                _this.editableDiv.innerHTML = '';\n                if (_this.owner.editorHistoryModule) {\n                    if (text !== '') {\n                        _this.owner.editorModule.isSkipOperationsBuild = _this.owner.enableCollaborativeEditing;\n                    }\n                    _this.owner.editorHistoryModule.updateComplexHistory();\n                    if (text === '') {\n                        //When the composition in live. The Undo operation will terminate the composition and empty text will be return from text box.\n                        //At that time the the history should be updated. Undo the operation and clear the redo stack. This undo operation will not be saved for redo operation.\n                        _this.owner.editorModule.isSkipOperationsBuild = _this.owner.enableCollaborativeEditing;\n                        _this.owner.editorHistoryModule.undo();\n                        _this.owner.editorHistoryModule.redoStack.pop();\n                    }\n                    _this.owner.editorModule.isSkipOperationsBuild = false;\n                }\n            }\n            event.preventDefault();\n            _this.isCompositionUpdated = false;\n            _this.isCompositionEnd = true;\n        };\n        /* eslint-disable @typescript-eslint/no-explicit-any */\n        this.onImageResizer = function (args) {\n            if (!isNullOrUndefined(_this.owner) && !isNullOrUndefined(_this.owner.imageResizerModule) &&\n                _this.owner.imageResizerModule.isImageResizerVisible && _this.owner.imageResizerModule.isImageResizing) {\n                if (args instanceof MouseEvent) {\n                    _this.onMouseUpInternal(args);\n                }\n                else if (args instanceof TouchEvent) {\n                    _this.onTouchUpInternal(args);\n                }\n            }\n            if (_this.scrollMoveTimer) {\n                _this.isMouseEntered = true;\n                clearInterval(_this.scrollMoveTimer);\n            }\n        };\n        /* eslint-enable @typescript-eslint/no-explicit-any */\n        /**\n         * @private\n         * @param {KeyboardEvent} event - Specifies keyboard event\n         * @returns {void}\n         */\n        this.onKeyPressInternal = function (event) {\n            var key = event.which || event.keyCode;\n            _this.triggerElementsOnLoading = false;\n            var ctrl = (event.ctrlKey || event.metaKey) ? true : ((key === 17) ? true : false); // ctrl detection\n            var alt = event.altKey ? event.altKey : ((key === 18) ? true : false); // alt key detection\n            if (Browser.isIE && alt && ctrl) {\n                ctrl = false;\n            }\n            // tslint:disable-next-line:max-line-length\n            if (ctrl && event.key === 'v' || ctrl && event.key === 'a' || (ctrl || (_this.isControlPressed && Browser.isIE)) && event.key === 'p') {\n                if (Browser.isIE) {\n                    _this.isControlPressed = false;\n                }\n                return;\n            }\n            if (!_this.owner.isReadOnlyMode || (_this.selection && _this.selection.isInlineFormFillMode())) {\n                var key_1 = event.keyCode || event.charCode;\n                var char = '';\n                if (key_1) {\n                    char = String.fromCharCode(key_1);\n                }\n                else if (event.key) {\n                    char = event.key;\n                }\n                if (char !== ' ' && char !== '\\r' && char !== '\\b' && char !== String.fromCharCode(27) && !ctrl) {\n                    _this.owner.editorModule.handleTextInput(char);\n                }\n                else if (char === ' ') {\n                    _this.triggerSpellCheck = true;\n                    _this.owner.editorModule.handleTextInput(' ');\n                    _this.triggerSpellCheck = false;\n                }\n                event.preventDefault();\n            }\n            _this.owner.focusIn();\n        };\n        /**\n         * @private\n         * @param {KeyboardEvent} event - Specifies keyboard event\n         * @returns {void}\n         */\n        this.onTextInputInternal = function (event) {\n            if (!_this.owner.isReadOnlyMode) {\n                _this.owner.editorModule.onTextInputInternal();\n            }\n            else {\n                _this.editableDiv.innerText = '';\n            }\n        };\n        /**\n         * Fired on paste.\n         *\n         * @private\n         * @param {ClipboardEvent} event - Specifies clipboard event.\n         * @returns {void}\n         */\n        this.onPaste = function (event) {\n            if ((!_this.owner.isReadOnlyMode && _this.owner.editorModule.canEditContentControl) || _this.selection.isInlineFormFillMode()) {\n                _this.owner.editorModule.pasteInternal(event);\n            }\n            _this.editableDiv.innerText = '';\n            event.preventDefault();\n        };\n        /**\n         * Fires when editable div loses focus.\n         *\n         * @private\n         * @returns {void}\n         */\n        this.onFocusOut = function () {\n            if (!isNullOrUndefined(_this.selection)) {\n                if (_this.owner.contextMenuModule && _this.owner.contextMenuModule.contextMenuInstance &&\n                    _this.owner.contextMenuModule.contextMenuInstance.element.style.display === 'block') {\n                    return;\n                }\n                _this.selection.hideCaret();\n            }\n        };\n        /**\n         * Updates focus to editor area.\n         *\n         * @private\n         * @returns {void}\n         */\n        this.updateFocus = function () {\n            if (_this.owner.enableCollaborativeEditing && _this.owner.editorModule.isRemoteAction) {\n                return;\n            }\n            if (!isNullOrUndefined(_this.currentSelectedComment) && !_this.owner.commentReviewPane.commentPane.isEditMode) {\n                if (_this.owner.commentReviewPane && _this.owner.commentReviewPane.commentPane.isEditMode) {\n                    _this.owner.commentReviewPane.commentPane.selectComment(_this.currentSelectedComment);\n                }\n                _this.selection.hideCaret();\n                return;\n            }\n            if (_this.selection && !(_this.isMobileDevice && _this.owner.isReadOnly)) {\n                if (navigator !== undefined && !Browser.isDevice && !Browser.isIE && !navigator.userAgent.match('Edge')\n                    && !isNullOrUndefined(_this.iframe)) {\n                    _this.iframe.focus();\n                }\n                if (!isNullOrUndefined(_this.editableDiv)) {\n                    _this.editableDiv.focus();\n                }\n                _this.selection.showCaret();\n            }\n        };\n        /**\n         * Fires on scrolling.\n         *\n         * @returns {void}\n         */\n        this.scrollHandler = function () {\n            if (_this.scrollTimer) {\n                clearTimeout(_this.scrollTimer);\n            }\n            _this.clearContent();\n            _this.isScrollHandler = true;\n            if (!Browser.isDevice && !_this.isComposingIME) {\n                _this.iframe.style.top = _this.owner.viewer.containerTop + 'px';\n                _this.iframe.style.left = _this.owner.viewer.containerLeft + 'px';\n            }\n            if (_this.owner.hRuler) {\n                var hRuler = document.getElementById(_this.owner.element.id + ('_hRulerBottom'));\n                hRuler.style.top = _this.viewerContainer.scrollTop + 'px';\n                var markIndicator = document.getElementById(_this.owner.element.id + ('_markIndicator'));\n                if (markIndicator) {\n                    markIndicator.style.top = _this.viewerContainer.scrollTop + 'px';\n                }\n            }\n            if (_this.owner.vRuler) {\n                var vRuler = document.getElementById(_this.owner.element.id + ('_vRulerBottom'));\n                vRuler.style.left = _this.viewerContainer.scrollLeft + 'px';\n                var markIndicator = document.getElementById(_this.owner.element.id + ('_markIndicator'));\n                if (markIndicator) {\n                    markIndicator.style.left = _this.viewerContainer.scrollLeft + 'px';\n                }\n            }\n            if (_this.owner.rulerHelper && !isNullOrUndefined(_this.owner.rulerHelper.vRulerBottom)) {\n                _this.owner.rulerHelper.vRulerBottom.style.height = _this.pageContainer.offsetHeight + 'px';\n            }\n            _this.owner.viewer.updateScrollBars();\n            var vtHeight = _this.owner.viewer.containerTop + _this.visibleBounds.height - (_this.owner.viewer.padding.top + _this.owner.viewer.padding.bottom);\n            if (vtHeight > _this.pageContainer.offsetHeight) {\n                _this.viewerContainer.scrollTop = _this.owner.viewer.containerTop - (vtHeight - _this.pageContainer.offsetHeight);\n            }\n            if (_this.owner.viewer instanceof PageLayoutViewer && !isNullOrUndefined(_this.owner)) {\n                _this.owner.fireViewChange();\n            }\n            _this.isScrollHandler = false;\n            _this.scrollTimer = setTimeout(function () {\n                if (!_this.isScrollHandler && !isNullOrUndefined(_this.owner) && _this.owner.isSpellCheck) {\n                    _this.isScrollToSpellCheck = true;\n                    _this.owner.viewer.updateScrollBars();\n                }\n            }, 200);\n        };\n        /**\n         * Fires when the window gets resized.\n         *\n         * @private\n         * @returns {void}\n         */\n        this.onWindowResize = function () {\n            if (_this.resizeTimer) {\n                clearTimeout(_this.resizeTimer);\n            }\n            _this.resizeTimer = setTimeout(function () {\n                if (!isNullOrUndefined(_this.owner) && !isNullOrUndefined(_this.owner.element)) {\n                    _this.updateViewerSize();\n                    if (_this.owner.rulerHelper && _this.owner.documentEditorSettings && _this.owner.documentEditorSettings.showRuler) {\n                        _this.owner.rulerHelper.updateRuler(_this.owner, true);\n                    }\n                    if (_this.owner.enableCollaborativeEditing && _this.owner.collaborativeEditingHandlerModule) {\n                        _this.owner.collaborativeEditingHandlerModule.updateCaretPosition();\n                    }\n                    _this.clearContent();\n                    _this.owner.viewer.updateScrollBars();\n                    if (!isNullOrUndefined(_this.selection)) {\n                        _this.selection.updateCaretPosition();\n                    }\n                    _this.updateTouchMarkPosition();\n                    if (_this.owner.contextMenuModule && _this.owner.contextMenuModule.contextMenuInstance) {\n                        _this.owner.contextMenuModule.contextMenuInstance.close();\n                    }\n                    if (_this.resizeTimer) {\n                        clearTimeout(_this.resizeTimer);\n                    }\n                }\n            }, 200);\n        };\n        /**\n         * @private\n         * @param {MouseEvent} event - Specified mouse event.\n         * @returns {void}\n         */\n        this.onContextMenu = function (event) {\n            if (_this.owner.contextMenuModule) {\n                if (_this.isMouseDown) {\n                    _this.isMouseDown = false;\n                }\n                _this.owner.contextMenuModule.onContextMenuInternal(event);\n                _this.updateFocus();\n            }\n        };\n        /**\n         * Called on mouse down.\n         *\n         * @private\n         * @param {MouseEvent} event - Specifies mouse event.\n         * @returns {void}\n         */\n        this.onMouseDownInternal = function (event) {\n            var target = event.target;\n            _this.owner.focusIn();\n            if ((!isNullOrUndefined(target) && target !== _this.viewerContainer) || _this.owner.isTableMarkerDragging || _this.isTouchInput ||\n                event.offsetX > (_this.visibleBounds.width - (_this.visibleBounds.width - _this.viewerContainer.clientWidth))\n                || event.offsetY > (_this.visibleBounds.height - (_this.visibleBounds.height - _this.viewerContainer.clientHeight))) {\n                return;\n            }\n            _this.isFootnoteWidget = false;\n            if (!isNullOrUndefined(_this.selection)) {\n                _this.updateCursor(event);\n                if (_this.formFillPopup) {\n                    _this.formFillPopup.hidePopup();\n                }\n                if (_this.isLeftButtonPressed(event) && !_this.owner.isReadOnlyMode && _this.owner.enableImageResizerMode && !isNullOrUndefined(_this.owner.imageResizerModule.selectedResizeElement)) {\n                    if (_this.selection.isInShape) {\n                        var textFram = _this.owner.selectionModule.getCurrentTextFrame();\n                        var shape = textFram.containerShape;\n                        _this.selection.selectShape(shape);\n                    }\n                    _this.owner.imageResizerModule.isImageResizing = true;\n                }\n                event.preventDefault();\n                if (!_this.isTouchInput) {\n                    _this.selection.hideCaret();\n                }\n                var cursorPoint = new Point(event.offsetX, event.offsetY);\n                var touchPoint = _this.owner.viewer.findFocusedPage(cursorPoint, true, true);\n                _this.mouseDownOffset.x = touchPoint.x;\n                _this.mouseDownOffset.y = touchPoint.y;\n                _this.isMouseDownInFooterRegion = _this.selection.isCursorInsidePageRect(cursorPoint, _this.currentPage) && _this.selection.isCursorInFooterRegion(cursorPoint, _this.currentPage);\n                _this.isSelectionChangedOnMouseMoved = false;\n                if (!_this.owner.isReadOnlyMode && (_this.owner.editorModule.tableResize.isInCellResizerArea(touchPoint) ||\n                    _this.owner.editorModule.tableResize.isInRowResizerArea(touchPoint))) {\n                    _this.selection.hideCaret();\n                    _this.isMouseDown = true;\n                    _this.isSelectionChangedOnMouseMoved = false;\n                    if (_this.isLeftButtonPressed(event)) {\n                        _this.owner.editorModule.tableResize.startingPoint.x = touchPoint.x;\n                        _this.owner.editorModule.tableResize.startingPoint.y = touchPoint.y;\n                        _this.owner.editorModule.tableResize.handleResize(touchPoint);\n                    }\n                    return;\n                }\n                if (event.ctrlKey) {\n                    _this.isControlPressed = true;\n                }\n                if (_this.owner.selectionModule.isEmpty) {\n                    _this.useTouchSelectionMark = false;\n                }\n                var widget = _this.getLineWidget(touchPoint);\n                if (event.which === 3 && !_this.owner.selectionModule.isEmpty\n                    && _this.selection.checkCursorIsInSelection(widget, touchPoint)) {\n                    event.preventDefault();\n                    return;\n                }\n                if (_this.owner && _this.owner.documentEditorSettings && _this.owner.documentEditorSettings.allowDragAndDrop &&\n                    !_this.owner.selectionModule.isEmpty\n                    && _this.selection.checkCursorIsInSelection(widget, touchPoint)) {\n                    _this.isMouseDownInSelection = true;\n                }\n                _this.isTouchInput = false;\n                _this.isMouseDown = true;\n                _this.updateFocus();\n                /* eslint-disable @typescript-eslint/indent */\n                _this.timer = setTimeout(function () {\n                    _this.tapCount++;\n                    if (_this.tapCount > 1) {\n                        _this.tapCount = 1;\n                    }\n                    if (!_this.isScrollHandler && !isNullOrUndefined(_this.owner) && _this.owner.isSpellCheck) {\n                        _this.isScrollToSpellCheck = true;\n                        _this.owner.viewer.updateScrollBars();\n                    }\n                }, 100);\n            }\n        };\n        /**\n         * Called on mouse move.\n         *\n         * @private\n         * @param {MouseEvent} event - Specified mouse event.\n         * @returns {void}\n         */\n        this.onMouseMoveInternal = function (event) {\n            if (!isNullOrUndefined(event.target) && event.target !== _this.viewerContainer || _this.owner.isTableMarkerDragging) {\n                return;\n            }\n            event.preventDefault();\n            if (!isNullOrUndefined(_this.selection)) {\n                //For image Resizing\n                if (!_this.owner.isReadOnlyMode && _this.owner.enableImageResizerMode\n                    && _this.owner.imageResizerModule.isImageResizing) {\n                    if (!_this.owner.imageResizerModule.isImageMoveToNextPage) {\n                        _this.owner.imageResizerModule.handleImageResizingOnMouse(event);\n                    }\n                    return;\n                }\n                var cursorPoint = new Point(event.offsetX, event.offsetY);\n                var touchPoint = _this.owner.viewer.findFocusedPage(cursorPoint, !_this.owner.enableHeaderAndFooter);\n                var widget = _this.getLineWidget(touchPoint);\n                if (_this.isMouseDown) {\n                    if (!isNullOrUndefined(_this.currentPage)) {\n                        var xPosition = touchPoint.x;\n                        var yPosition = touchPoint.y;\n                        if (!_this.owner.isReadOnlyMode && _this.isRowOrCellResizing) {\n                            var table = _this.owner.editorModule.tableResize.currentResizingTable;\n                            var startPosition = _this.selection.setPositionForBlock(table, true);\n                            var endPosition = _this.selection.setPositionForBlock(table, false);\n                            if (!(_this.owner.documentHelper.isDocumentProtected) || _this.selection.checkSelectionIsAtEditRegion(startPosition, endPosition)) {\n                                _this.owner.editorModule.tableResize.handleResizing(touchPoint);\n                            }\n                        }\n                        else {\n                            if ((!_this.isDragStarted\n                                && _this.isMouseDownInSelection\n                                && _this.isLeftButtonPressed(event)\n                                && !_this.owner.selectionModule.isEmpty\n                                && _this.selection.checkCursorIsInSelection(widget, touchPoint)) || (!_this.owner.isReadOnlyMode && _this.owner.enableImageResizerMode && !_this.isDragStarted && _this.isLeftButtonPressed(event) && !_this.owner.selectionModule.isEmpty && !isNullOrUndefined(widget) && _this.owner.imageResizerModule.selectedImageWidget.containsKey(widget) && !_this.owner.imageResizerModule.isImageResizing)) {\n                                _this.isDragStarted = true;\n                                _this.isMouseDownInSelection = false;\n                                if (_this.selection.isForward) {\n                                    _this.dragStartParaInfo = _this.selection.getParagraphInfo(_this.selection.start);\n                                    _this.dragEndParaInfo = _this.selection.getParagraphInfo(_this.selection.end);\n                                }\n                                else {\n                                    _this.dragStartParaInfo = _this.selection.getParagraphInfo(_this.selection.end);\n                                    _this.dragEndParaInfo = _this.selection.getParagraphInfo(_this.selection.start);\n                                }\n                                _this.selection.caret.classList.remove(\"e-de-cursor-animation\");\n                            }\n                            if (!(_this.isTouchInput || _this.isSelectionChangedOnMouseMoved || _this.touchDownOnSelectionMark > 0 || _this.isDragStarted)) {\n                                _this.updateTextPositionForSelection(touchPoint, 1);\n                            }\n                            if (_this.isLeftButtonPressed(event) && !_this.isDragStarted) {\n                                event.preventDefault();\n                                var touchY = yPosition;\n                                var textPosition = _this.owner.selectionModule.end;\n                                var touchPoint_1 = new Point(xPosition, touchY);\n                                if (!_this.owner.enableImageResizerMode || !_this.owner.imageResizerModule.isImageResizerVisible\n                                    || _this.owner.imageResizerModule.isShapeResize) {\n                                    _this.isCompleted = false;\n                                    _this.owner.selectionModule.moveTextPosition(touchPoint_1, textPosition);\n                                }\n                                _this.isSelectionChangedOnMouseMoved = true;\n                            }\n                            if (_this.isDragStarted && _this.isLeftButtonPressed(event)) {\n                                _this.autoScrollOnSelection(cursorPoint);\n                                _this.selection.updateTextPosition(widget, touchPoint);\n                            }\n                        }\n                    }\n                    _this.selection.checkForCursorVisibility();\n                }\n                if (!_this.isRowOrCellResizing && !_this.isSelectionChangedOnMouseMoved) {\n                    _this.updateCursor(event);\n                }\n                if (_this.isRowOrCellResizing) {\n                    _this.selection.hideCaret();\n                }\n            }\n        };\n        /**\n         * @private\n         * @param {MouseEvent} event - Specifies mouse event\n         * @returns {void}\n         */\n        this.onMouseLeaveInternal = function (event) {\n            event.preventDefault();\n            var cursorPoint = new Point(event.offsetX, event.offsetY);\n            if (_this.isMouseDown) {\n                var viewerTop = _this.viewerContainer.scrollTop;\n                clearInterval(_this.scrollMoveTimer);\n                if (event.offsetY + viewerTop > viewerTop) {\n                    _this.scrollMoveTimer = setInterval(function () {\n                        _this.scrollForwardOnSelection(cursorPoint);\n                    }, 100);\n                }\n                else {\n                    _this.scrollMoveTimer = setInterval(function () {\n                        _this.scrollBackwardOnSelection(cursorPoint);\n                    }, 100);\n                }\n                if (_this.isMouseEntered) {\n                    _this.isMouseEntered = false;\n                }\n            }\n            if (_this.isDragStarted) {\n                _this.selection.hideCaret();\n                if (_this.scrollMoveTimer) {\n                    clearInterval(_this.scrollMoveTimer);\n                    _this.scrollMoveTimer = 0;\n                }\n            }\n        };\n        /**\n         * @private\n         * @returns {void}\n         */\n        this.onMouseEnterInternal = function (event) {\n            if (!_this.isMouseEntered) {\n                _this.owner.viewer.updateScrollBars();\n            }\n            _this.isMouseEntered = true;\n            if (_this.scrollMoveTimer) {\n                clearInterval(_this.scrollMoveTimer);\n            }\n            if (!_this.isLeftButtonPressed(event) && _this.isDragStarted) {\n                if (!_this.selection.caret.classList.contains(\"e-de-cursor-animation\")) {\n                    _this.selection.caret.classList.add(\"e-de-cursor-animation\");\n                }\n                _this.isDragStarted = false;\n            }\n            if (!_this.isLeftButtonPressed(event) && _this.isMouseDown) {\n                _this.onMouseUpInternal(event);\n            }\n        };\n        /**\n         * Fired on double tap.\n         *\n         * @private\n         * @param {MouseEvent} event - Specifies mouse event.\n         * @returns {void}\n         */\n        this.onDoubleTap = function (event) {\n            _this.owner.focusIn();\n            if (!isNullOrUndefined(event.target) && event.target !== _this.viewerContainer) {\n                return;\n            }\n            if (!isNullOrUndefined(_this.selection)) {\n                _this.isTouchInput = false;\n                var cursorPoint = new Point(event.offsetX, event.offsetY);\n                var touchPoint = _this.owner.viewer.findFocusedPage(cursorPoint, true);\n                if (_this.selection.checkAndEnableHeaderFooter(cursorPoint, _this.owner.viewer.findFocusedPage(cursorPoint, true))) {\n                    return;\n                }\n                var widget = _this.getLineWidget(touchPoint);\n                var formField = _this.selection.getHyperLinkFieldInCurrentSelection(widget, touchPoint, true);\n                if (isNullOrUndefined(formField)) {\n                    formField = _this.selection.getCurrentFormField();\n                }\n                if (!_this.isDocumentProtected && _this.owner.enableFormField && !_this.owner.isReadOnlyMode) {\n                    var formatType = _this.selection.getFormFieldType(formField);\n                    if (formatType) {\n                        if (formatType.toString() !== '') {\n                            _this.selection.selectField(formField);\n                        }\n                        switch (formatType) {\n                            case 'Text':\n                                _this.owner.textFormFieldDialogModule.show();\n                                break;\n                            case 'CheckBox':\n                                _this.owner.checkBoxFormFieldDialogModule.show();\n                                break;\n                            case 'DropDown':\n                                _this.owner.dropDownFormFieldDialogModule.show();\n                                break;\n                        }\n                    }\n                }\n                else if (_this.isDocumentProtected && formField && formField.formFieldData instanceof TextFormField\n                    && formField.formFieldData.type === 'Text') {\n                    _this.selection.selectField();\n                }\n                var startPosition = _this.selection.start.clone();\n                var endPosition = _this.selection.end.clone();\n                var inlineObj = startPosition.currentWidget.getInline(startPosition.offset, 0);\n                var inline = inlineObj.element;\n                if (_this.owner.layoutType === 'Pages') {\n                    if (inline instanceof FootnoteElementBox) {\n                        if (inline.footnoteType === 'Footnote') {\n                            var footnotes = _this.currentPage.footnoteWidget;\n                            var i = void 0;\n                            for (i = 0; i <= footnotes.bodyWidgets.length; i++) {\n                                var footnoteText = (footnotes.bodyWidgets[i]).footNoteReference;\n                                if (inline.text === footnoteText.text) {\n                                    break;\n                                }\n                            }\n                            startPosition.setPositionParagraph(footnotes.bodyWidgets[i].childWidgets[0].childWidgets[0], 0);\n                            endPosition.setPositionParagraph(footnotes.bodyWidgets[i].childWidgets[0].childWidgets[0], 0);\n                            _this.selection.selectRange(startPosition, endPosition);\n                        }\n                        else {\n                            var endnotes = _this.pages[_this.pages.length - 1].endnoteWidget;\n                            var i = void 0;\n                            if (!isNullOrUndefined(endnotes)) {\n                                for (i = 0; i <= endnotes.childWidgets.length; i++) {\n                                    var endnoteText = (endnotes.bodyWidgets[i]).footNoteReference;\n                                    if (inline.text === endnoteText.text) {\n                                        break;\n                                    }\n                                }\n                            }\n                            startPosition.setPositionParagraph(endnotes.bodyWidgets[i].childWidgets[0].childWidgets[0], 0);\n                            endPosition.setPositionParagraph(endnotes.bodyWidgets[i].childWidgets[0].childWidgets[0], 0);\n                            _this.selection.selectRange(startPosition, endPosition);\n                        }\n                    }\n                    else {\n                        if (inline instanceof TextElementBox && (_this.selection.isinEndnote || _this.selection.isinFootnote)) {\n                            _this.selection.footnoteReferenceElement(startPosition, endPosition, inline);\n                        }\n                    }\n                }\n                if (_this.selection.isEmpty && !isNullOrUndefined(_this.currentPage) && !isNullOrUndefined(_this.owner.selectionModule.start)) {\n                    _this.owner.selectionModule.selectCurrentWord();\n                    _this.selection.checkForCursorVisibility();\n                    _this.tapCount = 2;\n                }\n            }\n        };\n        /**\n         * Called on mouse up.\n         *\n         * @private\n         * @param {MouseEvent} event - Specifies mouse event.\n         * @return {void}\n         */\n        /* eslint-disable  */\n        this.onMouseUpInternal = function (event) {\n            if (!isNullOrUndefined(event.target) && event.target !== _this.viewerContainer || _this.owner.isTableMarkerDragging) {\n                return;\n            }\n            event.preventDefault();\n            _this.isListTextSelected = false;\n            var cursorPoint = new Point(event.offsetX, event.offsetY);\n            var touchPoint = _this.owner.viewer.findFocusedPage(cursorPoint, true);\n            if (!isNullOrUndefined(_this.selection)) {\n                var tapCount = 1;\n                if (!Browser.isIE) {\n                    if (event.detail > 2) {\n                        tapCount = event.detail;\n                    }\n                }\n                else {\n                    tapCount = _this.tapCount;\n                }\n                if (_this.isRowOrCellResizing) {\n                    _this.owner.editorModule.tableResize.updateResizingHistory(touchPoint);\n                }\n                if (_this.isMouseDown && !_this.isSelectionChangedOnMouseMoved\n                    && !isNullOrUndefined(_this.currentPage) && !isNullOrUndefined(_this.owner.selectionModule.start)\n                    && (!_this.owner.enableImageResizerMode || !_this.owner.imageResizerModule.isImageResizing)) {\n                    if (_this.touchDownOnSelectionMark === 0 && !_this.isRowOrCellResizing) {\n                        var isShiftKeyPressed = event.shiftKey;\n                        if (isShiftKeyPressed) {\n                            var textPosition = _this.owner.selectionModule.end;\n                            _this.owner.selectionModule.moveTextPosition(touchPoint, textPosition);\n                        }\n                        else {\n                            _this.updateTextPositionForSelection(touchPoint, tapCount);\n                        }\n                        if (Browser.isIE && tapCount === 2) {\n                            _this.selection.checkAndEnableHeaderFooter(cursorPoint, touchPoint);\n                        }\n                    }\n                    _this.selection.checkForCursorVisibility();\n                    if (!isNullOrUndefined(_this.currentSelectedComment) && _this.owner.commentReviewPane\n                        && !_this.owner.commentReviewPane.commentPane.isEditMode) {\n                        _this.currentSelectedComment = undefined;\n                    }\n                }\n                var isCtrlkeyPressed = _this.isIosDevice ? event.metaKey : event.ctrlKey;\n                if (!isNullOrUndefined(_this.currentPage) && !isNullOrUndefined(_this.owner.selectionModule.start)\n                    && (_this.owner.selectionModule.isEmpty || _this.owner.selectionModule.isImageSelected) &&\n                    (((isCtrlkeyPressed && _this.owner.useCtrlClickToFollowHyperlink ||\n                        !_this.owner.useCtrlClickToFollowHyperlink) && _this.isLeftButtonPressed(event) === true))) {\n                    _this.selection.navigateHyperLinkOnEvent(touchPoint, false);\n                }\n                if (_this.isMouseDown && _this.isLeftButtonPressed(event) && _this.isDocumentProtected\n                    && _this.protectionType === 'FormFieldsOnly' && _this.selection) {\n                    var widget = _this.getLineWidget(touchPoint);\n                    var formField = _this.selection.getHyperLinkFieldInCurrentSelection(widget, touchPoint, true);\n                    if (isNullOrUndefined(formField)) {\n                        formField = _this.selection.getCurrentFormField(true);\n                    }\n                    if (formField && formField.formFieldData && formField.formFieldData.enabled && !_this.selection.isInlineFormFillMode(formField)) {\n                        var data = { 'fieldName': formField.formFieldData.name };\n                        if (formField.formFieldData instanceof TextFormField) {\n                            data.value = formField.resultText;\n                        }\n                        else if (formField.formFieldData instanceof CheckBoxFormField) {\n                            data.value = formField.formFieldData.checked;\n                        }\n                        else {\n                            data.value = formField.formFieldData.selectedIndex;\n                        }\n                        data.isCanceled = false;\n                        if (_this.owner.documentEditorSettings.formFieldSettings.formFillingMode === 'Popup' && _this.selection.previousSelectedFormField !== _this.selection.getCurrentFormField()) {\n                            _this.owner.trigger(beforeFormFieldFillEvent, data);\n                        }\n                        else {\n                            _this.owner.trigger(beforeFormFieldFillEvent, data);\n                        }\n                        if (!data.isCanceled) {\n                            if (_this.owner.documentEditorSettings.formFieldSettings.formFillingMode === 'Popup' && !(formField.formFieldData instanceof CheckBoxFormField)\n                                || (formField.formFieldData instanceof TextFormField && !(formField.formFieldData.type === 'Text'))\n                                || formField.formFieldData instanceof DropDownFormField) {\n                                _this.formFillPopup.showPopUp(formField);\n                            }\n                            else {\n                                _this.owner.editorModule.toggleCheckBoxFormField(formField);\n                                data.value = formField.formFieldData.checked;\n                                data.isCanceled = false;\n                                _this.owner.trigger(afterFormFieldFillEvent, data);\n                            }\n                        }\n                    }\n                    if (!formField && _this.isFormFillProtectedMode) {\n                        _this.selection.navigateToNextFormField();\n                    }\n                }\n                else if (_this.isMouseDown) {\n                    if (_this.formFields.length > 0) {\n                        var formField = _this.selection.getCurrentFormField(true);\n                        if (formField && formField.formFieldData instanceof TextFormField) {\n                            _this.selection.selectField();\n                        }\n                        else if (_this.isLeftButtonPressed(event) && formField && formField.formFieldData instanceof DropDownFormField) {\n                            var offset = formField.line.getOffset(formField, 0);\n                            var point = _this.selection.getPhysicalPositionInternal(formField.line, offset, false);\n                            _this.selection.selectInternal(formField.line, formField, 0, point);\n                        }\n                    }\n                    if (_this.isSelectionChangedOnMouseMoved) {\n                        _this.selection.fireSelectionChanged(true);\n                    }\n                }\n                if (!_this.owner.isReadOnlyMode && _this.isSelectionInListText(touchPoint)) {\n                    _this.selection.selectListText();\n                }\n                if (!_this.owner.isReadOnlyMode && _this.owner.enableImageResizerMode && _this.owner.imageResizerModule.isImageResizing) {\n                    _this.owner.imageResizerModule.mouseUpInternal();\n                    _this.scrollToPosition(_this.owner.selectionModule.start, _this.owner.selectionModule.end);\n                    _this.owner.imageResizerModule.isImageResizing = false;\n                }\n                if (_this.owner.enableImageResizerMode && _this.owner.imageResizerModule.isImageResizerVisible && !isNullOrUndefined(_this.selection.caret)) {\n                    _this.selection.caret.style.display = 'none';\n                }\n                if (_this.isDragStarted) {\n                    _this.isDragging = true;\n                    _this.moveSelectedContent();\n                    _this.isDragging = false;\n                }\n                if (_this.isMouseDown) {\n                    _this.updateFocus();\n                }\n                _this.isMouseDownInSelection = false;\n                _this.isMouseDown = false;\n                _this.isFootnoteWidget = false;\n                _this.isSelectionChangedOnMouseMoved = false;\n                _this.isTouchInput = false;\n                _this.useTouchSelectionMark = true;\n                _this.isControlPressed = false;\n                if (_this.isListTextSelected) {\n                    _this.selection.hideCaret();\n                }\n                if (_this.owner.enableImageResizerMode) {\n                    var imageResizer = _this.owner.imageResizerModule;\n                    imageResizer.isImageResizing = false;\n                    imageResizer.isImageMoveToNextPage = false;\n                    imageResizer.leftValue = undefined;\n                    imageResizer.topValue = undefined;\n                }\n                _this.isMouseDownInFooterRegion = false;\n            }\n            if (_this.selection) {\n                _this.selection.isCellPrevSelected = false;\n            }\n        };\n        /**\n         * Fired on touch start.\n         *\n         * @private\n         * @param {TouchEvent} event - Specifies touch event.\n         * @returns {void}\n         */\n        this.onTouchStartInternal = function (event) {\n            if (_this.selection) {\n                _this.isTouchMoved = false;\n                _this.isCompositionStart = false;\n                _this.isCompositionEnd = false;\n                _this.isCompositionUpdated = false;\n                _this.isCompositionCanceled = true;\n                _this.isTouchInput = true;\n                if (_this.isTimerStarted) {\n                    if (_this.tapCount === 1) {\n                        _this.tapCount = 2;\n                    }\n                    else {\n                        _this.tapCount = 3;\n                        _this.isTimerStarted = false;\n                    }\n                }\n                else {\n                    _this.isTimerStarted = true;\n                    _this.tapCount = 1;\n                }\n                if (event.touches.length === 1) {\n                    _this.zoomX = event.touches[0].clientX;\n                    _this.zoomY = event.touches[0].clientY;\n                    if (_this.owner.selectionModule.isEmpty) {\n                        _this.useTouchSelectionMark = false;\n                    }\n                    _this.isMouseDown = true;\n                    _this.isSelectionChangedOnMouseMoved = false;\n                    var point = void 0;\n                    if (_this.isMouseDown) {\n                        point = _this.getTouchOffsetValue(event);\n                    }\n                    point = _this.owner.viewer.findFocusedPage(point, true, true);\n                    if (_this.owner.enableImageResizerMode) {\n                        var resizeObj = _this.owner.imageResizerModule.getImagePointOnTouch(point);\n                        _this.owner.imageResizerModule.selectedResizeElement = resizeObj.selectedElement;\n                    }\n                    if (_this.owner.enableImageResizerMode && !isNullOrUndefined(_this.owner.imageResizerModule.selectedResizeElement)) {\n                        _this.owner.imageResizerModule.isImageResizing = true;\n                    }\n                    if (Browser.isDevice) {\n                        _this.editableDiv.contentEditable = _this.owner.isReadOnlyMode ? 'false' : 'true';\n                    }\n                    var x = _this.owner.selectionModule.end.location.x;\n                    var y = _this.selection.getCaretBottom(_this.owner.selectionModule.end, _this.owner.selectionModule.isEmpty) + 9;\n                    //TouchDownOnSelectionMark will be 2 when touch end is pressed\n                    _this.touchDownOnSelectionMark = ((point.y <= y && point.y >= y - 20 || point.y >= y && point.y <= y + 20)\n                        && (point.x <= x && point.x >= x - 20 || point.x >= x && point.x <= x + 20)) ? 1 : 0;\n                    if (!_this.owner.selectionModule.isEmpty && _this.touchDownOnSelectionMark === 0) {\n                        x = _this.owner.selectionModule.start.location.x;\n                        y = _this.selection.getCaretBottom(_this.owner.selectionModule.start, false) + 9;\n                        //TouchDownOnSelectionMark will be 1 when touch start is pressed\n                        _this.touchDownOnSelectionMark = ((point.y <= y && point.y >= y - 20 || point.y >= y && point.y <= y + 20)\n                            && (point.x <= x && point.x >= x - 20 || point.x >= x && point.x <= x + 20)) ? 2 : 0;\n                    }\n                }\n                if (!isNullOrUndefined(_this.owner.contextMenuModule) && _this.owner.contextMenuModule.contextMenuInstance) {\n                    _this.owner.contextMenuModule.contextMenuInstance.close();\n                }\n                if (_this.touchDownOnSelectionMark || event.touches.length > 1) {\n                    event.preventDefault();\n                }\n                _this.longTouchTimer = setTimeout(_this.onLongTouch, 500, event);\n                _this.timer = setTimeout(function () {\n                    _this.isTimerStarted = false;\n                }, 200);\n                _this.owner.focusIn();\n            }\n        };\n        /**\n         * Fired on long touch\n         *\n         * @private\n         * @param {TouchEvent} event - Specifies touch event.\n         * @returns {void}\n         */\n        this.onLongTouch = function (event) {\n            if (isNullOrUndefined(_this.owner) || isNullOrUndefined(_this.viewerContainer) || _this.isTouchMoved || event.touches.length !== 1) {\n                return;\n            }\n            var point = _this.getTouchOffsetValue(event);\n            var pointRelToPage = _this.owner.viewer.findFocusedPage(point, true);\n            var selStart = _this.selection.start;\n            var selEnd = _this.selection.end;\n            var updateSel = false;\n            if (!_this.selection.isForward) {\n                selStart = _this.selection.end;\n                selEnd = _this.selection.start;\n            }\n            var selStartPt = selStart.location;\n            var selEndPt = selEnd.location;\n            if (selStart.currentWidget !== selEnd.currentWidget) {\n                updateSel = !(pointRelToPage.x >= selStartPt.x && pointRelToPage.x <= selEndPt.x)\n                    && !(pointRelToPage.y >= selStartPt.y && pointRelToPage.y <= selEndPt.y);\n            }\n            else {\n                updateSel = !(pointRelToPage.x >= selStartPt.x && pointRelToPage.x <= selEndPt.x)\n                    || !(pointRelToPage.y >= selStartPt.y && pointRelToPage.y <= selEndPt.y);\n            }\n            if (event.changedTouches.length === 1 && updateSel) {\n                _this.updateSelectionOnTouch(point, pointRelToPage);\n                _this.isMouseDown = false;\n                _this.touchDownOnSelectionMark = 0;\n                _this.useTouchSelectionMark = true;\n                _this.isSelectionChangedOnMouseMoved = false;\n            }\n            if (_this.selection.isEmpty) {\n                _this.selection.selectCurrentWord();\n            }\n            if (!isNullOrUndefined(_this.owner.contextMenuModule) && _this.owner.contextMenuModule.contextMenuInstance) {\n                _this.owner.contextMenuModule.onContextMenuInternal(event);\n            }\n        };\n        /**\n         *\n         * @private\n         * @param {TouchEvent} event - Specifies touch event.\n         * @returns {void}\n         */\n        this.onTouchMoveInternal = function (event) {\n            _this.isTouchMoved = true;\n            var touch = event.touches;\n            var cursorPoint;\n            if (!isNullOrUndefined(_this.selection)) {\n                if (_this.owner.editorModule && _this.owner.enableImageResizerMode && _this.owner.imageResizerModule.isImageResizing) {\n                    event.preventDefault();\n                    if (!_this.owner.imageResizerModule.isImageMoveToNextPage) {\n                        _this.owner.imageResizerModule.handleImageResizingOnTouch(event);\n                        _this.selection.caret.style.display = 'none';\n                    }\n                    return;\n                }\n                if (_this.isMouseDown) {\n                    cursorPoint = _this.getTouchOffsetValue(event);\n                    var touchPoint = _this.owner.viewer.findFocusedPage(cursorPoint, true);\n                    if (_this.touchDownOnSelectionMark > 0 /*|| !this.useTouchSelectionMark*/) {\n                        _this.isCompleted = false;\n                        event.preventDefault();\n                        var touchY = touchPoint.y;\n                        var textPosition = _this.owner.selectionModule.end;\n                        var touchPointer = void 0;\n                        if (touchPoint.y <= 26) {\n                            touchY -= touchPoint.y < 0 ? 0 : touchPoint.y + 0.5;\n                        }\n                        else {\n                            touchY -= 36.5;\n                        }\n                        textPosition = _this.touchDownOnSelectionMark === 2 ? _this.selection.start : _this.selection.end;\n                        touchPoint = new Point(touchPoint.x, touchY);\n                        _this.owner.selectionModule.moveTextPosition(touchPoint, textPosition);\n                        _this.isSelectionChangedOnMouseMoved = true;\n                    }\n                    _this.selection.checkForCursorVisibility();\n                    _this.updateTouchMarkPosition();\n                }\n            }\n            if (touch.length > 1) {\n                event.preventDefault();\n                _this.isMouseDown = false;\n                _this.zoomX = (touch[0].clientX + touch[1].clientX) / 2;\n                _this.zoomY = (touch[0].clientY + touch[1].clientY) / 2;\n                var currentDiff = Math.sqrt(Math.pow((touch[0].clientX - touch[1].clientX), 2) + Math.pow((touch[0].clientY - touch[1].clientY), 2));\n                if (_this.preDifference > -1) {\n                    if (currentDiff > _this.preDifference) {\n                        _this.onPinchOutInternal(event);\n                    }\n                    else if (currentDiff < _this.preDifference) {\n                        _this.onPinchInInternal(event);\n                    }\n                }\n                else if (_this.zoomFactor < 2) {\n                    if (_this.preDifference !== -1) {\n                        if (currentDiff > _this.preDifference) {\n                            _this.onPinchInInternal(event);\n                        }\n                    }\n                }\n                else if (_this.preDifference === -1) {\n                    if (_this.zoomFactor > 2) {\n                        if (currentDiff > _this.preDifference) {\n                            _this.onPinchInInternal(event);\n                        }\n                    }\n                }\n                _this.preDifference = currentDiff;\n            }\n            if (_this.longTouchTimer) {\n                clearTimeout(_this.longTouchTimer);\n                _this.longTouchTimer = undefined;\n            }\n        };\n        /**\n         * Fired on touch up.\n         *\n         * @private\n         * @param {TouchEvent} event - Specifies touch event.\n         * @returns {void}\n         */\n        this.onTouchUpInternal = function (event) {\n            if (!isNullOrUndefined(_this.selection)) {\n                var point = _this.getTouchOffsetValue(event);\n                var touchPoint = _this.owner.viewer.findFocusedPage(point, true);\n                if (event.changedTouches.length === 1) {\n                    if (!_this.isTouchMoved || (_this.owner.enableImageResizerMode && _this.owner.imageResizerModule.isImageResizing)) {\n                        _this.updateSelectionOnTouch(point, touchPoint);\n                        if (!isNullOrUndefined(_this.currentPage) && !isNullOrUndefined(_this.selection.start)\n                            && !_this.isSelectionChangedOnMouseMoved && (_this.selection.isEmpty ||\n                            _this.selection.isImageField() && (!_this.owner.enableImageResizerMode ||\n                                _this.owner.enableImageResizerMode && !_this.owner.imageResizerModule.isImageResizing))) {\n                            _this.selection.navigateHyperLinkOnEvent(touchPoint, true);\n                        }\n                    }\n                    if (_this.isSelectionChangedOnMouseMoved) {\n                        _this.selection.fireSelectionChanged(true);\n                    }\n                    _this.isMouseDown = false;\n                    _this.touchDownOnSelectionMark = 0;\n                    _this.useTouchSelectionMark = true;\n                    _this.isSelectionChangedOnMouseMoved = false;\n                }\n                if (_this.owner.enableImageResizerMode && _this.owner.imageResizerModule.isImageResizing) {\n                    _this.owner.imageResizerModule.mouseUpInternal();\n                    _this.owner.imageResizerModule.isImageResizing = false;\n                    _this.owner.imageResizerModule.isImageMoveToNextPage = false;\n                    _this.scrollToPosition(_this.owner.selectionModule.start, _this.owner.selectionModule.end);\n                }\n                if (_this.owner.enableImageResizerMode && _this.owner.imageResizerModule.isImageResizerVisible && _this.isTouchInput) {\n                    _this.touchStart.style.display = 'none';\n                    _this.touchEnd.style.display = 'none';\n                }\n                // if (!this.owner.isReadOnlyMode && this.isSelectionInListText(touchPoint)) {\n                //     this.selection.selectListText();\n                // }\n                event.preventDefault();\n            }\n            _this.preDifference = -1;\n            _this.isTouchInput = false;\n            if (_this.longTouchTimer) {\n                clearTimeout(_this.longTouchTimer);\n                _this.longTouchTimer = undefined;\n            }\n            if (!_this.isTimerStarted) {\n                _this.tapCount = 1;\n            }\n            if (_this.isListTextSelected) {\n                _this.selection.hideCaret();\n            }\n            _this.owner.focusIn();\n        };\n        /**\n         * Fired on keyup event.\n         *\n         * @private\n         * @param {KeyboardEvent} event - Specifies keyboard event.\n         * @returns {void}\n         */\n        this.onKeyUpInternal = function (event) {\n            if (Browser.isDevice && event.target === _this.editableDiv) {\n                if (window.getSelection().anchorOffset !== _this.prefix.length) {\n                    _this.selection.setEditableDivCaretPosition(_this.editableDiv.innerText.length);\n                }\n            }\n            if (event.ctrlKey || (event.keyCode === 17 || event.which === 17)) {\n                _this.isControlPressed = false;\n            }\n        };\n        /**\n         * Fired on keydown.\n         *\n         * @private\n         * @param {KeyboardEvent} event - Specifies keyboard event.\n         * @returns {void}\n         */\n        this.onKeyDownInternal = function (event) {\n            if (!isNullOrUndefined(event.target) && event.target !== _this.editableDiv) {\n                return;\n            }\n            _this.owner.focusIn();\n            var isHandled = false;\n            var keyEventArgs = { 'event': event, 'isHandled': false, source: _this.owner };\n            _this.owner.trigger(keyDownEvent, keyEventArgs);\n            if (keyEventArgs.isHandled) {\n                return;\n            }\n            var key = event.which || event.keyCode;\n            var ctrl = (event.ctrlKey || event.metaKey) ? true : ((key === 17) ? true : false); // ctrl detection       \n            var shift = event.shiftKey ? event.shiftKey : ((key === 16) ? true : false); // Shift Key detection        \n            var alt = event.altKey ? event.altKey : ((key === 18) ? true : false); // alt key detection\n            if (ctrl && !shift && !alt) {\n                switch (key) {\n                    case 80:\n                        event.preventDefault();\n                        _this.owner.print();\n                        isHandled = true;\n                        break;\n                    case 83:\n                        event.preventDefault();\n                        _this.owner.save(_this.owner.documentName === '' ? 'sample' : _this.owner.documentName, 'Sfdt');\n                        isHandled = true;\n                        break;\n                }\n            }\n            if (!isHandled && !isNullOrUndefined(_this.selection)) {\n                _this.selection.onKeyDownInternal(event, ctrl, shift, alt);\n            }\n            if (isHandled) {\n                event.preventDefault();\n            }\n            _this.timer = setTimeout(function () {\n                if (!_this.isScrollHandler && !isNullOrUndefined(_this.owner) && _this.owner.isSpellCheck) {\n                    _this.isScrollToSpellCheck = true;\n                    _this.owner.viewer.updateScrollBars();\n                }\n            }, 100);\n        };\n        this.owner = owner;\n        this.pages = [];\n        this.lists = [];\n        this.abstractLists = [];\n        this.render = new Renderer(this);\n        this.characterFormat = new WCharacterFormat(this);\n        this.themeFontLanguage = new WCharacterFormat(this);\n        this.paragraphFormat = new WParagraphFormat(this);\n        this.renderedLists = new Dictionary();\n        this.renderedLevelOverrides = [];\n        this.headersFooters = [];\n        this.styles = new WStyles();\n        this.stylesMap = new Dictionary();\n        if (this.owner) {\n            this.L10n = new L10n('documenteditor', this.owner.defaultLocale);\n            this.L10n.setLocale(this.owner.locale);\n        }\n        this.preDefinedStyles = new Dictionary();\n        this.initalizeStyles();\n        this.bookmarks = new Dictionary();\n        this.editRanges = new Dictionary();\n        this.isIosDevice = typeof window !== 'undefined' ? /Mac|iPad|iPod/i.test(navigator.userAgent) : false;\n        this.isMobileDevice = typeof window !== 'undefined' ? /Android|Windows Phone|webOS/i.test(navigator.userAgent) : false;\n        this.formFillPopup = new FormFieldPopUp(this.owner);\n        this.customXmlData = new Dictionary();\n        this.fontSubstitutionTable = new Dictionary();\n        this.contentControlCollection = [];\n        this.footnoteCollection = [];\n        this.endnoteCollection = [];\n        this.themes = new Themes();\n        this.images = new Dictionary();\n    }\n    Object.defineProperty(DocumentHelper.prototype, \"visibleBounds\", {\n        /**\n         * Gets visible bounds.\n         *\n         * @private\n         * @returns {Rect} - Returns visible bounds.\n         */\n        get: function () {\n            return this.visibleBoundsIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentHelper.prototype, \"viewer\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.owner.viewer;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentHelper.prototype, \"containerCanvas\", {\n        //Document Protection Properties Ends\n        //#region Properties\n        /**\n         * Gets container canvas.\n         *\n         * @private\n         * @returns {HTMLCanvasElement} - Returns page canvas.\n         */\n        get: function () {\n            if (isNullOrUndefined(this.containerCanvasIn)) {\n                this.containerCanvasIn = document.createElement('canvas');\n                this.containerCanvasIn.getContext('2d').save();\n            }\n            if (!isNullOrUndefined(this.pageContainer)\n                && this.containerCanvasIn.parentElement !== this.pageContainer) {\n                this.pageContainer.appendChild(this.containerCanvasIn);\n            }\n            return this.containerCanvasIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     * @param {string} text - Specifies the text string.\n     */\n    DocumentHelper.prototype.openTextFile = function (text) {\n        this.layout.isTextFormat = true;\n        var arr = [];\n        text = text.replace(/\\r\\n/g, '\\n');\n        arr = text.split('\\n');\n        var widget = [];\n        var bodyWidget = new BodyWidget();\n        bodyWidget.sectionFormat = new WSectionFormat(bodyWidget);\n        bodyWidget.childWidgets = widget;\n        var paragraph1 = new ParagraphWidget();\n        var line1 = new LineWidget(paragraph1);\n        for (var i = 0; i < arr.length; i++) {\n            if (i === arr.length - 1 && arr[i].length === 0) {\n                paragraph1.childWidgets.push(line1);\n                paragraph1.containerWidget = bodyWidget;\n                bodyWidget.childWidgets.push(paragraph1);\n                continue;\n            }\n            var paragraph = new ParagraphWidget();\n            var line = new LineWidget(paragraph);\n            if (arr[i].length > 0) {\n                var singleLineLength = 90;\n                if (arr[i].length > singleLineLength) {\n                    var start = 0;\n                    var increment = singleLineLength;\n                    var split = void 0;\n                    var lineLength = (arr[i].length / singleLineLength) + 1;\n                    var count = 0;\n                    while (count < lineLength) {\n                        if (lineLength - 1 != count) {\n                            split = arr[i].substring(start, increment);\n                        }\n                        else {\n                            increment = arr[i].length % singleLineLength;\n                            split = arr[i].substring(start, increment);\n                        }\n                        var textElement = new TextElementBox();\n                        textElement.text = split;\n                        line.children.push(textElement);\n                        textElement.line = line;\n                        count++;\n                        increment += singleLineLength;\n                        start += singleLineLength;\n                    }\n                }\n                else {\n                    var textElement = new TextElementBox();\n                    textElement.text = arr[i];\n                    line.children.push(textElement);\n                    textElement.line = line;\n                }\n            }\n            paragraph.childWidgets.push(line);\n            paragraph.containerWidget = bodyWidget;\n            bodyWidget.childWidgets.push(paragraph);\n        }\n        this.onDocumentChanged([bodyWidget]);\n        this.layout.isTextFormat = false;\n    };\n    Object.defineProperty(DocumentHelper.prototype, \"selectionCanvas\", {\n        /**\n         * Gets selection canvas.\n         *\n         * @private\n         * @returns {HTMLCanvasElement} - Returns selection canvas.\n         */\n        get: function () {\n            if (isNullOrUndefined(this.selectionCanvasIn)) {\n                this.selectionCanvasIn = document.createElement('canvas');\n                this.selectionCanvas.getContext('2d').save();\n            }\n            if (!isNullOrUndefined(this.pageContainer)\n                && this.selectionCanvasIn.parentElement !== this.pageContainer) {\n                this.pageContainer.appendChild(this.selectionCanvasIn);\n            }\n            return this.selectionCanvasIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentHelper.prototype, \"containerContext\", {\n        /**\n         * Gets container context.\n         *\n         * @private\n         * @returns {CanvasRenderingContext2D} - Returns page canvas context.\n         */\n        get: function () {\n            return this.containerCanvas.getContext('2d');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentHelper.prototype, \"selectionContext\", {\n        /**\n         * Gets selection context.\n         *\n         * @private\n         * @returns {CanvasRenderingContext2D} - Returns selection canvas context.\n         */\n        get: function () {\n            return this.selectionCanvas.getContext('2d');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentHelper.prototype, \"currentRenderingPage\", {\n        /**\n         * Gets the current rendering page.\n         *\n         * @returns {Page} - Returns current rendering page.\n         */\n        get: function () {\n            if (this.pages.length === 0) {\n                return undefined;\n            }\n            return this.pages[this.pages.length - 1];\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentHelper.prototype, \"zoomFactor\", {\n        /**\n         * Gets or sets zoom factor.\n         *\n         * @private\n         * @returns {number} - Returns zoom factor value.\n         */\n        get: function () {\n            return this.zoomFactorInternal;\n        },\n        set: function (value) {\n            if (this.zoomFactorInternal !== value) {\n                this.preZoomFactor = this.zoomFactor;\n                this.zoomFactorInternal = value;\n                this.zoomModule.setZoomFactor();\n                this.owner.zoomFactor = value;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentHelper.prototype, \"selection\", {\n        /**\n         * Gets the selection.\n         *\n         * @private\n         * @returns {Selection} - Returns selection module.\n         */\n        get: function () {\n            return this.owner.selectionModule;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentHelper.prototype, \"selectionStartPage\", {\n        /**\n         * Gets or sets selection start page.\n         *\n         * @private\n         * @returns {Page} - Return selection start page.\n         */\n        get: function () {\n            return this.selectionStartPageIn;\n        },\n        set: function (value) {\n            this.selectionStartPageIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentHelper.prototype, \"selectionEndPage\", {\n        /**\n         * Gets or sets selection end page.\n         *\n         * @private\n         * @returns {Page} - Return selection end page.\n         */\n        get: function () {\n            return this.selectionEndPageIn;\n        },\n        set: function (value) {\n            this.selectionEndPageIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentHelper.prototype, \"dialog\", {\n        /**\n         * Gets the initialized default dialog.\n         *\n         * @private\n         * @returns {Dialog} - Returns dialog instance.\n         */\n        get: function () {\n            if (!this.dialogInternal) {\n                this.initDialog(this.owner.enableRtl);\n            }\n            return this.dialogInternal;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentHelper.prototype, \"dialog2\", {\n        /**\n         * Gets the initialized default dialog.\n         *\n         * @private\n         * @returns {Dialog} - Returns dialog instance.\n         */\n        get: function () {\n            if (!this.dialogInternal2) {\n                this.initDialog2(this.owner.enableRtl);\n            }\n            return this.dialogInternal2;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentHelper.prototype, \"dialog3\", {\n        /**\n         * Gets the initialized default dialog.\n         *\n         * @private\n         * @returns {Dialog} - Returns dialog instance.\n         */\n        get: function () {\n            if (!this.dialogInternal3) {\n                this.initDialog3(this.owner.enableRtl);\n            }\n            return this.dialogInternal3;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentHelper.prototype, \"currentSelectedComment\", {\n        /**\n         * @private\n         * @returns {void}\n         */\n        get: function () {\n            return this.currentSelectedCommentInternal;\n        },\n        set: function (value) {\n            if (this.owner && this.owner.commentReviewPane) {\n                this.owner.commentReviewPane.previousSelectedComment = this.currentSelectedCommentInternal;\n            }\n            this.currentSelectedCommentInternal = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentHelper.prototype, \"currentSelectedRevision\", {\n        /**\n         * @private\n         * @returns {void}\n         */\n        get: function () {\n            return this.currentSelectedRevisionInternal;\n        },\n        set: function (value) {\n            // if (this.owner && this.owner.commentReviewPane) {\n            //     this.owner.commentReviewPane.previousSelectedComment = this.currentSelectedCommentInternal;\n            // }\n            this.currentSelectedRevisionInternal = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentHelper.prototype, \"isInlineFormFillProtectedMode\", {\n        /**\n         * @private\n         * @returns {void}\n         */\n        get: function () {\n            return this.isFormFillProtectedMode && this.owner.documentEditorSettings.formFieldSettings.formFillingMode === 'Inline';\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentHelper.prototype, \"isFormFillProtectedMode\", {\n        /**\n         * @private\n         * @returns {void}\n         */\n        get: function () {\n            return this.isDocumentProtected && this.protectionType === 'FormFieldsOnly';\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentHelper.prototype, \"isCommentOnlyMode\", {\n        /**\n         * @private\n         * @returns {Boolean}\n         */\n        get: function () {\n            return this.isDocumentProtected && this.protectionType === 'CommentsOnly';\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentHelper.prototype, \"isTrackedOnlyMode\", {\n        get: function () {\n            return this.isDocumentProtected && this.protectionType === 'RevisionsOnly';\n        },\n        enumerable: true,\n        configurable: true\n    });\n    DocumentHelper.prototype.initalizeStyles = function () {\n        this.preDefinedStyles.add('Normal', '{\"type\":\"Paragraph\",\"name\":\"Normal\",\"next\":\"Normal\"}');\n        this.preDefinedStyles.add('Heading 1', '{\"type\":\"Paragraph\",\"name\":\"Heading 1\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"link\":\"Heading 1 Char\",\"characterFormat\":{\"fontSize\":16.0,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"},\"paragraphFormat\":{\"leftIndent\":0.0,\"rightIndent\":0.0,\"firstLineIndent\":0.0,\"beforeSpacing\":12.0,\"afterSpacing\":0.0,\"lineSpacing\":1.0791666507720947,\"lineSpacingType\":\"Multiple\",\"textAlignment\":\"Left\",\"outlineLevel\":\"Level1\"}}');\n        this.preDefinedStyles.add('Heading 2', '{\"type\":\"Paragraph\",\"name\":\"Heading 2\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"link\":\"Heading 2 Char\",\"characterFormat\":{\"fontSize\":13.0,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"},\"paragraphFormat\":{\"leftIndent\":0.0,\"rightIndent\":0.0,\"firstLineIndent\":0.0,\"beforeSpacing\":2.0,\"afterSpacing\":0.0,\"lineSpacing\":1.0791666507720947,\"lineSpacingType\":\"Multiple\",\"textAlignment\":\"Left\",\"outlineLevel\":\"Level2\"}}');\n        this.preDefinedStyles.add('Heading 3', '{\"type\":\"Paragraph\",\"name\":\"Heading 3\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"link\":\"Heading 3 Char\",\"characterFormat\":{\"fontSize\":12.0,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#1F3763\"},\"paragraphFormat\":{\"leftIndent\":0.0,\"rightIndent\":0.0,\"firstLineIndent\":0.0,\"beforeSpacing\":2.0,\"afterSpacing\":0.0,\"lineSpacing\":1.0791666507720947,\"lineSpacingType\":\"Multiple\",\"textAlignment\":\"Left\",\"outlineLevel\":\"Level3\"}}');\n        this.preDefinedStyles.add('Heading 4', '{\"type\":\"Paragraph\",\"name\":\"Heading 4\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"link\":\"Heading 4 Char\",\"characterFormat\":{\"italic\":true,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"},\"paragraphFormat\":{\"leftIndent\":0.0,\"rightIndent\":0.0,\"firstLineIndent\":0.0,\"beforeSpacing\":2.0,\"afterSpacing\":0.0,\"lineSpacing\":1.0791666507720947,\"lineSpacingType\":\"Multiple\",\"textAlignment\":\"Left\",\"outlineLevel\":\"Level4\"}}');\n        this.preDefinedStyles.add('Heading 5', '{\"type\":\"Paragraph\",\"name\":\"Heading 5\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"link\":\"Heading 5 Char\",\"characterFormat\":{\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"},\"paragraphFormat\":{\"leftIndent\":0.0,\"rightIndent\":0.0,\"firstLineIndent\":0.0,\"beforeSpacing\":2.0,\"afterSpacing\":0.0,\"lineSpacing\":1.0791666507720947,\"lineSpacingType\":\"Multiple\",\"textAlignment\":\"Left\",\"outlineLevel\":\"Level5\"}}');\n        this.preDefinedStyles.add('Heading 6', '{\"type\":\"Paragraph\",\"name\":\"Heading 6\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"link\":\"Heading 6 Char\",\"characterFormat\":{\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#1F3763\"},\"paragraphFormat\":{\"leftIndent\":0.0,\"rightIndent\":0.0,\"firstLineIndent\":0.0,\"beforeSpacing\":2.0,\"afterSpacing\":0.0,\"lineSpacing\":1.0791666507720947,\"lineSpacingType\":\"Multiple\",\"textAlignment\":\"Left\",\"outlineLevel\":\"Level6\"}}');\n        this.preDefinedStyles.add('Heading 7', '{\"type\":\"Paragraph\",\"name\":\"Heading 7\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"link\":\"Heading 7 Char\",\"characterFormat\":{\"italic\":true,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#1F3763\"},\"paragraphFormat\":{\"leftIndent\":0.0,\"rightIndent\":0.0,\"firstLineIndent\":0.0,\"beforeSpacing\":2.0,\"afterSpacing\":0.0,\"lineSpacing\":1.0791666507720947,\"lineSpacingType\":\"Multiple\",\"textAlignment\":\"Left\",\"outlineLevel\":\"Level7\"}}');\n        this.preDefinedStyles.add('Heading 8', '{\"type\":\"Paragraph\",\"name\":\"Heading 8\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"link\":\"Heading 8 Char\",\"characterFormat\":{\"fontSize\":10.5,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#333333\"},\"paragraphFormat\":{\"leftIndent\":0.0,\"rightIndent\":0.0,\"firstLineIndent\":0.0,\"beforeSpacing\":2.0,\"afterSpacing\":0.0,\"lineSpacing\":1.0791666507720947,\"lineSpacingType\":\"Multiple\",\"textAlignment\":\"Left\",\"outlineLevel\":\"Level8\"}}');\n        this.preDefinedStyles.add('Heading 9', '{\"type\":\"Paragraph\",\"name\":\"Heading 9\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"link\":\"Heading 9 Char\",\"characterFormat\":{\"fontSize\":10.5,\"italic\":true,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#333333\"},\"paragraphFormat\":{\"leftIndent\":0.0,\"rightIndent\":0.0,\"firstLineIndent\":0.0,\"beforeSpacing\":2.0,\"afterSpacing\":0.0,\"lineSpacing\":1.0791666507720947,\"lineSpacingType\":\"Multiple\",\"textAlignment\":\"Left\",\"outlineLevel\":\"Level9\"}}');\n        this.preDefinedStyles.add('Default Paragraph Font', '{\"type\":\"Character\",\"name\":\"Default Paragraph Font\"}');\n        this.preDefinedStyles.add('Heading 1 Char', '{\"type\":\"Character\",\"name\":\"Heading 1 Char\",\"basedOn\":\"Default Paragraph Font\",\"characterFormat\":{\"fontSize\":16.0,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"}}');\n        this.preDefinedStyles.add('Heading 2 Char', '{\"type\":\"Character\",\"name\":\"Heading 2 Char\",\"basedOn\":\"Default Paragraph Font\",\"characterFormat\":{\"fontSize\":13.0,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"}}');\n        this.preDefinedStyles.add('Heading 3 Char', '{\"type\":\"Character\",\"name\":\"Heading 3 Char\",\"basedOn\":\"Default Paragraph Font\",\"characterFormat\":{\"fontSize\":12.0,\"fontFamily\":\"Calibri Light\",\"fontColor\": \"#1F3763\"}}');\n        this.preDefinedStyles.add('Heading 4 Char', '{\"type\":\"Character\",\"name\":\"Heading 4 Char\",\"basedOn\":\"Default Paragraph Font\",\"characterFormat\":{\"italic\":true,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"}}');\n        this.preDefinedStyles.add('Heading 5 Char', '{\"type\":\"Character\",\"name\":\"Heading 5 Char\",\"basedOn\":\"Default Paragraph Font\",\"characterFormat\":{\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"}}');\n        this.preDefinedStyles.add('Heading 6 Char', '{\"type\":\"Character\",\"name\":\"Heading 6 Char\",\"basedOn\":\"Default Paragraph Font\",\"characterFormat\":{\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#1F3763\"}}');\n        this.preDefinedStyles.add('Heading 7 Char', '{\"type\":\"Character\",\"name\":\"Heading 7 Char\",\"basedOn\":\"Default Paragraph Font\",\"characterFormat\":{\"italic\":true,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#1F3763\"}}');\n        this.preDefinedStyles.add('Heading 8 Char', '{\"type\":\"Character\",\"name\":\"Heading 8 Char\",\"basedOn\":\"Default Paragraph Font\",\"characterFormat\":{\"fontSize\":10.5,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#333333\"}}');\n        this.preDefinedStyles.add('Heading 9 Char', '{\"type\":\"Character\",\"name\":\"Heading 9 Char\",\"basedOn\":\"Default Paragraph Font\",\"characterFormat\":{\"fontSize\":10.5,\"italic\":true,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#333333\"}}');\n        this.preDefinedStyles.add('Hyperlink', '{\"type\":\"Character\",\"name\":\"Hyperlink\",\"basedOn\":\"Default Paragraph Font\",\"next\":\"Normal\",\"characterFormat\":{\"fontColor\":\"#0563C1\",\"underline\": \"Single\"}}');\n        this.preDefinedStyles.add('TOC 1', '{\"type\":\"Paragraph\",\"name\":\"TOC 1\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"afterSpacing\":5.0}}');\n        this.preDefinedStyles.add('TOC 2', '{\"type\":\"Paragraph\",\"name\":\"TOC 2\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :11.0,\"afterSpacing\":5.0}}');\n        this.preDefinedStyles.add('TOC 3', '{\"type\":\"Paragraph\",\"name\":\"TOC 3\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :22.0,\"afterSpacing\":5.0}}');\n        this.preDefinedStyles.add('TOC 4', '{\"type\":\"Paragraph\",\"name\":\"TOC 4\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :33.0,\"afterSpacing\":5.0}}');\n        this.preDefinedStyles.add('TOC 5', '{\"type\":\"Paragraph\",\"name\":\"TOC 5\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :44.0,\"afterSpacing\":5.0}}');\n        this.preDefinedStyles.add('TOC 6', '{\"type\":\"Paragraph\",\"name\":\"TOC 6\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :55.0,\"afterSpacing\":5.0}}');\n        this.preDefinedStyles.add('TOC 7', '{\"type\":\"Paragraph\",\"name\":\"TOC 7\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :66.0,\"afterSpacing\":5.0}}');\n        this.preDefinedStyles.add('TOC 8', '{\"type\":\"Paragraph\",\"name\":\"TOC 8\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :77.0,\"afterSpacing\":5.0}}');\n        this.preDefinedStyles.add('TOC 9', '{\"type\":\"Paragraph\",\"name\":\"TOC 9\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :88.0,\"afterSpacing\":5.0}}');\n        this.preDefinedStyles.add('Header', '{\"type\":\"Paragraph\",\"name\":\"Header\",\"basedOn\":\"Normal\",\"next\":\"Header\",\"paragraphFormat\":{\"afterSpacing\":0,\"lineSpacing\":1,\"lineSpacingType\":\"Multiple\"}}');\n        this.preDefinedStyles.add('Footer', '{\"type\":\"Paragraph\",\"name\":\"Footer\",\"basedOn\":\"Normal\",\"next\":\"Footer\",\"paragraphFormat\":{\"afterSpacing\":0,\"lineSpacing\":1,\"lineSpacingType\":\"Multiple\"}}');\n    };\n    /**\n     * @private\n     * @returns {void}\n     */\n    DocumentHelper.prototype.clearDocumentItems = function () {\n        if (this.owner.editorModule) {\n            this.owner.editorModule.clear();\n        }\n        if (this.owner.searchModule) {\n            this.owner.searchModule.clearSearchHighlight();\n        }\n        if (this.owner.selectionModule) {\n            this.owner.selectionModule.clear();\n        }\n        this.editRanges.clear();\n        this.headersFooters = [];\n        this.fields = [];\n        this.formFields = [];\n        this.currentSelectedComment = undefined;\n        this.currentSelectedRevision = undefined;\n        for (var i = 0; i < this.comments.length; i++) {\n            var commentStart = this.comments[i].commentStart;\n            if (commentStart) {\n                commentStart.destroy();\n            }\n        }\n        this.comments = [];\n        this.bookmarks.clear();\n        this.endBookmarksUpdated = [];\n        this.styles.clear();\n        this.stylesMap.clear();\n        if (this.pages && this.pages.length > 0) {\n            for (var i = 0; i < this.pages.length; i++) {\n                var page = this.pages[i];\n                page.componentDestroy();\n            }\n            this.pages = [];\n        }\n        this.authors.clear();\n        this.revisionsInternal.clear();\n        this.owner.revisions.clear();\n        this.characterFormat.clearFormat();\n        this.themeFontLanguage.clearFormat();\n        this.paragraphFormat.clearFormat();\n        if (this.owner.trackChangesPane) {\n            this.owner.trackChangesPane.clear();\n        }\n        this.setDefaultCharacterValue(this.characterFormat);\n        this.setDefaultParagraphValue(this.paragraphFormat);\n        if (this.owner.commentReviewPane) {\n            this.owner.commentReviewPane.clear();\n        }\n        this.isHeaderFooter = false;\n        this.defaultTabWidth = 36;\n        this.isDocumentProtected = false;\n        this.protectionType = 'NoProtection';\n        this.restrictFormatting = false;\n        this.hashValue = '';\n        this.saltValue = '';\n        this.userCollection = [];\n        if (this.formFillPopup) {\n            this.formFillPopup.hidePopup();\n        }\n        this.customXmlData.clear();\n        this.fontSubstitutionTable.clear();\n        this.images.clear();\n        this.contentControlCollection = [];\n        this.backgroundColor = '#FFFFFF';\n        this.endnotes.clear();\n        this.footnotes.clear();\n        this.footnoteCollection = [];\n        this.endnoteCollection = [];\n        if (this.lists && this.lists.length > 0) {\n            for (var i = 0; i < this.lists.length; i++) {\n                var list = this.lists[i];\n                list.clear();\n            }\n        }\n        this.lists = [];\n        this.abstractLists = [];\n        this.themes = new Themes();\n        this.hasThemes = false;\n        this.isRestartNumbering = false;\n    };\n    /**\n     * @private\n     * @returns {void}\n     */\n    DocumentHelper.prototype.setDefaultDocumentFormat = function () {\n        this.owner.parser.parseCharacterFormat(0, this.owner.characterFormat, this.characterFormat);\n        this.owner.parser.parseParagraphFormat(0, this.owner.paragraphFormat, this.paragraphFormat);\n    };\n    DocumentHelper.prototype.setDefaultCharacterValue = function (characterFormat) {\n        characterFormat.bold = false;\n        characterFormat.italic = false;\n        characterFormat.fontFamily = 'Calibri';\n        characterFormat.fontSize = 11;\n        characterFormat.underline = 'None';\n        characterFormat.strikethrough = 'None';\n        characterFormat.fontSizeBidi = 11;\n        characterFormat.fontFamilyBidi = 'Calibri';\n        characterFormat.baselineAlignment = 'Normal';\n        characterFormat.highlightColor = 'NoColor';\n        characterFormat.allCaps = false;\n    };\n    DocumentHelper.prototype.setDefaultParagraphValue = function (paragraphFormat) {\n        paragraphFormat.leftIndent = 0;\n        paragraphFormat.rightIndent = 0;\n        paragraphFormat.firstLineIndent = 0;\n        paragraphFormat.textAlignment = 'Left';\n        paragraphFormat.beforeSpacing = 0;\n        paragraphFormat.afterSpacing = 0;\n        paragraphFormat.lineSpacing = 1;\n        paragraphFormat.lineSpacingType = 'Multiple';\n        paragraphFormat.bidi = false;\n        paragraphFormat.keepWithNext = false;\n        paragraphFormat.keepLinesTogether = false;\n        paragraphFormat.widowControl = true;\n        paragraphFormat.outlineLevel = 'BodyText';\n    };\n    /**\n     * @private\n     * @param {number} id - Specfies abstract list id.\n     * @returns {WAbstractList} - Returns abstract list.\n     */\n    DocumentHelper.prototype.getAbstractListById = function (id, isNsid) {\n        if (isNullOrUndefined(this.abstractLists)) {\n            return undefined;\n        }\n        for (var i = 0; i < this.abstractLists.length; i++) {\n            var abstractList = this.abstractLists[i];\n            if (!isNullOrUndefined(abstractList)) {\n                if (isNsid && abstractList.nsid === id) {\n                    return abstractList;\n                }\n                else if (abstractList.abstractListId === id) {\n                    return abstractList;\n                }\n            }\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     * @param {number} id - Specfies list id.\n     * @returns {WAbstractList} - Returns list.\n     */\n    DocumentHelper.prototype.getListById = function (id, isNsid) {\n        if (isNullOrUndefined(this.lists)) {\n            return undefined;\n        }\n        for (var i = 0; i < this.lists.length; i++) {\n            var list = this.lists[i];\n            if (!isNullOrUndefined(list)) {\n                if (isNsid && list.nsid === id) {\n                    return list;\n                }\n                else if (list.listId === id) {\n                    return list;\n                }\n            }\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     * @param {WListLevel} listLevel - Specfies list level.\n     * @returns {number} - Returns list level number.\n     */\n    DocumentHelper.getListLevelNumber = function (listLevel) {\n        if (listLevel.ownerBase instanceof WLevelOverride) {\n            return listLevel.ownerBase.levelNumber;\n        }\n        else if (listLevel.ownerBase instanceof WAbstractList && !isNullOrUndefined(listLevel.ownerBase.levels)) {\n            return listLevel.ownerBase.levels.indexOf(listLevel);\n        }\n        else {\n            return -1;\n        }\n    };\n    /**\n    * @private\n    * @param {ImageElementBox} image - Specfies image.\n    * @returns {number} - Returns base64string.\n    */\n    DocumentHelper.prototype.getImageString = function (image) {\n        var base64ImageString = this.images.get(parseInt(image.imageString));\n        var imageStr;\n        if (image.isMetaFile && HelperMethods.formatClippedString(base64ImageString[0]).extension !== \".svg\") {\n            imageStr = base64ImageString[1];\n        }\n        else if (HelperMethods.formatClippedString(base64ImageString[0]).extension === \".tif\") {\n            imageStr = base64ImageString[1];\n        }\n        else {\n            imageStr = base64ImageString[0];\n        }\n        return imageStr;\n    };\n    /**\n     * @private\n     * @param {ImageElementBox} image - Specfies image.\n     * @returns {number} - Returns key for specific image.\n     */\n    DocumentHelper.prototype.addBase64StringInCollection = function (image) {\n        return __awaiter(this, void 0, void 0, function () {\n            var key, addToCollection, base64ImageString, i, index, imageStringCol;\n            return __generator(this, function (_a) {\n                key = this.images.length;\n                addToCollection = true;\n                base64ImageString = [];\n                for (i = 0; i < this.images.length; i++) {\n                    index = this.images.keys[parseInt(i.toString(), 10)];\n                    imageStringCol = this.images.get(index);\n                    if (image.isMetaFile && image.metaFileImageString === imageStringCol[0]) {\n                        key = index;\n                        addToCollection = false;\n                        break;\n                    }\n                    else if (image.imageString === imageStringCol[0]) {\n                        key = index;\n                        addToCollection = false;\n                        break;\n                    }\n                }\n                if (addToCollection) {\n                    if (image.isMetaFile) {\n                        base64ImageString.push(image.metaFileImageString);\n                        base64ImageString.push(image.imageString === \"\" ? image.metaFileImageString : image.imageString);\n                    }\n                    else {\n                        base64ImageString.push(image.imageString);\n                    }\n                    this.images.add(this.images.length, base64ImageString);\n                }\n                if (image.isMetaFile) {\n                    image.metaFileImageString = key.toString();\n                }\n                image.imageString = key.toString();\n                return [2 /*return*/];\n            });\n        });\n    };\n    /**\n     * Gets the bookmarks.\n     *\n     * @private\n     * @param {boolean} includeHidden - Include hidden bookmark.\n     * @returns {string[]} - Returns bookmars present in current document.\n     */\n    DocumentHelper.prototype.getBookmarks = function (includeHidden) {\n        var bookmarks = [];\n        for (var i = 0; i < this.bookmarks.keys.length; i++) {\n            var bookmark = this.bookmarks.keys[i];\n            if (includeHidden || bookmark.indexOf('_') !== 0) {\n                bookmarks.push(bookmark);\n            }\n        }\n        return bookmarks;\n    };\n    DocumentHelper.prototype.selectComment = function (comment) {\n        var _this = this;\n        if (this.owner.selectionModule && this.owner.commentReviewPane) {\n            this.owner.showComments = true;\n            setTimeout(function () {\n                if (_this.owner && _this.owner.selectionModule) {\n                    _this.owner.selectionModule.selectComment(comment);\n                }\n            });\n        }\n    };\n    DocumentHelper.prototype.showComments = function (show) {\n        if (this.owner && show && this.owner.enableComment) {\n            var eventArgs = { type: 'Comment' };\n            this.owner.trigger(beforePaneSwitchEvent, eventArgs);\n        }\n        this.owner.commentReviewPane.reviewTab.hideTab(0, false);\n        this.owner.commentReviewPane.reviewTab.hideTab(1, false);\n        this.owner.commentReviewPane.showHidePane(show && this.owner.enableComment, 'Comments');\n    };\n    DocumentHelper.prototype.showRevisions = function (show) {\n        var isCommentTabVisible = false;\n        this.showRevision = show;\n        if (this.owner && show) {\n            var eventArgs = { type: 'comment' };\n            this.owner.trigger(beforePaneSwitchEvent, eventArgs);\n        }\n        if (!show && this.owner.showComments) {\n            this.owner.commentReviewPane.reviewTab.hideTab(0, false);\n            this.owner.commentReviewPane.showHidePane(true, 'Comments');\n        }\n        else {\n            this.owner.commentReviewPane.showHidePane(show, 'Changes');\n            if (!this.owner.enableComment) {\n                isCommentTabVisible = true;\n            }\n            // this.owner.commentReviewPane.reviewTab.hideTab(0, isCommentTabVisible);\n            this.showRevision = false;\n        }\n        if (show) {\n            this.owner.trackChangesPane.enableDisableButton(!this.owner.isReadOnly && !this.isDocumentProtected);\n        }\n    };\n    /**\n     * Initializes components.\n     *\n     * @private\n     * @returns {void}\n     */\n    DocumentHelper.prototype.initializeComponents = function () {\n        var element = this.owner.element;\n        if (isNullOrUndefined(element)) {\n            return;\n        }\n        //let viewer: LayoutViewer = this;\n        this.optionsPaneContainer = createElement('div', {\n            className: 'e-documenteditor-optionspane'\n        });\n        this.optionsPaneContainer.contentEditable = 'false';\n        element.appendChild(this.optionsPaneContainer);\n        var isRtl = this.owner.enableRtl;\n        var viewerContainerStyle;\n        if (isRtl) {\n            viewerContainerStyle = 'direction:ltr;';\n        }\n        this.viewerContainer = createElement('div', { id: this.owner.containerId + '_viewerContainer' });\n        this.viewerContainer.style.cssText = 'position:relative;backgroundColor:#FBFBFB;overflow:auto;' + viewerContainerStyle;\n        this.optionsPaneContainer.appendChild(this.viewerContainer);\n        this.viewerContainer.tabIndex = -1;\n        this.viewerContainer.style.outline = 'none';\n        this.pageContainer = createElement('div', { id: this.owner.containerId + '_pageContainer', className: 'e-de-background' });\n        this.viewerContainer.appendChild(this.pageContainer);\n        this.pageContainer.style.top = '0px';\n        this.pageContainer.style.left = '0px';\n        this.pageContainer.style.position = 'relative';\n        this.pageContainer.style.pointerEvents = 'none';\n        if (Browser.isDevice) {\n            this.createEditableDiv(element);\n        }\n        else {\n            this.createEditableIFrame();\n        }\n        if (this.owner.enableImageResizerMode) {\n            this.owner.imageResizerModule.initializeImageResizer();\n        }\n        this.updateViewerSizeInternal(element);\n        this.layout = new Layout(this);\n        this.textHelper = new TextHelper(this);\n        this.zoomModule = new Zoom(this);\n        this.initTouchEllipse();\n        this.wireEvent();\n        this.restrictEditingPane = new RestrictEditing(this);\n        this.owner.commentReviewPane = new CommentReviewPane(this.owner);\n        this.owner.trackChangesPane = new TrackChangesPane(this.owner, this.owner.commentReviewPane);\n        createSpinner({ target: this.owner.element, cssClass: 'e-spin-overlay' });\n    };\n    DocumentHelper.prototype.measureScrollbarWidth = function (element) {\n        var parentDiv = document.createElement('div');\n        parentDiv.setAttribute('style', 'visibility:hidden;overflow:scroll');\n        element.appendChild(parentDiv);\n        var childDiv = document.createElement('div');\n        parentDiv.appendChild(childDiv);\n        this.scrollbarWidth = (parentDiv.getBoundingClientRect().width - childDiv.getBoundingClientRect().width);\n        parentDiv.parentNode.removeChild(parentDiv);\n    };\n    DocumentHelper.prototype.createEditableDiv = function (element) {\n        this.editableDiv = document.createElement('div');\n        this.editableDiv.contentEditable = this.owner.isReadOnlyMode ? 'false' : 'true';\n        this.editableDiv.style.position = 'fixed';\n        this.editableDiv.style.left = '-150em';\n        this.editableDiv.style.width = '100%';\n        this.editableDiv.style.height = '100%';\n        this.editableDiv.id = element.id + '_editableDiv';\n        document.body.appendChild(this.editableDiv);\n    };\n    DocumentHelper.prototype.createEditableIFrame = function () {\n        this.iframe = createElement('iframe', {\n            attrs: {\n                'scrolling': 'no',\n                'title': 'Document Editor',\n                'style': 'pointer-events:none;position:absolute;left:0px;top:0px;outline:none;background-color:transparent;width:0px;height:0px;overflow:hidden',\n                'tabindex': \"0\"\n            },\n            className: 'e-de-text-target'\n        });\n        this.viewerContainer.appendChild(this.iframe);\n        this.initIframeContent();\n    };\n    DocumentHelper.prototype.initIframeContent = function () {\n        var style = 'background-color:transparent;width:100%;height:100%;padding: 0px; margin: 0px;';\n        var innerHtml = '<!DOCTYPE html>'\n            + '<html lang=\"' + this.owner.locale + '\"><head></head>'\n            + '<body spellcheck=\"false\" style=' + style + ' >'\n            + '<div contenteditable=\"true\" style=' + style + '></div>'\n            + '</body>'\n            + '</html>';\n        if (!isNullOrUndefined(this.iframe.contentDocument)) {\n            this.iframe.contentDocument.open();\n            this.iframe.contentDocument.write(innerHtml);\n            this.iframe.contentDocument.close();\n            this.editableDiv = this.iframe.contentDocument.body.children[0];\n        }\n    };\n    /**\n     * Wires events and methods.\n     *\n     * @returns {void}\n     */\n    DocumentHelper.prototype.wireEvent = function () {\n        if (!isNullOrUndefined(this.owner.selectionModule)) {\n            this.selection.initCaret();\n        }\n        this.wireInputEvents();\n        if (!isNullOrUndefined(this.iframe)) {\n            this.iframe.addEventListener('load', this.onIframeLoad.bind(this));\n        }\n        this.viewerContainer.addEventListener('scroll', this.scrollHandler);\n        this.viewerContainer.addEventListener('mousedown', this.onMouseDownInternal);\n        this.viewerContainer.addEventListener('keydown', this.onKeyDownInternal);\n        this.viewerContainer.addEventListener('mousemove', this.onMouseMoveInternal);\n        this.viewerContainer.addEventListener('mouseleave', this.onMouseLeaveInternal);\n        this.viewerContainer.addEventListener('mouseenter', this.onMouseEnterInternal);\n        this.viewerContainer.addEventListener('contextmenu', this.onContextMenu);\n        this.viewerContainer.addEventListener('dblclick', this.onDoubleTap);\n        this.viewerContainer.addEventListener('mouseup', this.onMouseUpInternal);\n        window.addEventListener('resize', this.onWindowResize);\n        window.addEventListener('keyup', this.onKeyUpInternal);\n        window.addEventListener('mouseup', this.onImageResizer);\n        window.addEventListener('touchend', this.onImageResizer);\n        this.viewerContainer.addEventListener('touchstart', this.onTouchStartInternal);\n        this.viewerContainer.addEventListener('touchmove', this.onTouchMoveInternal);\n        this.viewerContainer.addEventListener('touchend', this.onTouchUpInternal);\n        if (navigator !== undefined && navigator.userAgent.match('Firefox')) {\n            this.viewerContainer.addEventListener('DOMMouseScroll', this.zoomModule.onMouseWheelInternal);\n        }\n        this.viewerContainer.addEventListener('mousewheel', this.zoomModule.onMouseWheelInternal);\n        this.editableDiv.addEventListener('focus', this.updateFocus);\n    };\n    DocumentHelper.prototype.wireInputEvents = function () {\n        if (isNullOrUndefined(this.editableDiv)) {\n            return;\n        }\n        this.editableDiv.addEventListener('paste', this.onPaste);\n        if (!Browser.isDevice) {\n            this.editableDiv.addEventListener('keypress', this.onKeyPressInternal);\n            if (Browser.info.name === 'chrome') {\n                this.editableDiv.addEventListener('textInput', this.onTextInput);\n            }\n        }\n        else {\n            this.editableDiv.addEventListener('input', this.onTextInputInternal);\n        }\n        this.editableDiv.addEventListener('blur', this.onFocusOut);\n        this.editableDiv.addEventListener('keydown', this.onKeyDownInternal);\n        this.editableDiv.addEventListener('compositionstart', this.compositionStart);\n        this.editableDiv.addEventListener('compositionupdate', this.compositionUpdated);\n        this.editableDiv.addEventListener('compositionend', this.compositionEnd);\n    };\n    DocumentHelper.prototype.onIframeLoad = function () {\n        if (!isNullOrUndefined(this.iframe) && this.iframe.contentDocument.body.children.length === 0) {\n            this.initIframeContent();\n            this.wireInputEvents();\n        }\n    };\n    DocumentHelper.prototype.getEditableDivTextContent = function () {\n        return this.editableDiv.textContent;\n    };\n    DocumentHelper.prototype.updateAuthorIdentity = function () {\n        var revisions = this.owner.revisions.changes;\n        for (var i = 0; i < revisions.length; i++) {\n            this.getAuthorColor(revisions[i].author);\n        }\n    };\n    DocumentHelper.prototype.getAvatar = function (userInfo, userName, comment, revision) {\n        var author;\n        var userinitial;\n        if (!isNullOrUndefined(comment)) {\n            author = comment.author;\n            userinitial = comment.initial;\n        }\n        else {\n            author = revision.author;\n        }\n        if (!isNullOrUndefined(author)) {\n            var avatarDiv = createElement('div', { className: 'e-de-cmt-avatar' });\n            var avatar = createElement('div', { className: 'e-de-ff-cmt-avatar' });\n            avatar.style.backgroundColor = this.owner.documentHelper.getAuthorColor(author);\n            if (userinitial === '' || isNullOrUndefined(userinitial)) {\n                var authorName = author.split(' ');\n                var initial = authorName[0].charAt(0);\n                if (authorName.length > 1 && authorName[authorName.length - 1] !== '') {\n                    initial += authorName[authorName.length - 1][0];\n                }\n                avatar.innerText = initial.toUpperCase();\n            }\n            else {\n                if (userinitial.length > 2) {\n                    avatar.innerText = userinitial.substring(0, 2);\n                }\n                else {\n                    avatar.innerText = userinitial;\n                }\n            }\n            avatarDiv.appendChild(avatar);\n            avatarDiv.appendChild(userName);\n            userInfo.appendChild(avatarDiv);\n        }\n    };\n    /**\n     * @private\n     * @param {string} author - Specifies author name.\n     * @returns {string} - Return autor color.\n     */\n    DocumentHelper.prototype.getAuthorColor = function (author) {\n        if (this.authors.containsKey(author)) {\n            return this.authors.get(author);\n        }\n        var color;\n        if (this.authors.length === 0) {\n            color = '#b5082e'; //dark red\n        }\n        else {\n            color = this.generateRandomColor();\n        }\n        this.authors.add(author, color);\n        return color;\n    };\n    DocumentHelper.prototype.generateRandomColor = function () {\n        var userColors = ['#b5082e',\n            '#2e97d3',\n            '#bb00ff',\n            '#f37e43',\n            '#03a60b',\n            '#881824',\n            '#e09a2b',\n            '#50565e']; //dark grey\n        return userColors[(this.authors.length % 8)];\n    };\n    /**\n     * @private\n     * @returns {void}\n     */\n    DocumentHelper.prototype.positionEditableTarget = function () {\n        var point = this.selection.getRect(this.selection.start);\n        var page = this.selection.getSelectionPage(this.selection.start);\n        // const caretInfo: CaretHeightInfo = this.selection.updateCaretSize(this.owner.selection.start);\n        var sectionFormat = page.bodyWidgets[0].sectionFormat;\n        var left = page.boundingRectangle.x + (HelperMethods.convertPointToPixel(sectionFormat.leftMargin) * this.zoomFactor);\n        var top = point.y;\n        var pageWidth = sectionFormat.pageWidth - sectionFormat.leftMargin - sectionFormat.rightMargin;\n        var iframeStyle = 'left:' + left + 'px;';\n        iframeStyle += 'top:' + top + 'px;';\n        iframeStyle += 'width:' + (HelperMethods.convertPointToPixel(pageWidth) * this.zoomFactor) + 'px;';\n        iframeStyle += 'height:250px;outline-style:none;position:absolute';\n        this.iframe.setAttribute('style', iframeStyle);\n        var style = 'background-color:transparent;width:100%;height:250px;padding: 0px; margin: 0px;';\n        style += 'text-indent:' + (point.x - left) + 'px;';\n        style += 'color:transparent;pointer-events:none;outline-style:none;';\n        style += 'font-size:' + (HelperMethods.convertPointToPixel(this.selection.characterFormat.fontSize) * this.zoomFactor) + 'px;';\n        style += 'font-family' + this.selection.characterFormat.fontFamily + ';';\n        style += 'overflow:hidden;text-decoration:none;white-space:normal;';\n        this.editableDiv.setAttribute('style', style);\n    };\n    DocumentHelper.prototype.initDialog = function (isRtl) {\n        if (!this.dialogInternal) {\n            this.dialogTarget1 = createElement('div', { className: 'e-de-dlg-target' });\n            this.dialogTarget1.contentEditable = 'false';\n            document.body.appendChild(this.dialogTarget1);\n            if (isRtl) {\n                this.dialogTarget1.classList.add('e-de-rtl');\n            }\n            this.dialogInternal = new Dialog({\n                target: this.owner.documentEditorSettings.popupTarget, showCloseIcon: true,\n                allowDragging: true, enableRtl: isRtl, visible: false,\n                width: '1px', isModal: true, position: { X: 'center', Y: 'center' }, zIndex: this.owner.zIndex + 20,\n                animationSettings: { effect: 'None' }\n            });\n            this.dialogInternal.isStringTemplate = true;\n            this.dialogInternal.open = this.selection.hideCaret;\n            this.dialogInternal.beforeClose = this.updateFocus;\n            this.dialogInternal.appendTo(this.dialogTarget1);\n        }\n    };\n    DocumentHelper.prototype.initDialog3 = function (isRtl) {\n        if (!this.dialogInternal3) {\n            this.dialogTarget3 = createElement('div', { className: 'e-de-dlg-target' });\n            this.dialogTarget3.contentEditable = 'false';\n            document.body.appendChild(this.dialogTarget3);\n            if (isRtl) {\n                this.dialogTarget3.classList.add('e-de-rtl');\n            }\n            this.dialogInternal3 = new Dialog({\n                target: this.owner.documentEditorSettings.popupTarget, showCloseIcon: true,\n                allowDragging: true, enableRtl: isRtl, visible: false,\n                width: '1px', isModal: true, position: { X: 'center', Y: 'center' }, zIndex: this.owner.zIndex,\n                animationSettings: { effect: 'None' }\n            });\n            this.dialogInternal3.isStringTemplate = true;\n            this.dialogInternal3.open = this.selection.hideCaret;\n            this.dialogInternal3.beforeClose = this.updateFocus;\n            this.dialogInternal3.appendTo(this.dialogTarget3);\n        }\n    };\n    DocumentHelper.prototype.hideDialog = function () {\n        this.dialog.hide();\n        this.updateFocus();\n    };\n    DocumentHelper.prototype.initDialog2 = function (isRtl) {\n        if (!this.dialogInternal2) {\n            this.dialogTarget2 = createElement('div', { className: 'e-de-dlg-target' });\n            this.dialogTarget2.contentEditable = 'false';\n            document.body.appendChild(this.dialogTarget2);\n            if (isRtl) {\n                this.dialogTarget2.classList.add('e-de-rtl');\n            }\n            this.dialogInternal2 = new Dialog({\n                target: this.owner.documentEditorSettings.popupTarget, showCloseIcon: true,\n                allowDragging: true, enableRtl: isRtl, visible: false,\n                width: '1px', isModal: true, position: { X: 'center', Y: 'Top' }, zIndex: this.owner.zIndex + 10\n            });\n            this.dialogInternal2.isStringTemplate = true;\n            this.dialogInternal2.appendTo(this.dialogTarget2);\n        }\n    };\n    DocumentHelper.prototype.getBase64 = function (base64String, width, height) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                return [2 /*return*/, new Promise(function (resolve, reject) {\n                        var imageString = '';\n                        var drawImage = new Image();\n                        drawImage.onload = function () {\n                            var displayPixelRatio = Math.max(1, window.devicePixelRatio || 1);\n                            var draw = document.createElement('canvas');\n                            draw.width = width * displayPixelRatio;\n                            draw.height = height * displayPixelRatio;\n                            var context = draw.getContext('2d');\n                            context.scale(displayPixelRatio, displayPixelRatio);\n                            context.drawImage(drawImage, 0, 0, width, height);\n                            imageString = draw.toDataURL('image/png', 1);\n                            resolve(imageString);\n                        };\n                        if (base64String && (HelperMethods.startsWith(base64String, 'http://') || HelperMethods.startsWith(base64String, 'https://'))) {\n                            fetch(base64String)\n                                .then(function (response) { return response.blob(); })\n                                .then(function (blob) {\n                                return new Promise(function (resolve, reject) {\n                                    var reader = new FileReader();\n                                    reader.onloadend = function () { return resolve(reader.result); };\n                                    reader.onerror = reject;\n                                    reader.readAsDataURL(blob);\n                                });\n                            })\n                                .then(function (dataUrl) {\n                                // The dataUrl will be a base64-encoded string\n                                drawImage.src = dataUrl;\n                                // console.log(base64String);\n                            });\n                        }\n                    })];\n            });\n        });\n    };\n    /**\n     * Clears the context.\n     *\n     * @private\n     * @returns {void}\n     */\n    DocumentHelper.prototype.clearContent = function () {\n        this.containerContext.clearRect(0, 0, this.containerCanvas.width, this.containerCanvas.height);\n        this.selectionContext.clearRect(0, 0, this.selectionCanvas.width, this.selectionCanvas.height);\n        // Hide comment mark\n        if (this.pageContainer) {\n            var commentMarkElement = this.pageContainer.getElementsByClassName('e-de-cmt-mark');\n            for (var i = 0; i < commentMarkElement.length; i++) {\n                commentMarkElement[i].style.display = 'none';\n            }\n        }\n        if (this.pageContainer) {\n            var editRangeStart = this.pageContainer.getElementsByClassName('e-de-lock-mark');\n            for (var i = 0; i < editRangeStart.length; i++) {\n                editRangeStart[i].style.display = 'none';\n            }\n        }\n    };\n    /**\n     * Fired when the document gets changed.\n     *\n     * @private\n     * @param {BodyWidget[]} sections - Specified document content.\n     * @returns {void}\n     */\n    DocumentHelper.prototype.onDocumentChanged = function (sections, iOps) {\n        var _this = this;\n        this.clearContent();\n        if (this.owner.editorModule) {\n            this.owner.editorModule.tocStyles = {};\n            this.owner.editorModule.tocBookmarkId = 0;\n        }\n        this.heightInfoCollection = {};\n        this.owner.isDocumentLoaded = false;\n        this.viewer.columnLayoutArea.clear();\n        this.layout.isDocumentContainsRtl = false;\n        this.layout.isMultiColumnDoc = false;\n        this.updateAuthorIdentity();\n        for (var i = 0; i < this.pages.length; i++) {\n            for (var j = 0; j < this.pages[i].bodyWidgets.length; j++) {\n                this.pages[i].bodyWidgets[j].destroy();\n            }\n        }\n        this.pages = [];\n        if (!isNullOrUndefined(this.renderedLists)) {\n            this.renderedLists.clear();\n        }\n        if (!isNullOrUndefined(this.renderedLevelOverrides)) {\n            this.renderedLevelOverrides = [];\n        }\n        if (!isNullOrUndefined(this.owner.editorHistoryModule)) {\n            this.owner.editorHistoryModule.destroy();\n        }\n        this.owner.isDocumentLoaded = true;\n        this.layout.isInitialLoad = true;\n        this.layout.footHeight = 0;\n        this.layout.footnoteHeight = 0;\n        this.layout.layoutItems(sections, false);\n        if (this.owner.selectionModule) {\n            this.selection.previousSelectedFormField = undefined;\n            if (this.formFields.length > 0) {\n                this.owner.selectionModule.highlightFormFields();\n            }\n            this.owner.selectionModule.editRangeCollection = [];\n            this.owner.selectionModule.selectRange(this.owner.documentStart, this.owner.documentStart);\n            if (this.isDocumentProtected && this.protectionType == 'FormFieldsOnly') {\n                this.owner.selectionModule.navigateToNextFormField();\n            }\n            if (this.isDocumentProtected) {\n                this.restrictEditingPane.showHideRestrictPane(true);\n            }\n        }\n        if (!isNullOrUndefined(iOps) && this.owner.editorModule) {\n            this.owner.editorModule.intializeDefaultStyles();\n        }\n        if (this.owner.enableCollaborativeEditing && this.owner.collaborativeEditingHandlerModule && this.owner.enableEditor) {\n            this.owner.editorModule.isRemoteAction = true;\n            this.owner.editorModule.isIncrementalSave = true;\n            if (iOps && !isNullOrUndefined(iOps[incrementalOps[0]])\n                && !isNullOrUndefined(iOps[incrementalOps[0]].length > 0)) {\n                for (var k = 0; k < iOps[incrementalOps[0]].length; k++) {\n                    this.owner.collaborativeEditingHandlerModule.applyRemoteAction('action', iOps[incrementalOps[0]][k]);\n                }\n            }\n            this.owner.editorModule.isRemoteAction = false;\n            this.owner.editorModule.isIncrementalSave = false;\n            this.owner.selectionModule.selectRange(this.owner.documentStart, this.owner.documentStart);\n        }\n        if (this.owner.optionsPaneModule) {\n            this.owner.optionsPaneModule.showHideOptionsPane(false);\n        }\n        if (this.restrictEditingPane.restrictPane && !this.isDocumentProtected) {\n            this.restrictEditingPane.showHideRestrictPane(false);\n        }\n        if (!isNullOrUndefined(this.owner.selectionModule) && this.owner.selectionModule.isViewPasteOptions) {\n            this.owner.selectionModule.isViewPasteOptions = false;\n            this.owner.selectionModule.showHidePasteOptions(undefined, undefined);\n        }\n        this.owner.fireDocumentChange();\n        this.owner.showHideRulers();\n        setTimeout(function () {\n            if (!isNullOrUndefined(_this.owner) && _this.owner.showRevisions) {\n                _this.showRevisions(true);\n            }\n        });\n    };\n    /**\n     * Initialize touch ellipse.\n     *\n     * @returns {void}\n     */\n    DocumentHelper.prototype.initTouchEllipse = function () {\n        var style = 'height: 30px;width: 30px;position: absolute;background-color: transparent;margin: 0px;padding: 0px;z-index:5';\n        var ellipse = ' height: 12px;width: 12px;border-radius: 50%;background-color: white;position: absolute;margin: 0px 6px 0px 6px;border-width: 2px;border-style: solid;border-color: #000000;box-sizing: unset;';\n        this.touchStart = createElement('div', { className: 'e-touch-ellipse', styles: style });\n        var start = createElement('div', { styles: ellipse });\n        this.touchEnd = createElement('div', { className: 'e-touch-ellipse', styles: style });\n        this.touchStart.style.display = 'none';\n        var end = createElement('div', { styles: ellipse });\n        this.touchStart.appendChild(start);\n        this.touchEnd.appendChild(end);\n        this.touchEnd.style.display = 'none';\n        this.viewerContainer.appendChild(this.touchStart);\n        this.viewerContainer.appendChild(this.touchEnd);\n    };\n    /**\n     * Updates touch mark position.\n     *\n     * @private\n     * @returns {void}\n     */\n    DocumentHelper.prototype.updateTouchMarkPosition = function () {\n        if (this.touchStart.style.display !== 'none' && !isNullOrUndefined(this.selection)) {\n            if (!this.selection.isEmpty) {\n                var y = this.selection.getCaretBottom(this.selection.start, false);\n                var page = this.selection.getPage(this.selection.start.paragraph);\n                var pageTop = (page.boundingRectangle.y - (this.owner.viewer.pageGap * (this.pages.indexOf(page) + 1)) * this.zoomFactor + this.owner.viewer.pageGap * (this.pages.indexOf(page) + 1));\n                this.touchStart.style.left = page.boundingRectangle.x + (Math.round(this.selection.start.location.x) * this.zoomFactor - 14) + 'px';\n                this.touchStart.style.top = pageTop + ((y) * this.zoomFactor) + 'px';\n                if (!this.selection.isEmpty) {\n                    y = this.selection.getCaretBottom(this.selection.end, false);\n                    page = this.selection.getPage(this.selection.end.paragraph);\n                }\n                this.touchEnd.style.left = page.boundingRectangle.x + (Math.round(this.selection.end.location.x) * this.zoomFactor - 14) + 'px';\n                this.touchEnd.style.top = pageTop + (y * this.zoomFactor) + 'px';\n            }\n            else {\n                this.selection.updateCaretPosition();\n            }\n        }\n    };\n    DocumentHelper.prototype.autoScrollOnSelection = function (cursorPoint) {\n        var _this = this;\n        //Auto scroll when mouse moved hold on the edge of the viewer container.\n        if (this.scrollMoveTimer && (cursorPoint.y <= 0 || cursorPoint.y > 50 || cursorPoint.y < (this.viewerContainer.offsetHeight - 50))) {\n            clearInterval(this.scrollMoveTimer);\n            this.scrollMoveTimer = 0;\n        }\n        else if (cursorPoint.y < 60) {\n            clearInterval(this.scrollMoveTimer);\n            //Scroll up\n            this.scrollMoveTimer = setInterval(function () {\n                _this.viewerContainer.scrollTop -= 20;\n                setTimeout(function () {\n                    var touchPoint = _this.owner.viewer.findFocusedPage(cursorPoint, !_this.owner.enableHeaderAndFooter);\n                    var widget = _this.getLineWidget(touchPoint);\n                    _this.selection.updateTextPosition(widget, touchPoint);\n                }, 200);\n            }, 200);\n        }\n        else if (cursorPoint.y > (this.viewerContainer.offsetHeight - 70)) {\n            clearInterval(this.scrollMoveTimer);\n            //Scroll down\n            this.scrollMoveTimer = setInterval(function () {\n                _this.viewerContainer.scrollTop += 20;\n                setTimeout(function () {\n                    var touchPoint = _this.owner.viewer.findFocusedPage(cursorPoint, !_this.owner.enableHeaderAndFooter);\n                    var widget = _this.getLineWidget(touchPoint);\n                    _this.selection.updateTextPosition(widget, touchPoint);\n                }, 200);\n            }, 200);\n        }\n    };\n    DocumentHelper.prototype.scrollForwardOnSelection = function (cursorPoint) {\n        if (this.viewerContainer) {\n            this.viewerContainer.scrollTop = this.viewerContainer.scrollTop + 200;\n            var touchPoint = this.owner.viewer.findFocusedPage(cursorPoint, !this.owner.enableHeaderAndFooter);\n            var textPosition = this.owner.selectionModule.end;\n            if (!this.owner.enableImageResizerMode || !this.owner.imageResizerModule.isImageResizerVisible\n                || this.owner.imageResizerModule.isShapeResize) {\n                this.skipScrollToPosition = true;\n                this.owner.selectionModule.moveTextPosition(touchPoint, textPosition, true);\n            }\n        }\n    };\n    DocumentHelper.prototype.scrollBackwardOnSelection = function (cursorPoint) {\n        this.viewerContainer.scrollTop = this.viewerContainer.scrollTop - 200;\n        var touchPoint = this.owner.viewer.findFocusedPage(cursorPoint, !this.owner.enableHeaderAndFooter);\n        var textPosition = this.owner.selectionModule.end;\n        if (!this.owner.enableImageResizerMode || !this.owner.imageResizerModule.isImageResizerVisible\n            || this.owner.imageResizerModule.isShapeResize) {\n            this.skipScrollToPosition = true;\n            this.owner.selectionModule.moveTextPosition(touchPoint, textPosition, true);\n        }\n    };\n    DocumentHelper.prototype.moveSelectedContent = function () {\n        this.isDragStarted = false;\n        var info = this.owner.editor.getSelectionInfo(true);\n        info = this.owner.selection.updateSelectionInfo(info);\n        var start = this.selection.getTextPosBasedOnLogicalIndex(info.start);\n        var end = this.selection.getTextPosBasedOnLogicalIndex(info.end);\n        var dropSelectionStartParaInfo = this.selection.getParagraphInfo(start);\n        var dropSelectionEndParaInfo = this.selection.getParagraphInfo(end);\n        var dropSelectionStartParaIndex = this.selection.getHierarchicalIndex(dropSelectionStartParaInfo.paragraph, dropSelectionStartParaInfo.offset.toString());\n        var dropSelectionEndParaIndex = this.selection.getHierarchicalIndex(dropSelectionEndParaInfo.paragraph, dropSelectionEndParaInfo.offset.toString());\n        var dropSelectionStartPos = this.selection.getTextPosBasedOnLogicalIndex(dropSelectionStartParaIndex);\n        var dropSelectionEndPos = this.selection.getTextPosBasedOnLogicalIndex(dropSelectionEndParaIndex);\n        var dragOnSelectionStartParaIndex = this.selection.getHierarchicalIndex(this.dragStartParaInfo.paragraph, this.dragStartParaInfo.offset.toString());\n        var dragOnSelectionEndParaIndex = this.selection.getHierarchicalIndex(this.dragEndParaInfo.paragraph, this.dragEndParaInfo.offset.toString());\n        var dragOnSelectionStartPos = this.selection.getTextPosBasedOnLogicalIndex(dragOnSelectionStartParaIndex);\n        var dragOnSelectionEndPos = this.selection.getTextPosBasedOnLogicalIndex(dragOnSelectionEndParaIndex);\n        if (dropSelectionStartPos.isExistBefore(dragOnSelectionStartPos)\n            || dropSelectionEndPos.isExistAfter(dragOnSelectionEndPos)) {\n            this.owner.editorModule.initComplexHistory('DragAndDropContent');\n            this.selection.start = dragOnSelectionStartPos;\n            this.selection.end = dragOnSelectionEndPos;\n            var isEnableLocalPasteTrue = this.owner.enableLocalPaste;\n            if (!isEnableLocalPasteTrue) {\n                this.owner.enableLocalPaste = true;\n            }\n            var dropExtraOffset = this.dragEndParaInfo.paragraph.getLength();\n            var hasNewLineChar = false;\n            if (dropExtraOffset < this.dragEndParaInfo.offset\n                || !this.dragStartParaInfo.paragraph.equals(this.dragEndParaInfo.paragraph)) {\n                hasNewLineChar = true;\n            }\n            this.owner.editorModule.cut();\n            if (this.dragEndParaInfo.paragraph.equals(dropSelectionStartParaInfo.paragraph)\n                && this.dragEndParaInfo.offset < dropSelectionStartParaInfo.offset\n                && !this.owner.enableTrackChanges) {\n                dropExtraOffset -= this.dragEndParaInfo.paragraph.getLength();\n                dropSelectionStartParaInfo.offset -= dropExtraOffset;\n                dropSelectionEndParaInfo.offset -= dropExtraOffset;\n                dropSelectionStartParaIndex = this.selection.getHierarchicalIndex(dropSelectionStartParaInfo.paragraph, dropSelectionStartParaInfo.offset.toString());\n                dropSelectionEndParaIndex = this.selection.getHierarchicalIndex(dropSelectionEndParaInfo.paragraph, dropSelectionEndParaInfo.offset.toString());\n            }\n            if (!hasNewLineChar || !this.dragEndParaInfo.paragraph.equals(dropSelectionEndParaInfo.paragraph)) {\n                dropSelectionStartParaIndex = this.selection.getHierarchicalIndex(dropSelectionStartParaInfo.paragraph, dropSelectionStartParaInfo.offset.toString());\n                dropSelectionEndParaIndex = this.selection.getHierarchicalIndex(dropSelectionEndParaInfo.paragraph, dropSelectionEndParaInfo.offset.toString());\n            }\n            dropSelectionStartPos = this.selection.getTextPosBasedOnLogicalIndex(dropSelectionStartParaIndex);\n            dropSelectionEndPos = this.selection.getTextPosBasedOnLogicalIndex(dropSelectionEndParaIndex);\n            this.selection.start = dropSelectionStartPos;\n            this.selection.end = dropSelectionEndPos;\n            this.owner.editorModule.copiedTextContent = '';\n            this.owner.editorModule.paste();\n            if (!isEnableLocalPasteTrue) {\n                this.owner.enableLocalPaste = false;\n            }\n            this.owner.editorHistoryModule.updateComplexHistory();\n        }\n        else {\n            this.owner.selectionModule.selectPosition(dragOnSelectionStartPos, dragOnSelectionEndPos);\n        }\n        this.dragStartParaInfo = undefined;\n        this.dragEndParaInfo = undefined;\n        this.selection.caret.classList.add(\"e-de-cursor-animation\");\n    };\n    DocumentHelper.prototype.isSelectionInListText = function (cursorPoint) {\n        var widget = this.getLineWidget(cursorPoint);\n        if (!isNullOrUndefined(widget) && widget.children[0] instanceof ListTextElementBox) {\n            var left = this.getLeftValue(widget);\n            var width = widget.children[0].width;\n            var height = widget.children[0].height;\n            if (this.isInsideRect(left, widget.paragraph.y, width, height, cursorPoint)) {\n                this.selectionLineWidget = widget;\n                return true;\n            }\n        }\n        return false;\n    };\n    DocumentHelper.prototype.isInShapeBorder = function (floatElement, cursorPoint) {\n        if (!isNullOrUndefined(floatElement)) {\n            var width = floatElement.width;\n            var height = floatElement.height;\n            if (this.isInsideRect(floatElement.x - floatElement.margin.left, floatElement.y - floatElement.margin.top, width, height, cursorPoint)) {\n                // this.selectionLineWidget = this.getLineWidget(cursorPoint);\n                if (floatElement instanceof ImageElementBox) {\n                    return true;\n                }\n                else if (floatElement instanceof ShapeElementBox) {\n                    var lineWidth = floatElement.lineFormat.weight;\n                    if (!(this.isInsideRect(floatElement.x + lineWidth, floatElement.y + lineWidth + floatElement.textFrame.marginTop, width - (lineWidth * 2), height - ((lineWidth * 2) + floatElement.textFrame.marginTop + floatElement.textFrame.marginBottom), cursorPoint))) {\n                        return true;\n                    }\n                }\n            }\n        }\n        return false;\n    };\n    /**\n     * Check whether touch point is inside the rectangle or not.\n     *\n     * @private\n     * @param {number} x - Specifies left position.\n     * @param {number} y - Specifies top position.\n     * @param {number} width - Specifies width.\n     * @param {number} height - Specifies height\n     * @param {Point} touchPoint - Specifies the point to check.\n     * @returns {boolean} - Return true if points intersect.\n     */\n    DocumentHelper.prototype.isInsideRect = function (x, y, width, height, touchPoint) {\n        if ((touchPoint.x > x && touchPoint.x <= x + width) && (touchPoint.y > y && touchPoint.y <= y + height)) {\n            return true;\n        }\n        return false;\n    };\n    DocumentHelper.prototype.getLeftValue = function (widget) {\n        var left = widget.paragraph.x;\n        var paragraphFormat = widget.paragraph.paragraphFormat;\n        if (this.selection.isParagraphFirstLine(widget)) {\n            if (paragraphFormat.textAlignment === 'Right') {\n                left -= HelperMethods.convertPointToPixel(paragraphFormat.firstLineIndent);\n                left -= HelperMethods.convertPointToPixel(paragraphFormat.leftIndent);\n            }\n            else {\n                left += HelperMethods.convertPointToPixel(paragraphFormat.firstLineIndent);\n            }\n        }\n        var element = widget.children[0];\n        if (element instanceof ListTextElementBox) {\n            left += element.margin.left;\n        }\n        return left;\n    };\n    /**\n     * Checks whether left mouse button is pressed or not.\n     *\n     * @param {MouseEvent} event - Specifies mouse event.\n     * @returns {boolean} - Returns true if left mouse button is clicked.\n     */\n    DocumentHelper.prototype.isLeftButtonPressed = function (event) {\n        this.isTouchInput = false;\n        var button = event.which || event.button;\n        return button === 1;\n    };\n    DocumentHelper.prototype.updateSelectionOnTouch = function (point, touchPoint) {\n        this.zoomX = undefined;\n        this.zoomY = undefined;\n        if (this.isMouseDown && !this.isSelectionChangedOnMouseMoved && !isNullOrUndefined(this.currentPage) && !isNullOrUndefined(this.owner.selectionModule.start)) {\n            if (!isNullOrUndefined(this.currentSelectedComment) && this.owner.commentReviewPane\n                && !this.owner.commentReviewPane.commentPane.isEditMode) {\n                this.currentSelectedComment = undefined;\n            }\n            if (this.touchDownOnSelectionMark === 0) {\n                this.updateTextPositionForSelection(new Point(touchPoint.x, touchPoint.y), this.tapCount);\n                if (this.tapCount === 2) {\n                    this.selection.checkAndEnableHeaderFooter(point, touchPoint);\n                }\n            }\n            if (this.owner.selectionModule.isEmpty) {\n                this.selection.updateCaretPosition();\n            }\n            this.selection.checkForCursorVisibility();\n        }\n    };\n    /**\n     * Gets touch offset value.\n     *\n     * @private\n     * @param {TouchEvent} event - Specifies touch event\n     * @returns {Point}  - Returns modified touch offset\n     */\n    DocumentHelper.prototype.getTouchOffsetValue = function (event) {\n        var targetElement = this.viewerContainer;\n        var offset = targetElement.getBoundingClientRect();\n        var touchOffsetValues = event.touches[0];\n        if (isNullOrUndefined(touchOffsetValues)) {\n            touchOffsetValues = event.changedTouches[0];\n        }\n        var offsetX = touchOffsetValues.clientX - offset.left;\n        var offsetY = touchOffsetValues.clientY - offset.top;\n        return new Point(offsetX, offsetY);\n    };\n    /**\n     * Fired on pinch zoom in.\n     *\n     * @private\n     * @param {TouchEvent} event - Specifies touch event\n     * @returns {void}\n     */\n    DocumentHelper.prototype.onPinchInInternal = function (event) {\n        this.preZoomFactor = this.zoomFactor;\n        var updatedZoomFactor = this.zoomFactor - 0.01;\n        if (updatedZoomFactor < 5 && updatedZoomFactor > 2) {\n            updatedZoomFactor = updatedZoomFactor - 0.01;\n        }\n        if (updatedZoomFactor < 0.1) {\n            updatedZoomFactor = 0.1;\n        }\n        this.zoomFactor = updatedZoomFactor;\n    };\n    DocumentHelper.prototype.onPinchOutInternal = function (event) {\n        this.preZoomFactor = this.zoomFactor;\n        var updatedZoomFactor = this.zoomFactor + 0.01;\n        if (updatedZoomFactor > 2) {\n            updatedZoomFactor = updatedZoomFactor + 0.01;\n        }\n        if (updatedZoomFactor > 5) {\n            updatedZoomFactor = 5;\n        }\n        this.zoomFactor = updatedZoomFactor;\n    };\n    DocumentHelper.prototype.getPageWidth = function (page) {\n        var width = page.boundingRectangle.width;\n        return width;\n    };\n    /**\n     * Removes specified page.\n     * @private\n     * @param {Page} page - Specifies page to remove\n     * @returns {void}\n     */\n    DocumentHelper.prototype.removePage = function (page) {\n        if (this.currentPage === page) {\n            this.currentPage = undefined;\n        }\n        if (page.headerWidgetIn) {\n            page.headerWidgetIn.page = undefined;\n        }\n        if (page.footerWidgetIn) {\n            page.footerWidgetIn.page = undefined;\n        }\n        if (page.headerWidget) {\n            page.headerWidget.page = undefined;\n        }\n        if (page.footerWidget) {\n            page.footerWidget.page = undefined;\n        }\n        var index = this.pages.indexOf(page);\n        if (index > -1) {\n            this.pages.splice(index, 1);\n        }\n        //this.removeRenderedPages();\n        if (!isNullOrUndefined(this.owner.viewer.visiblePages)) {\n            if ((this.owner.viewer.visiblePages).indexOf(page) > -1) {\n                var pageIndex = (this.owner.viewer.visiblePages).indexOf(page);\n                (this.owner.viewer.visiblePages).splice(pageIndex, 1);\n            }\n        }\n        //(viewer as PageLayoutViewer).visiblePages.remove(page);\n        var height = 0;\n        for (var i = 0; i < this.pages.length; i++) {\n            height = height + this.pages[i].boundingRectangle.height;\n        }\n        //Updates the vertical height.\n        height -= page.boundingRectangle.height + 20;\n        //ToDo:Update horizontal width, if removed page has max width.\n        var top = 20;\n        if (index > 0) {\n            top += this.pages[index - 1].boundingRectangle.bottom;\n        }\n        if (index !== -1) {\n            for (var i = index; i < this.pages.length; i++) {\n                //Update bounding rectangle of next pages in collection.\n                page = this.pages[i];\n                page.boundingRectangle = new Rect(page.boundingRectangle.x, top, page.boundingRectangle.width, page.boundingRectangle.height);\n                top = page.boundingRectangle.bottom + 20;\n                if (!isNullOrUndefined(page.bodyWidgets[0].firstChild) && !(page.bodyWidgets[0].firstChild instanceof TableWidget && page.bodyWidgets[0].firstChild.header)) {\n                    page.repeatHeaderRowTableWidget = false;\n                }\n            }\n        }\n    };\n    // private removeRenderedPages(): void {\n    //     for (let i: number = 0; i < this.pages.length; i++) {\n    //         this.clearContainer(this.pages[i]);\n    //     }\n    // }\n    /**\n     * Updates viewer size on window resize.\n     *\n     * @private\n     * @returns {void}\n     */\n    DocumentHelper.prototype.updateViewerSize = function () {\n        var _this = this;\n        var element = this.owner.getDocumentEditorElement();\n        this.updateViewerSizeInternal(element);\n        this.owner.viewer.updateScrollBars();\n        if (this.owner.viewer instanceof WebLayoutViewer && (!isNullOrUndefined(this.owner)) && (!isNullOrUndefined(element))) {\n            if (this.resizerTimer) {\n                clearTimeout(this.resizerTimer);\n            }\n            /* eslint-disable @typescript-eslint/indent */\n            this.resizerTimer = setTimeout(function () {\n                if (!isNullOrUndefined(_this.owner)) {\n                    var currentVisibleWidth = void 0;\n                    if (!isNullOrUndefined(_this.visibleBounds)) {\n                        currentVisibleWidth = _this.visibleBounds.width;\n                    }\n                    else {\n                        currentVisibleWidth = 0;\n                    }\n                    if (isNullOrUndefined(_this.owner.viewer.preVisibleWidth)) {\n                        _this.owner.viewer.preVisibleWidth = 0;\n                    }\n                    if ((!isNullOrUndefined(_this.visibleBounds) && (currentVisibleWidth !== _this.owner.viewer.preVisibleWidth))) {\n                        _this.owner.editorModule.layoutWholeDocument();\n                        _this.owner.viewer.preVisibleWidth = currentVisibleWidth;\n                    }\n                    if (_this.resizerTimer) {\n                        clearTimeout(_this.resizerTimer);\n                    }\n                }\n            }, 50);\n        }\n        if (!isNullOrUndefined(this.selection)) {\n            this.selection.updateCaretPosition();\n        }\n        // if(!isNullOrUndefined(this.owner) && (!isNullOrUndefined(this.owner.hRuler && !isNullOrUndefined(this.owner.vRuler))))\n        // {\n        //      updateRuler(this.owner);\n        // }\n    };\n    /**\n     * @private\n     */\n    DocumentHelper.prototype.triggerAutoResizeInterval = function () {\n        var _this = this;\n        var timer = 0;\n        var element = this.owner.element;\n        var args = { cancel: false };\n        this.owner.notify(beforeAutoResize, args);\n        if (!isNullOrUndefined(args.element)) {\n            element = args.element;\n        }\n        element.style.visibility = 'hidden';\n        showSpinner(element);\n        var counter = 0;\n        var internal = this.owner.documentEditorSettings.autoResizeSettings.interval;\n        if (this.isAutoResizeCanStart) {\n            timer = setInterval(function () {\n                counter++;\n                var tempRect = _this.owner.element.getBoundingClientRect();\n                if (tempRect.width !== 0 && tempRect.height !== 0) {\n                    _this.isAutoResizeCanStart = false;\n                    var args_1 = { cancel: false };\n                    _this.owner.notify(internalAutoResize, args_1);\n                    clearInterval(timer);\n                    if (!args_1.cancel) {\n                        _this.owner.resize();\n                    }\n                    hideSpinner(element);\n                    element.style.visibility = 'visible';\n                }\n                else if (counter > _this.owner.documentEditorSettings.autoResizeSettings.iterationCount) {\n                    clearInterval(timer);\n                    hideSpinner(element);\n                    element.style.visibility = 'visible';\n                }\n            }, internal);\n        }\n        else {\n            hideSpinner(element);\n            element.style.visibility = 'visible';\n        }\n    };\n    DocumentHelper.prototype.updateViewerSizeInternal = function (element) {\n        if (!isNullOrUndefined(element)) {\n            var rect = element.getBoundingClientRect();\n            if (rect.width === 0 && rect.height === 0) {\n                this.isAutoResizeCanStart = true;\n            }\n            else {\n                this.isAutoResizeCanStart = false;\n            }\n            var width = 0;\n            var height = 0;\n            height = rect.height > 0 ? rect.height : 200;\n            var restrictPaneRect = this.restrictEditingPane && this.restrictEditingPane.isShowRestrictPane ?\n                this.restrictEditingPane.restrictPane.getBoundingClientRect() : undefined;\n            var optionsRect = this.owner.optionsPaneModule && this.owner.optionsPaneModule.isOptionsPaneShow ?\n                this.owner.optionsPaneModule.optionsPane.getBoundingClientRect() : undefined;\n            var commentPane = this.owner.commentReviewPane && this.owner.commentReviewPane.parentPaneElement ?\n                this.owner.commentReviewPane.parentPaneElement.getBoundingClientRect() : undefined;\n            if (restrictPaneRect || optionsRect || commentPane) {\n                var paneWidth = restrictPaneRect ? restrictPaneRect.width : 0;\n                paneWidth += optionsRect ? optionsRect.width : 0;\n                paneWidth += commentPane ? commentPane.width : 0;\n                width = (rect.width - paneWidth) > 0 ? (rect.width - paneWidth) : 200;\n            }\n            else {\n                width = rect.width > 0 ? rect.width : 200;\n            }\n            this.viewerContainer.style.height = height.toString() + 'px';\n            this.viewerContainer.style.width = Math.ceil(width) + 'px';\n            this.visibleBoundsIn = new Rect(0, 0, width, height);\n            this.containerCanvas.width = width;\n            this.containerCanvas.height = height;\n            this.selectionCanvas.width = width;\n            this.selectionCanvas.height = height;\n            this.measureScrollbarWidth(element);\n        }\n    };\n    /**\n     * Inserts page in specified index.\n     *\n     * @private\n     * @param {number} index - Specifes index to insert page\n     * @param {Page} page - Page to insert.\n     * @returns {void}\n     */\n    DocumentHelper.prototype.insertPage = function (index, page) {\n        if (this.pages.indexOf(page) > -1) {\n            this.pages.splice(this.pages.indexOf(page), 1);\n        }\n        this.pages.splice(index, 0, page);\n        var top = 20;\n        if (index > 0) {\n            top += this.pages[index - 1].boundingRectangle.bottom;\n        }\n        for (var i = index; i < this.pages.length; i++) {\n            //Update bounding rectangle of next pages in collection.\n            page = this.pages[i];\n            page.boundingRectangle = new Rect(page.boundingRectangle.x, top, page.boundingRectangle.width, page.boundingRectangle.height);\n            top = page.boundingRectangle.bottom + 20;\n        }\n    };\n    DocumentHelper.prototype.updateTextPositionForSelection = function (cursorPoint, tapCount) {\n        var widget = this.getLineWidget(cursorPoint);\n        if (!isNullOrUndefined(widget)) {\n            this.selection.updateTextPosition(widget, cursorPoint);\n        }\n        if (tapCount > 1) {\n            this.isMouseDown = false;\n            this.useTouchSelectionMark = false;\n            if (this.pages.length === 0) {\n                return;\n            }\n            //Double tap/triple tap selection\n            if (!isNullOrUndefined(this.currentPage) && !isNullOrUndefined(this.owner.selectionModule.start)) {\n                if (tapCount % 2 === 0) {\n                    this.owner.selectionModule.selectCurrentWord();\n                }\n                else if (!this.isDragStarted) {\n                    this.owner.selectionModule.selectParagraph();\n                }\n            }\n        }\n    };\n    DocumentHelper.prototype.scrollToPosition = function (startPosition, endPosition, skipCursorUpdate, isBookmark) {\n        if (this.skipScrollToPosition || this.isWebPrinting || (this.owner.editorModule && this.owner.editorModule.isRemoteAction)) {\n            this.skipScrollToPosition = false;\n            return;\n        }\n        if (this.owner.enableImageResizerMode && this.owner.imageResizerModule.isImageResizing\n            || this.isMouseDownInFooterRegion || this.isRowOrCellResizing) {\n            return;\n        }\n        var lineWidget = this.selection.getLineWidgetInternal(endPosition.currentWidget, endPosition.offset, true);\n        if (isNullOrUndefined(lineWidget)) {\n            return;\n        }\n        var top = this.selection.getTop(lineWidget);\n        if (this.isMouseDown) {\n            var prevLineWidget = this.selection.getLineWidgetInternal(endPosition.currentWidget, endPosition.offset, false);\n            var prevTop = this.selection.getTop(prevLineWidget);\n            if (prevLineWidget !== lineWidget && endPosition.location.y >= prevTop) {\n                lineWidget = prevLineWidget;\n            }\n        }\n        var height = lineWidget.height;\n        //Gets current page.\n        var endPage = this.selection.getPage(lineWidget.paragraph);\n        this.currentPage = endPage;\n        var x = 0;\n        var y = 0;\n        var horizontalWidth = 0;\n        var isPageLayout = this.owner.viewer instanceof PageLayoutViewer;\n        var pageLayout = this.owner.viewer;\n        if (isNullOrUndefined(endPage)) {\n            return;\n        }\n        var pageWidth = endPage.boundingRectangle.width;\n        x = (this.visibleBounds.width - pageWidth * this.zoomFactor) / 2;\n        if (x < 30) {\n            x = 30;\n        }\n        y = endPage.boundingRectangle.y * this.zoomFactor + (this.pages.indexOf(endPage) + 1) * this.owner.viewer.pageGap * (1 - this.zoomFactor);\n        var scrollTop = this.owner.viewer.containerTop;\n        var scrollLeft = this.owner.viewer.containerLeft;\n        var pageHeight = this.visibleBounds.height;\n        var caretInfo = this.selection.updateCaretSize(this.owner.selectionModule.end, true);\n        var topMargin = caretInfo.topMargin;\n        var caretHeight = caretInfo.height;\n        x += (endPosition.location.x) * this.zoomFactor;\n        y += (endPosition.location.y + topMargin) * this.zoomFactor;\n        if (!isBookmark) {\n            //vertical scroll bar update\n            if ((scrollTop + 20) > y) {\n                this.viewerContainer.scrollTop = (y - 10);\n            }\n            else if (scrollTop + pageHeight < y + caretHeight) {\n                this.viewerContainer.scrollTop = y + caretHeight - pageHeight + 10;\n            }\n        }\n        else {\n            // As per MS Word behaviour, update vertical scroll bar using static value while navigate bookmark\n            this.viewerContainer.scrollTop = y - 96;\n        }\n        if (!skipCursorUpdate) {\n            this.selection.updateCaretToPage(startPosition, endPage);\n        }\n        var scrollBarWidth = this.viewerContainer.offsetWidth - this.viewerContainer.clientWidth;\n        if (scrollLeft > x) {\n            this.viewerContainer.scrollLeft = x - (this.pageContainer.offsetWidth / 100) * 20;\n        }\n        else if (scrollLeft + this.visibleBounds.width < x + scrollBarWidth) {\n            this.viewerContainer.scrollLeft = scrollLeft + (this.pageContainer.offsetWidth / 100) * 15 + scrollBarWidth;\n            while (x < this.owner.viewer.containerWidth && this.viewerContainer.scrollLeft + this.visibleBounds.width < x + scrollBarWidth) {\n                this.viewerContainer.scrollLeft = this.viewerContainer.scrollLeft + (this.pageContainer.offsetWidth / 100) * 15 + scrollBarWidth;\n            }\n        }\n    };\n    DocumentHelper.prototype.getLineWidget = function (cursorPoint) {\n        return this.getLineWidgetInternal(cursorPoint, false);\n    };\n    DocumentHelper.prototype.getLineWidgetInternal = function (cursorPoint, isMouseDragged) {\n        var widget = undefined;\n        if (!isNullOrUndefined(this.currentPage)) {\n            var childWidgets = void 0;\n            if (this.owner.enableHeaderAndFooter) {\n                var page = this.currentPage;\n                var pageBottom = page.boundingRectangle.height;\n                var headerHeight = Math.max((page.headerWidget.y + page.headerWidget.height), HelperMethods.convertPointToPixel(page.bodyWidgets[0].sectionFormat.topMargin)) * this.zoomFactor;\n                var footerDistance = HelperMethods.convertPointToPixel(page.bodyWidgets[0].sectionFormat.footerDistance);\n                var footerHeight = (page.boundingRectangle.height -\n                    Math.max(page.footerWidget.height + footerDistance, footerDistance * 2));\n                if (isMouseDragged) {\n                    if (this.isBlockInHeader(this.selection.start.paragraph)) {\n                        childWidgets = this.currentPage.headerWidget;\n                    }\n                    else {\n                        childWidgets = this.currentPage.footerWidget;\n                    }\n                }\n                else {\n                    if (cursorPoint.y <= pageBottom && cursorPoint.y >= footerHeight) {\n                        childWidgets = this.currentPage.footerWidget;\n                    }\n                    else if ((cursorPoint.y) >= 0 && (cursorPoint.y) <= headerHeight) {\n                        childWidgets = this.currentPage.headerWidget;\n                    }\n                }\n                if (isNullOrUndefined(childWidgets)) {\n                    return undefined;\n                }\n                var shapeElementInfo = this.checkFloatingItems(childWidgets, cursorPoint, isMouseDragged);\n                if (shapeElementInfo.isShapeSelected) {\n                    if (shapeElementInfo.isInShapeBorder) {\n                        return shapeElementInfo.element.line;\n                    }\n                    return this.selection.getLineWidgetBodyWidget(shapeElementInfo.element.textFrame, cursorPoint);\n                }\n                else {\n                    return this.selection.getLineWidgetBodyWidget(childWidgets, cursorPoint);\n                }\n            }\n            else {\n                var shapeInfo = undefined;\n                var behindShapeInfo = undefined;\n                for (var i = 0; i < this.currentPage.bodyWidgets.length; i++) {\n                    var bodyWidget = this.currentPage.bodyWidgets[i];\n                    shapeInfo = this.checkFloatingItems(bodyWidget, cursorPoint, isMouseDragged, false);\n                    behindShapeInfo = this.checkFloatingItems(bodyWidget, cursorPoint, isMouseDragged, true);\n                    if (shapeInfo.isShapeSelected || behindShapeInfo.isShapeSelected) {\n                        break;\n                    }\n                }\n                if (shapeInfo.isShapeSelected && !this.isEmptyShape(shapeInfo)) {\n                    if (shapeInfo.isInShapeBorder) {\n                        return shapeInfo.element.line;\n                    }\n                    if (shapeInfo.element instanceof ShapeElementBox) {\n                        widget = this.selection.getLineWidgetBodyWidget(shapeInfo.element.textFrame, cursorPoint);\n                    }\n                }\n                else if (isMouseDragged && this.isFootnoteWidget) {\n                    if (this.selection.start.paragraph.bodyWidget.footNoteReference !== undefined && this.selection.start.paragraph.bodyWidget.containerWidget instanceof FootNoteWidget && this.selection.start.paragraph.bodyWidget.containerWidget.footNoteType === 'Footnote') {\n                        return this.selection.getLineWidgetBodyWidget(this.currentPage.footnoteWidget, cursorPoint);\n                    }\n                    else if (this.selection.start.paragraph.bodyWidget.footNoteReference !== undefined &&\n                        this.selection.start.paragraph.bodyWidget.containerWidget instanceof FootNoteWidget\n                        && this.selection.start.paragraph.bodyWidget.containerWidget.footNoteType === 'Endnote') {\n                        return this.selection.getLineWidgetBodyWidget(this.currentPage.endnoteWidget, cursorPoint);\n                    }\n                }\n                else {\n                    if (!isMouseDragged && this.currentPage.footnoteWidget && this.isInFootnoteWidget(this.currentPage.footnoteWidget, cursorPoint)) {\n                        widget = this.selection.getLineWidgetBodyWidget(this.currentPage.footnoteWidget, cursorPoint);\n                        if (widget) {\n                            this.isFootnoteWidget = true;\n                        }\n                    }\n                    else if (!isMouseDragged && this.currentPage.endnoteWidget &&\n                        this.isInFootnoteWidget(this.currentPage.endnoteWidget, cursorPoint)) {\n                        widget = this.selection.getLineWidgetBodyWidget(this.currentPage.endnoteWidget, cursorPoint);\n                        if (widget) {\n                            this.isFootnoteWidget = true;\n                        }\n                    }\n                    else {\n                        for (var i_1 = 0; i_1 < this.currentPage.bodyWidgets.length; i_1++) {\n                            var bodyWidget_1 = this.currentPage.bodyWidgets[i_1];\n                            if (i_1 < this.currentPage.bodyWidgets.length - 1) {\n                                if (cursorPoint.x <= bodyWidget_1.x + bodyWidget_1.width) {\n                                    //let isGetFirstChild: boolean = i === this.currentPage.bodyWidgets.length - 1;\n                                    widget = this.selection.getLineWidgetBodyWidget(bodyWidget_1, cursorPoint, true);\n                                    if (!isNullOrUndefined(widget) && widget.paragraph.y <= cursorPoint.y\n                                        && (widget.paragraph.y + widget.paragraph.height) >= cursorPoint.y) {\n                                        this.isFootnoteWidget = false;\n                                        break;\n                                    }\n                                }\n                            }\n                            if (cursorPoint.x > bodyWidget_1.x + bodyWidget_1.width && this.layout.getNextWidgetHeight(bodyWidget_1) >= cursorPoint.y && bodyWidget_1.y <= cursorPoint.y) {\n                                if (isNullOrUndefined(bodyWidget_1.nextRenderedWidget) || !(this.layout.getNextWidgetHeight(bodyWidget_1.nextRenderedWidget) >= cursorPoint.y && bodyWidget_1.nextRenderedWidget.y <= cursorPoint.y)) {\n                                    widget = this.selection.getLineWidgetBodyWidget(bodyWidget_1, cursorPoint, true);\n                                    if (!isNullOrUndefined(widget) && widget.paragraph.y <= cursorPoint.y\n                                        && (widget.paragraph.y + widget.paragraph.height) >= cursorPoint.y) {\n                                        this.isFootnoteWidget = false;\n                                        break;\n                                    }\n                                }\n                            }\n                            if (i_1 == this.currentPage.bodyWidgets.length - 1) {\n                                widget = this.selection.getLineWidgetBodyWidget(bodyWidget_1, cursorPoint, true);\n                                if (!isNullOrUndefined(widget) && widget.paragraph.y <= cursorPoint.y\n                                    && (widget.paragraph.y + widget.paragraph.height) >= cursorPoint.y) {\n                                    this.isFootnoteWidget = false;\n                                    break;\n                                }\n                            }\n                            if (cursorPoint.x < bodyWidget_1.x && i_1 < this.currentPage.bodyWidgets.length - 1) {\n                                widget = this.selection.getLineWidgetBodyWidget(bodyWidget_1, cursorPoint, true);\n                                if (!isNullOrUndefined(widget) && widget.paragraph.y <= cursorPoint.y\n                                    && (widget.paragraph.y + widget.paragraph.height) >= cursorPoint.y) {\n                                    this.isFootnoteWidget = false;\n                                    break;\n                                }\n                                else if (!isNullOrUndefined(widget) && i_1 === this.currentPage.bodyWidgets.length - 1) {\n                                    this.isFootnoteWidget = false;\n                                    break;\n                                }\n                            }\n                        }\n                    }\n                    var inlineShapeInfo = this.checkInlineShapeItems(widget, cursorPoint, isMouseDragged);\n                    if (inlineShapeInfo.isShapeSelected) {\n                        if (inlineShapeInfo.isInShapeBorder) {\n                            return inlineShapeInfo.element.line;\n                        }\n                        if (inlineShapeInfo.element instanceof ShapeElementBox) {\n                            widget = this.selection.getLineWidgetBodyWidget(inlineShapeInfo.element.textFrame, cursorPoint);\n                        }\n                    }\n                    else if (!this.checkPointIsInLine(widget, cursorPoint) && behindShapeInfo.isShapeSelected) {\n                        if (behindShapeInfo.isInShapeBorder) {\n                            return behindShapeInfo.element.line;\n                        }\n                        if (behindShapeInfo.element instanceof ShapeElementBox) {\n                            widget = this.selection.getLineWidgetBodyWidget(behindShapeInfo.element.textFrame, cursorPoint);\n                        }\n                    }\n                }\n            }\n        }\n        return widget;\n    };\n    DocumentHelper.prototype.checkInlineShapeItems = function (widget, cursorPoint, isMouseDragged) {\n        var isInShape = false;\n        var isInShapeBorder = false;\n        var floatingElement;\n        var selectionInShape = this.selection.isInShape;\n        var isMouseDraggedInShape = isMouseDragged && selectionInShape;\n        if (!isNullOrUndefined(widget) && widget.children.length > 0) {\n            if (isMouseDraggedInShape) {\n                var textFrame = this.owner.selectionModule.getCurrentTextFrame();\n                if (textFrame) {\n                    floatingElement = textFrame.containerShape;\n                    isInShape = true;\n                }\n            }\n            else {\n                for (var i = 0; i < widget.children.length; i++) {\n                    if (!(widget.children[i] instanceof ShapeElementBox && widget.children[i].textWrappingStyle === 'Inline')) {\n                        continue;\n                    }\n                    floatingElement = widget.children[i];\n                    if (cursorPoint.x < floatingElement.x + floatingElement.margin.left + floatingElement.width &&\n                        cursorPoint.x > floatingElement.x && cursorPoint.y < floatingElement.y + floatingElement.margin.top +\n                        floatingElement.height && cursorPoint.y > floatingElement.y) {\n                        isInShape = true;\n                        if (this.isInShapeBorder(floatingElement, cursorPoint)) {\n                            isInShapeBorder = true;\n                        }\n                        break;\n                    }\n                }\n                if (isMouseDragged && !selectionInShape) {\n                    isInShape = false;\n                }\n            }\n        }\n        return {\n            'element': floatingElement,\n            'caretPosition': cursorPoint,\n            'isInShapeBorder': isInShapeBorder,\n            'isShapeSelected': isInShape\n        };\n    };\n    /**\n     * @private\n     */\n    DocumentHelper.prototype.checkPointIsInLine = function (widget, cursorPoint) {\n        if (!isNullOrUndefined(widget) && widget.children.length > 0) {\n            var element = void 0;\n            var left = widget.paragraph.x;\n            var top_1 = this.selection.getTop(widget);\n            for (var i = widget.children.indexOf(widget.children[0]); i < widget.children.length; i++) {\n                element = widget.children[i];\n                if (element instanceof ShapeBase && element.textWrappingStyle !== 'Inline') {\n                    continue;\n                }\n                if (cursorPoint.x < left + element.margin.left + element.width + element.padding.left\n                    && cursorPoint.x > left && cursorPoint.y < top_1 + widget.height && cursorPoint.y > top_1) {\n                    return true;\n                }\n                left += element.margin.left + element.width + element.padding.left;\n            }\n        }\n        return false;\n    };\n    DocumentHelper.prototype.isInFootnoteWidget = function (footnoteWidget, point) {\n        for (var i = 0; i < footnoteWidget.bodyWidgets.length; i++) {\n            for (var j = 0; j < footnoteWidget.bodyWidgets[i].childWidgets.length; j++) {\n                var childWidget = footnoteWidget.bodyWidgets[i].childWidgets[j];\n                if (childWidget instanceof Widget && childWidget.y <= point.y\n                    && (childWidget.y + childWidget.height) >= point.y) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    };\n    DocumentHelper.prototype.checkFloatingItems = function (blockContainer, cursorPoint, isMouseDragged, isBehind) {\n        var isInShape = false;\n        var isInShapeBorder = false;\n        var floatElement;\n        var selectionInShape = this.selection.isInShape;\n        var isMouseDraggedInShape = isMouseDragged && selectionInShape;\n        if (blockContainer.floatingElements.length > 0) {\n            var page = this.currentPage;\n            /* eslint-disable */\n            blockContainer.floatingElements.sort(function (a, b) {\n                if (a instanceof TableWidget || b instanceof TableWidget) {\n                    return 0;\n                }\n                else {\n                    return a.zOrderPosition - b.zOrderPosition;\n                }\n            });\n            if (isMouseDraggedInShape) {\n                var textFrame = this.owner.selectionModule.getCurrentTextFrame();\n                if (textFrame) {\n                    floatElement = textFrame.containerShape;\n                    isInShape = true;\n                }\n            }\n            else {\n                for (var i = blockContainer.floatingElements.length - 1; i >= 0; i--) {\n                    if (blockContainer.floatingElements[i] instanceof TableWidget\n                        || (!isNullOrUndefined(isBehind) && isBehind ? blockContainer.floatingElements[i].textWrappingStyle !== 'Behind' : blockContainer.floatingElements[i].textWrappingStyle === 'Behind')) {\n                        continue;\n                    }\n                    floatElement = blockContainer.floatingElements[i];\n                    if (cursorPoint.x < floatElement.x + floatElement.margin.left + floatElement.width &&\n                        cursorPoint.x > floatElement.x && cursorPoint.y < floatElement.y + floatElement.margin.top +\n                        floatElement.height && cursorPoint.y > floatElement.y) {\n                        isInShape = true;\n                        if (this.isInShapeBorder(floatElement, cursorPoint)) {\n                            isInShapeBorder = true;\n                        }\n                        break;\n                    }\n                }\n                if (isMouseDragged && !selectionInShape) {\n                    isInShape = false;\n                }\n            }\n        }\n        return {\n            'element': floatElement,\n            'caretPosition': cursorPoint,\n            'isShapeSelected': isInShape,\n            'isInShapeBorder': isInShapeBorder\n        };\n    };\n    DocumentHelper.prototype.isBlockInHeader = function (block) {\n        while (!(block.containerWidget instanceof HeaderFooterWidget)) {\n            if (!block.containerWidget) {\n                return false;\n            }\n            block = block.containerWidget;\n            if (block instanceof TextFrame) {\n                block = block.containerShape.paragraph;\n            }\n        }\n        return block.containerWidget.headerFooterType.indexOf('Header') !== -1;\n    };\n    DocumentHelper.prototype.clearSelectionHighlight = function () {\n        var canClear = true;\n        canClear = (!this.isControlPressed || !this.isMouseDown);\n        // if (this.owner.selection.selectionRanges.length > 0 && canClear) {\n        if (this.owner.selectionModule.clearSelectionHighlightInSelectedWidgets()) {\n            this.selectionContext.clearRect(0, 0, this.selectionCanvas.width, this.selectionCanvas.height);\n        }\n        // } else if (!isNullOrUndefined(this.owner.selection.currentSelectionRange) && this.isMouseDown) {\n        //     this.owner.selection.currentSelectionRange.clearSelectionHighlight();\n        // }\n        //this.renderVisiblePages();\n    };\n    /**\n     * @private\n     * @returns {void}\n     */\n    DocumentHelper.prototype.removeEmptyPages = function () {\n        var scrollToLastPage = false;\n        var pageIndex = this.selection.startPage - 1;\n        for (var j = 0; j < this.pages.length; j++) {\n            var page = this.pages[j];\n            for (var i = 0; i < page.bodyWidgets.length; i++) {\n                if (page.bodyWidgets.length === 0 || page.bodyWidgets[i].childWidgets.length === 0) {\n                    if (page.bodyWidgets.length >= 1) {\n                        var startindex = page.bodyWidgets.indexOf(page.bodyWidgets[i]);\n                        page.bodyWidgets.splice(startindex, 1);\n                        i--;\n                    }\n                }\n            }\n            if (page.bodyWidgets.length <= 0) {\n                if (j === this.pages.length - 1 && this.owner.viewer instanceof PageLayoutViewer && this.owner.viewer.visiblePages.indexOf(this.pages[j]) !== -1) {\n                    scrollToLastPage = true;\n                }\n                this.removePage(this.pages[j]);\n                j--;\n            }\n        }\n        if (!isNullOrUndefined(this.pages[pageIndex])) {\n            var page = this.pages[pageIndex];\n            if (page.headerWidget) {\n                page.headerWidget.page = page;\n            }\n            if (page.footerWidget) {\n                page.footerWidget.page = page;\n            }\n        }\n        if (scrollToLastPage) {\n            this.scrollToBottom();\n        }\n    };\n    /**\n     * @private\n     * @returns {void}\n     */\n    DocumentHelper.prototype.scrollToBottom = function () {\n        if (this.selection.start.paragraph && this.selection.start.paragraph.bodyWidget) {\n            var page = this.selection.start.paragraph.bodyWidget.page;\n            var containerHeight = this.visibleBounds.height;\n            this.viewerContainer.scrollTop = page.boundingRectangle.bottom - containerHeight;\n        }\n    };\n    DocumentHelper.prototype.getFieldResult = function (fieldBegin, page) {\n        if (!isNullOrUndefined(page) && !isNullOrUndefined(this.selection) && !isNullOrUndefined(fieldBegin)) {\n            var fieldCode = this.selection.getFieldCode(fieldBegin);\n            var fieldCodes = fieldCode.split('\\*');\n            var fieldCategory = fieldCodes[0].replace(/[^\\w\\s]/gi, '').trim().toLowerCase();\n            var fieldPattern = '';\n            if (fieldCodes.length > 1) {\n                if (fieldCodes[1] !== ' MERGEFORMAT') {\n                    fieldPattern = fieldCodes[1].replace(/[^\\w\\s]/gi, '').trim();\n                }\n            }\n            if (fieldPattern == '') {\n                fieldPattern = page.bodyWidgets[0].sectionFormat.pageNumberStyle;\n            }\n            if (fieldCategory.indexOf(' ') !== -1) {\n                fieldCategory = fieldCategory.split(' ')[0];\n            }\n            switch (fieldCategory) {\n                case 'page':\n                    if (page.bodyWidgets[0].sectionFormat.restartPageNumbering && page.sectionIndex !== 0) {\n                        var currentSectionIndex_1 = page.sectionIndex;\n                        var previousPage = page.previousPage;\n                        this.isRestartNumbering = true;\n                        if (currentSectionIndex_1 !== previousPage.sectionIndex && previousPage.bodyWidgets[previousPage.bodyWidgets.length - 1].sectionIndex !== currentSectionIndex_1) {\n                            page.currentPageNum = (page.bodyWidgets[0].sectionFormat.pageStartingNumber);\n                            return this.getFieldText(fieldPattern, page.currentPageNum);\n                        }\n                        if (previousPage.currentPageNum === 1 && currentSectionIndex_1 !== previousPage.sectionIndex) {\n                            previousPage.currentPageNum = (page.bodyWidgets[0].sectionFormat.pageStartingNumber);\n                        }\n                        page.currentPageNum = previousPage.currentPageNum + 1;\n                        return this.getFieldText(fieldPattern, page.currentPageNum);\n                    }\n                    else if (page.bodyWidgets[0].sectionFormat.restartPageNumbering && page.sectionIndex === 0) {\n                        page.currentPageNum = page.bodyWidgets[0].sectionFormat.pageStartingNumber + page.index;\n                        return this.getFieldText(fieldPattern, page.currentPageNum);\n                    }\n                    if (!isNullOrUndefined(page.previousPage) && ((page.previousPage.bodyWidgets[0].sectionFormat.restartPageNumbering && page.previousPage.currentPageNum === 1)\n                        || (this.isRestartNumbering && page.previousPage.currentPageNum !== 1))) {\n                        if (page.previousPage.bodyWidgets[0].sectionFormat.restartPageNumbering) {\n                            this.isRestartNumbering = true;\n                        }\n                        page.currentPageNum = page.previousPage.currentPageNum + 1;\n                    }\n                    else {\n                        page.currentPageNum = page.index + 1;\n                    }\n                    return this.getFieldText(fieldPattern, page.currentPageNum);\n                case 'numpages':\n                    return this.getFieldText(fieldPattern, page.documentHelper.pages.length);\n                case 'sectionpages':\n                    var currentSectionIndex = page.sectionIndex;\n                    var currentPageCount = 0;\n                    for (var i = 0; i < page.documentHelper.pages.length; i++) {\n                        if (page.documentHelper.pages[i].sectionIndex === currentSectionIndex) {\n                            currentPageCount++;\n                        }\n                        else if (currentPageCount !== 0) {\n                            break;\n                        }\n                    }\n                    return this.getFieldText(fieldPattern, currentPageCount);\n                default:\n                    break;\n            }\n        }\n        return '';\n    };\n    DocumentHelper.prototype.getFieldText = function (pattern, value) {\n        switch (pattern) {\n            case 'ALPHABETIC':\n                return this.layout.getAsLetter(value).toUpperCase();\n            case 'alphabetic':\n                return this.layout.getAsLetter(value).toLowerCase();\n            case 'roman':\n                return this.layout.getAsRoman(value).toLowerCase();\n            case 'ROMAN':\n                return this.layout.getAsRoman(value).toUpperCase();\n            case 'RomanUpper':\n                return this.layout.getAsRoman(value).toUpperCase();\n            case 'RomanLower':\n                return this.layout.getAsRoman(value).toLowerCase();\n            case 'LetterUpper':\n                return this.layout.getAsLetter(value).toUpperCase();\n            case 'LetterLower':\n                return this.layout.getAsLetter(value).toLowerCase();\n            default:\n                return value.toString();\n        }\n    };\n    DocumentHelper.prototype.isEmptyShape = function (shape) {\n        var isEmpty = true;\n        if (shape.element instanceof ImageElementBox) {\n            return isEmpty;\n        }\n        var textFrame = shape.element.textFrame;\n        if (textFrame.childWidgets.length === 0) {\n            return isEmpty;\n        }\n        else {\n            return false;\n        }\n    };\n    /**\n     * Destroys the internal objects maintained for control.\n     *\n     * @returns {void}\n     */\n    DocumentHelper.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.owner)) {\n            this.unWireEvent();\n        }\n        if (this.styles) {\n            this.styles.destroy();\n            this.styles = undefined;\n        }\n        if (this.stylesMap) {\n            this.stylesMap.destroy();\n            this.stylesMap = undefined;\n        }\n        if (this.characterFormat) {\n            this.characterFormat.destroy();\n            this.characterFormat = undefined;\n        }\n        if (this.themeFontLanguage) {\n            this.themeFontLanguage.destroy();\n            this.themeFontLanguage = undefined;\n        }\n        if (this.paragraphFormat) {\n            this.paragraphFormat.destroy();\n            this.paragraphFormat = undefined;\n        }\n        if (this.pages && this.pages.length > 0) {\n            for (var i = 0; i < this.pages.length; i++) {\n                var page = this.pages[i];\n                page.componentDestroy();\n            }\n            this.pages = [];\n        }\n        this.pages = undefined;\n        if (this.lists && this.lists.length > 0) {\n            for (var i = 0; i < this.lists.length; i++) {\n                var list = this.lists[i];\n                list.destroy();\n            }\n            this.lists = [];\n        }\n        this.lists = undefined;\n        if (this.formFillPopup) {\n            this.formFillPopup.destroy();\n            this.formFillPopup = undefined;\n        }\n        this.L10n = undefined;\n        this.currentPage = undefined;\n        this.selectionStartPageIn = undefined;\n        this.selectionEndPageIn = undefined;\n        this.fieldStacks = [];\n        this.fieldStacks = undefined;\n        this.splittedCellWidgets = [];\n        this.splittedCellWidgets = undefined;\n        this.fields = [];\n        this.fields = undefined;\n        this.abstractLists = [];\n        this.abstractLists = undefined;\n        if (!isNullOrUndefined(this.owner)) {\n            this.renderedLists.destroy();\n        }\n        this.renderedLists = undefined;\n        if (!isNullOrUndefined(this.owner)) {\n            this.authors.destroy();\n        }\n        this.authors = undefined;\n        if (!isNullOrUndefined(this.owner)) {\n            this.revisionsInternal.destroy();\n        }\n        this.revisionsInternal = undefined;\n        if (!isNullOrUndefined(this.owner)) {\n            this.preDefinedStyles.destroy();\n        }\n        this.preDefinedStyles = undefined;\n        if (!isNullOrUndefined(this.owner)) {\n            this.bookmarks.destroy();\n        }\n        this.bookmarks = undefined;\n        if (!isNullOrUndefined(this.owner)) {\n            this.editRanges.destroy();\n        }\n        this.editRanges = undefined;\n        if (!isNullOrUndefined(this.owner)) {\n            this.customXmlData.destroy();\n        }\n        if (!isNullOrUndefined(this.owner)) {\n            this.images.destroy();\n        }\n        if (!isNullOrUndefined(this.owner)) {\n            this.fontSubstitutionTable.destroy();\n        }\n        this.fontSubstitutionTable = undefined;\n        this.customXmlData = undefined;\n        this.images = undefined;\n        this.blockToShift = undefined;\n        this.cachedPages = [];\n        this.cachedPages = undefined;\n        if (this.comments && this.comments.length > 0) {\n            for (var i = 0; i < this.comments.length; i++) {\n                var comment = this.comments[i];\n                comment.destroy();\n            }\n            this.comments = [];\n        }\n        this.comments = undefined;\n        this.compositionEnd = undefined;\n        this.compositionStart = undefined;\n        this.compositionUpdated = undefined;\n        this.contentControlCollection = [];\n        this.contentControlCollection = undefined;\n        this.renderedLevelOverrides = [];\n        this.renderedLevelOverrides = undefined;\n        this.headersFooters = [];\n        this.headersFooters = undefined;\n        this.listParagraphs = [];\n        this.listParagraphs = undefined;\n        this.formFields = [];\n        this.formFields = undefined;\n        this.fieldCollection = [];\n        this.fieldCollection = undefined;\n        this.userCollection = [];\n        this.userCollection = undefined;\n        if (this.footnotes) {\n            this.footnotes.componentDestroy();\n            this.footnotes = undefined;\n        }\n        if (this.endnotes) {\n            this.endnotes.componentDestroy();\n            this.endnotes = undefined;\n        }\n        if (this.zoomModule) {\n            this.zoomModule.destroy();\n            this.zoomModule = undefined;\n        }\n        this.footnoteCollection = [];\n        this.footnoteCollection = undefined;\n        this.endnoteCollection = [];\n        this.endnoteCollection = undefined;\n        if (this.restrictEditingPane) {\n            this.restrictEditingPane.destroy();\n            this.restrictEditingPane = undefined;\n        }\n        if (this.layout) {\n            this.layout.destroy();\n        }\n        this.layout = undefined;\n        if (!isNullOrUndefined(this.render)) {\n            this.render.destroy();\n        }\n        this.render = undefined;\n        if (this.dialogInternal) {\n            this.dialogInternal.destroy();\n        }\n        this.dialogInternal = undefined;\n        if (this.dialogInternal2) {\n            this.dialogInternal2.destroy();\n            this.dialogInternal2 = undefined;\n        }\n        if (this.dialogInternal3) {\n            this.dialogInternal3.destroy();\n            this.dialogInternal3 = undefined;\n        }\n        if (this.dialogTarget1 && this.dialogTarget1.parentElement) {\n            this.dialogTarget1.parentElement.removeChild(this.dialogTarget1);\n        }\n        this.dialogTarget1 = undefined;\n        if (this.dialogTarget2 && this.dialogTarget2.parentElement) {\n            this.dialogTarget2.parentElement.removeChild(this.dialogTarget2);\n        }\n        this.dialogTarget2 = undefined;\n        if (this.dialogTarget3 && this.dialogTarget3.parentElement) {\n            this.dialogTarget3.parentElement.removeChild(this.dialogTarget3);\n        }\n        this.dialogTarget3 = undefined;\n        if (!isNullOrUndefined(this.touchStart)) {\n            this.touchStart.innerHTML = '';\n            if (!isNullOrUndefined(this.touchStart.parentElement)) {\n                this.touchStart.parentElement.removeChild(this.touchStart);\n            }\n        }\n        this.touchStart = undefined;\n        if (this.textHelper) {\n            this.textHelper.destroy();\n        }\n        this.textHelper = undefined;\n        if (!isNullOrUndefined(this.touchEnd)) {\n            this.touchEnd.innerHTML = '';\n            if (!isNullOrUndefined(this.touchEnd.parentElement)) {\n                this.touchEnd.parentElement.removeChild(this.touchEnd);\n            }\n        }\n        this.touchEnd = undefined;\n        if (!isNullOrUndefined(this.containerCanvasIn)) {\n            this.containerCanvasIn.innerHTML = '';\n            if (!isNullOrUndefined(this.containerCanvasIn.parentElement)) {\n                this.containerCanvasIn.parentElement.removeChild(this.containerCanvasIn);\n            }\n        }\n        this.containerCanvasIn = undefined;\n        if (!isNullOrUndefined(this.selectionCanvasIn)) {\n            this.selectionCanvasIn.innerHTML = '';\n            if (!isNullOrUndefined(this.selectionCanvasIn.parentElement)) {\n                this.selectionCanvasIn.parentElement.removeChild(this.selectionCanvasIn);\n            }\n        }\n        this.selectionCanvasIn = undefined;\n        if (!isNullOrUndefined(this.editableDiv)) {\n            this.editableDiv.innerHTML = '';\n            if (!isNullOrUndefined(this.editableDiv.parentElement)) {\n                this.editableDiv.parentElement.removeChild(this.editableDiv);\n            }\n        }\n        this.editableDiv = undefined;\n        if (!isNullOrUndefined(this.pageContainer)) {\n            this.pageContainer.innerHTML = '';\n            if (!isNullOrUndefined(this.pageContainer.parentElement)) {\n                this.pageContainer.parentElement.removeChild(this.pageContainer);\n            }\n        }\n        this.pageContainer = undefined;\n        if (!isNullOrUndefined(this.viewerContainer)) {\n            this.viewerContainer.innerHTML = '';\n            if (!isNullOrUndefined(this.viewerContainer.parentElement)) {\n                this.viewerContainer.parentElement.removeChild(this.viewerContainer);\n            }\n        }\n        if (!isNullOrUndefined(this.iframe)) {\n            this.iframe.innerHTML = '';\n            if (!isNullOrUndefined(this.iframe.parentElement)) {\n                this.iframe.parentElement.removeChild(this.iframe);\n            }\n            this.iframe = undefined;\n        }\n        if (this.optionsPaneContainer) {\n            this.optionsPaneContainer.innerHTML = '';\n            if (!isNullOrUndefined(this.optionsPaneContainer.parentElement)) {\n                this.optionsPaneContainer.parentElement.removeChild(this.optionsPaneContainer);\n            }\n        }\n        this.optionsPaneContainer = undefined;\n        this.visibleBoundsIn = undefined;\n        this.mouseDownOffset = undefined;\n        this.viewerContainer = undefined;\n        this.currentPage = undefined;\n        this.selectionStartPageIn = undefined;\n        this.selectionEndPageIn = undefined;\n        this.currentSelectedCommentInternal = undefined;\n        this.currentSelectedRevisionInternal = undefined;\n        this.owner = undefined;\n        this.heightInfoCollection = undefined;\n        this.isRestartNumbering = false;\n    };\n    /**\n     * Un-Wires events and methods\n     *\n     * @returns {void}\n     */\n    DocumentHelper.prototype.unWireEvent = function () {\n        this.viewerContainer.removeEventListener('scroll', this.scrollHandler);\n        this.viewerContainer.removeEventListener('mousedown', this.onMouseDownInternal);\n        this.viewerContainer.removeEventListener('mousemove', this.onMouseMoveInternal);\n        if (!Browser.isDevice) {\n            this.editableDiv.removeEventListener('keypress', this.onKeyPressInternal);\n            if (Browser.info.name === 'chrome') {\n                this.editableDiv.removeEventListener('textInput', this.onTextInput);\n            }\n        }\n        else {\n            this.editableDiv.removeEventListener('input', this.onTextInputInternal);\n        }\n        this.editableDiv.removeEventListener('paste', this.onPaste);\n        this.viewerContainer.removeEventListener('contextmenu', this.onContextMenu);\n        this.editableDiv.removeEventListener('blur', this.onFocusOut);\n        this.editableDiv.removeEventListener('keydown', this.onKeyDownInternal);\n        this.editableDiv.removeEventListener('compositionstart', this.compositionStart);\n        this.editableDiv.removeEventListener('compositionupdate', this.compositionUpdated);\n        this.editableDiv.removeEventListener('compositionend', this.compositionEnd);\n        this.viewerContainer.removeEventListener('mouseup', this.onMouseUpInternal);\n        if (!isNullOrUndefined(this.iframe)) {\n            this.iframe.removeEventListener('load', this.onIframeLoad);\n        }\n        this.viewerContainer.removeEventListener('dblclick', this.onDoubleTap);\n        window.removeEventListener('resize', this.onWindowResize);\n        window.removeEventListener('keyup', this.onKeyUpInternal);\n        window.removeEventListener('mouseup', this.onImageResizer);\n        window.removeEventListener('touchend', this.onImageResizer);\n        if (navigator !== undefined && navigator.userAgent.match('Firefox')) {\n            this.viewerContainer.removeEventListener('DOMMouseScroll', this.zoomModule.onMouseWheelInternal);\n        }\n        this.viewerContainer.removeEventListener('mousewheel', this.zoomModule.onMouseWheelInternal);\n    };\n    DocumentHelper.prototype.updateCursor = function (event) {\n        var hyperlinkField = undefined;\n        var footnoteElement = undefined;\n        var div = this.viewerContainer;\n        var point = new Point(event.offsetX, event.offsetY);\n        var touchPoint = this.owner.viewer.findFocusedPage(point, true);\n        var widget = this.getLineWidget(touchPoint);\n        var widgetInfo;\n        var left;\n        var top;\n        var editor = !this.owner.isReadOnlyMode ? this.owner.editorModule : undefined;\n        var isRowResize = editor ? editor.tableResize.isInRowResizerArea(touchPoint) : false;\n        var isCellResize = editor ? editor.tableResize.isInCellResizerArea(touchPoint) : false;\n        var floatItemInfo = this.selection.checkAllFloatingElements(widget, touchPoint);\n        var resizePosition = '';\n        if (this.owner.enableImageResizerMode) {\n            var resizeObj = this.owner.imageResizerModule.getImagePoint(touchPoint);\n            this.owner.imageResizerModule.selectedResizeElement = resizeObj.selectedElement;\n            resizePosition = resizeObj.resizePosition;\n        }\n        var lineLeft = 0;\n        var formField = undefined;\n        var referenceField = undefined;\n        var isInInline = this.checkPointIsInLine(widget, touchPoint);\n        if (!isNullOrUndefined(widget)) {\n            lineLeft = this.selection.getLineStartLeft(widget);\n            hyperlinkField = this.selection.getHyperLinkFieldInCurrentSelection(widget, touchPoint);\n            if (isNullOrUndefined(hyperlinkField)) {\n                formField = this.selection.getHyperLinkFieldInCurrentSelection(widget, touchPoint, true);\n            }\n            if (!isNullOrUndefined(hyperlinkField)) {\n                var code = this.selection.getFieldCode(hyperlinkField);\n                if (code.toLowerCase().indexOf('ref ') === 0 && !code.match('\\\\h')) {\n                    hyperlinkField = undefined;\n                }\n            }\n            widgetInfo = this.selection.updateTextPositionIn(widget, undefined, 0, touchPoint, true);\n            left = this.selection.getLeft(widget);\n            top = this.selection.getTop(widget);\n            if (isNullOrUndefined(hyperlinkField) && !isNullOrUndefined(formField) && this.isDocumentProtected &&\n                this.protectionType === 'FormFieldsOnly' && !this.isFormFilling) {\n                this.selection.setHyperlinkContentToToolTip(formField, widget, touchPoint.x, true);\n            }\n            else {\n                this.selection.setHyperlinkContentToToolTip(hyperlinkField, widget, touchPoint.x, false);\n            }\n            if (formField) {\n                var isInlineFormFillMode = (formField.formFieldData instanceof TextFormField) && formField.formFieldData.type === 'Text';\n                if (this.owner.documentEditorSettings.formFieldSettings.formFillingMode === 'Inline' && isInlineFormFillMode) {\n                    //Update text cursor in text form field.\n                    formField = undefined;\n                }\n            }\n            if (this.owner.enableLockAndEdit) {\n                var isLocked = false;\n                var block = widget.paragraph;\n                if (block.isInsideTable) {\n                    block = this.layout.getParentTable(block);\n                }\n                if (block.locked && block.lockedBy !== this.owner.currentUser) {\n                    isLocked = true;\n                }\n                var sectionFormat = widget.paragraph.bodyWidget.sectionFormat;\n                var pageWidth = sectionFormat.pageWidth - sectionFormat.rightMargin - sectionFormat.leftMargin;\n                pageWidth = HelperMethods.convertPointToPixel(pageWidth) * this.zoomFactor;\n                if (this.viewer instanceof WebLayoutViewer) {\n                    pageWidth = (this.visibleBounds.width - (this.viewer.padding.right * 5)) / this.zoomFactor;\n                }\n                if (isLocked && touchPoint.x >= lineLeft && touchPoint.x < lineLeft + pageWidth) {\n                    this.selection.setLockInfoTooptip(widget, touchPoint.x, block.lockedBy);\n                }\n                else {\n                    this.selection.setLockInfoTooptip(undefined, touchPoint.x, '');\n                }\n            }\n        }\n        if (!isNullOrUndefined(widget)) {\n            if (isNullOrUndefined(footnoteElement) && this.owner.layoutType == 'Pages') {\n                footnoteElement = this.selection.getFootNoteElementInCurrentSelection(widget, touchPoint);\n                if (footnoteElement instanceof FootnoteElementBox) {\n                    this.selection.setFootnoteContentToToolTip(footnoteElement, widget, touchPoint.x);\n                }\n            }\n        }\n        var isCtrlkeyPressed = this.isIosDevice ? event.metaKey : event.ctrlKey;\n        if ((!isNullOrUndefined(hyperlinkField) && (isCtrlkeyPressed &&\n            this.owner.useCtrlClickToFollowHyperlink || !this.owner.useCtrlClickToFollowHyperlink)) || formField) {\n            if (!isNullOrUndefined(formField)) {\n                if (this.isFormFillProtectedMode) {\n                    div.style.cursor = 'default';\n                }\n            }\n            else {\n                div.style.cursor = 'pointer';\n            }\n            return;\n        }\n        else if (touchPoint.x >= lineLeft &&\n            event.offsetX < (this.visibleBounds.width - (this.visibleBounds.width - this.viewerContainer.clientWidth)) &&\n            event.offsetY < (this.visibleBounds.height - (this.visibleBounds.height - this.viewerContainer.clientHeight))) {\n            if (this.selection.isEmpty) {\n                div.style.cursor = 'text';\n            }\n            else {\n                div.style.cursor = this.selection.checkCursorIsInSelection(widget, touchPoint) ? 'default' : 'text';\n            }\n        }\n        else {\n            div.style.cursor = 'default';\n        }\n        if (!isNullOrUndefined(resizePosition) && resizePosition !== '') {\n            if (!this.owner.imageResizerModule.isShapeResize || this.owner.imageResizerModule.isShapeResize && resizePosition !== 'move') {\n                div.style.cursor = resizePosition;\n            }\n        }\n        else if (!isNullOrUndefined(widgetInfo) && widgetInfo.isImageSelected && left < touchPoint.x && top < touchPoint.y &&\n            left + widget.width > touchPoint.x && top + widget.height > touchPoint.y) {\n            div.style.cursor = 'move';\n        }\n        if (isRowResize) {\n            div.style.cursor = 'row-resize';\n        }\n        else if (isCellResize) {\n            div.style.cursor = 'col-resize';\n        }\n        if (floatItemInfo.isInShapeBorder && !isInInline) {\n            div.style.cursor = 'all-scroll';\n        }\n    };\n    /**\n     * @private\n     */\n    DocumentHelper.prototype.updateDialogTabHeight = function (dialogElement, targetElement) {\n        var header = dialogElement.getElementsByClassName('e-dlg-header-content')[0];\n        var contentElement = dialogElement.getElementsByClassName('e-dlg-content')[0];\n        var footer = dialogElement.getElementsByClassName('e-footer-content')[0];\n        var contentStyle = getComputedStyle(contentElement);\n        var dialogStyle = getComputedStyle(dialogElement);\n        var paddingTop = parseInt(contentStyle.paddingTop, 10);\n        var paddingBottom = parseInt(contentStyle.paddingBottom, 10);\n        var paddingVertical = (isNaN(paddingTop) ? 0 : paddingTop) + (isNaN(paddingBottom) ? 0 : paddingBottom);\n        var borderTop = parseInt(dialogStyle.borderTop, 10);\n        var borderBottom = parseInt(dialogStyle.borderBottom, 10);\n        var borderVertical = (isNaN(borderTop) ? 0 : borderTop) + (isNaN(borderBottom) ? 0 : borderBottom);\n        var contentHeight = dialogElement.offsetHeight - (header.offsetHeight + footer.offsetHeight + paddingVertical + borderVertical);\n        targetElement.style.height = contentHeight + 'px';\n        var paddingLeft = parseInt(contentStyle.paddingLeft, 10);\n        var paddingRight = parseInt(contentStyle.paddingRight, 10);\n        var paddingHorizontal = (isNaN(paddingLeft) ? 0 : paddingLeft) + (isNaN(paddingRight) ? 0 : paddingRight);\n        var borderLeft = parseInt(dialogStyle.borderLeft, 10);\n        var borderRight = parseInt(dialogStyle.borderRight, 10);\n        var borderHorizontal = (isNaN(borderLeft) ? 0 : borderLeft) + (isNaN(borderRight) ? 0 : borderRight);\n        var contentWidth = dialogElement.offsetWidth - (paddingHorizontal + borderHorizontal);\n        return contentWidth;\n    };\n    /**\n     *\n     * @private\n     */\n    DocumentHelper.prototype.canRenderBorder = function (paragraph) {\n        var skipTopBorder = false;\n        var skipBottomBorder = false;\n        var isSamePreviousBorder;\n        var isSameNextBorder;\n        var isSameTopBorder;\n        var isSameBottomBorder;\n        var isSameLeftBorder;\n        var isSameRightBorder;\n        var previousBlock = paragraph.previousRenderedWidget;\n        var nextBlock = paragraph.nextRenderedWidget;\n        var paragraphX = this.getParagraphLeftPosition(paragraph);\n        var previousBlockX = 0;\n        var nextBlockX = 0;\n        if (!isNullOrUndefined(previousBlock) && previousBlock instanceof ParagraphWidget) {\n            previousBlockX = this.getParagraphLeftPosition(previousBlock);\n        }\n        if (!isNullOrUndefined(nextBlock) && nextBlock instanceof ParagraphWidget) {\n            nextBlockX = this.getParagraphLeftPosition(nextBlock);\n        }\n        if (!isNullOrUndefined(previousBlock) && previousBlock instanceof ParagraphWidget && paragraphX === previousBlockX) {\n            isSameTopBorder = this.checkEqualBorder(paragraph.paragraphFormat.borders.top, previousBlock.paragraphFormat.borders.top);\n            isSameBottomBorder = this.checkEqualBorder(paragraph.paragraphFormat.borders.bottom, previousBlock.paragraphFormat.borders.bottom);\n            isSameLeftBorder = this.checkEqualBorder(paragraph.paragraphFormat.borders.left, previousBlock.paragraphFormat.borders.left);\n            isSameRightBorder = this.checkEqualBorder(paragraph.paragraphFormat.borders.right, previousBlock.paragraphFormat.borders.right);\n            if (isSameTopBorder && isSameBottomBorder && isSameLeftBorder && isSameRightBorder\n                && !isNullOrUndefined(previousBlock.paragraphFormat.borders.horizontal) && previousBlock.paragraphFormat.borders.horizontal.lineStyle === 'None') {\n                skipTopBorder = true;\n            }\n        }\n        if (!isNullOrUndefined(nextBlock) && nextBlock instanceof ParagraphWidget && (paragraphX === nextBlockX || (this.owner.documentHelper.layout.isInitialLoad && this.skipBottomBorder(paragraph, nextBlock)))) {\n            isSameTopBorder = this.checkEqualBorder(paragraph.paragraphFormat.borders.top, nextBlock.paragraphFormat.borders.top);\n            isSameBottomBorder = this.checkEqualBorder(paragraph.paragraphFormat.borders.bottom, nextBlock.paragraphFormat.borders.bottom);\n            isSameLeftBorder = this.checkEqualBorder(paragraph.paragraphFormat.borders.left, nextBlock.paragraphFormat.borders.left);\n            isSameRightBorder = this.checkEqualBorder(paragraph.paragraphFormat.borders.right, nextBlock.paragraphFormat.borders.right);\n            if (isSameBottomBorder && isSameTopBorder && isSameLeftBorder && isSameRightBorder) {\n                skipBottomBorder = true;\n            }\n        }\n        return {\n            'skipTopBorder': skipTopBorder,\n            'skipBottomBorder': skipBottomBorder\n        };\n    };\n    DocumentHelper.prototype.checkEqualBorder = function (source, dest) {\n        if (!isNullOrUndefined(source) && !isNullOrUndefined(dest)) {\n            return source.isEqualFormat(dest);\n        }\n        else {\n            if (isNullOrUndefined(source) && isNullOrUndefined(dest)) {\n                return true;\n            }\n            else {\n                return false;\n            }\n        }\n    };\n    /**\n    * @private\n    */\n    DocumentHelper.prototype.getParagraphLeftPosition = function (paragraphWidget) {\n        var hangingIndent = 0;\n        var startX = 0;\n        if (paragraphWidget.paragraphFormat.firstLineIndent < 0) {\n            hangingIndent = HelperMethods.convertPointToPixel(Math.abs(paragraphWidget.paragraphFormat.firstLineIndent));\n            hangingIndent = parseFloat(hangingIndent.toFixed(5));\n        }\n        if (paragraphWidget.isEmpty() && ((paragraphWidget.paragraphFormat.textAlignment !== 'Left' && paragraphWidget.paragraphFormat.textAlignment !== 'Justify')\n            || (paragraphWidget.paragraphFormat.textAlignment === 'Justify' && paragraphWidget.paragraphFormat.bidi))) {\n            startX = paragraphWidget.clientX > hangingIndent ? paragraphWidget.clientX - hangingIndent : paragraphWidget.clientX;\n            return startX;\n        }\n        else {\n            startX = paragraphWidget.x > hangingIndent ? paragraphWidget.x - hangingIndent : paragraphWidget.x;\n            return startX;\n        }\n    };\n    /**\n  * @private\n  */\n    DocumentHelper.prototype.skipBottomBorder = function (paragraph, nextWidget) {\n        var currentIndent = 0;\n        var previousIndent = 0;\n        if (paragraph.paragraphFormat.leftIndent === nextWidget.paragraphFormat.leftIndent) {\n            return true;\n        }\n        else {\n            currentIndent = paragraph.paragraphFormat.firstLineIndent < 0 ? Math.abs(paragraph.paragraphFormat.firstLineIndent) : 0;\n            previousIndent = nextWidget.paragraphFormat.firstLineIndent < 0 ? Math.abs(nextWidget.paragraphFormat.firstLineIndent) : 0;\n            currentIndent = paragraph.paragraphFormat.leftIndent > currentIndent ? paragraph.paragraphFormat.leftIndent - currentIndent : 0;\n            previousIndent = nextWidget.paragraphFormat.leftIndent > previousIndent ? nextWidget.paragraphFormat.leftIndent - previousIndent : 0;\n            if (currentIndent === previousIndent) {\n                return true;\n            }\n            else {\n                return false;\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    DocumentHelper.prototype.isPageInVisibleBound = function (page, pageTop) {\n        var height = this.visibleBounds.height;\n        var vertical = this.viewerContainer.scrollTop;\n        var pageH = page.boundingRectangle.height * this.zoomFactor;\n        var isTopFit = pageTop >= vertical && pageTop <= vertical + height;\n        var isBottomFit = pageTop + pageH >= vertical && pageTop + pageH <= vertical + height;\n        var isMiddleFit = pageTop <= vertical && pageTop + pageH >= vertical + height;\n        return isTopFit || isBottomFit || isMiddleFit;\n    };\n    /**\n     * Get first paragraph in cell\n     *\n     * @private\n     * @returns {ParagraphWidget}\n     */\n    DocumentHelper.prototype.getFirstParagraphInCell = function (cell) {\n        var firstBlock = cell.childWidgets[0];\n        if (firstBlock instanceof ParagraphWidget) {\n            return firstBlock;\n        }\n        else {\n            return this.getFirstParagraphInFirstCell(firstBlock);\n        }\n    };\n    /**\n     * Get first paragraph in first cell\n     *\n     * @private\n     * @returns {TableWidget}\n     */\n    DocumentHelper.prototype.getFirstParagraphInFirstCell = function (table) {\n        if (!isNullOrUndefined(table.childWidgets) && table.childWidgets.length > 0) {\n            var firstRow = table.childWidgets[0];\n            var cell = firstRow.childWidgets[0];\n            var block = cell.childWidgets[0];\n            return this.getFirstParagraphBlock(block);\n        }\n        return undefined;\n    };\n    /**\n     * Get last paragraph in last cell\n     *\n     * @private\n     * @returns {ParagraphWidget}\n     */\n    DocumentHelper.prototype.getLastParagraphInLastCell = function (table) {\n        if (!isNullOrUndefined(table.childWidgets) && table.childWidgets.length > 0) {\n            var lastrow = table.lastChild;\n            var lastcell = lastrow.lastChild;\n            var lastBlock = lastcell.lastChild;\n            return this.getLastParagraphBlock(lastBlock);\n        }\n        return undefined;\n    };\n    /**\n     * Get first paragraph in block\n     *\n     * @private\n     * @returns {ParagraphWidget}\n     */\n    DocumentHelper.prototype.getFirstParagraphBlock = function (block) {\n        if (block instanceof ParagraphWidget) {\n            return block;\n        }\n        else if (block instanceof TableWidget) {\n            return this.getFirstParagraphInFirstCell(block);\n        }\n        return undefined;\n    };\n    /**\n     * Get last paragraph in block\n     *\n     * @private\n     * @returns {ParagraphWidget}\n     */\n    DocumentHelper.prototype.getLastParagraphBlock = function (block) {\n        if (block instanceof ParagraphWidget) {\n            return block;\n        }\n        else if (block instanceof TableWidget) {\n            return this.getLastParagraphInLastCell(block);\n        }\n        return undefined;\n    };\n    /**\n     * Get last paragraph in first row\n     *\n     * @private\n     * @returns {ParagraphWidget}\n     */\n    DocumentHelper.prototype.getLastParagraphInFirstRow = function (table) {\n        if (table.childWidgets.length > 0) {\n            var row = table.firstChild;\n            var lastcell = row.lastChild;\n            var lastBlock = lastcell.lastChild;\n            return this.getLastParagraphBlock(lastBlock);\n        }\n        return undefined;\n    };\n    /**\n     * Get first paragraph in last row\n     *\n     * @private\n     */\n    DocumentHelper.prototype.getFirstParagraphInLastRow = function (table) {\n        if (table.childWidgets.length > 0) {\n            var lastRow = table.childWidgets[table.childWidgets.length - 1];\n            var lastCell = lastRow.childWidgets[0];\n            var lastBlock = lastCell.childWidgets[0];\n            return this.getFirstParagraphBlock(lastBlock);\n        }\n        return undefined;\n    };\n    /**\n     * Add the given WStyle Object ot stylesMap Dictionary\n     *\n     * @private\n     */\n    /* eslint-disable  */\n    DocumentHelper.prototype.addToStylesMap = function (style) {\n        var returnStyle = {};\n        var returnStyleObject = {};\n        var paraIcon = 'e-list-icon e-de-listview-icon e-de-e-paragraph-style-mark e-icons';\n        var charIcon = 'e-list-icon e-de-listview-icon e-de-e-character-style-mark e-icons';\n        var linkedIcon = 'e-list-icon e-de-listview-icon e-de-e-linked-style-mark e-icons';\n        // StyleName for the dropDownItem\n        if (!isNullOrUndefined(style)) {\n            var styleName = this.owner ? this.L10n.getConstant(style.name) : style.name;\n            returnStyle.StyleName = (styleName === '') ? style.name : styleName;\n            if (style.type == \"Paragraph\") {\n                returnStyleObject.paragraphFormat = {};\n                HelperMethods.writeParagraphFormat(returnStyleObject.paragraphFormat, true, style.paragraphFormat);\n            }\n            returnStyleObject.characterFormat = {};\n            HelperMethods.writeCharacterFormat(returnStyleObject.characterFormat, true, style.characterFormat);\n            // CSS Style for dropDownItem\n            returnStyle.Style = this.parseStyle(JSON.stringify(returnStyleObject));\n            // Setting type for segregating and adding iconcss\n            if (!isNullOrUndefined(style.type)) {\n                returnStyle.type = style.type;\n                if (returnStyle.type == \"Paragraph\" && !isNullOrUndefined(style.link)) {\n                    returnStyle.type = \"Linked\";\n                }\n            }\n            // Adding IconCss to the dropDownItem\n            if (returnStyle.type == \"Paragraph\") {\n                returnStyle.IconClass = paraIcon;\n            }\n            else if (returnStyle.type == \"Character\") {\n                returnStyle.IconClass = charIcon;\n            }\n            else {\n                returnStyle.IconClass = linkedIcon;\n            }\n            if (this.stylesMap.get(returnStyle.type)) {\n                this.stylesMap.get(returnStyle.type).push(returnStyle);\n            }\n            else {\n                this.stylesMap.add(returnStyle.type, [returnStyle]);\n            }\n        }\n    };\n    DocumentHelper.prototype.parseStyle = function (style) {\n        var domStyle = '';\n        var styleObj = JSON.parse(style);\n        var textDecoration = '';\n        if (!isNullOrUndefined(styleObj.characterFormat.baselineAlignment) && styleObj.characterFormat.baselineAlignment !== 'Normal') {\n            var vAlign = '';\n            switch (styleObj.characterFormat.baselineAlignment) {\n                case 'Superscript':\n                    vAlign = 'super';\n                    break;\n                case 'Subscript':\n                    vAlign = 'sub';\n                    break;\n            }\n            if (vAlign.length > 1) {\n                domStyle += 'vertical-align:' + vAlign + ';';\n            }\n        }\n        if (!isNullOrUndefined(styleObj.characterFormat.underline) && styleObj.characterFormat.underline !== 'None') {\n            textDecoration += 'underline ';\n        }\n        if (!isNullOrUndefined(styleObj.characterFormat.strikethrough) && styleObj.characterFormat.strikethrough !== 'None') {\n            textDecoration += 'line-through ';\n        }\n        if (!isNullOrUndefined(styleObj.characterFormat.fontSize)) {\n            domStyle += 'font-size:' + styleObj.characterFormat.fontSize + 'px;';\n        }\n        if (!isNullOrUndefined(styleObj.characterFormat.fontFamily)) {\n            domStyle += 'font-family:' + styleObj.characterFormat.fontFamily + ';';\n        }\n        if (!isNullOrUndefined(styleObj.characterFormat.bold) && styleObj.characterFormat.bold) {\n            domStyle += 'font-weight:bold;';\n        }\n        if (!isNullOrUndefined(styleObj.characterFormat.italic) && styleObj.characterFormat.italic) {\n            domStyle += 'font-style:italic;';\n        }\n        // if (!isNullOrUndefined(styleObj.characterFormat.fontColor)) {\n        //     domStyle += 'color: ' + styleObj.characterFormat.fontColor + ';';\n        // }\n        if (textDecoration.length > 1) {\n            domStyle += 'text-decoration:' + textDecoration + ';';\n        }\n        return domStyle;\n    };\n    return DocumentHelper;\n}());\nexport { DocumentHelper };\n/**\n * @private\n */\nvar LayoutViewer = /** @class */ (function () {\n    function LayoutViewer(owner) {\n        /**\n         * @private\n         */\n        this.visiblePages = [];\n        /**\n         * @private\n         */\n        this.padding = new Padding(10, 10, 30, 10);\n        /**\n         * @private\n         */\n        this.textWrap = true;\n        /**\n         * @private\n         */\n        this.pageFitTypeIn = 'None';\n        /**\n         * @private\n         */\n        this.containerTop = 0;\n        /**\n         * @private\n         */\n        this.containerWidth = 0;\n        /**\n         * @private\n         */\n        this.containerLeft = 0;\n        this.owner = owner;\n        this.columnLayoutArea = new ColumnLayout(this);\n    }\n    Object.defineProperty(LayoutViewer.prototype, \"documentHelper\", {\n        get: function () {\n            return this.owner.documentHelper;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"pageFitType\", {\n        /**\n         * Gets or sets page fit type.\n         * @private\n         */\n        get: function () {\n            return this.pageFitTypeIn;\n        },\n        set: function (value) {\n            this.pageFitTypeIn = value;\n            this.onPageFitTypeChanged(this.pageFitTypeIn);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    LayoutViewer.prototype.updateClientArea = function (bodyWidget, page, isReLayout) {\n        var sectionFormat;\n        if (!isNullOrUndefined(bodyWidget)) {\n            sectionFormat = bodyWidget.sectionFormat;\n            this.columnLayoutArea.setColumns(sectionFormat);\n        }\n        var width = 0;\n        var height = 0;\n        if (this instanceof WebLayoutViewer) {\n            var top_2 = 0;\n            width = (this.documentHelper.visibleBounds.width - (this.padding.right * 4) - (this.padding.left * 2)) / this.documentHelper.zoomFactor;\n            if (width < 0) {\n                width = 0;\n            }\n            height = Number.POSITIVE_INFINITY;\n            this.clientArea = new Rect(this.padding.left / this.documentHelper.zoomFactor, top_2, width, height);\n            this.clientActiveArea = new Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n        }\n        else {\n            var top_3 = 0;\n            var headerDistance = 48;\n            var footerDistance = 48;\n            var pageHeight = HelperMethods.convertPointToPixel(sectionFormat.pageHeight);\n            var bottomMargin = HelperMethods.convertPointToPixel(sectionFormat.bottomMargin);\n            if (!isNullOrUndefined(sectionFormat)) {\n                top_3 = HelperMethods.convertPointToPixel(sectionFormat.topMargin);\n                headerDistance = HelperMethods.convertPointToPixel(sectionFormat.headerDistance);\n                footerDistance = HelperMethods.convertPointToPixel(sectionFormat.footerDistance);\n            }\n            var isEmptyWidget = false;\n            if (!isNullOrUndefined(page.headerWidget)) {\n                isEmptyWidget = page.headerWidget.isEmpty;\n                if (top_3 >= 0) {\n                    if (!isEmptyWidget || isEmptyWidget && this.owner.enableHeaderAndFooter) {\n                        top_3 = Math.min(Math.max(headerDistance + page.headerWidget.height, top_3), pageHeight / 100 * 40);\n                    }\n                }\n                else {\n                    top_3 = Math.abs(top_3);\n                }\n            }\n            var bottom = 0.667 + bottomMargin;\n            if (!isNullOrUndefined(page.footerWidget)) {\n                isEmptyWidget = page.footerWidget.isEmpty;\n                var footnoteHeight = !isNullOrUndefined(page.footnoteWidget) ? page.footnoteWidget.height : 0;\n                footnoteHeight = Math.min(footnoteHeight, ((pageHeight - top_3 - bottom) / 100 * 90));\n                if (bottom >= 0) {\n                    if (!isEmptyWidget || isEmptyWidget && this.owner.enableHeaderAndFooter) {\n                        bottom = 0.667 + Math.min(pageHeight / 100 * 40, Math.max(footerDistance + page.footerWidget.height, bottomMargin));\n                    }\n                }\n                else {\n                    bottom = Math.abs(bottom);\n                }\n                bottom += footnoteHeight;\n            }\n            if (!isNullOrUndefined(sectionFormat)) {\n                width = HelperMethods.convertPointToPixel(sectionFormat.pageWidth - sectionFormat.leftMargin - sectionFormat.rightMargin);\n                height = pageHeight - top_3 - bottom;\n            }\n            if (width < 0) {\n                width = 0;\n            }\n            var clientArea = new Rect(HelperMethods.convertPointToPixel(sectionFormat.leftMargin), top_3, width, pageHeight - top_3 - bottom);\n            if (page.footnoteWidget && isReLayout && !this.documentHelper.owner.editorModule.isFootNote) {\n                if (page.footnoteWidget.y !== 0 && this.clientArea.y + this.clientArea.height > page.footnoteWidget.y) {\n                    var sub = (this.clientArea.y + this.clientArea.height - page.footnoteWidget.y);\n                    this.clientArea.height -= sub / 2;\n                }\n            }\n            if (bodyWidget.page.bodyWidgets[0].columnIndex !== 0) {\n                this.owner.editorModule.updateColumnIndex(bodyWidget, false);\n            }\n            this.setClientArea(bodyWidget, clientArea);\n            this.clientActiveArea = new Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n        }\n    };\n    LayoutViewer.prototype.setClientArea = function (bodyWidget, clientArea) {\n        this.clientArea = this.columnLayoutArea.getColumnBoundsByBodyWidget(bodyWidget, clientArea);\n        bodyWidget.x = this.clientArea.x;\n        bodyWidget.width = this.clientArea.width;\n    };\n    LayoutViewer.prototype.updateClientAreaTopOrLeft = function (tableWidget, beforeLayout) {\n        if (beforeLayout) {\n            this.clientActiveArea.y = this.clientActiveArea.y + tableWidget.topBorderWidth;\n            this.clientActiveArea.x = this.clientActiveArea.x + tableWidget.leftBorderWidth;\n        }\n    };\n    LayoutViewer.prototype.updateClientAreaForTable = function (tableWidget) {\n        this.clientActiveArea.x = this.clientArea.x = tableWidget.x;\n        this.clientActiveArea.width = this.clientArea.width = tableWidget.width;\n    };\n    LayoutViewer.prototype.updateClientAreaForRow = function (row, beforeLayout) {\n        var tableWidget = row.ownerTable;\n        if (beforeLayout) {\n        }\n        else {\n            this.clientActiveArea.x = this.clientArea.x = tableWidget.x;\n            this.clientActiveArea.width = this.clientArea.width = tableWidget.width;\n            this.clientArea = new Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n            this.clientActiveArea = new Rect(this.clientActiveArea.x, this.clientActiveArea.y, this.clientActiveArea.width, this.clientActiveArea.height);\n        }\n    };\n    LayoutViewer.prototype.updateClientAreaForCell = function (cell, beforeLayout) {\n        var rowWidget = cell.ownerRow;\n        var cellWidget = cell;\n        if (beforeLayout) {\n            this.clientActiveArea.x = this.clientArea.x = cellWidget.x;\n            this.clientActiveArea.y = cellWidget.y;\n            this.clientActiveArea.width = this.clientArea.width = cellWidget.width > 0 ? cellWidget.width : 0;\n            if (this instanceof PageLayoutViewer) {\n                this.clientActiveArea.height = Number.POSITIVE_INFINITY;\n            }\n            this.clientArea = new Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n            this.clientActiveArea = new Rect(this.clientActiveArea.x, this.clientActiveArea.y, this.clientActiveArea.width, this.clientActiveArea.height);\n        }\n        else {\n            this.clientActiveArea.x = this.clientArea.x = cellWidget.x + cellWidget.width + cellWidget.margin.right;\n            if (rowWidget.x + rowWidget.width - this.clientArea.x < 0) {\n                this.clientActiveArea.width = this.clientArea.width = 0;\n            }\n            else {\n                this.clientActiveArea.width = this.clientArea.width = rowWidget.x + rowWidget.width - this.clientArea.x;\n            }\n            this.clientActiveArea.y = cellWidget.y - cellWidget.margin.top - HelperMethods.convertPointToPixel(cell.ownerTable.tableFormat.cellSpacing);\n            if (!cell.ownerTable.isInsideTable) {\n                this.clientActiveArea.height = this.clientArea.bottom - rowWidget.y > 0 ? this.clientArea.bottom - rowWidget.y : 0;\n                if (!cell.ownerTable.wrapTextAround && this.documentHelper.layout.existFootnoteHeight > 0) {\n                    var updateHeight = this.clientActiveArea.height - this.documentHelper.layout.existFootnoteHeight;\n                    this.clientActiveArea.height = updateHeight < 0 ? 0 : updateHeight;\n                }\n            }\n            this.clientArea = new Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n            this.clientActiveArea = new Rect(this.clientActiveArea.x, this.clientActiveArea.y, this.clientActiveArea.width, this.clientActiveArea.height);\n        }\n    };\n    LayoutViewer.prototype.updateClientAreaForTextBoxShape = function (textBox, beforeLayout, shiftNextWidget) {\n        if (textBox.textWrappingStyle === 'Inline' && !shiftNextWidget) {\n            textBox.y = this.clientActiveArea.y;\n            textBox.x = this.clientActiveArea.x;\n        }\n        if (beforeLayout) {\n            var marginLeft = HelperMethods.convertPointToPixel(textBox.textFrame.marginLeft);\n            var marginRight = HelperMethods.convertPointToPixel(textBox.textFrame.marginRight);\n            var marginTop = HelperMethods.convertPointToPixel(textBox.textFrame.marginTop);\n            var marginBottom = HelperMethods.convertPointToPixel(textBox.textFrame.marginBottom);\n            var width = textBox.width;\n            var height = Number.POSITIVE_INFINITY;\n            this.clientArea = new Rect(textBox.x + marginLeft, textBox.y + marginTop, width - marginLeft - marginRight, height - marginTop - marginBottom);\n            this.clientActiveArea = new Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n        }\n    };\n    LayoutViewer.prototype.updateClientAreaByWidgetFootNote = function (widget) {\n        this.clientArea.x = widget.x;\n        this.clientArea.y = widget.y;\n        this.clientActiveArea.x = widget.x;\n        this.clientActiveArea.y = widget.y;\n    };\n    /**\n     * @private\n     */\n    LayoutViewer.prototype.updateClientAreaForTextWrap = function (area) {\n        this.clientActiveArea = new Rect(area.x, area.y, area.width, area.height);\n    };\n    LayoutViewer.prototype.updateBoundsBasedOnTextWrap = function (bottom) {\n        var diff = bottom - this.clientActiveArea.y;\n        this.clientActiveArea.y = bottom;\n        this.clientActiveArea.height = this.clientActiveArea.height - diff;\n    };\n    LayoutViewer.prototype.updateBoundsBasedOnTextWrapTable = function (bottom) {\n        var diff = bottom - this.clientArea.y;\n        this.clientArea.y = bottom;\n        this.clientArea.height = this.clientArea.height - diff;\n        this.clientActiveArea = new Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n    };\n    LayoutViewer.prototype.updateClientAreaByWidget = function (widget) {\n        this.clientArea.x = widget.x;\n        this.clientArea.y = widget.y;\n        this.clientActiveArea.x = widget.x;\n        this.clientActiveArea.y = widget.y;\n    };\n    LayoutViewer.prototype.updateClientAreaLocation = function (widget, area) {\n        widget.x = area.x;\n        widget.y = area.y;\n        widget.width = area.width;\n    };\n    LayoutViewer.prototype.updateClientAreaForBlock = function (block, beforeLayout, tableCollection, updateYPosition, updateXPosition) {\n        var leftIndent = HelperMethods.convertPointToPixel(block.leftIndent);\n        var rightIndent = HelperMethods.convertPointToPixel(block.rightIndent);\n        var bidi = block.bidi;\n        var width = 0;\n        if (beforeLayout) {\n            if (block instanceof TableWidget && tableCollection) {\n                var tableWidget = tableCollection[0];\n                if (block.bodyWidget.sectionFormat.columns.length <= 1) {\n                    this.clientActiveArea.x = this.clientArea.x = tableWidget.x;\n                    this.clientActiveArea.width = this.clientArea.width = tableWidget.width;\n                }\n                //Updates the location of last item.\n                tableWidget = tableCollection[tableCollection.length - 1];\n                tableWidget.x = this.clientActiveArea.x;\n                tableWidget.y = this.clientActiveArea.y;\n            }\n            else {\n                if (block instanceof TableWidget && !isNullOrUndefined(block.tableFormat)) {\n                    if (!block.isGridUpdated) {\n                        block.buildTableColumns();\n                        block.isGridUpdated = true;\n                    }\n                    var tableAlignment = this.tableAlignmentForBidi(block, bidi);\n                    if (tableAlignment !== 'Left') {\n                        var tableWidth = 0;\n                        // If the grid is calculated, we can direclty get the width from the grid.\n                        // Otherwise, calculate the width.\n                        tableWidth = HelperMethods.convertPointToPixel(block.tableHolder.getTotalWidth(0));\n                        tableWidth = tableWidth === 0 ? block.tableHolder.tableWidth === 0 ?\n                            block.getTableClientWidth(block.getOwnerWidth(false)) : block.tableHolder.tableWidth : tableWidth;\n                        // Fore resizing table, the tableholder table width taken for updated width. \n                        // Since, the columns will be cleared if we performed resizing.\n                        if (this.owner.editorModule && this.owner.editorModule.tableResize.currentResizingTable === block\n                            && this.owner.editorModule.tableResize.resizerPosition === 0) {\n                            tableWidth = HelperMethods.convertPointToPixel(block.tableHolder.tableWidth);\n                        }\n                        if (tableAlignment === 'Center') {\n                            if (!this.documentHelper.isRowOrCellResizing) {\n                                tableWidth = block.getTableCellWidth();\n                            }\n                            leftIndent = (this.clientArea.width - tableWidth) / 2;\n                        }\n                        else {\n                            leftIndent = this.clientArea.width - tableWidth;\n                        }\n                        if (bidi) {\n                            leftIndent = leftIndent - HelperMethods.convertPointToPixel(block.leftIndent);\n                            rightIndent = leftIndent;\n                        }\n                        if (!block.isInsideTable) {\n                            //leftIndent = (block.tableFormat.horizontalPositionAbs === 'Left') ? block.tableFormat.horizontalPosition : leftIndent;\n                        }\n                        this.documentHelper.tableLefts.push(leftIndent);\n                    }\n                }\n                width = this.clientArea.width - (leftIndent + HelperMethods.convertPointToPixel(block.rightIndent));\n                var x = this.clientArea.x + (bidi ? rightIndent : leftIndent);\n                width = width > 0 ? width : 0;\n                this.clientActiveArea.x = this.clientArea.x = x;\n                this.clientActiveArea.width = this.clientArea.width = width;\n                if (updateYPosition) {\n                    this.updateParagraphYPositionBasedonTextWrap(block, new Rect(this.clientActiveArea.x, this.clientActiveArea.y, this.clientActiveArea.width, this.clientActiveArea.height));\n                }\n                if (updateXPosition) {\n                    if (block instanceof ParagraphWidget) {\n                        this.updateParagraphXPositionBasedOnTextWrap(block);\n                    }\n                    else {\n                        this.updateTableXPositionBasedOnTextWrap(block);\n                    }\n                }\n            }\n        }\n        else {\n            // Clears table left for table with right or center alignment.\n            if (block instanceof TableWidget && !isNullOrUndefined(block.tableFormat)) {\n                var tableAlignment = this.tableAlignmentForBidi(block, bidi);\n                if (!block.isGridUpdated) {\n                    block.buildTableColumns();\n                    block.isGridUpdated = true;\n                }\n                if (tableAlignment !== 'Left' && this.documentHelper.tableLefts.length > 0) {\n                    leftIndent = this.documentHelper.tableLefts.pop();\n                    if (bidi) {\n                        rightIndent = leftIndent;\n                    }\n                }\n            }\n            width = this.clientArea.width + leftIndent + HelperMethods.convertPointToPixel(block.rightIndent);\n            var x = this.clientArea.x - (bidi ? rightIndent : leftIndent);\n            width = width > 0 ? width : 0;\n            this.clientActiveArea.x = this.clientArea.x = x;\n            this.clientActiveArea.width = this.clientArea.width = width;\n        }\n        this.clientArea = new Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n        this.clientActiveArea = new Rect(this.clientActiveArea.x, this.clientActiveArea.y, this.clientActiveArea.width, this.clientActiveArea.height);\n    };\n    LayoutViewer.prototype.updateParagraphYPositionBasedonTextWrap = function (block, rect) {\n        var bodyWidget = block.bodyWidget;\n        var clientLayoutArea = this.clientActiveArea;\n        if (bodyWidget && bodyWidget.floatingElements.length > 0 && block instanceof ParagraphWidget && !(block.containerWidget instanceof TextFrame)\n            && !block.isInsideTable && !(block.containerWidget instanceof FootNoteWidget)) {\n            var isWord2013 = this.documentHelper.compatibilityMode === 'Word2013';\n            var paragraph = block;\n            var isEmptyPara = paragraph.isEmpty();\n            var paragraphHeight = paragraph.height;\n            if (paragraphHeight === 0) {\n                paragraphHeight = this.documentHelper.textHelper.getParagraphMarkSize(paragraph.characterFormat).Height;\n            }\n            //Update Layout area based on text wrap\n            if (((!paragraph.isInHeaderFooter || paragraph.isInsideTable)\n                || isWord2013)) {\n                var yposition = rect.y;\n                // As per Microsoft Word behavior, need to update bottom position of first inline item to floating item bottom,\n                // when first inline item of page intersects in-between two adjacent floating items parallel in vertical\n                // for Word document lower than Microsoft Word 2013 version.\n                // To do: Currently this behavior handled for bottom position update based on Y position,\n                // need to handle this behavior for bottom position update based on X position in UpdateParagraphXPositionBasedOnTextWrap method.\n                var isFirstItemBottomPositionUpdated = false;\n                //Need to handle sorting floating items.\n                // Sort based on Y position\n                bodyWidget.floatingElements.sort(function (a, b) { return a.y - b.y; });\n                // Sort based on X position\n                bodyWidget.floatingElements.sort(function (a, b) { return a.x - b.x; });\n                var previousItem = paragraph.previousRenderedWidget;\n                if (previousItem && (previousItem instanceof TableWidget) && previousItem.wrapTextAround\n                    && !isEmptyPara && !paragraph.isContainsShapeAlone() && isWord2013 && rect.y < previousItem.y) {\n                    rect.y = previousItem.y;\n                }\n                for (var i = 0; i < bodyWidget.floatingElements.length; i++) {\n                    var floatingItem = bodyWidget.floatingElements[i];\n                    var isInsideHeaderFooter = false;\n                    if (floatingItem instanceof ShapeBase) {\n                        isInsideHeaderFooter = floatingItem.paragraph.isInHeaderFooter;\n                    }\n                    else {\n                        isInsideHeaderFooter = floatingItem.bodyWidget instanceof HeaderFooterWidget ? true : false;\n                    }\n                    if (paragraph.isInsideTable) {\n                        if (floatingItem instanceof TableWidget && !floatingItem.isInsideTable) {\n                            continue;\n                        }\n                    }\n                    var textWrappingBounds = this.getTextWrappingBound(floatingItem);\n                    var textWrappingStyle = floatingItem instanceof TableWidget ? 'Square' : floatingItem.textWrappingStyle;\n                    var textWrappingType = floatingItem instanceof TableWidget ? 'Both' : floatingItem.textWrappingType;\n                    var minimumWidthRequired = 24;\n                    if (!(clientLayoutArea.x > (textWrappingBounds.right + minimumWidthRequired) || clientLayoutArea.right < textWrappingBounds.x - minimumWidthRequired)) {\n                        if ((((rect.y + (floatingItem instanceof TableWidget && !isEmptyPara && paragraph.floatingElements.length === 0 ? paragraphHeight : paragraph.height) > textWrappingBounds.y\n                            || isFirstItemBottomPositionUpdated) && rect.y < (textWrappingBounds.bottom))) && textWrappingStyle !== 'Inline'\n                            && textWrappingStyle !== 'TopAndBottom' && textWrappingStyle !== 'InFrontOfText'\n                            && textWrappingStyle !== 'Behind') {\n                            var rightIndent = 0;\n                            var paragarphRightIndent = HelperMethods.convertPointToPixel(paragraph.paragraphFormat.rightIndent);\n                            var firstLineIndent = HelperMethods.convertPointToPixel(paragraph.paragraphFormat.firstLineIndent);\n                            firstLineIndent = ((!isEmptyPara && paragraph.childWidgets[0].isFirstLine()) && firstLineIndent > 0) ? firstLineIndent : 0;\n                            if (rect.x >= textWrappingBounds.x && textWrappingType !== 'Left') {\n                                rightIndent = paragarphRightIndent;\n                            }\n                            // Gets the value from right indent when it is negative, otherwise sets the value as zero.\n                            rightIndent = rightIndent < 0 ? rightIndent : 0;\n                            if (rect.x < textWrappingBounds.x && rect.x > textWrappingBounds.x && textWrappingType !== 'Left') {\n                                if (rect.right > textWrappingBounds.x) {\n                                    rect.width = rect.width - (rect.right - textWrappingBounds.right);\n                                }\n                                if (rect.width < minimumWidthRequired) {\n                                    //Skip to wrap the immediate paragraph of floating table based on corresponding floating table. \n                                    if (isWord2013 || !((floatingItem instanceof TableWidget) && previousItem === floatingItem)) {\n                                        this.updateBoundsBasedOnTextWrap(textWrappingBounds.bottom);\n                                        rect = this.clientActiveArea;\n                                    }\n                                    if ((!isEmptyPara && paragraph.childWidgets[0].isFirstLine() || isEmptyPara) && isWord2013 ? true : !isInsideHeaderFooter) {\n                                        paragraph.y = this.clientActiveArea.y;\n                                    }\n                                }\n                                else {\n                                    rect.x = textWrappingBounds.right;\n                                }\n                            }\n                            else if (rect.x >= textWrappingBounds.x && rect.x < textWrappingBounds.right) {\n                                rect.width = rect.width - (textWrappingBounds.right - rect.x) - rightIndent;\n                                //checks minimum width\n                                if (rect.width < minimumWidthRequired || isFirstItemBottomPositionUpdated) {\n                                    rect.width = this.clientActiveArea.right - textWrappingBounds.right - rightIndent;\n                                    var isPositionsUpdated = false;\n                                    if (rect.width < minimumWidthRequired || isFirstItemBottomPositionUpdated) {\n                                        // If left side of floating item has minimum width to layout the paragraph, then find the minimum bottom among the floating items to the left side of current floating item.\n                                        // Then update the Y position to that bottom.\n                                        if (this.clientActiveArea.x + minimumWidthRequired < textWrappingBounds.x) {\n                                            var tempBounds = this.getIntersectingItemBounds(bodyWidget.floatingElements, floatingItem, yposition);\n                                            if (!isNullOrUndefined(tempBounds) && tempBounds.bottom <= textWrappingBounds.bottom) {\n                                                this.updateBoundsBasedOnTextWrap(tempBounds.bottom);\n                                                rect = this.clientActiveArea;\n                                                isPositionsUpdated = true;\n                                                //When we update the client area to the bottom of floating item, we also need to updtae the X position. \n                                                //To-Do: Some more X position updating cases also need to handle.\n                                                paragraph.x = tempBounds.x;\n                                            }\n                                        }\n                                        // Skip to wrap the immediate paragraph of floating table based on corresponding floating table.\n                                        if ((isWord2013) && !isPositionsUpdated) {\n                                            if (floatingItem instanceof TableWidget && previousItem === floatingItem) {\n                                                this.updateBoundsBasedOnTextWrapTable(textWrappingBounds.bottom);\n                                            }\n                                            else {\n                                                this.updateBoundsBasedOnTextWrap(textWrappingBounds.bottom);\n                                            }\n                                            rect = this.clientActiveArea;\n                                        }\n                                        if ((!isEmptyPara && paragraph.childWidgets[0].isFirstLine() || isEmptyPara) && isWord2013 ? true : !isInsideHeaderFooter) {\n                                            paragraph.y = this.clientActiveArea.y;\n                                        }\n                                    }\n                                    else {\n                                        rect.x = textWrappingBounds.right;\n                                    }\n                                }\n                                else {\n                                    rect.x = textWrappingBounds.right;\n                                }\n                            }\n                            else if (textWrappingBounds.x > rect.x && rect.right > textWrappingBounds.x) {\n                                rect.width = textWrappingBounds.x - rect.x;\n                                //checks minimum width\n                                if (rect.width < minimumWidthRequired) {\n                                    rect.width = this.clientActiveArea.right - textWrappingBounds.right - rightIndent;\n                                    if (rect.width < minimumWidthRequired) {\n                                        //Skip to wrap the immediate paragraph of floating table based on corresponding floating table. \n                                        if (isWord2013 || !((floatingItem instanceof TableWidget) && previousItem === floatingItem)) {\n                                            this.updateBoundsBasedOnTextWrap(textWrappingBounds.bottom);\n                                            rect = this.clientActiveArea;\n                                        }\n                                        if ((!isEmptyPara && paragraph.childWidgets[0].isFirstLine() || isEmptyPara) && isWord2013 ? true : !isInsideHeaderFooter) {\n                                            paragraph.y = this.clientActiveArea.y;\n                                        }\n                                    }\n                                    else {\n                                        rect.x = textWrappingBounds.right;\n                                    }\n                                }\n                            }\n                        }\n                        else if ((bodyWidget.floatingElements.length > 0 && ((rect.y >= (textWrappingBounds.y) && rect.y < (textWrappingBounds.bottom))\n                            || ((rect.y + paragraphHeight >= textWrappingBounds.y) && (rect.y + paragraphHeight < (textWrappingBounds.bottom))))\n                            && textWrappingStyle === 'TopAndBottom')) {\n                            //Skip to wrap the immediate paragraph of floating table based on corresponding floating table. \n                            if (isWord2013 || !((floatingItem instanceof TableWidget) && previousItem === floatingItem)) {\n                                this.updateBoundsBasedOnTextWrap(textWrappingBounds.bottom);\n                                // Sets true to update bottom position of first inline item in page\n                                // when this item's bottom position already updated based on previous floating item.\n                                if (!isWord2013 && (!isEmptyPara && paragraph.childWidgets[0].isFirstLine() || isEmptyPara)) {\n                                    isFirstItemBottomPositionUpdated = true;\n                                }\n                            }\n                            if ((!isEmptyPara && paragraph.childWidgets[0].isFirstLine() || isEmptyPara) && isWord2013 ? true : !isInsideHeaderFooter) {\n                                paragraph.y = this.clientActiveArea.y;\n                            }\n                        }\n                    }\n                    // //Reset the floating item bounds to original position\n                    // ResetXPositionForRTLLayouting(i, ref textWrappingBounds, floatingItemXPosition);\n                }\n                //Update the wrapping difference value.\n                // if (isFirstItem && yValue < rect.Y) {\n                //     (m_lcOperator as Layouter).WrappingDifference = (float)(rect.Y - (m_lcOperator as Layouter).PageTopMargin);\n                // }\n            }\n        }\n    };\n    LayoutViewer.prototype.updateParagraphXPositionBasedOnTextWrap = function (block) {\n        // #region textwrap\n        var yValue = 0;\n        var isFirstItem = false;\n        var isWord2013 = this.documentHelper.compatibilityMode === 'Word2013';\n        var bodyWidget = block.containerWidget;\n        var clientLayoutArea = this.clientActiveArea;\n        // if (!(m_lcOperator as Layouter).IsLayoutingHeaderFooter &&\n        //     (m_lcOperator as Layouter).WrappingDifference === Number.MIN_VALUE &&\n        //     Math.round(yPosition, 2) === Math.round((m_lcOperator as Layouter).PageTopMargin, 2)) {\n        //     yValue = yPosition;\n        //     isFirstItem = true;\n        // }\n        if (this instanceof PageLayoutViewer && !isNullOrUndefined(bodyWidget) && block instanceof ParagraphWidget && !isNullOrUndefined(bodyWidget.page) && !isNullOrUndefined(bodyWidget.page.headerWidget)) {\n            var floatingItems = bodyWidget.page.headerWidget.floatingElements;\n            if (floatingItems.length > 0 &&\n                (!block.isInHeaderFooter || block.isInsideTable ||\n                    isWord2013) &&\n                !(block.containerWidget instanceof FootNoteWidget) && !(block.bodyWidget instanceof TextFrame)) {\n                // const clientLayoutArea: RectangleF = (m_lcOperator as Layouter).ClientLayoutArea;\n                // clientLayoutArea.X = xPosition;\n                // clientLayoutArea.Y = yPosition;\n                //let cellPadings: number = 0;\n                var paragraph = block;\n                //if (paragraph.isInsideTable) {\n                //const cellLayoutInfo: CellLayoutInfo = ((paragraph.GetOwnerEntity() as WTableCell) as IWidget).LayoutInfo as CellLayoutInfo;\n                //cellPadings = cellLayoutInfo.Paddings.Left + cellLayoutInfo.Paddings.Right;\n                // }\n                // let defMinWidth: number = minimumWidthRequired - cellPadings;\n                // const size: SizeF = (paragraph as IWidget).LayoutInfo.Size;\n                for (var i = 0; i < floatingItems.length; i++) {\n                    var floatingItem = floatingItems[i];\n                    // if (paragraph.IsInCell && floatingItems[i].allowOverlap &&\n                    //     (paragraph.associatedCell.ownerRow.ownerTable.tableFormat.positioning.allowOverlap) {\n                    if (paragraph.isInsideTable) {\n                        if (floatingItem instanceof TableWidget && !floatingItem.isInsideTable) {\n                            continue;\n                        }\n                    }\n                    // }\n                    var textWrappingBounds = this.getTextWrappingBound(floatingItem);\n                    var textWrappingStyle = floatingItem instanceof TableWidget ? 'Square' : floatingItem.textWrappingStyle;\n                    var textWrappingType = floatingItem instanceof TableWidget ? 'Both' : floatingItem.textWrappingType;\n                    //let ownerBody: BodyWidget = undefined;\n                    //As per Microsoft Word behavior, when floating item and paragraph in cell means,\n                    //then, wrap the bounds for the items in same cell only.                 \n                    //Skip, if it is in different cell.\n                    // let ownerBody: BodyWidget = undefined\n                    // if (!this.isInSameTextBody(paragraph, floatingItem, ownerBody) &&\n                    //     paragraph.isInsideTable && bodyWidget instanceof TableCellWidget) {\n                    //     continue;\n                    // }\n                    // if (this.IsInFrame((m_lcOperator as Layouter).FloatingItems[i].FloatingEntity as WParagraph) &&\n                    //     this.IsOwnerCellInFrame(paragraph)) {\n                    //     continue;\n                    // }\n                    // if (paragraph.ParagraphFormat.Bidi &&\n                    //     (this.IsInSameTextBody(paragraph, (m_lcOperator as Layouter).FloatingItems[i], ownerBody) &&\n                    //         paragraph.IsInCell && ownerBody instanceof WTableCell)) {\n                    //     this.ModifyXPositionForRTLLayouting(i, textWrappingBounds, (m_layoutArea as any).ClientArea);\n                    // } else if (paragraph.ParagraphFormat.Bidi) {\n                    //     this.ModifyXPositionForRTLLayouting(i, textWrappingBounds, (m_lcOperator as Layouter).ClientLayoutArea);\n                    // }\n                    var minimumWidthRequired = 24;\n                    // if (textWrappingStyle === TextWrappingStyle.Tight || textWrappingStyle === TextWrappingStyle.Through) {\n                    //     minimumWidthRequired = paragraph.Document.Settings.CompatibilityMode === CompatibilityMode.Word2013 ?\n                    //         DEF_MIN_WIDTH_2013_TIGHTANDTHROW : DEF_MIN_WIDTH_TIGHTANDTHROW;\n                    // }\n                    // minimumWidthRequired -= cellPadings;\n                    // defMinWidth = minimumWidthRequired;\n                    // if (textWrappingStyle === TextWrappingStyle.Tight || textWrappingStyle === TextWrappingStyle.Through &&\n                    //     (m_lcOperator as Layouter).FloatingItems[i].IsDoesNotDenotesRectangle) {\n                    //     const temp: RectangleF = this.AdjustTightAndThroughBounds(\n                    //         (m_lcOperator as Layouter).FloatingItems[i], clientLayoutArea, size.Height);\n                    //     if (temp.X !== 0) {\n                    //         textWrappingBounds = temp;\n                    //         defMinWidth = size.Width;\n                    //     }\n                    // }\n                    if (!paragraph.isInsideTable &&\n                        (!(clientLayoutArea.x > textWrappingBounds.right + minimumWidthRequired ||\n                            clientLayoutArea.right < textWrappingBounds.x - minimumWidthRequired))) {\n                        if (floatingItems.length > 0 &&\n                            (clientLayoutArea.y + paragraph.height > textWrappingBounds.y && clientLayoutArea.y < textWrappingBounds.bottom) &&\n                            textWrappingStyle !== \"Inline\" &&\n                            textWrappingStyle !== \"TopAndBottom\" &&\n                            textWrappingStyle !== \"InFrontOfText\" &&\n                            textWrappingStyle !== \"Behind\") {\n                            var rightIndent = HelperMethods.convertPointToPixel(paragraph.paragraphFormat.rightIndent);\n                            if (paragraph.paragraphFormat.textAlignment != \"Left\" && (clientLayoutArea.x < textWrappingBounds.x && clientLayoutArea.x + paragraph.width > textWrappingBounds.x)) {\n                                paragraph.x = clientLayoutArea.x;\n                            }\n                            else if (clientLayoutArea.x >= textWrappingBounds.x && clientLayoutArea.x < textWrappingBounds.right && !paragraph.paragraphFormat.bidi) {\n                                clientLayoutArea.width = clientLayoutArea.width - (textWrappingBounds.right - clientLayoutArea.x) - rightIndent;\n                                if (clientLayoutArea.width < minimumWidthRequired) {\n                                    clientLayoutArea.width = this.clientActiveArea.right - textWrappingBounds.right - rightIndent;\n                                    if (clientLayoutArea.width < minimumWidthRequired) {\n                                        paragraph.x = clientLayoutArea.x;\n                                        clientLayoutArea.width = clientLayoutArea.width;\n                                        clientLayoutArea.height = textWrappingBounds.bottom - clientLayoutArea.x;\n                                        clientLayoutArea.y = textWrappingBounds.bottom;\n                                    }\n                                    else {\n                                        clientLayoutArea.x = textWrappingBounds.right;\n                                    }\n                                }\n                                else if (this.documentHelper.compatibilityMode === \"Word2007\" ||\n                                    clientLayoutArea.y <= textWrappingBounds.bottom) {\n                                    // if (this.IsNeedToUpdateParagraphYPosition(clientLayoutArea.Y, textWrappingStyle,\n                                    //     paragraph, clientLayoutArea.Y + size.Height + paragraph.ParagraphFormat.AfterSpacing, textWrappingBounds.Bottom)) {\n                                    //     paragraph.x = clientLayoutArea.x;\n                                    //     clientLayoutArea.width = clientLayoutArea.width;\n                                    //     clientLayoutArea.y = textWrappingBounds.bottom;\n                                    //     clientLayoutArea.height = clientLayoutArea.height -\n                                    //         (textWrappingBounds.bottom - clientLayoutArea.y);\n                                    //     this.updateBoundsBasedOnTextWrap(textWrappingBounds.bottom);\n                                    // } else {\n                                    //const paraInfo: ParagraphLayoutInfo = paragraph.m_layoutInfo as ParagraphLayoutInfo;\n                                    var leftIndent = HelperMethods.convertPointToPixel(paragraph.paragraphFormat.leftIndent);\n                                    var firstLineIndent = HelperMethods.convertPointToPixel(paragraph.paragraphFormat.firstLineIndent);\n                                    if (leftIndent + firstLineIndent + clientLayoutArea.x < textWrappingBounds.right) {\n                                        //paragraph.x = textWrappingBounds.right;\n                                        clientLayoutArea.x = textWrappingBounds.right;\n                                        if (isWord2013) {\n                                            //this.documentHelper.layout.IsXpositionUpated = true;\n                                        }\n                                    }\n                                    // }\n                                }\n                            }\n                            else if ((textWrappingBounds.x - minimumWidthRequired > clientLayoutArea.x && clientLayoutArea.right > textWrappingBounds.x) ||\n                                (clientLayoutArea.x > textWrappingBounds.x && clientLayoutArea.x > textWrappingBounds.right)) {\n                                paragraph.x = clientLayoutArea.x;\n                            }\n                            // else if (clientLayoutArea.x > textWrappingBounds.x - minimumWidthRequired && clientLayoutArea.x < textWrappingBounds.right) {\n                            //     const width: number = clientLayoutArea.width + (clientLayoutArea.x - textWrappingBounds.right);\n                            //     if (width < minimumWidthRequired) {\n                            //         clientLayoutArea.y = textWrappingBounds.bottom;\n                            //     } else {\n                            //         paragraph.x = textWrappingBounds.right;\n                            //     }\n                            // } \n                            // else if (this.IsNeedToUpdateParagraphYPosition(clientLayoutArea.Y, textWrappingStyle,\n                            //     paragraph, clientLayoutArea.Y + size.Height + paragraph.ParagraphFormat.AfterSpacing, textWrappingBounds.Bottom)) {\n                            //     (paragraph.m_layoutInfo as ParagraphLayoutInfo).XPosition = clientLayoutArea.X;\n                            //     clientLayoutArea.Width = (m_lcOperator as Layouter).ClientLayoutArea.Width;\n                            //     clientLayoutArea.Y = textWrappingBounds.Bottom;\n                            //     clientLayoutArea.Height = (m_lcOperator as Layouter).ClientLayoutArea.Height -\n                            //         (textWrappingBounds.Bottom - (m_lcOperator as Layouter).ClientLayoutArea.Y);\n                            //     (m_layoutArea as any).UpdateBoundsBasedOnTextWrap(textWrappingBounds.Bottom);\n                            // }\n                        }\n                    }\n                    //this.ResetXPositionForRTLLayouting(i, textWrappingBounds, floatingItemXPosition);\n                }\n            }\n            // if (m_widget instanceof WParagraph) {\n            //     const sortYPosition: FloatingItem[] = (m_lcOperator as Layouter).FloatingItems.slice(0);\n            //     FloatingItem.SortFloatingItems(sortYPosition, SortPosition.Y);\n            //     this.UpdateXYPositionBasedOnAdjacentFloatingItems(sortYPosition, clientLayoutArea, size,\n            //         m_widget as WParagraph, false);\n            // }\n            // if (isFirstItem && yValue < yPosition) {\n            //     (m_lcOperator as Layouter).WrappingDifference = yPosition - (m_lcOperator as Layouter).PageTopMargin;\n            // }\n        }\n    };\n    LayoutViewer.prototype.updateTableXPositionBasedOnTextWrap = function (block) {\n        // Get the first row width\n        var firstRowWidth = HelperMethods.convertPointToPixel(block.childWidgets[0].getFirstRowWidth());\n        var bodyWidget = block.bodyWidget;\n        if (this instanceof PageLayoutViewer && !isNullOrUndefined(bodyWidget) && !isNullOrUndefined(bodyWidget.page) && !isNullOrUndefined(bodyWidget.page.headerWidget)) {\n            var floatingItems = bodyWidget.page.headerWidget.floatingElements;\n            // textwrap\n            // Update Layout area based on text wrap and ignore the yposition update while \n            // wrapping bounds already added to the collection\n            if (floatingItems.length > 0 && (!block.isInHeaderFooter || !block.isInsideTable || this.documentHelper.compatibilityMode === 'Word2013')\n                && !(block.containerWidget instanceof TextFrame)) {\n                var rect = this.clientActiveArea;\n                //let wrapItemIndex: number = -1;\n                // sort the list items based on y position,\n                // Call Sort on the list. This will use the  \n                // default comparer, which is the Compare method  \n                // implemented on FloatingItem.\n                //FloatingItem.sortFloatingItems(this.m_lcOperator.floatingItems, SortPosition.Y);\n                for (var i = 0; i < floatingItems.length; i++) {\n                    var floatingItem = floatingItems[i];\n                    var textWrappingBounds = this.getTextWrappingBound(floatingItem);\n                    var textWrappingStyle = floatingItem instanceof TableWidget ? 'Square' : floatingItem.textWrappingStyle;\n                    var allowOverlap = floatingItem instanceof TableWidget ? floatingItem.positioning.allowOverlap : floatingItem.allowOverlap;\n                    // if (this.isAdjustTightAndThroughBounds(textWrappingStyle, i)) {\n                    //     let temp: RectangleF = this.adjustTightAndThroughBounds(this.m_lcOperator.floatingItems[i], rect, size.height);\n                    //     textWrappingBounds = temp;\n                    // }\n                    // let ownerBody: WTextBody = null;\n                    // // As per Microsoft Word behavior, when floating item and table in cell means,\n                    // // then, wrap the bounds for the items in same cell only.                 \n                    // // Skip, if it is in different cell.\n                    // if (!this.isInSameTextBody(this.m_table, this.m_lcOperator.floatingItems[i], ownerBody)\n                    //     && this.m_table.isInCell && ownerBody instanceof WTableCell)\n                    //     continue;\n                    // // Skip if the current table is in different frame\n                    // if (this.isInFrame(this.m_lcOperator.floatingItems[i].floatingEntity as WParagraph) && this.m_table.isFrame)\n                    //     continue;\n                    // // Adjusts the text wrapping bounds based on distance from text values when floating table intersects with another floating item.\n                    // textWrappingBounds = this.adjustTextWrappingBounds(this.m_lcOperator.floatingItems[i], clientLayoutArea, size,\n                    //     wrapItemIndex, i, rect, textWrappingBounds, textWrappingStyle, allowOverlap);\n                    var minimumWidthRequired = 24;\n                    var paragarph = this.documentHelper.getFirstParagraphInFirstCell(block);\n                    var height = this.documentHelper.textHelper.getParagraphMarkSize(paragarph.characterFormat).Height;\n                    var rowHeight = block.childWidgets[0] instanceof TableRowWidget ? block.childWidgets[0].height : 0;\n                    if (rowHeight > height) {\n                        height = rowHeight;\n                    }\n                    var width = HelperMethods.convertPointToPixel(block.getTableClientWidth(block.getContainerWidth()));\n                    if (!(this.clientArea.x > textWrappingBounds.right + minimumWidthRequired || this.clientArea.right < textWrappingBounds.x - minimumWidthRequired)) {\n                        if (this.isFloatingItemIntersect(block, rect, textWrappingBounds, textWrappingStyle, allowOverlap, height, width)) {\n                            if (rect.x >= textWrappingBounds.x && rect.x < textWrappingBounds.right) {\n                                rect.width = rect.width - (textWrappingBounds.right - rect.x);\n                                //checks minimum width\n                                if (rect.width < minimumWidthRequired || (rect.width < firstRowWidth && firstRowWidth > 0)) {\n                                    rect.width = this.clientActiveArea.right - textWrappingBounds.right;\n                                    //Check if the client active area width is lesser than table width to update the y position\n                                    if (rect.width < minimumWidthRequired || ((rect.width < firstRowWidth && firstRowWidth > 0) &&\n                                        this.clientArea.right <= firstRowWidth + textWrappingBounds.right)) {\n                                        //When the table y position is lesser than the text wrapping bottom position then \n                                        //difference of these two should be subtracted from the table client height instead of the floating item height.\n                                        var remainingHeightOfFloatingItem = (textWrappingBounds.bottom > rect.y) ? textWrappingBounds.bottom - rect.y : 0;\n                                        rect.y = textWrappingBounds.bottom;\n                                        rect.width = this.clientArea.width;\n                                        rect.height = rect.height - remainingHeightOfFloatingItem;\n                                        this.updateClientAreaForTextWrap(rect);\n                                    }\n                                    else {\n                                        rect.x = textWrappingBounds.right;\n                                        // if (textWrappingStyle == TextWrappingStyle.Through\n                                        //     && this.m_lcOperator.floatingItems[i].isDoesNotDenotesRectangle) {\n                                        //     textWrappingBounds = this.adjustTightAndThroughBounds(this.m_lcOperator.floatingItems[i], rect, size.height);\n                                        //     if (textWrappingBounds.x != 0)\n                                        //         rect.width = textWrappingBounds.x - rect.x;\n                                        // }\n                                        this.updateClientAreaForTextWrap(rect);\n                                    }\n                                }\n                                else {\n                                    rect.x = textWrappingBounds.right;\n                                    // if (textWrappingStyle == TextWrappingStyle.Through\n                                    //     && this.m_lcOperator.floatingItems[i].isDoesNotDenotesRectangle) {\n                                    //     textWrappingBounds = this.adjustTightAndThroughBounds(this.m_lcOperator.floatingItems[i], rect, size.height);\n                                    //     if (textWrappingBounds.x != 0)\n                                    //         rect.width = textWrappingBounds.x - rect.x;\n                                    // }\n                                    this.updateClientAreaForTextWrap(rect);\n                                }\n                            }\n                            // else if ((rect.right - textWrappingBounds.right) > 0\n                            //     && (rect.right - textWrappingBounds.right) < rect.width\n                            //     && (rect.y >= textWrappingBounds.y\n                            //         || (rect.y + size.height) >= textWrappingBounds.y)) {\n                            //     //If the table is intersect with  another floating item from the top ,then we need to consider distance from text with respect to relative margin position.\n                            //     if (rect.x < textWrappingBounds.x && rect.right > textWrappingBounds.x) {\n                            //         if (this.m_table.tableFormat.positioning.horizPositionAbs == HorizontalPosition.Left)\n                            //             rect.x += this.m_table.tableFormat.positioning.distanceFromLeft;\n                            //         else if (this.m_table.tableFormat.positioning.horizPositionAbs == HorizontalPosition.Right)\n                            //             rect.x -= this.m_table.tableFormat.positioning.distanceFromRight;\n                            //     }\n                            //     //When the table y position is lesser than the text wrapping bottom position then \n                            //     //difference of these two should be subtracted from the table client height instead of the floating item height.\n                            //     let remainingHeightOfFloatingItem = (textWrappingBounds.bottom > rect.y) ? textWrappingBounds.bottom - rect.y : 0;\n                            //     rect.y = textWrappingBounds.bottom;\n                            //     rect.height = rect.height - remainingHeightOfFloatingItem;\n                            //     this.createLayoutArea(rect);\n                            // }\n                            // else if (textWrappingBounds.x > rect.x && rect.right > textWrappingBounds.x) {\n                            //     rect.width = textWrappingBounds.x - rect.x;\n                            //     //checks minimum width\n                            //     if (rect.width < DEF_MIN_WIDTH || (rect.width < firstRowWidth && firstRowWidth > 0)) {\n                            //         rect.width = this.m_layoutArea.clientActiveArea.right - textWrappingBounds.right;\n                            //         if (rect.width < DEF_MIN_WIDTH || (rect.width < firstRowWidth && firstRowWidth > 0)) {\n                            //             //Check if the client active area width is greater than table width to update the x position\n                            //             if (this.m_layoutArea.clientArea.right < this.m_lcOperator.clientLayoutArea.right\n                            //                 && textWrappingBounds.right < this.m_lcOperator.clientLayoutArea.right\n                            //                 && this.m_lcOperator.clientLayoutArea.right - textWrappingBounds.right > DEF_MIN_WIDTH\n                            //                 && Math.round(this.m_layoutArea.clientActiveArea.width, 2) > Math.round(firstRowWidth, 2)) {\n                            //                 rect.width = this.m_lcOperator.clientLayoutArea.right - textWrappingBounds.right;\n                            //                 rect.x = textWrappingBounds.right;\n                            //                 if (textWrappingStyle == TextWrappingStyle.Through\n                            //                     && this.m_lcOperator.floatingItems[i].isDoesNotDenotesRectangle) {\n                            //                     textWrappingBounds = this.adjustTightAndThroughBounds(this.m_lcOperator.floatingItems[i], rect, size.height);\n                            //                     if (textWrappingBounds.x != 0)\n                            //                         rect.width = textWrappingBounds.x - rect.x;\n                            //                 }\n                            //             }\n                            //             else {\n                            //                 //When the table y position is lesser than the text wrapping bottom position then \n                            //                 //difference of these two should be subtracted from the table client height instead of the floating item height.\n                            //                 let remainingHeightOfFloatingItem = (textWrappingBounds.bottom > rect.y) ? textWrappingBounds.bottom - rect.y : 0;\n                            //                 rect.y = textWrappingBounds.bottom;\n                            //                 rect.height = rect.height - remainingHeightOfFloatingItem;\n                            //             }\n                            //             this.createLayoutArea(rect);\n                            //         }\n                            //     }\n                            //     else\n                            //         this.createLayoutArea(rect);\n                            // }\n                            // else if (rect.x > textWrappingBounds.x && rect.x > textWrappingBounds.right) {\n                            //     rect.width = this.m_layoutArea.clientArea.width;\n                            //     this.createLayoutArea(rect);\n                            // }\n                            // else if (rect.x > textWrappingBounds.x && rect.x < textWrappingBounds.right) {\n                            //     rect.width = rect.width - (textWrappingBounds.right - rect.x);\n                            //     rect.x = textWrappingBounds.right;\n                            //     if (textWrappingStyle == TextWrappingStyle.Through\n                            //         && this.m_lcOperator.floatingItems[i].isDoesNotDenotesRectangle) {\n                            //         textWrappingBounds = this.adjustTightAndThroughBounds(this.m_lcOperator.floatingItems[i], rect, size.height);\n                            //         if (textWrappingBounds.x != 0)\n                            //             rect.width = textWrappingBounds.x - rect.x;\n                            //     }\n                            //     this.createLayoutArea(rect);\n                            // }\n                        }\n                    }\n                }\n            }\n        }\n    };\n    LayoutViewer.prototype.isFloatingItemIntersect = function (table, rect, textWrappingBounds, textWrappingStyle, allowOverlap, height, width) {\n        return ((Math.round(rect.y + height) >= Math.round(textWrappingBounds.y)\n            && Math.round(rect.y) < Math.round(textWrappingBounds.bottom))\n            //Checks whether the bottom of the table intersects with floating item.\n            || Math.round(rect.y + height) <= Math.round(textWrappingBounds.bottom)\n                && Math.round(rect.y + height) >= Math.round(textWrappingBounds.y))\n            && textWrappingStyle !== \"Inline\"\n            && textWrappingStyle !== \"TopAndBottom\"\n            && textWrappingStyle !== \"InFrontOfText\"\n            && textWrappingStyle !== \"Behind\"\n            && !(allowOverlap && (table.tableFormat !== null && table.wrapTextAround && table.positioning.allowOverlap));\n    };\n    LayoutViewer.prototype.getIntersectingItemBounds = function (floatingElements, intersectedfloatingItem, yPosition) {\n        var floatingItem = this.getMinBottomFloatingItem(floatingElements, this.getIntersectingFloatingItems(floatingElements, intersectedfloatingItem, yPosition));\n        if (!isNullOrUndefined(floatingItem)) {\n            var floatingItemBound = this.getTextWrappingBound(floatingItem);\n            return floatingItemBound;\n        }\n        return undefined;\n    };\n    LayoutViewer.prototype.getMinBottomFloatingItem = function (floatingElements, fItems) {\n        var minBottomItemIndex = -1;\n        var minBottom = Number.MAX_VALUE;\n        var skippedCount = 0;\n        // Sort based on X position\n        floatingElements.sort(function (a, b) { return a.x - b.x; });\n        for (var i = 0; i < fItems.length; i++) {\n            var floatingItem = floatingElements[i];\n            var item = this.getTextWrappingBound(floatingItem);\n            if (minBottom > item.bottom) {\n                // Need to ignore if floating items preserved in same frame.\n                if (floatingItem && fItems.indexOf(floatingItem) + 1 < fItems.length) {\n                    skippedCount++;\n                }\n                else {\n                    minBottom = item.bottom;\n                    minBottomItemIndex = fItems.indexOf(floatingItem);\n                }\n            }\n        }\n        //If floating item which has minimum bottom is first item (no items preserved left side of this item).\n        //Then return current item Other cases need to handle.\n        return minBottomItemIndex - skippedCount == 0 ? fItems[minBottomItemIndex] : null;\n    };\n    LayoutViewer.prototype.getIntersectingFloatingItems = function (floatingElements, intersectedfloatingItem, yPosition) {\n        var fItems = [];\n        //Get all the items which preserved left side of the current floating item.\n        for (var i = 0; i < floatingElements.length; i++) {\n            {\n                var floatingItem = floatingElements[i];\n                var itemTextWrapBound = this.getTextWrappingBound(floatingItem);\n                var intersectItemTextWrapBound = this.getTextWrappingBound(intersectedfloatingItem);\n                if (yPosition <= itemTextWrapBound.bottom\n                    && intersectItemTextWrapBound.bottom >= itemTextWrapBound.bottom\n                    && itemTextWrapBound.right > this.clientActiveArea.x\n                    && itemTextWrapBound.x < intersectItemTextWrapBound.x)\n                    fItems.push(floatingItem);\n            }\n        }\n        return fItems;\n    };\n    LayoutViewer.prototype.getTextWrappingBound = function (floatingItem) {\n        var distanceLeft = 0;\n        var distanceTop = 0;\n        var distanceRight = 0;\n        var distanceBottom = 0;\n        var width = 0;\n        if (floatingItem instanceof ShapeBase) {\n            distanceLeft = floatingItem.distanceLeft;\n            distanceTop = floatingItem.distanceTop;\n            distanceRight = floatingItem.distanceRight;\n            distanceBottom = floatingItem.distanceBottom;\n            width = floatingItem.width;\n        }\n        else {\n            width = floatingItem.getTableCellWidth();\n            distanceLeft = floatingItem.positioning.distanceLeft;\n            distanceTop = floatingItem.positioning.distanceTop;\n            distanceRight = floatingItem.positioning.distanceRight;\n            distanceBottom = floatingItem.positioning.distanceBottom;\n        }\n        var textWrappingBounds = new Rect(floatingItem.x - distanceLeft, floatingItem.y - distanceTop, width + distanceLeft + distanceRight, floatingItem.height + distanceTop + distanceBottom);\n        return textWrappingBounds;\n    };\n    LayoutViewer.prototype.tableAlignmentForBidi = function (block, bidi) {\n        var tableAlignment = block.tableFormat.tableAlignment;\n        if (bidi) {\n            if (tableAlignment === 'Left') {\n                tableAlignment = 'Right';\n            }\n            else if (tableAlignment === 'Right') {\n                tableAlignment = 'Left';\n            }\n        }\n        return tableAlignment;\n    };\n    LayoutViewer.prototype.cutFromLeft = function (x) {\n        if (x < this.clientActiveArea.x) {\n            x = this.clientActiveArea.x;\n        }\n        if (x > this.clientActiveArea.right && this.textWrap) {\n            x = this.clientActiveArea.right;\n        }\n        this.clientActiveArea.width = this.clientActiveArea.right > x ? this.clientActiveArea.right - x : 0;\n        this.clientActiveArea.x = x;\n    };\n    LayoutViewer.prototype.cutFromTop = function (y) {\n        if (y < this.clientActiveArea.y) {\n            y = this.clientActiveArea.y;\n        }\n        if (y > this.clientActiveArea.bottom) {\n            y = this.clientActiveArea.bottom;\n        }\n        this.clientActiveArea.height = this.clientActiveArea.bottom - y;\n        this.clientActiveArea.x = this.clientArea.x;\n        this.clientActiveArea.width = this.clientArea.width;\n        this.clientActiveArea.y = y;\n    };\n    LayoutViewer.prototype.updateClientWidth = function (width) {\n        this.clientActiveArea.x -= width;\n        if (this.clientActiveArea.width + width > 0) {\n            this.clientActiveArea.width += width;\n        }\n        else {\n            this.clientActiveArea.width = 0;\n        }\n    };\n    LayoutViewer.prototype.findFocusedPage = function (currentPoint, updateCurrentPage, updateHeaderFooterPage) {\n        var point = new Point(currentPoint.x, currentPoint.y);\n        point.x += this.documentHelper.viewerContainer.scrollLeft;\n        point.y += this.documentHelper.viewerContainer.scrollTop;\n        for (var i = 0; i < this.documentHelper.pages.length; i++) {\n            var page = this.documentHelper.pages[i];\n            var pageTop = (page.boundingRectangle.y - this.pageGap * (i + 1)) * this.documentHelper.zoomFactor + this.pageGap * (i + 1);\n            var pageHeight = (page.boundingRectangle.height * this.documentHelper.zoomFactor) + this.pageGap;\n            var pageLeft = page.boundingRectangle.x;\n            var pageRight = void 0;\n            if (this instanceof PageLayoutViewer) {\n                pageRight = ((page.boundingRectangle.right - pageLeft) * this.documentHelper.zoomFactor) + pageLeft;\n            }\n            else {\n                pageRight = page.boundingRectangle.right + pageLeft;\n            }\n            if (pageTop <= point.y && pageTop + pageHeight >= point.y) {\n                if (updateCurrentPage) {\n                    this.documentHelper.currentPage = page;\n                    if (updateHeaderFooterPage) {\n                        if (!isNullOrUndefined(page.headerWidget)) {\n                            page.headerWidget.page = page;\n                        }\n                        if (!isNullOrUndefined(page.footerWidget)) {\n                            page.footerWidget.page = page;\n                        }\n                    }\n                }\n                point.y = (point.y - (pageTop)) / this.documentHelper.zoomFactor;\n                if (point.x > pageRight) {\n                    point.x = page.boundingRectangle.right;\n                }\n                else if (point.x < pageLeft) {\n                    point.x = 0;\n                }\n                else {\n                    point.x = (point.x - pageLeft) / this.documentHelper.zoomFactor;\n                }\n                return point;\n            }\n        }\n        return point;\n    };\n    LayoutViewer.prototype.getPageHeightAndWidth = function (height, width, viewerWidth, viewerHeight) {\n        height = 0;\n        for (var i = 0; i < this.documentHelper.pages.length; i++) {\n            height = height + this.documentHelper.pages[i].boundingRectangle.height;\n        }\n        width = 0;\n        for (var i = 0; i < this.documentHelper.pages.length; i++) {\n            if (width < this.documentHelper.pages[i].boundingRectangle.width) {\n                width = this.documentHelper.pages[i].boundingRectangle.width;\n            }\n        }\n        //this.documentHelper.visibleBoundsIn = new Rect(0, 0, width, height);\n        viewerWidth = this.documentHelper.visibleBounds.width;\n        viewerHeight = this.documentHelper.visibleBounds.height;\n        return {\n            'height': height,\n            'width': width,\n            'viewerWidth': viewerWidth,\n            'viewerHeight': viewerHeight\n        };\n    };\n    LayoutViewer.prototype.renderVisiblePages = function () {\n        if (isNullOrUndefined(this.visiblePages) || this.visiblePages.length < 1) {\n            return;\n        }\n        this.documentHelper.clearContent();\n        for (var i = 0; i < this.visiblePages.length; i++) {\n            var page = this.visiblePages[i];\n            var width = page.boundingRectangle.width * this.documentHelper.zoomFactor;\n            var height = page.boundingRectangle.height * this.documentHelper.zoomFactor;\n            var x = page.boundingRectangle.x;\n            var y = (page.boundingRectangle.y - this.pageGap * (i + 1)) * this.documentHelper.zoomFactor + this.pageGap * (i + 1);\n            this.owner.viewer.renderPage(page, x, y, width, height);\n        }\n    };\n    /* eslint-disable  */\n    LayoutViewer.prototype.handleZoom = function () {\n        var prevScaleFactor = this.documentHelper.preZoomFactor;\n        var page = null;\n        var verticalHeight = 0;\n        var scrollToPosition = false;\n        if (this.documentHelper.selection && isNullOrUndefined(this.documentHelper.zoomX && isNullOrUndefined(this.documentHelper.zoomY))) {\n            var x = 0;\n            var y = 0;\n            var endPage = this.documentHelper.selection.getPage(this.documentHelper.selection.end.currentWidget.paragraph);\n            x = (this.documentHelper.visibleBounds.width - endPage.boundingRectangle.width * prevScaleFactor) / 2;\n            if (x < 30) {\n                x = 30;\n            }\n            y = endPage.boundingRectangle.y * prevScaleFactor + (this.documentHelper.pages.indexOf(endPage) + 1) * this.pageGap * (1 - prevScaleFactor);\n            var caretInfo = this.documentHelper.selection.updateCaretSize(this.owner.selectionModule.end, true);\n            var topMargin = caretInfo.topMargin;\n            var caretHeight = caretInfo.height;\n            x += (this.documentHelper.selection.end.location.x) * prevScaleFactor;\n            y += (this.documentHelper.selection.end.location.y + topMargin) * prevScaleFactor;\n            if (x >= this.containerLeft && x <= this.documentHelper.visibleBounds.width &&\n                y >= this.containerTop && y <= this.containerTop + this.documentHelper.visibleBounds.height) {\n                scrollToPosition = true;\n            }\n        }\n        for (var i = 0; i < this.documentHelper.pages.length; i++) {\n            verticalHeight = verticalHeight + this.documentHelper.pages[i].boundingRectangle.height;\n        }\n        var horizontalWidth = 0;\n        for (var i = 0; i < this.documentHelper.pages.length; i++) {\n            if (horizontalWidth < this.documentHelper.pages[i].boundingRectangle.width) {\n                horizontalWidth = this.documentHelper.pages[i].boundingRectangle.width;\n            }\n        }\n        var height = (verticalHeight * this.documentHelper.zoomFactor + (this.documentHelper.pages.length + 1) * this.pageGap * (1 - this.documentHelper.zoomFactor)) - this.documentHelper.visibleBounds.height;\n        var horWidth = horizontalWidth * this.documentHelper.zoomFactor - this.documentHelper.visibleBounds.width;\n        if (this.documentHelper.visibleBounds.width - horizontalWidth * this.documentHelper.zoomFactor < 60) {\n            horWidth += 60;\n        }\n        //Update Vertical Scroll bar\n        if (height > 0) {\n            var value = this.containerTop;\n            if (this.visiblePages.length > 0) {\n                page = this.visiblePages[0];\n                var prevPageTop = (page.boundingRectangle.y - (page.index + 1) * this.pageGap) * prevScaleFactor + (page.index + 1) * this.pageGap;\n                var zoomY = this.documentHelper.zoomY;\n                if (isNullOrUndefined) {\n                    zoomY = this.documentHelper.visibleBounds.height / 2;\n                }\n                var prevY = value + zoomY;\n                while (prevY > prevPageTop + (page.boundingRectangle.height * prevScaleFactor)) {\n                    var pageIndex = page.index + 1;\n                    if (pageIndex === this.documentHelper.pages.length) {\n                        break;\n                    }\n                    page = this.documentHelper.pages[pageIndex];\n                    prevPageTop = (page.boundingRectangle.y - (page.index + 1) * this.pageGap) * prevScaleFactor + (page.index + 1) * this.pageGap;\n                }\n                var currentY = (page.boundingRectangle.y - (page.index + 1) * this.pageGap) * this.documentHelper.zoomFactor + (page.index + 1) * this.pageGap\n                    + ((prevY - prevPageTop) < 0 ? prevY - prevPageTop : (prevY - prevPageTop) * (this.documentHelper.zoomFactor / prevScaleFactor));\n                value = currentY - zoomY;\n                zoomY = this.documentHelper.visibleBounds.height / 2;\n            }\n            this.documentHelper.viewerContainer.scrollTop = value;\n        }\n        else {\n            this.documentHelper.viewerContainer.scrollTop = 0;\n        }\n        // update Horizontal Scroll Bar\n        if (horWidth > 0) {\n            var value = this.containerLeft;\n            if (this.visiblePages.length > 0) {\n                if (page === null) {\n                    page = this.visiblePages[0];\n                }\n                var zoomX = this.documentHelper.zoomX;\n                if (isNullOrUndefined(zoomX)) {\n                    zoomX = this.documentHelper.visibleBounds.width / 2;\n                }\n                var prevValue = (page.boundingRectangle.width * prevScaleFactor) / page.boundingRectangle.width;\n                var prevX = value + zoomX;\n                var currentX = page.boundingRectangle.x\n                    + ((prevX - page.boundingRectangle.x) < 0 ? prevX - page.boundingRectangle.x : (prevX - page.boundingRectangle.x) * (this.documentHelper.zoomFactor / prevValue));\n                value = currentX - zoomX;\n                zoomX = this.documentHelper.visibleBounds.width / 2;\n            }\n            this.documentHelper.viewerContainer.scrollLeft = value;\n        }\n        else {\n            this.documentHelper.viewerContainer.scrollLeft = 0;\n        }\n        this.updateScrollBars();\n        if (scrollToPosition) {\n            this.documentHelper.scrollToPosition(this.documentHelper.selection.start, this.documentHelper.selection.end);\n        }\n        if (this instanceof WebLayoutViewer) {\n            this.owner.editorModule.layoutWholeDocument();\n        }\n    };\n    LayoutViewer.prototype.updateCanvasWidthAndHeight = function (viewerWidth, viewerHeight, containerHeight, containerWidth, width, height) {\n        if (this instanceof PageLayoutViewer) {\n            if (this.documentHelper.visibleBounds.width !== this.documentHelper.viewerContainer.clientWidth) {\n                viewerWidth -= (this.documentHelper.visibleBounds.width - this.documentHelper.viewerContainer.clientWidth);\n            }\n            else if (containerHeight > viewerHeight) {\n                viewerWidth -= this.documentHelper.viewerContainer.offsetWidth - this.documentHelper.viewerContainer.clientWidth;\n            }\n        }\n        else {\n            if (containerHeight > viewerHeight) {\n                viewerWidth -= this.documentHelper.scrollbarWidth;\n                containerWidth -= this.documentHelper.scrollbarWidth;\n            }\n        }\n        if (containerWidth > viewerWidth) {\n            viewerHeight -= this.documentHelper.scrollbarWidth;\n        }\n        width = containerWidth > viewerWidth ? containerWidth : viewerWidth;\n        height = containerHeight > viewerHeight ? containerHeight : viewerHeight;\n        if (parseInt(this.documentHelper.pageContainer.style.width.replace('px', ''), 10) !== width ||\n            parseInt(this.documentHelper.pageContainer.style.height.replace('px', ''), 10) !== width) {\n            this.documentHelper.pageContainer.style.width = width.toString() + 'px';\n            this.documentHelper.pageContainer.style.height = height.toString() + 'px';\n        }\n        // if (!isNullOrUndefined(this.selection) && !this.selection.isEmpty) {\n        //     this.selectionContext.clearRect(0, 0, this.selectionCanvas.width, this.selectionCanvas.height);\n        var displayPixelRatio = Math.max(1, window.devicePixelRatio || 1);\n        if (this.documentHelper.containerCanvas.width !== Math.floor(viewerWidth * displayPixelRatio)\n            || this.documentHelper.containerCanvas.height !== Math.floor(viewerHeight * displayPixelRatio)) {\n            this.documentHelper.containerCanvas.width = viewerWidth * displayPixelRatio;\n            this.documentHelper.containerCanvas.height = viewerHeight * displayPixelRatio;\n            this.documentHelper.containerCanvas.style.width = viewerWidth + 'px';\n            this.documentHelper.containerCanvas.style.height = viewerHeight + 'px';\n            this.documentHelper.containerContext.scale(displayPixelRatio, displayPixelRatio);\n            this.documentHelper.selectionCanvas.width = viewerWidth * displayPixelRatio;\n            this.documentHelper.selectionCanvas.height = viewerHeight * displayPixelRatio;\n            this.documentHelper.selectionCanvas.style.width = viewerWidth + 'px';\n            this.documentHelper.selectionCanvas.style.height = viewerHeight + 'px';\n            this.documentHelper.selectionContext.scale(displayPixelRatio, displayPixelRatio);\n        }\n        return {\n            'height': height,\n            'width': width,\n            'viewerWidth': viewerWidth,\n            'viewerHeight': viewerHeight,\n            'containerHeight': containerHeight,\n            'containerWidth': containerWidth\n        };\n    };\n    LayoutViewer.prototype.updateScrollBarPosition = function (containerWidth, containerHeight, viewerWidth, viewerHeight, width, height) {\n        this.owner.viewer.containerTop = this.documentHelper.viewerContainer.scrollTop;\n        this.owner.viewer.containerWidth = containerWidth;\n        this.documentHelper.containerCanvas.style.position = 'absolute';\n        this.documentHelper.containerCanvas.style.top = this.owner.viewer.containerTop.toString() + 'px';\n        this.documentHelper.selectionCanvas.style.position = 'absolute';\n        this.documentHelper.selectionCanvas.style.top = this.owner.viewer.containerTop.toString() + 'px';\n        this.owner.viewer.containerLeft = this.documentHelper.viewerContainer.scrollLeft;\n        this.documentHelper.containerCanvas.style.left = this.owner.viewer.containerLeft + 'px';\n        this.documentHelper.selectionCanvas.style.left = this.owner.viewer.containerLeft + 'px';\n    };\n    LayoutViewer.prototype.destroy = function () {\n        this.clientArea = undefined;\n        this.clientActiveArea = undefined;\n    };\n    /**\n     * Disposes the internal objects which are maintained.\n     * @private\n     */\n    LayoutViewer.prototype.componentDestroy = function () {\n        this.clientArea = undefined;\n        this.clientActiveArea = undefined;\n        this.owner = undefined;\n    };\n    return LayoutViewer;\n}());\nexport { LayoutViewer };\n/**\n * @private\n */\nvar PageLayoutViewer = /** @class */ (function (_super) {\n    __extends(PageLayoutViewer, _super);\n    /**\n     * Initialize the constructor of PageLayoutViewer\n     */\n    function PageLayoutViewer(owner) {\n        var _this = _super.call(this, owner) || this;\n        _this.pageLeft = 30;\n        // if (isNullOrUndefined(owner) || isNullOrUndefined(owner.element)) {\n        //     return;\n        // }\n        _this.owner = owner;\n        return _this;\n    }\n    Object.defineProperty(PageLayoutViewer.prototype, \"pageGap\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.owner.pageGap;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(PageLayoutViewer.prototype, \"documentHelper\", {\n        get: function () {\n            return this.owner.documentHelper;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    PageLayoutViewer.prototype.createNewPage = function (section, index) {\n        var viewer = this;\n        var yPos = this.pageGap;\n        if (this.documentHelper.pages.length > 0) {\n            yPos = this.documentHelper.pages[this.documentHelper.pages.length - 1].boundingRectangle.bottom + this.pageGap;\n        }\n        var page = new Page(this.documentHelper);\n        this.updatePageBoundingRectangle(section, page, yPos);\n        if (isNullOrUndefined(index)) {\n            this.documentHelper.pages.push(page);\n        }\n        else {\n            this.documentHelper.pages.splice(index, 0, page);\n        }\n        page.bodyWidgets.push(section);\n        page.bodyWidgets[page.bodyWidgets.length - 1].page = page;\n        this.updateClientArea(section, page);\n        this.documentHelper.layout.layoutHeaderFooter(section, viewer, page);\n        this.updateClientArea(section, page);\n        this.documentHelper.layout.footnoteHeight = 0;\n        return page;\n    };\n    PageLayoutViewer.prototype.updatePageBoundingRectangle = function (section, page, yPosition) {\n        //page.viewer = this;\n        var pageWidth = !isNullOrUndefined(section.sectionFormat) ? HelperMethods.convertPointToPixel(section.sectionFormat.pageWidth) : 816;\n        var pageHeight = !isNullOrUndefined(section.sectionFormat) ? HelperMethods.convertPointToPixel(section.sectionFormat.pageHeight) : 1056;\n        var xPos = (this.documentHelper.visibleBounds.width - pageWidth * this.documentHelper.zoomFactor) / 2;\n        if (xPos < this.pageLeft) {\n            xPos = this.pageLeft;\n        }\n        page.boundingRectangle = new Rect(xPos, yPosition, pageWidth, pageHeight);\n    };\n    PageLayoutViewer.prototype.onPageFitTypeChanged = function (pageFitType) {\n        var width = this.documentHelper.visibleBounds.width;\n        var height = this.documentHelper.visibleBounds.height;\n        var section = this.visiblePages[0].bodyWidgets[0];\n        var pageWidth = HelperMethods.convertPointToPixel(section.sectionFormat.pageWidth);\n        var pageHeight = HelperMethods.convertPointToPixel(section.sectionFormat.pageHeight);\n        switch (pageFitType) {\n            case 'FitOnePage':\n                if (height > 0 && pageHeight > 0) {\n                    var zoomFactor = (this.documentHelper.visibleBounds.height - 2 * this.pageGap - (this.pageGap - 2)) / pageHeight;\n                    if (zoomFactor === this.documentHelper.zoomFactor) {\n                        if (!isNullOrUndefined(this.owner.selectionModule) && !isNullOrUndefined(this.owner.selectionModule.start) &&\n                            !isNullOrUndefined(this.owner.selectionModule.end)) {\n                            this.documentHelper.scrollToPosition(this.owner.selectionModule.start, this.owner.selectionModule.end);\n                        }\n                    }\n                    else {\n                        this.documentHelper.zoomFactor = zoomFactor;\n                    }\n                }\n                break;\n            case 'FitPageWidth':\n                if (width > 0 && pageWidth > 0) {\n                    this.documentHelper.zoomFactor = (this.documentHelper.visibleBounds.width - 80) / pageWidth;\n                }\n                break;\n            default:\n                this.documentHelper.zoomFactor = 100 / 100;\n                break;\n        }\n    };\n    PageLayoutViewer.prototype.getCurrentPageHeaderFooter = function (section, isHeader) {\n        return this.getCurrentHeaderFooter(this.getHeaderFooterType(section, isHeader), section.index);\n    };\n    PageLayoutViewer.prototype.getHeaderFooterType = function (section, isHeader) {\n        var type;\n        type = isHeader ? 'OddHeader' : 'OddFooter';\n        var page = section.page;\n        if (section.sectionFormat.differentFirstPage && (isNullOrUndefined(page.previousPage) || (!isNullOrUndefined(page.previousPage) && page.sectionIndex !== page.previousPage.sectionIndex && page.previousPage.bodyWidgets[page.previousPage.bodyWidgets.length - 1].sectionIndex !== page.bodyWidgets[0].sectionIndex))) {\n            type = isHeader ? 'FirstPageHeader' : 'FirstPageFooter';\n        }\n        else if (section.sectionFormat.differentOddAndEvenPages && (page.index + 1) % 2 === 0) {\n            type = isHeader ? 'EvenHeader' : 'EvenFooter';\n        }\n        return type;\n    };\n    PageLayoutViewer.prototype.getCurrentHeaderFooter = function (type, sectionIndex) {\n        if (this.documentHelper.headersFooters[sectionIndex]) {\n            var index = this.getHeaderFooter(type);\n            var headerFooter = this.documentHelper.headersFooters[sectionIndex][index];\n            if (!headerFooter) {\n                var currentSecIndex = sectionIndex > 0 ? sectionIndex - 1 : sectionIndex;\n                while (!headerFooter && currentSecIndex !== -1) {\n                    headerFooter = this.documentHelper.headersFooters[currentSecIndex][index];\n                    currentSecIndex--;\n                }\n                if (!headerFooter) {\n                    headerFooter = this.createHeaderFooterWidget(type);\n                    headerFooter.isEmpty = true;\n                }\n                if (sectionIndex == 0) {\n                    this.documentHelper.headersFooters[sectionIndex][index] = headerFooter;\n                }\n            }\n            return headerFooter;\n        }\n        else if (sectionIndex > 0) {\n            return this.getCurrentHeaderFooter(type, sectionIndex - 1);\n        }\n        return undefined;\n    };\n    PageLayoutViewer.prototype.createHeaderFooterWidget = function (type) {\n        var headerFooter = new HeaderFooterWidget(type);\n        var paragraph = new ParagraphWidget();\n        paragraph.childWidgets.push(new LineWidget(paragraph));\n        var style;\n        if (type.indexOf('Header') !== -1) {\n            style = this.documentHelper.styles.findByName('Header');\n        }\n        else {\n            style = this.documentHelper.styles.findByName('Footer');\n        }\n        paragraph.paragraphFormat.baseStyle = style;\n        paragraph.paragraphFormat.listFormat.baseStyle = style;\n        headerFooter.childWidgets.push(paragraph);\n        paragraph.containerWidget = headerFooter;\n        return headerFooter;\n    };\n    PageLayoutViewer.prototype.getHeaderFooter = function (type) {\n        switch (type) {\n            case 'OddHeader':\n                return 0;\n            case 'OddFooter':\n                return 1;\n            case 'EvenHeader':\n                return 2;\n            case 'EvenFooter':\n                return 3;\n            case 'FirstPageHeader':\n                return 4;\n            case 'FirstPageFooter':\n                return 5;\n        }\n    };\n    PageLayoutViewer.prototype.updateHFClientArea = function (sectionFormat, isHeader) {\n        var width = HelperMethods.convertPointToPixel(sectionFormat.pageWidth - sectionFormat.leftMargin - sectionFormat.rightMargin);\n        if (width < 0) {\n            width = 0;\n        }\n        if (isHeader) {\n            this.clientArea = new Rect(HelperMethods.convertPointToPixel(sectionFormat.leftMargin), HelperMethods.convertPointToPixel(sectionFormat.headerDistance), width, Number.POSITIVE_INFINITY);\n        }\n        else {\n            this.clientArea = new Rect(HelperMethods.convertPointToPixel(sectionFormat.leftMargin), HelperMethods.convertPointToPixel(sectionFormat.pageHeight - sectionFormat.footerDistance), width, Number.POSITIVE_INFINITY);\n        }\n        this.clientActiveArea = new Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n    };\n    PageLayoutViewer.prototype.updateHeaderFooterClientAreaWithTop = function (sectionFormat, isHeader, page) {\n        this.updateHFClientArea(sectionFormat, isHeader);\n        if (!isHeader) {\n            if (page.footerWidget.y < this.clientActiveArea.y) {\n                this.clientActiveArea.y = page.footerWidget.y;\n                this.clientActiveArea.height = Number.POSITIVE_INFINITY;\n            }\n        }\n    };\n    PageLayoutViewer.prototype.updateFootnoteClientArea = function (sectionFormat, footnote, footNoteType, para) {\n        var width = HelperMethods.convertPointToPixel(sectionFormat.pageWidth - sectionFormat.leftMargin - sectionFormat.rightMargin);\n        var left = HelperMethods.convertPointToPixel(sectionFormat.leftMargin);\n        var bottomMargin = HelperMethods.convertPointToPixel(sectionFormat.bottomMargin);\n        var footerDistance = HelperMethods.convertPointToPixel(sectionFormat.footerDistance);\n        var top = HelperMethods.convertPointToPixel(sectionFormat.pageHeight) - Math.max(footerDistance + footnote.page.footerWidget.height, bottomMargin);\n        this.clientArea = new Rect(left, top, width, Number.POSITIVE_INFINITY);\n        this.clientActiveArea = new Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, Number.POSITIVE_INFINITY);\n    };\n    PageLayoutViewer.prototype.scrollToPage = function (pageIndex) {\n        var top = 0;\n        for (var i = 0; i < this.documentHelper.pages.length; i++) {\n            top = this.documentHelper.pages[i].boundingRectangle.y - (this.pageGap / 2);\n            if (i === pageIndex) {\n                break;\n            }\n        }\n        this.documentHelper.viewerContainer.scrollTop = top;\n        this.updateScrollBars();\n    };\n    PageLayoutViewer.prototype.updateScrollBars = function () {\n        var updatePositionObj;\n        updatePositionObj = this.getPageHeightAndWidth(0, 0, 0, 0);\n        var containerWidth = (updatePositionObj.width * this.documentHelper.zoomFactor) + (this.pageLeft * 2);\n        var containerHeight = (updatePositionObj.height * this.documentHelper.zoomFactor) + (this.documentHelper.pages.length + 1) * this.pageGap;\n        var updateObj;\n        updateObj = this.updateCanvasWidthAndHeight(updatePositionObj.viewerWidth, updatePositionObj.viewerHeight, containerHeight, containerWidth, updatePositionObj.width, updatePositionObj.height);\n        containerHeight = updateObj.containerHeight;\n        containerWidth = updateObj.containerWidth;\n        this.documentHelper.containerContext.globalAlpha = 1;\n        this.documentHelper.selectionContext.globalAlpha = 0.4;\n        for (var i = 0; i < this.documentHelper.pages.length; i++) {\n            var left = (updateObj.width - this.documentHelper.pages[i].boundingRectangle.width * this.documentHelper.zoomFactor) / 2;\n            if (left > this.pageLeft) {\n                this.documentHelper.pages[i].boundingRectangle = new Rect(left, this.documentHelper.pages[i].boundingRectangle.y, this.documentHelper.pages[i].boundingRectangle.width, this.documentHelper.pages[i].boundingRectangle.height);\n            }\n            else {\n                this.documentHelper.pages[i].boundingRectangle = new Rect(this.pageLeft, this.documentHelper.pages[i].boundingRectangle.y, this.documentHelper.pages[i].boundingRectangle.width, this.documentHelper.pages[i].boundingRectangle.height);\n            }\n        }\n        this.updateScrollBarPosition(containerWidth, containerHeight, updateObj.viewerWidth, updateObj.viewerHeight, updateObj.width, updateObj.height);\n        this.updateVisiblePages();\n        this.documentHelper.isScrollToSpellCheck = false;\n    };\n    PageLayoutViewer.prototype.updateVisiblePages = function () {\n        // Clears the container first.\n        this.visiblePages = [];\n        for (var i = 0; i < this.documentHelper.pages.length; i++) {\n            var page = this.documentHelper.pages[i];\n            var y = (page.boundingRectangle.y - this.pageGap * (i + 1)) * this.documentHelper.zoomFactor + this.pageGap * (i + 1);\n            var left = page.boundingRectangle.x;\n            //UI Virtualization\n            if (this.documentHelper.isPageInVisibleBound(page, y)) {\n                this.addVisiblePage(page, left, y);\n            }\n        }\n    };\n    PageLayoutViewer.prototype.addVisiblePage = function (page, x, y) {\n        var _this = this;\n        var width = page.boundingRectangle.width * this.documentHelper.zoomFactor;\n        var height = page.boundingRectangle.height * this.documentHelper.zoomFactor;\n        if (this.owner.enableImageResizerMode && this.owner.imageResizerModule.currentPage !== undefined && this.owner.imageResizerModule.currentPage === page && this.owner.imageResizerModule.isImageResizerVisible) {\n            this.owner.imageResizerModule.setImageResizerPositions(x, y, width, height);\n        }\n        this.visiblePages.push(page);\n        if (this.documentHelper.owner.isSpellCheck && this.documentHelper.owner.spellCheckerModule.enableOptimizedSpellCheck && (this.owner.documentHelper.triggerElementsOnLoading || this.owner.documentHelper.isScrollHandler) && (this.documentHelper.cachedPages.indexOf(page.index) < 0 || this.owner.editorModule.isPasteContentCheck)) {\n            this.owner.documentHelper.cachedPages.push(page.index);\n            var content = void 0;\n            if (this.owner.editorModule.isPasteContentCheck) {\n                content = !isNullOrUndefined(this.owner.editorModule.copiedTextContent) ? this.owner.editorModule.copiedTextContent : '';\n            }\n            else {\n                content = this.documentHelper.owner.spellCheckerModule.getPageContent(page);\n            }\n            if (content.trim().length > 0) {\n                page.allowNextPageRendering = false;\n                if (!isNullOrUndefined(this.owner) && !isNullOrUndefined(this.owner.spellCheckerModule)) {\n                    this.owner.spellCheckerModule.updateUniqueWords(HelperMethods.getSpellCheckData(content));\n                }\n                /* eslint-disable @typescript-eslint/no-explicit-any */\n                this.owner.spellCheckerModule.callSpellChecker(this.owner.spellCheckerModule.languageID, content, true, false, false, true).then(function (data) {\n                    /* eslint-disable @typescript-eslint/no-explicit-any */\n                    var jsonObject = JSON.parse(data);\n                    if (!isNullOrUndefined(_this.owner) && !isNullOrUndefined(_this.owner.spellCheckerModule)) {\n                        _this.owner.spellCheckerModule.updateUniqueWords(jsonObject.SpellCollection);\n                    }\n                    page.allowNextPageRendering = true;\n                    _this.documentHelper.triggerElementsOnLoading = true;\n                    _this.documentHelper.triggerSpellCheck = true;\n                    _this.documentHelper.triggerElementsOnLoading = true;\n                    _this.renderPage(page, x, y, width, height);\n                    _this.documentHelper.triggerSpellCheck = false;\n                    _this.documentHelper.triggerElementsOnLoading = false;\n                });\n            }\n            else {\n                this.renderPage(page, x, y, width, height);\n            }\n        }\n        else {\n            this.renderPage(page, x, y, width, height);\n        }\n    };\n    PageLayoutViewer.prototype.renderPage = function (page, x, y, width, height) {\n        this.documentHelper.render.renderWidgets(page, x - this.owner.viewer.containerLeft, y - this.owner.viewer.containerTop, width, height);\n    };\n    return PageLayoutViewer;\n}(LayoutViewer));\nexport { PageLayoutViewer };\nvar WebLayoutViewer = /** @class */ (function (_super) {\n    __extends(WebLayoutViewer, _super);\n    function WebLayoutViewer(owner) {\n        var _this = _super.call(this, owner) || this;\n        /**\n         * @private\n         */\n        _this.visiblePages = [];\n        /* if (isNullOrUndefined(owner) || isNullOrUndefined(owner.element)) {\n             return;\n         }*/\n        _this.owner = owner;\n        return _this;\n    }\n    Object.defineProperty(WebLayoutViewer.prototype, \"documentHelper\", {\n        get: function () {\n            return this.owner.documentHelper;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WebLayoutViewer.prototype, \"pageGap\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return 0;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Creates new page.\n     * @private\n     */\n    WebLayoutViewer.prototype.createNewPage = function (section, index) {\n        var page;\n        var yPos = 0;\n        var x = 10;\n        if (this.documentHelper.pages.length > 0) {\n            yPos = this.documentHelper.pages[this.documentHelper.pages.length - 1].boundingRectangle.bottom;\n        }\n        page = new Page(this.documentHelper);\n        if (this.documentHelper.pages.length === 0) {\n            page.boundingRectangle = new Rect(x, yPos, this.documentHelper.visibleBounds.width, this.documentHelper.visibleBounds.height);\n        }\n        else {\n            page.boundingRectangle = new Rect(x, yPos - 20, this.documentHelper.visibleBounds.width, this.documentHelper.visibleBounds.height);\n        }\n        this.documentHelper.pages.push(page);\n        this.updateClientArea(undefined, page);\n        page.bodyWidgets.push(section);\n        page.bodyWidgets[page.bodyWidgets.length - 1].page = page;\n        return page;\n    };\n    WebLayoutViewer.prototype.onPageFitTypeChanged = function (pageFitType) {\n        this.documentHelper.zoomFactor = 1;\n    };\n    WebLayoutViewer.prototype.scrollToPage = function (pageIndex) {\n        this.updateScrollBars();\n    };\n    WebLayoutViewer.prototype.getContentHeight = function () {\n        var height = 0;\n        for (var i = 0; i < this.documentHelper.pages.length; i++) {\n            var page = this.documentHelper.pages[i];\n            if (i === 0) {\n                height += this.padding.top;\n                page.boundingRectangle.y = this.padding.top;\n            }\n            else {\n                page.boundingRectangle.y = this.documentHelper.pages[i - 1].boundingRectangle.bottom;\n            }\n            page.boundingRectangle.height = page.bodyWidgets[0].height;\n            height += page.bodyWidgets[0].height;\n            if (i === this.documentHelper.pages.length - 1) {\n                height += this.padding.bottom;\n            }\n        }\n        return height;\n    };\n    /**\n     * @private\n     */\n    WebLayoutViewer.prototype.getContentWidth = function () {\n        var width = this.documentHelper.visibleBounds.width;\n        var currentWidth = width;\n        for (var i = 0; i < this.documentHelper.pages.length; i++) {\n            var page = this.documentHelper.pages[i];\n            for (var j = 0; j < page.bodyWidgets[0].childWidgets.length; j++) {\n                if (page.bodyWidgets[0].childWidgets[j] instanceof TableWidget) {\n                    var tableWidget = page.bodyWidgets[0].childWidgets[j];\n                    var tableWidth = HelperMethods.convertPointToPixel(tableWidget.getTableWidth()) *\n                        this.documentHelper.zoomFactor + this.padding.left * 4 + this.padding.right * 4\n                        + page.boundingRectangle.x;\n                    if (currentWidth < tableWidth) {\n                        width = tableWidth;\n                        currentWidth = tableWidth;\n                    }\n                }\n            }\n            page.boundingRectangle.width = width;\n        }\n        return width;\n    };\n    WebLayoutViewer.prototype.updateScrollBars = function () {\n        var updatePositionObj;\n        updatePositionObj = this.getPageHeightAndWidth(0, 0, 0, 0);\n        var containerWidth = this.getContentWidth() * this.documentHelper.zoomFactor + this.padding.left + this.padding.right;\n        var containerHeight = this.getContentHeight() * this.documentHelper.zoomFactor + this.padding.top + this.padding.bottom;\n        var updateObj;\n        updateObj = this.updateCanvasWidthAndHeight(updatePositionObj.viewerWidth, updatePositionObj.viewerHeight, containerHeight, containerWidth, updatePositionObj.width, updatePositionObj.height);\n        this.documentHelper.containerContext.globalAlpha = 1;\n        this.documentHelper.selectionContext.globalAlpha = 0.4;\n        this.updateScrollBarPosition(containerWidth, containerHeight, updateObj.viewerWidth, updateObj.viewerHeight, updateObj.width, updateObj.height);\n        this.updateVisiblePages();\n        this.documentHelper.isScrollToSpellCheck = false;\n    };\n    WebLayoutViewer.prototype.updateVisiblePages = function () {\n        this.visiblePages = [];\n        var page;\n        var y;\n        var height = this.documentHelper.visibleBounds.height;\n        var vertical = this.documentHelper.viewerContainer.scrollTop;\n        for (var i = 0; i < this.documentHelper.pages.length; i++) {\n            page = this.documentHelper.pages[i];\n            y = (page.boundingRectangle.y) * this.documentHelper.zoomFactor;\n            var pageH = page.boundingRectangle.height * this.documentHelper.zoomFactor;\n            var isTopFit = y >= vertical && y <= vertical + height;\n            var isBottomFit = y + pageH >= vertical && y + pageH <= vertical + height;\n            var isMiddleFit = y <= vertical && y + pageH >= vertical + height;\n            //UI Virtualization\n            if (isTopFit || isBottomFit || isMiddleFit) {\n                this.addVisiblePage(page, this.padding.left, y);\n            }\n        }\n    };\n    WebLayoutViewer.prototype.addVisiblePage = function (page, x, y) {\n        var _this = this;\n        var width = this.getContentWidth();\n        var height = this.getContentHeight() * this.documentHelper.zoomFactor + this.padding.top + this.padding.bottom;\n        if (this.owner.enableImageResizerMode && this.owner.imageResizerModule.currentPage !== undefined && this.owner.imageResizerModule.currentPage === page && this.owner.imageResizerModule.isImageResizerVisible) {\n            this.owner.imageResizerModule.setImageResizerPositions(x, y, width, height);\n        }\n        this.visiblePages.push(page);\n        if (this.documentHelper.owner.isSpellCheck && this.documentHelper.owner.spellCheckerModule.enableOptimizedSpellCheck && (this.owner.documentHelper.triggerElementsOnLoading || this.owner.documentHelper.isScrollHandler) && (this.documentHelper.cachedPages.indexOf(page.index) < 0 || this.owner.editorModule.isPasteContentCheck)) {\n            this.owner.documentHelper.cachedPages.push(page.index);\n            var contentlen = void 0;\n            if (this.owner.editorModule.isPasteContentCheck) {\n                contentlen = !isNullOrUndefined(this.owner.editorModule.copiedTextContent) ? this.owner.editorModule.copiedTextContent : '';\n            }\n            else {\n                contentlen = this.documentHelper.owner.spellCheckerModule.getPageContent(page);\n            }\n            if (contentlen.trim().length > 0) {\n                page.allowNextPageRendering = false;\n                if (!isNullOrUndefined(this.owner) && !isNullOrUndefined(this.owner.spellCheckerModule)) {\n                    this.owner.spellCheckerModule.updateUniqueWords(HelperMethods.getSpellCheckData(contentlen));\n                }\n                /* eslint-disable @typescript-eslint/no-explicit-any */\n                this.owner.spellCheckerModule.callSpellChecker(this.owner.spellCheckerModule.languageID, contentlen, true, false, false, true).then(function (data) {\n                    /* eslint-disable @typescript-eslint/no-explicit-any */\n                    var jsonObj = JSON.parse(data);\n                    if (!isNullOrUndefined(_this.owner) && !isNullOrUndefined(_this.owner.spellCheckerModule)) {\n                        _this.owner.spellCheckerModule.updateUniqueWords(jsonObj.SpellCollection);\n                    }\n                    page.allowNextPageRendering = true;\n                    _this.owner.documentHelper.triggerSpellCheck = true;\n                    _this.owner.documentHelper.triggerElementsOnLoading = true;\n                    _this.renderPage(page, x, y, width, height);\n                    _this.owner.documentHelper.triggerSpellCheck = false;\n                    _this.owner.documentHelper.triggerElementsOnLoading = false;\n                });\n            }\n            else {\n                this.renderPage(page, x, y, width, height);\n            }\n        }\n        else {\n            this.renderPage(page, x, y, width, height);\n        }\n    };\n    /**\n     * @private\n     */\n    WebLayoutViewer.prototype.renderPage = function (page, x, y, width, height) {\n        this.documentHelper.render.renderWidgets(page, x - this.owner.viewer.containerLeft, y - this.owner.viewer.containerTop, width, height);\n    };\n    return WebLayoutViewer;\n}(LayoutViewer));\nexport { WebLayoutViewer };\n/**\n * @private\n */\nvar ColumnLayout = /** @class */ (function () {\n    /**\n     * Initialize the constructor of Column Layout Settings\n     */\n    function ColumnLayout(viewer) {\n        this.viewerIn = viewer;\n        this.clear();\n    }\n    Object.defineProperty(ColumnLayout.prototype, \"currentIndex\", {\n        get: function () {\n            return this.currentIndexIn;\n        },\n        set: function (value) {\n            if (value >= 0) {\n                this.currentIndexIn = value;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ColumnLayout.prototype, \"columnCount\", {\n        get: function () {\n            var colCount;\n            if (!isNullOrUndefined(this.columnIn)) {\n                colCount = this.numberOfColumnsIn;\n            }\n            colCount = colCount > 0 ? colCount : 1;\n            return colCount;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     * @param sectionFormat\n     */\n    ColumnLayout.prototype.setColumns = function (sectionFormat) {\n        this.pageWidth = HelperMethods.convertPointToPixel(sectionFormat.pageWidth - sectionFormat.leftMargin - sectionFormat.rightMargin);\n        this.numberOfColumnsIn = sectionFormat.numberOfColumns;\n        if (!isNullOrUndefined(sectionFormat.columns)) {\n            var columns = sectionFormat.columns;\n            var columnList = [];\n            for (var i = 0; i < sectionFormat.numberOfColumns; i++) {\n                var space = this.defaultSpaceIn;\n                var width = 0;\n                if (!isNullOrUndefined(columns) && columns.length > 0) {\n                    space = columns[i].space;\n                    width = columns[i].width;\n                }\n                var col = this.getColumnObj(width, space, sectionFormat.numberOfColumns, sectionFormat.equalWidth);\n                col.index = i;\n                columnList.push(col);\n            }\n            this.columnIn = columnList;\n        }\n    };\n    /**\n     * @private\n     */\n    ColumnLayout.prototype.clear = function () {\n        this.currentIndexIn = 0;\n        this.defaultSpaceIn = 36;\n        this.columnIn = null;\n        this.pageWidth = 0;\n    };\n    ColumnLayout.prototype.reset = function () {\n        this.currentIndex = 0;\n    };\n    /**\n     * @private\n     * @param bodyWidget\n     * @param clientArea\n     * @returns\n     */\n    ColumnLayout.prototype.getColumnBounds = function (bodyWidget, clientArea) {\n        var colIndex = this.currentIndexIn;\n        return this.getColumnBoundsByIndex(colIndex, clientArea);\n    };\n    /**\n     * @private\n     * @param bodyWidget\n     * @param clientArea\n     * @returns\n     */\n    ColumnLayout.prototype.getColumnBoundsByBodyWidget = function (bodyWidget, clientArea) {\n        var colIndex = bodyWidget.columnIndex;\n        return this.getColumnBoundsByIndex(colIndex, clientArea);\n    };\n    /**\n     * @private\n     * @param bodyWidget\n     * @param clientArea\n     * @returns\n     */\n    ColumnLayout.prototype.getNextColumnByBodyWidget = function (bodyWidget) {\n        var colIndex = bodyWidget.columnIndex;\n        var nextColumn = this.getColumnByIndex(colIndex + 1);\n        return nextColumn;\n    };\n    ColumnLayout.prototype.getColumnByIndex = function (index) {\n        if (index >= 0 && index < this.columnCount && !isNullOrUndefined(this.columnIn) && this.columnIn.length > 0) {\n            return this.columnIn[index];\n        }\n        return undefined;\n    };\n    ColumnLayout.prototype.getColumnObj = function (colWidth, colSpace, noOfCols, isEqualWidth) {\n        var totalSpace = (noOfCols - 1) * colSpace;\n        var colObj = new WColumnFormat();\n        if ((isEqualWidth || colWidth === 0) && !isNullOrUndefined(this.pageWidth)) {\n            colWidth = (this.pageWidth - totalSpace) / noOfCols;\n        }\n        colObj.width = colWidth;\n        colObj.space = colSpace;\n        return colObj;\n    };\n    ColumnLayout.prototype.getColumnBoundsByIndex = function (colIndex, clientArea) {\n        var colRect = new Rect(clientArea.x, clientArea.y, clientArea.width, clientArea.height);\n        if (colIndex >= 0 && this.columnIn.length > 0) {\n            var curColumn = void 0;\n            var prevColumn = void 0;\n            if (!isNullOrUndefined(this.columnIn[colIndex])) {\n                curColumn = this.getColumnByIndex(colIndex);\n                colRect.width = curColumn.width;\n                for (var i = 0; i < colIndex; i++) {\n                    prevColumn = this.columnIn[i];\n                    colRect.x += prevColumn.width;\n                    colRect.x += prevColumn.space;\n                }\n            }\n        }\n        return colRect;\n    };\n    return ColumnLayout;\n}());\nexport { ColumnLayout };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}