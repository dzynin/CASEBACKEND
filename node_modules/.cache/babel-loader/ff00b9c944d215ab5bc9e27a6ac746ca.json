{"ast":null,"code":"var _jsxFileName = \"/home/taymur/Documents/legal2/DATA/Highlight/newmerged/CASEFRONTt/src/TextEditor.js\";\nimport React, { useContext, useEffect, useState, useCallback } from \"react\";\nimport Quill from \"quill\";\nimport { Button, Modal } from \"react-bootstrap\";\nimport \"quill/dist/quill.snow.css\";\nimport { io } from \"socket.io-client\";\nimport { UserContext } from \"./App\";\nimport { FaRegPaperPlane, FaBriefcase, FaFile } from 'react-icons/fa'; // Importing icons\n// Time in milliseconds to auto save the document\n\nconst SAVE_INTERVAL_MS = 15000; // Options available in toolbar\n\nconst TOOLBAR_OPTIONS = [[{\n  header: [1, 2, 3, 4, 5, 6, false]\n}], [{\n  font: []\n}], [{\n  list: \"ordered\"\n}, {\n  list: \"bullet\"\n}], [\"bold\", \"italic\", \"underline\"], [{\n  color: []\n}, {\n  background: []\n}], [{\n  script: \"sub\"\n}, {\n  script: \"super\"\n}], [{\n  align: []\n}], [\"blockquote\", \"code-block\"], [\"clean\"]];\nexport default function TextEditor({\n  id,\n  fileName,\n  showTextEditor,\n  setShowTextEditor\n}) {\n  const documentId = id;\n  const {\n    state\n  } = useContext(UserContext);\n  const [socket, setSocket] = useState();\n  const [quill, setQuill] = useState();\n  const [openaiResponses, setOpenaiResponses] = useState([]);\n  const [editorMode, setEditorMode] = useState(null);\n  const [isQuillReady, setIsQuillReady] = useState(false);\n\n  const handleCopyToClipboard = text => {\n    // Copy to clipboard\n    navigator.clipboard.writeText(text).then(() => {\n      console.log('Text copied to clipboard');\n    }, err => {\n      console.error('Could not copy text: ', err);\n    }); // Paste into the Quill editor at the current cursor position, or at the end if no selection is made\n\n    const range = quill.getSelection();\n    const position = range ? range.index : quill.getLength();\n    quill.insertText(position, text);\n    quill.setSelection(position + text.length); // Move cursor to the end of the inserted text\n  };\n\n  useEffect(() => {\n    const s = io(\"http://localhost:8000\");\n    setSocket(s);\n    return () => {\n      s.disconnect();\n    };\n  }, []);\n  useEffect(() => {\n    if (quill != null && state.highlightTextForEditor) {\n      const length = quill.getLength();\n      quill.insertText(length, \"\\n\" + state.highlightTextForEditor);\n    }\n  }, [quill, state.highlightTextForEditor]);\n  const wrapperRef = useCallback(wrapper => {\n    if (wrapper == null) return;\n    wrapper.innerHTML = \"\";\n    const editor = document.createElement(\"div\");\n    wrapper.append(editor);\n    const q = new Quill(editor, {\n      theme: \"snow\",\n      modules: {\n        toolbar: TOOLBAR_OPTIONS\n      }\n    });\n    q.enable();\n    setQuill(q);\n    setIsQuillReady(true);\n  }, []);\n\n  const handleAppeal = () => {\n    if (socket && socket.connected) {\n      const dataToSend = {\n        content: 'Your input data here'\n      };\n      socket.emit(\"openai_call\", JSON.stringify(dataToSend));\n      setEditorMode('appeal');\n    } else {\n      console.log(\"Socket is not connected.\");\n    }\n  };\n\n  const handleGetRecommendations = () => {\n    if (socket && socket.connected) {\n      socket.emit(\"openai-get-recommendations\", {\n        documentId,\n        fileName\n      });\n    } else {\n      console.log(\"Socket is not connected.\");\n    }\n  };\n\n  useEffect(() => {\n    const newSocket = io(\"http://localhost:8000\");\n    setSocket(newSocket);\n    return () => {\n      newSocket.disconnect();\n    };\n  }, []);\n  useEffect(() => {\n    if (editorMode === 'edit_document' && socket) {\n      socket.emit(\"get-document\", {\n        documentId,\n        fileName\n      });\n    }\n  }, [editorMode, socket, documentId, fileName]);\n  useEffect(() => {\n    if (!socket || !isQuillReady) return;\n\n    const handleOpenaiRecommendations = recommendations => {\n      setOpenaiResponses(recommendations);\n    };\n\n    socket.on(\"openai-recommendations\", handleOpenaiRecommendations);\n    return () => {\n      socket.off(\"openai-recommendations\", handleOpenaiRecommendations);\n    };\n  }, [socket, isQuillReady]);\n  return /*#__PURE__*/React.createElement(React.Fragment, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 5\n    }\n  }, !editorMode ? /*#__PURE__*/React.createElement(Modal, {\n    show: showTextEditor,\n    onHide: handleClose,\n    backdrop: \"static\",\n    centered: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Modal.Header, {\n    closeButton: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Modal.Title, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 13\n    }\n  }, \"Choose an Option\")), /*#__PURE__*/React.createElement(Modal.Body, {\n    style: {\n      textAlign: 'center'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    variant: \"outline-primary\",\n    onClick: handleAppeal,\n    style: {\n      margin: '10px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(FaRegPaperPlane, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 15\n    }\n  }), \" Appeal\"), /*#__PURE__*/React.createElement(Button, {\n    variant: \"outline-success\",\n    onClick: handleEditDocument,\n    style: {\n      margin: '10px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(FaBriefcase, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 15\n    }\n  }), \" Edit Document\"), /*#__PURE__*/React.createElement(Button, {\n    variant: \"outline-info\",\n    onClick: handleNewDocument,\n    style: {\n      margin: '10px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(FaFile, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 15\n    }\n  }), \" New Document\"))) : /*#__PURE__*/React.createElement(Modal, {\n    style: {\n      color: \"#050505\"\n    },\n    show: showTextEditor,\n    onHide: handleClose,\n    backdrop: \"static\",\n    size: \"xl\",\n    centered: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Modal.Body, {\n    style: {\n      height: '60vh'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      display: 'flex',\n      flexDirection: 'row',\n      height: '100%'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      flex: 2,\n      borderRight: '1px solid #ccc',\n      paddingRight: '20px',\n      overflowY: 'auto'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"h4\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 17\n    }\n  }, \"Highlights\"), state.highlightTextsForEditor && state.highlightTextsForEditor.length > 0 ? state.highlightTextsForEditor.map((highlight, index) => /*#__PURE__*/React.createElement(\"div\", {\n    key: index,\n    style: {\n      padding: '10px',\n      margin: '5px 0'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 23\n    }\n  }, highlight.commentText), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 23\n    }\n  }, highlight.contentText))) : /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 19\n    }\n  }, \"No highlights to show\")), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      flex: 7,\n      marginRight: '20px'\n    },\n    ref: wrapperRef,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 15\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      flex: 3,\n      borderLeft: '1px solid #ccc',\n      paddingLeft: '20px',\n      overflowY: 'auto'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"h4\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 17\n    }\n  }, \"Recommendations\"), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      display: 'flex',\n      flexDirection: 'column-reverse'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 17\n    }\n  }, openaiResponses.map((response, index) => /*#__PURE__*/React.createElement(\"div\", {\n    key: index,\n    style: {\n      border: '1px solid #ccc',\n      padding: '10px',\n      margin: '5px 0',\n      display: 'flex',\n      justifyContent: 'space-between',\n      alignItems: 'center'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 179,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 23\n    }\n  }, response), /*#__PURE__*/React.createElement(Button, {\n    variant: \"outline-primary\",\n    onClick: () => handleCopyToClipboard(response),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 23\n    }\n  }, \"Insert\"))))))), /*#__PURE__*/React.createElement(Modal.Footer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    variant: \"secondary\",\n    onClick: handleClose,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 13\n    }\n  }, \"Close\"), /*#__PURE__*/React.createElement(Button, {\n    variant: \"primary\",\n    onClick: handleNoteSave,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 13\n    }\n  }, \"Save\"))));\n}","map":{"version":3,"sources":["/home/taymur/Documents/legal2/DATA/Highlight/newmerged/CASEFRONTt/src/TextEditor.js"],"names":["React","useContext","useEffect","useState","useCallback","Quill","Button","Modal","io","UserContext","FaRegPaperPlane","FaBriefcase","FaFile","SAVE_INTERVAL_MS","TOOLBAR_OPTIONS","header","font","list","color","background","script","align","TextEditor","id","fileName","showTextEditor","setShowTextEditor","documentId","state","socket","setSocket","quill","setQuill","openaiResponses","setOpenaiResponses","editorMode","setEditorMode","isQuillReady","setIsQuillReady","handleCopyToClipboard","text","navigator","clipboard","writeText","then","console","log","err","error","range","getSelection","position","index","getLength","insertText","setSelection","length","s","disconnect","highlightTextForEditor","wrapperRef","wrapper","innerHTML","editor","document","createElement","append","q","theme","modules","toolbar","enable","handleAppeal","connected","dataToSend","content","emit","JSON","stringify","handleGetRecommendations","newSocket","handleOpenaiRecommendations","recommendations","on","off","handleClose","textAlign","margin","handleEditDocument","handleNewDocument","height","display","flexDirection","flex","borderRight","paddingRight","overflowY","highlightTextsForEditor","map","highlight","padding","commentText","contentText","marginRight","borderLeft","paddingLeft","response","border","justifyContent","alignItems","handleNoteSave"],"mappings":"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","sourcesContent":["import React, { useContext, useEffect, useState, useCallback } from \"react\";\nimport Quill from \"quill\";\nimport { Button, Modal } from \"react-bootstrap\";\nimport \"quill/dist/quill.snow.css\";\nimport { io } from \"socket.io-client\";\nimport { UserContext } from \"./App\";\nimport { FaRegPaperPlane, FaBriefcase, FaFile } from 'react-icons/fa'; // Importing icons\n\n// Time in milliseconds to auto save the document\nconst SAVE_INTERVAL_MS = 15000;\n\n// Options available in toolbar\nconst TOOLBAR_OPTIONS = [\n  [{ header: [1, 2, 3, 4, 5, 6, false] }],\n  [{ font: [] }],\n  [{ list: \"ordered\" }, { list: \"bullet\" }],\n  [\"bold\", \"italic\", \"underline\"],\n  [{ color: [] }, { background: [] }],\n  [{ script: \"sub\" }, { script: \"super\" }],\n  [{ align: [] }],\n  [\"blockquote\", \"code-block\"],\n  [\"clean\"],\n];\n\nexport default function TextEditor({\n  id,\n  fileName,\n  showTextEditor,\n  setShowTextEditor,\n}) {\n  const documentId = id;\n  const { state } = useContext(UserContext);\n  const [socket, setSocket] = useState();\n  const [quill, setQuill] = useState();\n  const [openaiResponses, setOpenaiResponses] = useState([]);\n  const [editorMode, setEditorMode] = useState(null);\n  const [isQuillReady, setIsQuillReady] = useState(false);\n\n  const handleCopyToClipboard = (text) => {\n    // Copy to clipboard\n    navigator.clipboard.writeText(text).then(() => {\n      console.log('Text copied to clipboard');\n    }, (err) => {\n      console.error('Could not copy text: ', err);\n    });\n\n    // Paste into the Quill editor at the current cursor position, or at the end if no selection is made\n    const range = quill.getSelection();\n    const position = range ? range.index : quill.getLength();\n    quill.insertText(position, text);\n    quill.setSelection(position + text.length); // Move cursor to the end of the inserted text\n  };\n\n  useEffect(() => {\n    const s = io(\"http://localhost:8000\");\n    setSocket(s);\n\n    return () => {\n      s.disconnect();\n    };\n  }, []);\n\n  useEffect(() => {\n    if (quill != null && state.highlightTextForEditor) {\n      const length = quill.getLength();\n      quill.insertText(length, \"\\n\" + state.highlightTextForEditor);\n    }\n  }, [quill, state.highlightTextForEditor]);\n\n  const wrapperRef = useCallback((wrapper) => {\n    if (wrapper == null) return;\n    wrapper.innerHTML = \"\";\n    const editor = document.createElement(\"div\");\n    wrapper.append(editor);\n    const q = new Quill(editor, {\n      theme: \"snow\",\n      modules: { toolbar: TOOLBAR_OPTIONS },\n    });\n    q.enable();\n    setQuill(q);\n    setIsQuillReady(true);\n  }, []);\n\n  const handleAppeal = () => {\n    if (socket && socket.connected) {\n      const dataToSend = { content: 'Your input data here' };\n      socket.emit(\"openai_call\", JSON.stringify(dataToSend));\n      setEditorMode('appeal');\n    } else {\n      console.log(\"Socket is not connected.\");\n    }\n  };\n\n  const handleGetRecommendations = () => {\n    if (socket && socket.connected) {\n      socket.emit(\"openai-get-recommendations\", { documentId, fileName });\n    } else {\n      console.log(\"Socket is not connected.\");\n    }\n  };\n\n  useEffect(() => {\n    const newSocket = io(\"http://localhost:8000\");\n    setSocket(newSocket);\n\n    return () => {\n      newSocket.disconnect();\n    };\n  }, []);\n\n  useEffect(() => {\n    if (editorMode === 'edit_document' && socket) {\n      socket.emit(\"get-document\", { documentId, fileName });\n    }\n  }, [editorMode, socket, documentId, fileName]);\n\n  useEffect(() => {\n    if (!socket || !isQuillReady) return;\n\n    const handleOpenaiRecommendations = (recommendations) => {\n      setOpenaiResponses(recommendations);\n    };\n\n    socket.on(\"openai-recommendations\", handleOpenaiRecommendations);\n\n    return () => {\n      socket.off(\"openai-recommendations\", handleOpenaiRecommendations);\n    };\n  }, [socket, isQuillReady]);\n\n  return (\n    <React.Fragment>\n      {!editorMode ? (\n        <Modal show={showTextEditor} onHide={handleClose} backdrop=\"static\" centered>\n          <Modal.Header closeButton>\n            <Modal.Title>Choose an Option</Modal.Title>\n          </Modal.Header>\n          <Modal.Body style={{ textAlign: 'center' }}>\n            <Button variant=\"outline-primary\" onClick={handleAppeal} style={{ margin: '10px' }}>\n              <FaRegPaperPlane /> Appeal\n            </Button>\n            <Button variant=\"outline-success\" onClick={handleEditDocument} style={{ margin: '10px' }}>\n              <FaBriefcase /> Edit Document\n            </Button>\n            <Button variant=\"outline-info\" onClick={handleNewDocument} style={{ margin: '10px' }}>\n              <FaFile /> New Document\n            </Button>\n          </Modal.Body>\n        </Modal>\n      ) : (\n        <Modal\n          style={{ color: \"#050505\" }}\n          show={showTextEditor}\n          onHide={handleClose}\n          backdrop=\"static\"\n          size=\"xl\"\n          centered\n        >\n          <Modal.Body style={{ height: '60vh' }}>\n            <div style={{ display: 'flex', flexDirection: 'row', height: '100%' }}>\n              <div style={{ flex: 2, borderRight: '1px solid #ccc', paddingRight: '20px', overflowY: 'auto' }}>\n                <h4>Highlights</h4>\n                {state.highlightTextsForEditor && state.highlightTextsForEditor.length > 0 ? (\n                  state.highlightTextsForEditor.map((highlight, index) => (\n                    <div key={index} style={{ padding: '10px', margin: '5px 0' }}>\n                      <strong>{highlight.commentText}</strong>\n                      <p>{highlight.contentText}</p>\n                    </div>\n                  ))\n                ) : (\n                  <div>No highlights to show</div>\n                )}\n              </div>\n              <div style={{ flex: 7, marginRight: '20px' }} ref={wrapperRef}></div>\n              <div style={{ flex: 3, borderLeft: '1px solid #ccc', paddingLeft: '20px', overflowY: 'auto' }}>\n                <h4>Recommendations</h4>\n                <div style={{ display: 'flex', flexDirection: 'column-reverse' }}>\n                  {openaiResponses.map((response, index) => (\n                    <div key={index} style={{ border: '1px solid #ccc', padding: '10px', margin: '5px 0', display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\n                      <span>{response}</span>\n                      <Button variant=\"outline-primary\" onClick={() => handleCopyToClipboard(response)}>Insert</Button>\n                    </div>\n                  ))}\n                </div>\n              </div>\n            </div>\n          </Modal.Body>\n          <Modal.Footer>\n            <Button variant=\"secondary\" onClick={handleClose}>Close</Button>\n            <Button variant=\"primary\" onClick={handleNoteSave}>Save</Button>\n          </Modal.Footer>\n        </Modal>\n      )}\n    </React.Fragment>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}