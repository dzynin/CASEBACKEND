{"ast":null,"code":"/* eslint-disable */\nimport { TextSearchResults } from '../index';\nimport { beforeXmlHttpRequestSend } from './../../index';\nimport { Dictionary } from '../../base/dictionary';\nimport { TextElementBox, ErrorTextElementBox, TableCellWidget, FieldElementBox } from '../viewer/page';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * The spell checker module\n */\nvar SpellChecker = /** @class */function () {\n  function SpellChecker(documentHelper) {\n    this.langIDInternal = 0;\n    /**\n     * Specifies whether spell check has to be performed or not.\n     */\n    this.enableSpellCheckInternal = true;\n    /**\n     * @private\n     */\n    /* eslint-disable @typescript-eslint/no-explicit-any */\n    this.uniqueSpelledWords = {};\n    this.spellSuggestionInternal = true;\n    /**\n     * @private\n     */\n    this.uniqueKey = '';\n    this.removeUnderlineInternal = false;\n    /**\n     * @private\n     */\n    this.isChangeAll = false;\n    /**\n     * @default 1000\n     */\n    this.uniqueWordsCountInternal = 15000;\n    this.performOptimizedCheck = true;\n    this.documentHelper = documentHelper;\n    this.errorWordCollection = new Dictionary();\n    this.uniqueWordsCollection = new Dictionary();\n    this.errorSuggestions = new Dictionary();\n    this.ignoreAllItems = [];\n    this.uniqueSpelledWords = {};\n    this.textSearchResults = new TextSearchResults(this.documentHelper.owner);\n    this.uniqueKey = this.documentHelper.owner.element.id + '_' + this.createGuid();\n  }\n  /**\n   * Gets module name.\n   */\n  SpellChecker.prototype.getModuleName = function () {\n    return 'SpellChecker';\n  };\n  Object.defineProperty(SpellChecker.prototype, \"enableOptimizedSpellCheck\", {\n    /**\n     * Gets the boolean indicating whether optimized spell check to be performed.\n     *\n     * @aspType bool\n     * @returns {boolean} Returns enableOptimizedSpellCheck\n     */\n    get: function () {\n      return this.performOptimizedCheck;\n    },\n    /**\n     * Sets the boolean indicating whether optimized spell check to be performed.\n     *\n     * @aspType bool\n     */\n    set: function (value) {\n      this.performOptimizedCheck = value;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(SpellChecker.prototype, \"uniqueWordsCount\", {\n    /**\n     * Gets the spell checked Unique words.\n     *\n     * @aspType int\n     */\n    get: function () {\n      return isNullOrUndefined(this.uniqueWordsCountInternal) ? 0 : this.uniqueWordsCountInternal;\n    },\n    /**\n     * Sets the spell checked Unique words.\n     *\n     * @aspType int\n     */\n    set: function (value) {\n      this.uniqueWordsCountInternal = value;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(SpellChecker.prototype, \"languageID\", {\n    /**\n     * Gets the languageID.\n     *\n     * @aspType int\n     */\n    get: function () {\n      return isNullOrUndefined(this.langIDInternal) ? 0 : this.langIDInternal;\n    },\n    /**\n     * Sets the languageID.\n     *\n     * @aspType int\n     */\n    set: function (value) {\n      this.langIDInternal = value;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(SpellChecker.prototype, \"allowSpellCheckAndSuggestion\", {\n    /**\n     * Getter indicates whether suggestion enabled.\n     *\n     * @aspType bool\n     */\n    get: function () {\n      return this.spellSuggestionInternal;\n    },\n    /**\n     * Setter to enable or disable suggestion\n     *\n     * @aspType bool\n     */\n    set: function (value) {\n      this.spellSuggestionInternal = value;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(SpellChecker.prototype, \"removeUnderline\", {\n    /**\n     * Getter indicates whether underline removed for mis-spelled word.\n     *\n     * @aspType bool\n     */\n    get: function () {\n      return this.removeUnderlineInternal;\n    },\n    /**\n     * Setter to enable or disable underline for mis-spelled word\n     *\n     * @aspType bool\n     */\n    set: function (value) {\n      this.removeUnderlineInternal = value;\n      this.documentHelper.owner.editorModule.reLayout(this.documentHelper.selection);\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(SpellChecker.prototype, \"enableSpellCheck\", {\n    /**\n     * Getter indicates whether spell check has to be performed or not.\n     *\n     * @aspType bool\n     */\n    get: function () {\n      return this.enableSpellCheckInternal;\n    },\n    /**\n     * Setter to enable or disable spell check has to be performed or not\n     *\n     * @aspType bool\n     */\n    set: function (value) {\n      this.enableSpellCheckInternal = value;\n      this.documentHelper.owner.editorModule.reLayout(this.documentHelper.selection);\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(SpellChecker.prototype, \"viewer\", {\n    get: function () {\n      return this.documentHelper.owner.viewer;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  /**\n   * Method to manage replace logic\n   *\n   * @private\n   */\n  SpellChecker.prototype.manageReplace = function (content, dialogElement) {\n    this.documentHelper.triggerSpellCheck = true;\n    var exactText = '';\n    var elementInfo;\n    if (!isNullOrUndefined(dialogElement) && dialogElement instanceof ErrorTextElementBox) {\n      var exactText_1 = dialogElement.text;\n      this.documentHelper.selection.start = dialogElement.start.clone();\n      this.documentHelper.selection.end = dialogElement.end.clone();\n      if (content !== 'Ignore Once') {\n        content = this.manageSpecialCharacters(exactText_1, content);\n        this.documentHelper.owner.editorModule.insertTextInternal(content, true);\n        this.documentHelper.selection.start.setPositionInternal(this.documentHelper.selection.end);\n        this.documentHelper.clearSelectionHighlight();\n        return;\n      } else {\n        this.currentContextInfo = {\n          'text': exactText_1,\n          'element': dialogElement\n        };\n      }\n    }\n    if (!isNullOrUndefined(this.currentContextInfo) && this.currentContextInfo.element && content !== 'Ignore Once') {\n      var elementBox = this.currentContextInfo.element;\n      exactText = this.currentContextInfo.element.text;\n      this.documentHelper.selection.start = elementBox.start.clone();\n      this.documentHelper.selection.end = elementBox.end.clone();\n    } else {\n      this.handleReplace(content);\n    }\n    if (content !== 'Ignore Once') {\n      this.documentHelper.owner.editorModule.insertTextInternal(content, true);\n      if (!isNullOrUndefined(this.currentContextInfo)) {\n        this.removeErrorsFromCollection(this.currentContextInfo);\n      }\n      this.documentHelper.selection.start.setPositionInternal(this.documentHelper.selection.end);\n      this.documentHelper.clearSelectionHighlight();\n    }\n    //this.documentHelper.owner.errorWordCollection.remove(content);\n    this.documentHelper.triggerSpellCheck = false;\n  };\n  /**\n   * Method to handle replace logic\n   *\n   * @private\n   */\n  SpellChecker.prototype.handleReplace = function (content) {\n    var startPosition = this.documentHelper.selection.start;\n    var offset = startPosition.offset;\n    var startIndex = 0;\n    var startInlineObj = startPosition.currentWidget.getInline(offset, startIndex, false, true);\n    var startOffset = startInlineObj.element.line.getOffset(startInlineObj.element, 0) + startInlineObj.element.length;\n    if (startOffset === offset) {\n      this.retrieveExactElementInfo(startInlineObj);\n    }\n    var exactText = startInlineObj.element.text;\n    var startPattern = new RegExp('^[#\\\\@\\\\!\\\\~\\\\$\\\\%\\\\^\\\\&\\\\*\\\\(\\\\)\\\\-\\\\_\\\\+\\\\=\\\\{\\\\}\\\\[\\\\]\\\\:\\\\;\\\\\"\\'\\\\,\\\\<\\\\.\\\\>\\\\/\\\\?\\\\`\\\\s]+', 'g');\n    var matches = [];\n    var matchInfo;\n    // eslint-disable  no-cond-assign\n    while (!isNullOrUndefined(matchInfo = startPattern.exec(exactText))) {\n      matches.push(matchInfo);\n    }\n    if (content === 'Ignore Once') {\n      this.handleIgnoreOnce(startInlineObj);\n      return;\n    }\n    startPosition.offset = offset - startInlineObj.index;\n    if (!isNullOrUndefined(matches) && matches.length > 0) {\n      startPosition.offset += matches[0].toString().length;\n    }\n    startPosition.location = this.documentHelper.owner.selectionModule.getPhysicalPositionInternal(startPosition.currentWidget, startPosition.offset, true);\n    startPosition = this.documentHelper.owner.searchModule.textSearch.getTextPosition(startPosition.currentWidget, startPosition.offset.toString());\n    //startPosition.location = this.owner.selection.getPhysicalPositionInternal(span.line, offset, true);\n    startPosition.setPositionParagraph(startPosition.currentWidget, startPosition.offset);\n    var index = startPosition.offset + startInlineObj.element.length - startPosition.offset;\n    var endOffset = startPosition.currentWidget.getOffset(startInlineObj.element, index);\n    var lineWidget = startPosition.currentWidget;\n    var endPattern = new RegExp('[#\\\\@\\\\!\\\\~\\\\$\\\\%\\\\^\\\\&\\\\*\\\\(\\\\)\\\\-\\\\_\\\\+\\\\=\\\\{\\\\}\\\\[\\\\]\\\\:\\\\;\\\\\"\\'\\\\,\\\\<\\\\.\\\\>\\\\/\\\\?\\\\s\\\\`]+$', 'g');\n    matches = [];\n    // eslint-disable  no-cond-assign\n    while (!isNullOrUndefined(matchInfo = endPattern.exec(exactText))) {\n      matches.push(matchInfo);\n    }\n    if (!isNullOrUndefined(matches) && matches.length > 0) {\n      endOffset -= matches[0].toString().length;\n    }\n    this.documentHelper.selection.end = this.documentHelper.owner.searchModule.textSearch.getTextPosition(lineWidget, endOffset.toString());\n    this.documentHelper.selection.end.location = this.documentHelper.owner.selectionModule.getPhysicalPositionInternal(startPosition.currentWidget, endOffset, true);\n    this.documentHelper.selection.end.setPositionParagraph(lineWidget, endOffset);\n    this.currentContextInfo = {\n      'element': startInlineObj.element,\n      'text': startInlineObj.element.text\n    };\n  };\n  /**\n   * Method to retrieve exact element info\n   *\n   * @private\n   */\n  SpellChecker.prototype.retrieveExactElementInfo = function (startInlineObj) {\n    var nextElement = startInlineObj.element.nextElement;\n    if (!isNullOrUndefined(nextElement) && nextElement instanceof TextElementBox) {\n      var nextTextElBox = nextElement;\n      if (nextTextElBox.text.trim() != \"\") {\n        startInlineObj.element = nextElement;\n      }\n    }\n  };\n  /**\n   * Method to handle to ignore error Once\n   *\n   * @private\n   */\n  SpellChecker.prototype.handleIgnoreOnce = function (startInlineObj) {\n    var textElement = startInlineObj.element;\n    var exactText = '';\n    if (!isNullOrUndefined(this.currentContextInfo) && this.currentContextInfo.element) {\n      exactText = this.currentContextInfo.element.text;\n    } else {\n      exactText = textElement.text;\n    }\n    exactText = this.manageSpecialCharacters(exactText, undefined, true);\n    if (textElement.ignoreOnceItems.indexOf(exactText) === -1) {\n      textElement.ignoreOnceItems.push(exactText);\n    }\n    this.documentHelper.owner.editorModule.reLayout(this.documentHelper.selection);\n  };\n  /**\n   * Method to handle ignore all items\n   *\n   * @private\n   */\n  SpellChecker.prototype.handleIgnoreAllItems = function (contextElement) {\n    var contextItem = !isNullOrUndefined(contextElement) ? contextElement : this.retriveText();\n    var retrievedText = this.manageSpecialCharacters(contextItem.text, undefined, true);\n    if (this.ignoreAllItems.indexOf(retrievedText) === -1) {\n      this.ignoreAllItems.push(retrievedText);\n      this.removeErrorsFromCollection(contextItem);\n      this.documentHelper.triggerSpellCheck = true;\n      this.documentHelper.owner.editorModule.reLayout(this.documentHelper.selection);\n      this.documentHelper.triggerSpellCheck = false;\n      this.documentHelper.clearSelectionHighlight();\n    }\n  };\n  /**\n   * Method to handle dictionary\n   *\n   * @private\n   */\n  SpellChecker.prototype.handleAddToDictionary = function (contextElement) {\n    var _this = this;\n    var contextItem = !isNullOrUndefined(contextElement) ? contextElement : this.retriveText();\n    var retrievedText = this.manageSpecialCharacters(contextItem.text, undefined, true);\n    /* eslint-disable @typescript-eslint/no-explicit-any */\n    this.callSpellChecker(this.languageID, retrievedText, false, false, true).then(function (data) {\n      _this.documentHelper.triggerSpellCheck = true;\n      _this.removeErrorsFromCollection(contextItem);\n      _this.ignoreAllItems.push(retrievedText);\n      _this.documentHelper.owner.editorModule.reLayout(_this.documentHelper.selection, true);\n      _this.documentHelper.triggerSpellCheck = false;\n    });\n  };\n  /**\n   * Method to append/remove special characters\n   *\n   * @private\n   */\n  SpellChecker.prototype.manageSpecialCharacters = function (exactText, replaceText, isRemove) {\n    if (!isNullOrUndefined(exactText)) {\n      if (isNullOrUndefined(replaceText)) {\n        replaceText = exactText;\n      }\n      var pattern = new RegExp('^[#\\\\@\\\\!\\\\$\\\\%\\\\^\\\\&\\\\*\\\\(\\\\)\\\\-\\\\_\\\\+\\\\=\\\\{\\\\}\\\\[\\\\]\\\\:\\\\;\\\\\"\\\\”\\'\\\\,\\\\<\\\\.\\\\>\\\\/\\\\?\\\\`\\\\s\\\\’]+', 'g');\n      var matches = [];\n      var matchInfo = void 0;\n      // eslint-disable  no-cond-assign\n      while (!isNullOrUndefined(matchInfo = pattern.exec(exactText))) {\n        matches.push(matchInfo);\n      }\n      if (matches.length > 0) {\n        for (var i = 0; i < matches.length; i++) {\n          /* eslint-disable @typescript-eslint/no-explicit-any */\n          var match = matches[i];\n          replaceText = !isRemove ? match[0] + replaceText : replaceText.replace(match[0], '');\n        }\n      }\n      var endPattern = new RegExp('[#\\\\@\\\\!\\\\$\\\\%\\\\^\\\\&\\\\*\\\\(\\\\)\\\\-\\\\_\\\\+\\\\=\\\\{\\\\}\\\\[\\\\]\\\\:\\\\;\\\\\"\\\\”\\'\\\\,\\\\<\\\\.\\\\>\\\\/\\\\?\\\\s\\\\`\\\\’]+$', 'g');\n      matches = [];\n      // eslint-disable  no-cond-assign\n      while (!isNullOrUndefined(matchInfo = endPattern.exec(replaceText))) {\n        matches.push(matchInfo);\n      }\n      if (matches.length > 0) {\n        for (var i = 0; i < matches.length; i++) {\n          /* eslint-disable @typescript-eslint/no-explicit-any */\n          var match = matches[i];\n          replaceText = !isRemove ? replaceText + match[0] : replaceText.slice(0, match.index);\n        }\n      }\n    }\n    return replaceText;\n  };\n  /**\n   * Method to remove errors\n   *\n   * @private\n   */\n  SpellChecker.prototype.removeErrorsFromCollection = function (contextItem) {\n    if (!isNullOrUndefined(contextItem.text) && this.errorWordCollection.containsKey(contextItem.text)) {\n      var textElement = this.errorWordCollection.get(contextItem.text);\n      if (textElement.indexOf(contextItem.element) >= 0) {\n        textElement.splice(0, 1);\n      }\n      if (textElement.length === 0) {\n        this.errorWordCollection.remove(contextItem.text);\n      }\n    }\n  };\n  /**\n   * Method to retrieve exact text\n   *\n   * @private\n   */\n  SpellChecker.prototype.retriveText = function () {\n    var exactText;\n    var currentElement;\n    if (!isNullOrUndefined(this.currentContextInfo) && this.currentContextInfo.element) {\n      currentElement = this.currentContextInfo.element;\n      exactText = this.currentContextInfo.element.text;\n      this.documentHelper.selection.start = currentElement.start.clone();\n      this.documentHelper.selection.end = currentElement.end.clone();\n    } else {\n      var startPosition = this.documentHelper.selection.start;\n      var offset = startPosition.offset;\n      var startIndex = 0;\n      var startInlineObj = startPosition.currentWidget.getInline(offset, startIndex);\n      currentElement = startInlineObj.element;\n      exactText = startInlineObj.element.text;\n    }\n    return {\n      'text': exactText,\n      'element': currentElement\n    };\n  };\n  /**\n   * Method to handle suggestions\n   *\n   * @private\n   */\n  /* eslint-disable @typescript-eslint/no-explicit-any */\n  SpellChecker.prototype.handleSuggestions = function (allsuggestions) {\n    this.spellCheckSuggestion = [];\n    if (allsuggestions.length === 0) {\n      this.spellCheckSuggestion.push(this.documentHelper.owner.contextMenuModule.locale.getConstant('Add to Dictionary'));\n    } else {\n      allsuggestions = allsuggestions.length > 3 ? this.constructInlineMenu(allsuggestions) : allsuggestions;\n      this.spellCheckSuggestion.push(this.documentHelper.owner.contextMenuModule.locale.getConstant('Add to Dictionary'));\n    }\n    /* eslint-disable @typescript-eslint/no-explicit-any */\n    var spellSuggestion = [];\n    if (this.spellCheckSuggestion.length > 0) {\n      for (var _i = 0, _a = this.spellCheckSuggestion; _i < _a.length; _i++) {\n        var str = _a[_i];\n        spellSuggestion.push({\n          text: str,\n          id: this.documentHelper.owner.element.id + '_contextmenu_otherSuggestions_spellcheck_' + (str === this.documentHelper.owner.contextMenuModule.locale.getConstant('Add to Dictionary') ? 'Add to Dictionary' : str),\n          iconCss: ''\n        });\n      }\n    }\n    return spellSuggestion;\n  };\n  /**\n   * Method to check whether text element has errors\n   *\n   * @private\n   */\n  SpellChecker.prototype.checktextElementHasErrors = function (text, element, left) {\n    var hasError = false;\n    var erroElements = [];\n    text = text.replace(/[\\s]+/g, '');\n    if (!isNullOrUndefined(element.errorCollection) && element.errorCollection.length > 0) {\n      if (!this.documentHelper.isScrollHandler && (element.ischangeDetected || element.paragraph.isChangeDetected)) {\n        this.updateStatusForGlobalErrors(element.errorCollection, element);\n        element.errorCollection = [];\n        element.ischangeDetected = true;\n        return {\n          'errorFound': hasError,\n          'elements': erroElements\n        };\n      }\n      for (var i = 0; i < element.errorCollection.length; i++) {\n        if (this.handleErrorCollection(element.errorCollection[i])) {\n          hasError = true;\n          erroElements.push(element.errorCollection[i]);\n        }\n      }\n    } else if (!this.documentHelper.isScrollHandler && element.paragraph.isChangeDetected) {\n      element.ischangeDetected = true;\n    } else if (!element.ischangeDetected && this.handleErrorCollection(element)) {\n      hasError = true;\n      erroElements.push(element);\n    }\n    return {\n      'errorFound': hasError,\n      'elements': erroElements\n    };\n  };\n  SpellChecker.prototype.updateStatusForGlobalErrors = function (erroElements, parentElement) {\n    if (erroElements.length > 0) {\n      for (var i = 0; i < erroElements.length; i++) {\n        var exactText = this.manageSpecialCharacters(erroElements[i].text, undefined, true);\n        if (this.errorWordCollection.containsKey(exactText)) {\n          var elements = this.errorWordCollection.get(exactText);\n          for (var j = 0; j < elements.length; j++) {\n            if (elements[j] instanceof ErrorTextElementBox && elements[j] === erroElements[i]) {\n              elements[j].ischangeDetected = true;\n              elements[j].start.offset = parentElement.line.getOffset(parentElement.istextCombined ? this.getCombinedElement(parentElement) : parentElement, 0);\n              elements[j].line = parentElement.line;\n              break;\n            }\n          }\n        }\n      }\n    }\n  };\n  /**\n   * Method to handle document error collection.\n   *\n   * @param {string} errorInElement\n   * @private\n   */\n  SpellChecker.prototype.handleErrorCollection = function (errorInElement) {\n    var errors = this.errorWordCollection;\n    var exactText = this.manageSpecialCharacters(errorInElement.text, undefined, true);\n    if (errors.containsKey(exactText) && errorInElement.length > 1) {\n      var ignoreAllIndex = this.ignoreAllItems.indexOf(exactText);\n      if (ignoreAllIndex > -1) {\n        if (errors.containsKey(exactText)) {\n          errors.remove(exactText);\n        }\n        return false;\n      }\n      return true;\n    }\n    return false;\n  };\n  /* eslint-disable @typescript-eslint/no-explicit-any */\n  SpellChecker.prototype.constructInlineMenu = function (inlineSuggestion) {\n    for (var i = inlineSuggestion.length - 1; i > 0; i--) {\n      if (inlineSuggestion.length > 3) {\n        this.spellCheckSuggestion.push(inlineSuggestion[i]);\n        inlineSuggestion.pop();\n      }\n    }\n    return inlineSuggestion;\n  };\n  /**\n   * Method to retrieve error element text\n   *\n   * @private\n   */\n  SpellChecker.prototype.findCurretText = function () {\n    var insertPosition = this.documentHelper.selection.start;\n    /* eslint-disable @typescript-eslint/no-explicit-any */\n    var element;\n    /* eslint-disable @typescript-eslint/no-explicit-any */\n    var inlineObj = insertPosition.currentWidget.getInline(this.documentHelper.selection.start.offset, 0);\n    var text;\n    if (!isNullOrUndefined(inlineObj.element)) {\n      if (!isNullOrUndefined(inlineObj.element.errorCollection) && inlineObj.element.errorCollection.length > 0) {\n        for (var i = 0; i < inlineObj.element.errorCollection.length; i++) {\n          var errorElement = inlineObj.element.errorCollection[i];\n          if (errorElement.start.location.x <= insertPosition.location.x && errorElement.end.location.x >= insertPosition.location.x) {\n            text = errorElement.text;\n            element = errorElement;\n            break;\n          }\n        }\n      } else {\n        text = inlineObj.element.text;\n      }\n      if (text === ' ') {\n        inlineObj = insertPosition.currentWidget.getInline(this.documentHelper.selection.start.offset + 1, 0);\n        text = inlineObj.element.text;\n      }\n    }\n    return {\n      'text': text,\n      'element': element\n    };\n  };\n  SpellChecker.prototype.addErrorCollection = function (text, elementToCompare, suggestions) {\n    text = this.manageSpecialCharacters(text, undefined, true);\n    if (this.errorWordCollection.containsKey(text)) {\n      var errorElements = this.errorWordCollection.get(text);\n      if (elementToCompare instanceof ErrorTextElementBox) {\n        if (!this.compareErrorTextElement(elementToCompare, errorElements)) {\n          errorElements.push(elementToCompare);\n        }\n      } else if (elementToCompare instanceof TextElementBox) {\n        if (!this.compareTextElement(elementToCompare, errorElements)) {\n          errorElements.push(elementToCompare);\n        }\n      }\n    } else {\n      if (!isNullOrUndefined(suggestions) && suggestions.length > 0) {\n        this.errorSuggestions.add(text, suggestions);\n      }\n      this.errorWordCollection.add(text, [elementToCompare]);\n      if (!this.uniqueWordsCollection.containsKey(text)) {\n        this.uniqueWordsCollection.add(text, true);\n      }\n    }\n  };\n  SpellChecker.prototype.addCorrectWordCollection = function (text) {\n    text = this.manageSpecialCharacters(text, undefined, true);\n    if (!this.uniqueWordsCollection.containsKey(text)) {\n      this.uniqueWordsCollection.add(text, false);\n    }\n  };\n  /**\n   * @private\n   */\n  SpellChecker.prototype.isInUniqueWords = function (text) {\n    text = text.replace(/[\\s]+/g, '');\n    return this.uniqueWordsCollection.containsKey(text);\n  };\n  /**\n   * @private\n   */\n  SpellChecker.prototype.isErrorWord = function (text) {\n    text = text.replace(/[\\s]+/g, '');\n    return this.uniqueWordsCollection.get(text);\n  };\n  /**\n   * @private\n   */\n  SpellChecker.prototype.isCorrectWord = function (text) {\n    text = text.replace(/[\\s]+/g, '');\n    return !this.uniqueWordsCollection.get(text);\n  };\n  SpellChecker.prototype.compareErrorTextElement = function (errorElement, errorCollection) {\n    var copyElement = [];\n    var isChanged = false;\n    for (var i = 0; i < errorCollection.length; i++) {\n      copyElement.push(errorCollection[i]);\n    }\n    var length = errorCollection.length;\n    for (var i = 0; i < length; i++) {\n      if (copyElement[i] instanceof ErrorTextElementBox) {\n        if (copyElement[i].ischangeDetected) {\n          var exactText = this.manageSpecialCharacters(copyElement[i].text, undefined, true);\n          isChanged = true;\n          this.removeErrorsFromCollection({\n            'element': copyElement[i],\n            'text': exactText\n          });\n        } else {\n          var currentElement = copyElement[i];\n          if (errorElement.start.offset === currentElement.start.offset && errorElement.end.offset === currentElement.end.offset) {\n            return true;\n          }\n        }\n      }\n    }\n    if (isChanged) {\n      this.errorWordCollection.add(this.manageSpecialCharacters(errorElement.text, undefined, true), [errorElement]);\n    }\n    return false;\n  };\n  /**\n   * Method to compare text elements\n   *\n   * @private\n   */\n  SpellChecker.prototype.compareTextElement = function (errorElement, errorCollection) {\n    for (var i = 0; i < errorCollection.length; i++) {\n      if (errorCollection[i] instanceof TextElementBox) {\n        var currentElement = errorCollection[i];\n        if (currentElement === errorElement) {\n          return true;\n        }\n      }\n    }\n    return false;\n  };\n  /**\n   * Method to handle Word by word spell check\n   *\n   * @private\n   */\n  SpellChecker.prototype.handleWordByWordSpellCheck = function (jsonObject, elementBox, left, top, underlineY, baselineAlignment, isSamePage) {\n    if (jsonObject.HasSpellingError && isSamePage) {\n      this.addErrorCollection(elementBox.text, elementBox, jsonObject.Suggestions);\n      var backgroundColor = elementBox.line.paragraph.containerWidget instanceof TableCellWidget ? elementBox.line.paragraph.containerWidget.cellFormat.shading.backgroundColor : this.documentHelper.backgroundColor;\n      this.documentHelper.render.renderWavyLine(elementBox, left, top, underlineY, '#FF0000', 'Single', baselineAlignment, backgroundColor);\n      elementBox.isSpellChecked = true;\n    } else {\n      this.addCorrectWordCollection(elementBox.text);\n      elementBox.isSpellChecked = true;\n    }\n  };\n  /**\n   * Method to check errors for combined elements\n   *\n   * @private\n   */\n  SpellChecker.prototype.checkElementCanBeCombined = function (elementBox, underlineY, beforeIndex, callSpellChecker, textToCombine, isNext, isPrevious, canCombine) {\n    var currentText = isNullOrUndefined(textToCombine) ? '' : textToCombine;\n    var isCombined = isNullOrUndefined(canCombine) ? false : canCombine;\n    var checkPrevious = !isNullOrUndefined(isPrevious) ? isPrevious : true;\n    var checkNext = !isNullOrUndefined(isNext) ? isNext : true;\n    var combinedElements = [];\n    var line = this.documentHelper.selection.getLineWidget(elementBox, 0);\n    var index = line.children.indexOf(elementBox);\n    var prevText = elementBox.text;\n    combinedElements.push(elementBox);\n    var difference = isPrevious ? 0 : 1;\n    var prevCombined = false;\n    var isPrevField = false;\n    if (elementBox.text !== '\\v') {\n      if (checkPrevious) {\n        var textElement = undefined;\n        for (var i = index - difference; i >= 0; i--) {\n          textElement = line.children[i];\n          if (textElement instanceof TextElementBox && !isPrevField) {\n            if (prevText.indexOf(' ') !== 0 && textElement.text.lastIndexOf(' ') !== textElement.text.length - 1) {\n              prevCombined = !isNullOrUndefined(textToCombine) ? true : false;\n              currentText = textElement.text + currentText;\n              prevText = textElement.text;\n              isPrevField = false;\n              combinedElements.push(textElement);\n              isCombined = true;\n            } else if (!isNullOrUndefined(textElement)) {\n              textElement = textElement.nextElement;\n              break;\n            }\n          } else if (textElement instanceof FieldElementBox && textElement.fieldType !== 1) {\n            isPrevField = true;\n          }\n        }\n        var currentElement = isCombined ? textElement : elementBox;\n        if (this.lookThroughPreviousLine(currentText, prevText, currentElement, underlineY, beforeIndex)) {\n          return true;\n        }\n      }\n      if (isPrevious) {\n        currentText = prevCombined ? currentText : elementBox.text + currentText;\n      } else {\n        currentText += elementBox.text;\n      }\n      isPrevField = false;\n      var nextText = elementBox.text;\n      if (checkNext) {\n        var canCombine_1 = false;\n        var element = undefined;\n        for (var i = index + 1; i < line.children.length; i++) {\n          element = line.children[i];\n          if (element instanceof TextElementBox && !isPrevField) {\n            if (nextText.lastIndexOf(' ') !== nextText.length - 1 && element.text.indexOf(' ') !== 0) {\n              currentText += element.text;\n              nextText = element.text;\n              isPrevField = false;\n              combinedElements.push(element);\n              canCombine_1 = true;\n              isCombined = true;\n            } else if (!isNullOrUndefined(element)) {\n              element = element.previousElement;\n              break;\n            }\n          } else if (element instanceof FieldElementBox && element.fieldType !== 2) {\n            isPrevField = true;\n          }\n        }\n        var currentElement = canCombine_1 ? element : elementBox;\n        if (currentElement.text !== '\\f' && currentElement.text !== String.fromCharCode(14) && this.lookThroughNextLine(currentText, prevText, currentElement, underlineY, beforeIndex)) {\n          return true;\n        }\n      }\n    }\n    if (isCombined && callSpellChecker && !this.checkCombinedElementsBeIgnored(combinedElements, currentText)) {\n      this.handleCombinedElements(elementBox, currentText, underlineY, beforeIndex);\n    }\n    return isCombined;\n  };\n  SpellChecker.prototype.lookThroughPreviousLine = function (currentText, prevText, currentElement, underlineY, beforeIndex) {\n    if (!isNullOrUndefined(currentElement) && currentElement.indexInOwner === 0 && !isNullOrUndefined(currentElement.line.previousLine)) {\n      var previousLine = currentElement.line.previousLine;\n      var index = previousLine.children.length - 1;\n      if (!isNullOrUndefined(previousLine.children[index]) && previousLine.children[index] instanceof TextElementBox) {\n        var firstElement = previousLine.children[index];\n        if (!isNullOrUndefined(currentElement.text)) {\n          if (currentElement.text.indexOf(' ') !== 0 && firstElement.text.lastIndexOf(' ') !== firstElement.text.length - 1) {\n            currentText = currentText.length > 0 ? currentText : prevText;\n            this.checkElementCanBeCombined(firstElement, underlineY, beforeIndex, true, currentText, false, true, true);\n            return true;\n          }\n        }\n      }\n    }\n    return false;\n  };\n  SpellChecker.prototype.lookThroughNextLine = function (currentText, prevText, elementBox, underlineY, beforeIndex) {\n    if (elementBox instanceof TextElementBox && !isNullOrUndefined(elementBox) && elementBox.indexInOwner === elementBox.line.children.length - 1 && !isNullOrUndefined(elementBox.line.nextLine)) {\n      var nextLine = elementBox.line.nextLine;\n      if (!isNullOrUndefined(nextLine.children[0]) && nextLine.children[0] instanceof TextElementBox) {\n        var firstElement = nextLine.children[0];\n        if (elementBox.text.lastIndexOf(' ') !== elementBox.text.length - 1 && firstElement.text.indexOf(' ') !== 0) {\n          currentText = currentText.length > 0 ? currentText : prevText;\n          this.checkElementCanBeCombined(firstElement, underlineY, beforeIndex, true, currentText, true, false, true);\n          return true;\n        }\n      }\n    }\n    return false;\n  };\n  /**\n   * Method to handle combined elements\n   *\n   * @param {TextElementBox} elementBox\n   * @param {string} currentText\n   * @param {number} underlineY\n   * @param {number} beforeIndex\n   * @private\n   */\n  SpellChecker.prototype.handleCombinedElements = function (elementBox, currentText, underlineY, beforeIndex) {\n    elementBox.istextCombined = true;\n    var splittedText = currentText.split(/[\\s]+/);\n    if (this.ignoreAllItems.indexOf(currentText) === -1 && elementBox instanceof TextElementBox && elementBox.ignoreOnceItems.indexOf(currentText) === -1) {\n      if (splittedText.length > 1) {\n        for (var i = 0; i < splittedText.length; i++) {\n          var currentText_1 = splittedText[i];\n          currentText_1 = this.manageSpecialCharacters(currentText_1, undefined, true);\n          this.documentHelper.render.handleUnorderedElements(currentText_1, elementBox, underlineY, i, 0, i === splittedText.length - 1, beforeIndex);\n        }\n      } else {\n        currentText = this.manageSpecialCharacters(currentText, undefined, true);\n        this.documentHelper.render.handleUnorderedElements(currentText, elementBox, underlineY, 0, 0, true, beforeIndex);\n      }\n    }\n  };\n  /**\n   * Method to check error element collection has unique element\n   *\n   * @param {ErrorTextElementBox[]} errorCollection\n   * @param {ErrorTextElementBox} elementToCheck\n   * @private\n   */\n  SpellChecker.prototype.checkArrayHasSameElement = function (errorCollection, elementToCheck) {\n    for (var i = 0; i < errorCollection.length; i++) {\n      var errorText = errorCollection[i];\n      if (errorText.start.location.x === elementToCheck.start.location.x && errorText.start.location.y === elementToCheck.start.location.y) {\n        return true;\n      }\n    }\n    return false;\n  };\n  /**\n   * @private\n   */\n  SpellChecker.prototype.handleSplitWordSpellCheck = function (jsonObject, currentText, elementBox, isSamePage, underlineY, iteration, markIndex, isLastItem) {\n    if (jsonObject.HasSpellingError && elementBox.text !== ' ' && isSamePage) {\n      var matchResults = this.getMatchedResultsFromElement(elementBox, currentText);\n      markIndex = elementBox.istextCombined ? elementBox.line.getOffset(this.getCombinedElement(elementBox), 0) : markIndex;\n      this.documentHelper.owner.searchModule.textSearch.updateMatchedTextLocation(matchResults.matches, matchResults.textResults, matchResults.elementInfo, 0, elementBox, false, null, markIndex);\n      this.handleMatchedResults(matchResults.textResults, elementBox, underlineY, iteration, jsonObject.Suggestions, isLastItem);\n    } else {\n      this.addCorrectWordCollection(currentText);\n      if (isLastItem) {\n        elementBox.isSpellChecked = true;\n      }\n    }\n    this.updateUniqueWords([{\n      Text: currentText,\n      HasSpellError: jsonObject.HasSpellingError\n    }]);\n  };\n  SpellChecker.prototype.handleMatchedResults = function (results, elementBox, wavyLineY, index, suggestions, isLastItem) {\n    if (results.length === 0 && isLastItem) {\n      elementBox.isSpellChecked = true;\n      return;\n    }\n    for (var i = 0; i < results.length; i++) {\n      var span = this.createErrorElementWithInfo(results.innerList[i], elementBox);\n      var color = '#FF0000';\n      if (!isNullOrUndefined(elementBox.errorCollection) && !this.checkArrayHasSameElement(elementBox.errorCollection, span)) {\n        elementBox.errorCollection.splice(index, 0, span);\n      }\n      this.addErrorCollection(span.text, span, suggestions);\n      var backgroundColor = elementBox.line.paragraph.containerWidget instanceof TableCellWidget ? elementBox.paragraph.containerWidget.cellFormat.shading.backgroundColor : this.documentHelper.backgroundColor;\n      var para = elementBox.line.paragraph;\n      var lineY = para.y;\n      for (var i_1 = 0; i_1 < para.childWidgets.length; i_1++) {\n        if (para.childWidgets[i_1] == elementBox.line) break;\n        lineY += para.childWidgets[i_1].height;\n      }\n      if (elementBox.isRightToLeft) {\n        this.documentHelper.render.renderWavyLine(span, span.end.location.x, lineY, wavyLineY, color, 'Single', elementBox.characterFormat.baselineAlignment, backgroundColor);\n      } else {\n        this.documentHelper.render.renderWavyLine(span, span.start.location.x, lineY, wavyLineY, color, 'Single', elementBox.characterFormat.baselineAlignment, backgroundColor);\n      }\n      if (isLastItem) {\n        elementBox.isSpellChecked = true;\n      }\n    }\n  };\n  /**\n   * Calls the spell checker service\n   * @private\n   */\n  /* eslint-disable @typescript-eslint/no-explicit-any */\n  SpellChecker.prototype.callSpellChecker = function (languageID, word, checkSpelling, checkSuggestion, addWord, isByPage) {\n    var _this = this;\n    var spellchecker = this;\n    return new Promise(function (resolve, reject) {\n      if (!isNullOrUndefined(_this)) {\n        var httpRequest_1 = new XMLHttpRequest();\n        var service_1 = _this.documentHelper.owner.serviceUrl;\n        service_1 = isByPage ? service_1 + _this.documentHelper.owner.serverActionSettings.spellCheckByPage : service_1 + _this.documentHelper.owner.serverActionSettings.spellCheck;\n        httpRequest_1.open('POST', service_1, true);\n        httpRequest_1.setRequestHeader('Content-Type', 'application/json');\n        _this.setCustomHeaders(httpRequest_1);\n        /* eslint-disable @typescript-eslint/no-explicit-any */\n        var spellCheckData = {\n          LanguageID: languageID,\n          TexttoCheck: word,\n          CheckSpelling: checkSpelling,\n          CheckSuggestion: checkSuggestion,\n          AddWord: addWord\n        };\n        var httprequestEventArgs = {\n          serverActionType: 'SpellCheck',\n          headers: _this.documentHelper.owner.headers,\n          timeout: 0,\n          cancel: false,\n          withCredentials: false\n        };\n        _this.documentHelper.owner.trigger(beforeXmlHttpRequestSend, httprequestEventArgs);\n        if (!httprequestEventArgs.cancel) {\n          httpRequest_1.send(JSON.stringify(spellCheckData));\n        }\n        httpRequest_1.onreadystatechange = function () {\n          if (httpRequest_1.readyState === 4) {\n            if (httpRequest_1.status === 200 || httpRequest_1.status === 304) {\n              resolve(httpRequest_1.response);\n            } else {\n              var result = {\n                status: httpRequest_1.status.toString(),\n                statusText: httpRequest_1.responseText,\n                url: service_1\n              };\n              result.name = 'onFailure';\n              if (!isNullOrUndefined(spellchecker.documentHelper)) {\n                spellchecker.documentHelper.owner.fireServiceFailure(result);\n              }\n              reject(httpRequest_1.response);\n            }\n          }\n        };\n      }\n    });\n  };\n  SpellChecker.prototype.setCustomHeaders = function (httpRequest) {\n    for (var i = 0; i < this.documentHelper.owner.headers.length; i++) {\n      var header = this.documentHelper.owner.headers[i];\n      for (var _i = 0, _a = Object.keys(header); _i < _a.length; _i++) {\n        var key = _a[_i];\n        httpRequest.setRequestHeader(key, header[key]);\n      }\n    }\n  };\n  /**\n   * Method to check for next error\n   *\n   * @private\n   * @returns {void}\n   */\n  SpellChecker.prototype.checkForNextError = function () {\n    if (!isNullOrUndefined(this.viewer)) {\n      var errorWords = this.errorWordCollection;\n      if (errorWords.length > 0) {\n        for (var i = 0; i < errorWords.length; i++) {\n          var errorElements = errorWords.get(errorWords.keys[i]);\n          for (var j = 0; j < errorElements.length; j++) {\n            if (errorElements[j] instanceof ErrorTextElementBox && !errorElements[j].ischangeDetected) {\n              this.updateErrorElementTextBox(errorWords.keys[i], errorElements[j]);\n            } else if (errorElements[j] instanceof TextElementBox) {\n              var matchResults = this.getMatchedResultsFromElement(errorElements[j]);\n              var results = matchResults.textResults;\n              var markIndex = errorElements[j].ischangeDetected ? errorElements[j].start.offset : errorElements[j].line.getOffset(errorElements[j], 0);\n              this.documentHelper.owner.searchModule.textSearch.updateMatchedTextLocation(matchResults.matches, results, matchResults.elementInfo, 0, errorElements[j], false, null, markIndex);\n              for (var i_2 = 0; i_2 < results.length; i_2++) {\n                var element = this.createErrorElementWithInfo(results.innerList[i_2], errorElements[j]);\n                this.updateErrorElementTextBox(element.text, element);\n                break;\n              }\n            }\n            break;\n          }\n          break;\n        }\n      } else {\n        this.documentHelper.clearSelectionHighlight();\n      }\n    }\n  };\n  /**\n   * Method to create error element with matched results\n   *\n   * @param {TextSearchResult} result\n   * @param {ElementBox} errorElement\n   * @private\n   */\n  SpellChecker.prototype.createErrorElementWithInfo = function (result, errorElement) {\n    var element = new ErrorTextElementBox();\n    element.text = result.text;\n    element.start = result.start;\n    element.end = result.end;\n    element.height = errorElement.height;\n    element.canTrigger = errorElement.canTrigger;\n    element.characterFormat.copyFormat(errorElement.characterFormat);\n    // element.width = this.documentHelper.textHelper.getWidth(element.text, errorElement.characterFormat, (errorElement as TextElementBox).scriptType);\n    element.width = Math.abs(element.start.location.x - element.end.location.x);\n    return element;\n  };\n  /**\n   * Method to get matched results from element box\n   *\n   * @private\n   * @param {ElementBox} errorElement - Specifies the error element box.\n   * @param {string} currentText - Specifies the current text\n   * @returns {MatchResults} - Returns match results info.\n   */\n  SpellChecker.prototype.getMatchedResultsFromElement = function (errorElement, currentText) {\n    var line = errorElement.line;\n    var pattern = this.documentHelper.owner.searchModule.textSearch.stringToRegex(isNullOrUndefined(currentText) ? errorElement.text : currentText, 'CaseSensitive');\n    this.textSearchResults.clearResults();\n    var results = this.textSearchResults;\n    var textLineInfo = this.documentHelper.owner.searchModule.textSearch.getElementInfo(line.children[0], 0, false, pattern, undefined, undefined, undefined, undefined, true);\n    var text = textLineInfo.fullText;\n    var matches = [];\n    var spans = textLineInfo.elementsWithOffset;\n    var matchObject;\n    // eslint-disable  no-cond-assign\n    while (!isNullOrUndefined(matchObject = pattern.exec(text))) {\n      if (this.isChangeAll) {\n        matchObject.index = spans.get(errorElement);\n      }\n      matches.push(matchObject);\n    }\n    return {\n      'matches': matches,\n      'elementInfo': spans,\n      'textResults': results\n    };\n  };\n  /**\n   * Method to update error element information\n   *\n   * @private\n   * @param {string} error - Specifies the error word.\n   * @param {ErrorTextElementBox} errorElement - Specifies the error element box.\n   * @returns {void}\n   */\n  SpellChecker.prototype.updateErrorElementTextBox = function (error, errorElement) {\n    var element = errorElement;\n    this.documentHelper.clearSelectionHighlight();\n    this.documentHelper.selection.start = element.start.clone();\n    this.documentHelper.selection.end = element.end.clone();\n    this.documentHelper.selection.highlight(errorElement.start.paragraph, errorElement.start, errorElement.end);\n    this.documentHelper.owner.spellCheckDialogModule.updateSuggestionDialog(error, element);\n  };\n  /**\n   * Method to retrieve space information in a text\n   *\n   * @private\n   * @param {string} text - Specifies the text\n   * @param {WCharacterFormat} characterFormat - Specifies the character format.\n   * @returns {SpecialCharacterInfo} - Returs special character info.\n   */\n  SpellChecker.prototype.getWhiteSpaceCharacterInfo = function (elementBox) {\n    var text = elementBox.text;\n    var characterFormat = elementBox.characterFormat;\n    /* eslint-disable @typescript-eslint/no-explicit-any */\n    var matchedText = [];\n    var width = 0;\n    var length = 0;\n    matchedText = text.match(/[\\s]+/);\n    if (!isNullOrUndefined(matchedText) && matchedText.length > 0) {\n      for (var i = 0; i < matchedText.length; i++) {\n        width += this.documentHelper.textHelper.getWidth(matchedText[i], characterFormat, elementBox.scriptType);\n        length += matchedText[i].length;\n      }\n    }\n    return {\n      'width': width,\n      'wordLength': length,\n      'isBeginning': !isNullOrUndefined(matchedText) && matchedText.index === 0\n    };\n  };\n  /**\n   * Retrieve Special character info\n   *\n   * @private\n   * @param {string} text - Specifies the text\n   * @param {WCharacterFormat} characterFormat - Specifies the character format.\n   * @returns {SpecialCharacterInfo} - Returs special character info.\n   */\n  SpellChecker.prototype.getSpecialCharactersInfo = function (elementBox) {\n    var text = elementBox.text;\n    var characterFormat = elementBox.characterFormat;\n    /* eslint-disable @typescript-eslint/no-explicit-any */\n    var matchedText = [];\n    var beginingwidth = 0;\n    var endWidth = 0;\n    var length = 0;\n    matchedText = text.match(/^[\\#\\@\\!\\~\\$\\%\\^\\&\\*\\(\\)\\-\\_\\+\\=\\{\\}\\[\\]\\:\\;\\\"\\'\\,\\<\\.\\>\\/\\?\\`]*/);\n    for (var i = 0; i < matchedText.length; i++) {\n      if (!isNullOrUndefined(matchedText[i]) && matchedText[i].length > 0) {\n        beginingwidth = this.documentHelper.textHelper.getWidth(matchedText[i], characterFormat, elementBox.scriptType);\n      }\n      length = matchedText.length;\n    }\n    matchedText = text.match(/[\\#\\@\\!\\~\\$\\%\\^\\&\\*\\(\\)\\-\\_\\+\\=\\{\\}\\[\\]\\:\\;\\\"\\'\\,\\<\\.\\>\\/\\?\\`]*$/);\n    for (var i = 0; i < matchedText.length; i++) {\n      if (!isNullOrUndefined(matchedText[i]) && matchedText[i].length > 0) {\n        endWidth = this.documentHelper.textHelper.getWidth(matchedText[i], characterFormat, elementBox.scriptType);\n      }\n      length = matchedText.length;\n    }\n    return {\n      'beginningWidth': beginingwidth,\n      'endWidth': endWidth,\n      'wordLength': length\n    };\n  };\n  /**\n   * Method to retrieve next available combined element\n   *\n   * @private\n   * @param {ElementBox} element - Specified the element.\n   * @returns {ElementBox} - Returns combined element.\n   */\n  SpellChecker.prototype.getCombinedElement = function (element) {\n    var prevElement = element;\n    while (!isNullOrUndefined(element) && element instanceof TextElementBox && element.istextCombined) {\n      prevElement = element;\n      element = element.previousElement;\n    }\n    return prevElement;\n  };\n  SpellChecker.prototype.checkCombinedElementsBeIgnored = function (elements, exactText) {\n    exactText = this.manageSpecialCharacters(exactText, undefined, true);\n    for (var i = 0; i < elements.length; i++) {\n      if (elements[i].ignoreOnceItems.indexOf(exactText) !== -1) {\n        return true;\n      }\n    }\n    return false;\n  };\n  /**\n   * Method to update error collection\n   *\n   * @private\n   * @param {TextElementBox} currentElement - Specifies current element.\n   * @param {TextElementBox} splittedElement - Specifies splitted element.\n   * @returns {void}\n   */\n  SpellChecker.prototype.updateSplittedElementError = function (currentElement, splittedElement) {\n    var errorCount = currentElement.errorCollection.length;\n    if (errorCount > 0) {\n      var errorCollection = [];\n      for (var i = 0; i < errorCount; i++) {\n        errorCollection.push(currentElement.errorCollection[i]);\n      }\n      for (var i = 0; i < errorCount; i++) {\n        if (currentElement.text.indexOf(errorCollection[i].text) === -1) {\n          splittedElement.ischangeDetected = true;\n          currentElement.errorCollection.splice(0, 1);\n        }\n      }\n    }\n  };\n  /**\n   * @private\n   * @param {Page} page - Specifies the page.\n   * @returns {string} - Returns page content.\n   */\n  SpellChecker.prototype.getPageContent = function (page) {\n    var content = '';\n    if (this.documentHelper.owner.sfdtExportModule) {\n      var sfdtExport = this.documentHelper.owner.sfdtExportModule;\n      var index = sfdtExport.keywordIndex;\n      sfdtExport.keywordIndex = 0;\n      sfdtExport.Initialize();\n      var document_1 = sfdtExport.writePage(page);\n      sfdtExport.keywordIndex = index;\n      if (this.documentHelper.owner.textExportModule) {\n        var textExport = this.documentHelper.owner.textExportModule;\n        textExport.pageContent = '';\n        textExport.setDocument(document_1);\n        textExport.writeInternal();\n        content = textExport.pageContent;\n      }\n    }\n    return content;\n  };\n  /**\n   * @private\n   * @param {any[]} spelledWords - Specifies spelledWords\n   * @returns {void}\n   */\n  SpellChecker.prototype.updateUniqueWords = function (spelledWords) {\n    if (!isNullOrUndefined(localStorage.getItem(this.uniqueKey))) {\n      this.uniqueSpelledWords = JSON.parse(localStorage.getItem(this.uniqueKey));\n    }\n    this.uniqueSpelledWords = this.uniqueSpelledWords || {};\n    var totalCount = spelledWords.length + Object.keys(this.uniqueSpelledWords).length;\n    if (totalCount <= this.uniqueWordsCount) {\n      for (var i = 0; i < spelledWords.length; i++) {\n        this.checkForUniqueWords(spelledWords[i]);\n      }\n    }\n    localStorage.setItem(this.uniqueKey, JSON.stringify(this.uniqueSpelledWords));\n    this.uniqueSpelledWords = {};\n  };\n  SpellChecker.prototype.checkForUniqueWords = function (spellData) {\n    var identityMatched = this.uniqueSpelledWords[spellData.Text];\n    if (!identityMatched) {\n      this.uniqueSpelledWords[spellData.Text] = spellData.HasSpellError;\n    }\n  };\n  /**\n   * Method to clear cached words for spell check\n   *\n   * @returns {void}\n   */\n  SpellChecker.prototype.clearCache = function () {\n    if (!isNullOrUndefined(localStorage.getItem(this.uniqueKey))) {\n      localStorage.removeItem(this.uniqueKey);\n    }\n  };\n  SpellChecker.prototype.createGuid = function () {\n    var dateTime = new Date().getTime();\n    var uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (char) {\n      var randNo = (dateTime + Math.random() * 16) % 16 | 0;\n      dateTime = Math.floor(dateTime / 16);\n      return (char === 'x' ? randNo : randNo & 0x3 | 0x8).toString(16);\n    });\n    return uuid;\n  };\n  /**\n   * Check spelling in page data\n   *\n   * @private\n   * @param {string} wordToCheck - Specifies wordToCheck\n   * @returns {WordSpellInfo} - Retruns WordSpellInfo\n   */\n  SpellChecker.prototype.checkSpellingInPageInfo = function (wordToCheck) {\n    var hasError = false;\n    var elementPresent = false;\n    /* eslint-disable @typescript-eslint/no-explicit-any */\n    var uniqueWords = JSON.parse(localStorage.getItem(this.uniqueKey));\n    if (!isNullOrUndefined(uniqueWords)) {\n      if (!isNullOrUndefined(uniqueWords[wordToCheck])) {\n        return {\n          hasSpellError: uniqueWords[wordToCheck],\n          isElementPresent: true\n        };\n      }\n    }\n    return {\n      hasSpellError: hasError,\n      isElementPresent: elementPresent\n    };\n  };\n  /**\n   * @private\n   * @returns {void}\n   */\n  SpellChecker.prototype.destroy = function () {\n    this.errorWordCollection = undefined;\n    this.ignoreAllItems = undefined;\n    this.errorSuggestions = undefined;\n    this.uniqueWordsCollection = undefined;\n    this.uniqueSpelledWords = {};\n    this.textSearchResults = undefined;\n    if (!isNullOrUndefined(localStorage.getItem(this.uniqueKey))) {\n      localStorage.removeItem(this.uniqueKey);\n    }\n    this.documentHelper = undefined;\n  };\n  return SpellChecker;\n}();\nexport { SpellChecker };","map":{"version":3,"names":["TextSearchResults","beforeXmlHttpRequestSend","Dictionary","TextElementBox","ErrorTextElementBox","TableCellWidget","FieldElementBox","isNullOrUndefined","SpellChecker","documentHelper","langIDInternal","enableSpellCheckInternal","uniqueSpelledWords","spellSuggestionInternal","uniqueKey","removeUnderlineInternal","isChangeAll","uniqueWordsCountInternal","performOptimizedCheck","errorWordCollection","uniqueWordsCollection","errorSuggestions","ignoreAllItems","textSearchResults","owner","element","id","createGuid","prototype","getModuleName","Object","defineProperty","get","set","value","enumerable","configurable","editorModule","reLayout","selection","viewer","manageReplace","content","dialogElement","triggerSpellCheck","exactText","elementInfo","exactText_1","text","start","clone","end","manageSpecialCharacters","insertTextInternal","setPositionInternal","clearSelectionHighlight","currentContextInfo","elementBox","handleReplace","removeErrorsFromCollection","startPosition","offset","startIndex","startInlineObj","currentWidget","getInline","startOffset","line","getOffset","length","retrieveExactElementInfo","startPattern","RegExp","matches","matchInfo","exec","push","handleIgnoreOnce","index","toString","location","selectionModule","getPhysicalPositionInternal","searchModule","textSearch","getTextPosition","setPositionParagraph","endOffset","lineWidget","endPattern","nextElement","nextTextElBox","trim","textElement","undefined","ignoreOnceItems","indexOf","handleIgnoreAllItems","contextElement","contextItem","retriveText","retrievedText","handleAddToDictionary","_this","callSpellChecker","languageID","then","data","replaceText","isRemove","pattern","i","match","replace","slice","containsKey","splice","remove","currentElement","handleSuggestions","allsuggestions","spellCheckSuggestion","contextMenuModule","locale","getConstant","constructInlineMenu","spellSuggestion","_i","_a","str","iconCss","checktextElementHasErrors","left","hasError","erroElements","errorCollection","isScrollHandler","ischangeDetected","paragraph","isChangeDetected","updateStatusForGlobalErrors","handleErrorCollection","parentElement","elements","j","istextCombined","getCombinedElement","errorInElement","errors","ignoreAllIndex","inlineSuggestion","pop","findCurretText","insertPosition","inlineObj","errorElement","x","addErrorCollection","elementToCompare","suggestions","errorElements","compareErrorTextElement","compareTextElement","add","addCorrectWordCollection","isInUniqueWords","isErrorWord","isCorrectWord","copyElement","isChanged","handleWordByWordSpellCheck","jsonObject","top","underlineY","baselineAlignment","isSamePage","HasSpellingError","Suggestions","backgroundColor","containerWidget","cellFormat","shading","render","renderWavyLine","isSpellChecked","checkElementCanBeCombined","beforeIndex","textToCombine","isNext","isPrevious","canCombine","currentText","isCombined","checkPrevious","checkNext","combinedElements","getLineWidget","children","prevText","difference","prevCombined","isPrevField","lastIndexOf","fieldType","lookThroughPreviousLine","nextText","canCombine_1","previousElement","String","fromCharCode","lookThroughNextLine","checkCombinedElementsBeIgnored","handleCombinedElements","indexInOwner","previousLine","firstElement","nextLine","splittedText","split","currentText_1","handleUnorderedElements","checkArrayHasSameElement","elementToCheck","errorText","y","handleSplitWordSpellCheck","iteration","markIndex","isLastItem","matchResults","getMatchedResultsFromElement","updateMatchedTextLocation","textResults","handleMatchedResults","updateUniqueWords","Text","HasSpellError","results","wavyLineY","span","createErrorElementWithInfo","innerList","color","para","lineY","i_1","childWidgets","height","isRightToLeft","characterFormat","word","checkSpelling","checkSuggestion","addWord","isByPage","spellchecker","Promise","resolve","reject","httpRequest_1","XMLHttpRequest","service_1","serviceUrl","serverActionSettings","spellCheckByPage","spellCheck","open","setRequestHeader","setCustomHeaders","spellCheckData","LanguageID","TexttoCheck","CheckSpelling","CheckSuggestion","AddWord","httprequestEventArgs","serverActionType","headers","timeout","cancel","withCredentials","trigger","send","JSON","stringify","onreadystatechange","readyState","status","response","result","statusText","responseText","url","name","fireServiceFailure","httpRequest","header","keys","key","checkForNextError","errorWords","updateErrorElementTextBox","i_2","canTrigger","copyFormat","width","Math","abs","stringToRegex","clearResults","textLineInfo","getElementInfo","fullText","spans","elementsWithOffset","matchObject","error","highlight","spellCheckDialogModule","updateSuggestionDialog","getWhiteSpaceCharacterInfo","matchedText","textHelper","getWidth","scriptType","getSpecialCharactersInfo","beginingwidth","endWidth","prevElement","updateSplittedElementError","splittedElement","errorCount","getPageContent","page","sfdtExportModule","sfdtExport","keywordIndex","Initialize","document_1","writePage","textExportModule","textExport","pageContent","setDocument","writeInternal","spelledWords","localStorage","getItem","parse","totalCount","uniqueWordsCount","checkForUniqueWords","setItem","spellData","identityMatched","clearCache","removeItem","dateTime","Date","getTime","uuid","char","randNo","random","floor","checkSpellingInPageInfo","wordToCheck","elementPresent","uniqueWords","hasSpellError","isElementPresent","destroy"],"sources":["/home/taymur/Documents/legal2/DATA/Highlight/newmerged/CASEFRONTt/node_modules/@syncfusion/ej2-documenteditor/src/document-editor/implementation/spell-check/spell-checker.js"],"sourcesContent":["/* eslint-disable */\nimport { TextSearchResults } from '../index';\nimport { beforeXmlHttpRequestSend } from './../../index';\nimport { Dictionary } from '../../base/dictionary';\nimport { TextElementBox, ErrorTextElementBox, TableCellWidget, FieldElementBox } from '../viewer/page';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * The spell checker module\n */\nvar SpellChecker = /** @class */ (function () {\n    function SpellChecker(documentHelper) {\n        this.langIDInternal = 0;\n        /**\n         * Specifies whether spell check has to be performed or not.\n         */\n        this.enableSpellCheckInternal = true;\n        /**\n         * @private\n         */\n        /* eslint-disable @typescript-eslint/no-explicit-any */\n        this.uniqueSpelledWords = {};\n        this.spellSuggestionInternal = true;\n        /**\n         * @private\n         */\n        this.uniqueKey = '';\n        this.removeUnderlineInternal = false;\n        /**\n         * @private\n         */\n        this.isChangeAll = false;\n        /**\n         * @default 1000\n         */\n        this.uniqueWordsCountInternal = 15000;\n        this.performOptimizedCheck = true;\n        this.documentHelper = documentHelper;\n        this.errorWordCollection = new Dictionary();\n        this.uniqueWordsCollection = new Dictionary();\n        this.errorSuggestions = new Dictionary();\n        this.ignoreAllItems = [];\n        this.uniqueSpelledWords = {};\n        this.textSearchResults = new TextSearchResults(this.documentHelper.owner);\n        this.uniqueKey = this.documentHelper.owner.element.id + '_' + this.createGuid();\n    }\n    /**\n     * Gets module name.\n     */\n    SpellChecker.prototype.getModuleName = function () {\n        return 'SpellChecker';\n    };\n    Object.defineProperty(SpellChecker.prototype, \"enableOptimizedSpellCheck\", {\n        /**\n         * Gets the boolean indicating whether optimized spell check to be performed.\n         *\n         * @aspType bool\n         * @returns {boolean} Returns enableOptimizedSpellCheck\n         */\n        get: function () {\n            return this.performOptimizedCheck;\n        },\n        /**\n         * Sets the boolean indicating whether optimized spell check to be performed.\n         *\n         * @aspType bool\n         */\n        set: function (value) {\n            this.performOptimizedCheck = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SpellChecker.prototype, \"uniqueWordsCount\", {\n        /**\n         * Gets the spell checked Unique words.\n         *\n         * @aspType int\n         */\n        get: function () {\n            return isNullOrUndefined(this.uniqueWordsCountInternal) ? 0 : this.uniqueWordsCountInternal;\n        },\n        /**\n         * Sets the spell checked Unique words.\n         *\n         * @aspType int\n         */\n        set: function (value) {\n            this.uniqueWordsCountInternal = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SpellChecker.prototype, \"languageID\", {\n        /**\n         * Gets the languageID.\n         *\n         * @aspType int\n         */\n        get: function () {\n            return isNullOrUndefined(this.langIDInternal) ? 0 : this.langIDInternal;\n        },\n        /**\n         * Sets the languageID.\n         *\n         * @aspType int\n         */\n        set: function (value) {\n            this.langIDInternal = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SpellChecker.prototype, \"allowSpellCheckAndSuggestion\", {\n        /**\n         * Getter indicates whether suggestion enabled.\n         *\n         * @aspType bool\n         */\n        get: function () {\n            return this.spellSuggestionInternal;\n        },\n        /**\n         * Setter to enable or disable suggestion\n         *\n         * @aspType bool\n         */\n        set: function (value) {\n            this.spellSuggestionInternal = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SpellChecker.prototype, \"removeUnderline\", {\n        /**\n         * Getter indicates whether underline removed for mis-spelled word.\n         *\n         * @aspType bool\n         */\n        get: function () {\n            return this.removeUnderlineInternal;\n        },\n        /**\n         * Setter to enable or disable underline for mis-spelled word\n         *\n         * @aspType bool\n         */\n        set: function (value) {\n            this.removeUnderlineInternal = value;\n            this.documentHelper.owner.editorModule.reLayout(this.documentHelper.selection);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SpellChecker.prototype, \"enableSpellCheck\", {\n        /**\n         * Getter indicates whether spell check has to be performed or not.\n         *\n         * @aspType bool\n         */\n        get: function () {\n            return this.enableSpellCheckInternal;\n        },\n        /**\n         * Setter to enable or disable spell check has to be performed or not\n         *\n         * @aspType bool\n         */\n        set: function (value) {\n            this.enableSpellCheckInternal = value;\n            this.documentHelper.owner.editorModule.reLayout(this.documentHelper.selection);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SpellChecker.prototype, \"viewer\", {\n        get: function () {\n            return this.documentHelper.owner.viewer;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Method to manage replace logic\n     *\n     * @private\n     */\n    SpellChecker.prototype.manageReplace = function (content, dialogElement) {\n        this.documentHelper.triggerSpellCheck = true;\n        var exactText = '';\n        var elementInfo;\n        if (!isNullOrUndefined(dialogElement) && dialogElement instanceof ErrorTextElementBox) {\n            var exactText_1 = dialogElement.text;\n            this.documentHelper.selection.start = dialogElement.start.clone();\n            this.documentHelper.selection.end = dialogElement.end.clone();\n            if (content !== 'Ignore Once') {\n                content = this.manageSpecialCharacters(exactText_1, content);\n                this.documentHelper.owner.editorModule.insertTextInternal(content, true);\n                this.documentHelper.selection.start.setPositionInternal(this.documentHelper.selection.end);\n                this.documentHelper.clearSelectionHighlight();\n                return;\n            }\n            else {\n                this.currentContextInfo = { 'text': exactText_1, 'element': dialogElement };\n            }\n        }\n        if (!isNullOrUndefined(this.currentContextInfo) && this.currentContextInfo.element && content !== 'Ignore Once') {\n            var elementBox = this.currentContextInfo.element;\n            exactText = this.currentContextInfo.element.text;\n            this.documentHelper.selection.start = elementBox.start.clone();\n            this.documentHelper.selection.end = elementBox.end.clone();\n        }\n        else {\n            this.handleReplace(content);\n        }\n        if (content !== 'Ignore Once') {\n            this.documentHelper.owner.editorModule.insertTextInternal(content, true);\n            if (!isNullOrUndefined(this.currentContextInfo)) {\n                this.removeErrorsFromCollection(this.currentContextInfo);\n            }\n            this.documentHelper.selection.start.setPositionInternal(this.documentHelper.selection.end);\n            this.documentHelper.clearSelectionHighlight();\n        }\n        //this.documentHelper.owner.errorWordCollection.remove(content);\n        this.documentHelper.triggerSpellCheck = false;\n    };\n    /**\n     * Method to handle replace logic\n     *\n     * @private\n     */\n    SpellChecker.prototype.handleReplace = function (content) {\n        var startPosition = this.documentHelper.selection.start;\n        var offset = startPosition.offset;\n        var startIndex = 0;\n        var startInlineObj = startPosition.currentWidget.getInline(offset, startIndex, false, true);\n        var startOffset = startInlineObj.element.line.getOffset(startInlineObj.element, 0) + startInlineObj.element.length;\n        if (startOffset === offset) {\n            this.retrieveExactElementInfo(startInlineObj);\n        }\n        var exactText = startInlineObj.element.text;\n        var startPattern = new RegExp('^[#\\\\@\\\\!\\\\~\\\\$\\\\%\\\\^\\\\&\\\\*\\\\(\\\\)\\\\-\\\\_\\\\+\\\\=\\\\{\\\\}\\\\[\\\\]\\\\:\\\\;\\\\\"\\'\\\\,\\\\<\\\\.\\\\>\\\\/\\\\?\\\\`\\\\s]+', 'g');\n        var matches = [];\n        var matchInfo;\n        // eslint-disable  no-cond-assign\n        while (!isNullOrUndefined(matchInfo = startPattern.exec(exactText))) {\n            matches.push(matchInfo);\n        }\n        if (content === 'Ignore Once') {\n            this.handleIgnoreOnce(startInlineObj);\n            return;\n        }\n        startPosition.offset = offset - startInlineObj.index;\n        if (!isNullOrUndefined(matches) && matches.length > 0) {\n            startPosition.offset += matches[0].toString().length;\n        }\n        startPosition.location = this.documentHelper.owner.selectionModule.getPhysicalPositionInternal(startPosition.currentWidget, startPosition.offset, true);\n        startPosition = this.documentHelper.owner.searchModule.textSearch.getTextPosition(startPosition.currentWidget, startPosition.offset.toString());\n        //startPosition.location = this.owner.selection.getPhysicalPositionInternal(span.line, offset, true);\n        startPosition.setPositionParagraph(startPosition.currentWidget, startPosition.offset);\n        var index = (startPosition.offset + startInlineObj.element.length) - startPosition.offset;\n        var endOffset = startPosition.currentWidget.getOffset(startInlineObj.element, index);\n        var lineWidget = startPosition.currentWidget;\n        var endPattern = new RegExp('[#\\\\@\\\\!\\\\~\\\\$\\\\%\\\\^\\\\&\\\\*\\\\(\\\\)\\\\-\\\\_\\\\+\\\\=\\\\{\\\\}\\\\[\\\\]\\\\:\\\\;\\\\\"\\'\\\\,\\\\<\\\\.\\\\>\\\\/\\\\?\\\\s\\\\`]+$', 'g');\n        matches = [];\n        // eslint-disable  no-cond-assign\n        while (!isNullOrUndefined(matchInfo = endPattern.exec(exactText))) {\n            matches.push(matchInfo);\n        }\n        if (!isNullOrUndefined(matches) && matches.length > 0) {\n            endOffset -= matches[0].toString().length;\n        }\n        this.documentHelper.selection.end = this.documentHelper.owner.searchModule.textSearch.getTextPosition(lineWidget, endOffset.toString());\n        this.documentHelper.selection.end.location = this.documentHelper.owner.selectionModule.getPhysicalPositionInternal(startPosition.currentWidget, endOffset, true);\n        this.documentHelper.selection.end.setPositionParagraph(lineWidget, endOffset);\n        this.currentContextInfo = { 'element': startInlineObj.element, 'text': startInlineObj.element.text };\n    };\n    /**\n     * Method to retrieve exact element info\n     *\n     * @private\n     */\n    SpellChecker.prototype.retrieveExactElementInfo = function (startInlineObj) {\n        var nextElement = startInlineObj.element.nextElement;\n        if (!isNullOrUndefined(nextElement) && nextElement instanceof TextElementBox) {\n            var nextTextElBox = nextElement;\n            if (nextTextElBox.text.trim() != \"\") {\n                startInlineObj.element = nextElement;\n            }\n        }\n    };\n    /**\n     * Method to handle to ignore error Once\n     *\n     * @private\n     */\n    SpellChecker.prototype.handleIgnoreOnce = function (startInlineObj) {\n        var textElement = startInlineObj.element;\n        var exactText = '';\n        if (!isNullOrUndefined(this.currentContextInfo) && this.currentContextInfo.element) {\n            exactText = this.currentContextInfo.element.text;\n        }\n        else {\n            exactText = textElement.text;\n        }\n        exactText = this.manageSpecialCharacters(exactText, undefined, true);\n        if (textElement.ignoreOnceItems.indexOf(exactText) === -1) {\n            textElement.ignoreOnceItems.push(exactText);\n        }\n        this.documentHelper.owner.editorModule.reLayout(this.documentHelper.selection);\n    };\n    /**\n     * Method to handle ignore all items\n     *\n     * @private\n     */\n    SpellChecker.prototype.handleIgnoreAllItems = function (contextElement) {\n        var contextItem = (!isNullOrUndefined(contextElement)) ? contextElement : this.retriveText();\n        var retrievedText = this.manageSpecialCharacters(contextItem.text, undefined, true);\n        if (this.ignoreAllItems.indexOf(retrievedText) === -1) {\n            this.ignoreAllItems.push(retrievedText);\n            this.removeErrorsFromCollection(contextItem);\n            this.documentHelper.triggerSpellCheck = true;\n            this.documentHelper.owner.editorModule.reLayout(this.documentHelper.selection);\n            this.documentHelper.triggerSpellCheck = false;\n            this.documentHelper.clearSelectionHighlight();\n        }\n    };\n    /**\n     * Method to handle dictionary\n     *\n     * @private\n     */\n    SpellChecker.prototype.handleAddToDictionary = function (contextElement) {\n        var _this = this;\n        var contextItem = (!isNullOrUndefined(contextElement)) ? contextElement : this.retriveText();\n        var retrievedText = this.manageSpecialCharacters(contextItem.text, undefined, true);\n        /* eslint-disable @typescript-eslint/no-explicit-any */\n        this.callSpellChecker(this.languageID, retrievedText, false, false, true).then(function (data) {\n            _this.documentHelper.triggerSpellCheck = true;\n            _this.removeErrorsFromCollection(contextItem);\n            _this.ignoreAllItems.push(retrievedText);\n            _this.documentHelper.owner.editorModule.reLayout(_this.documentHelper.selection, true);\n            _this.documentHelper.triggerSpellCheck = false;\n        });\n    };\n    /**\n     * Method to append/remove special characters\n     *\n     * @private\n     */\n    SpellChecker.prototype.manageSpecialCharacters = function (exactText, replaceText, isRemove) {\n        if (!isNullOrUndefined(exactText)) {\n            if (isNullOrUndefined(replaceText)) {\n                replaceText = exactText;\n            }\n            var pattern = new RegExp('^[#\\\\@\\\\!\\\\$\\\\%\\\\^\\\\&\\\\*\\\\(\\\\)\\\\-\\\\_\\\\+\\\\=\\\\{\\\\}\\\\[\\\\]\\\\:\\\\;\\\\\"\\\\”\\'\\\\,\\\\<\\\\.\\\\>\\\\/\\\\?\\\\`\\\\s\\\\’]+', 'g');\n            var matches = [];\n            var matchInfo = void 0;\n            // eslint-disable  no-cond-assign\n            while (!isNullOrUndefined(matchInfo = pattern.exec(exactText))) {\n                matches.push(matchInfo);\n            }\n            if (matches.length > 0) {\n                for (var i = 0; i < matches.length; i++) {\n                    /* eslint-disable @typescript-eslint/no-explicit-any */\n                    var match = matches[i];\n                    replaceText = (!isRemove) ? match[0] + replaceText : replaceText.replace(match[0], '');\n                }\n            }\n            var endPattern = new RegExp('[#\\\\@\\\\!\\\\$\\\\%\\\\^\\\\&\\\\*\\\\(\\\\)\\\\-\\\\_\\\\+\\\\=\\\\{\\\\}\\\\[\\\\]\\\\:\\\\;\\\\\"\\\\”\\'\\\\,\\\\<\\\\.\\\\>\\\\/\\\\?\\\\s\\\\`\\\\’]+$', 'g');\n            matches = [];\n            // eslint-disable  no-cond-assign\n            while (!isNullOrUndefined(matchInfo = endPattern.exec(replaceText))) {\n                matches.push(matchInfo);\n            }\n            if (matches.length > 0) {\n                for (var i = 0; i < matches.length; i++) {\n                    /* eslint-disable @typescript-eslint/no-explicit-any */\n                    var match = matches[i];\n                    replaceText = (!isRemove) ? replaceText + match[0] : replaceText.slice(0, match.index);\n                }\n            }\n        }\n        return replaceText;\n    };\n    /**\n     * Method to remove errors\n     *\n     * @private\n     */\n    SpellChecker.prototype.removeErrorsFromCollection = function (contextItem) {\n        if (!isNullOrUndefined(contextItem.text) && this.errorWordCollection.containsKey(contextItem.text)) {\n            var textElement = this.errorWordCollection.get(contextItem.text);\n            if (textElement.indexOf(contextItem.element) >= 0) {\n                textElement.splice(0, 1);\n            }\n            if (textElement.length === 0) {\n                this.errorWordCollection.remove(contextItem.text);\n            }\n        }\n    };\n    /**\n     * Method to retrieve exact text\n     *\n     * @private\n     */\n    SpellChecker.prototype.retriveText = function () {\n        var exactText;\n        var currentElement;\n        if (!isNullOrUndefined(this.currentContextInfo) && this.currentContextInfo.element) {\n            currentElement = this.currentContextInfo.element;\n            exactText = this.currentContextInfo.element.text;\n            this.documentHelper.selection.start = currentElement.start.clone();\n            this.documentHelper.selection.end = currentElement.end.clone();\n        }\n        else {\n            var startPosition = this.documentHelper.selection.start;\n            var offset = startPosition.offset;\n            var startIndex = 0;\n            var startInlineObj = startPosition.currentWidget.getInline(offset, startIndex);\n            currentElement = startInlineObj.element;\n            exactText = startInlineObj.element.text;\n        }\n        return { 'text': exactText, 'element': currentElement };\n    };\n    /**\n     * Method to handle suggestions\n     *\n     * @private\n     */\n    /* eslint-disable @typescript-eslint/no-explicit-any */\n    SpellChecker.prototype.handleSuggestions = function (allsuggestions) {\n        this.spellCheckSuggestion = [];\n        if (allsuggestions.length === 0) {\n            this.spellCheckSuggestion.push(this.documentHelper.owner.contextMenuModule.locale.getConstant('Add to Dictionary'));\n        }\n        else {\n            allsuggestions = (allsuggestions.length > 3) ? this.constructInlineMenu(allsuggestions) : allsuggestions;\n            this.spellCheckSuggestion.push(this.documentHelper.owner.contextMenuModule.locale.getConstant('Add to Dictionary'));\n        }\n        /* eslint-disable @typescript-eslint/no-explicit-any */\n        var spellSuggestion = [];\n        if (this.spellCheckSuggestion.length > 0) {\n            for (var _i = 0, _a = this.spellCheckSuggestion; _i < _a.length; _i++) {\n                var str = _a[_i];\n                spellSuggestion.push({\n                    text: str,\n                    id: this.documentHelper.owner.element.id + '_contextmenu_otherSuggestions_spellcheck_' + (str === this.documentHelper.owner.contextMenuModule.locale.getConstant('Add to Dictionary') ? 'Add to Dictionary' : str),\n                    iconCss: ''\n                });\n            }\n        }\n        return spellSuggestion;\n    };\n    /**\n     * Method to check whether text element has errors\n     *\n     * @private\n     */\n    SpellChecker.prototype.checktextElementHasErrors = function (text, element, left) {\n        var hasError = false;\n        var erroElements = [];\n        text = text.replace(/[\\s]+/g, '');\n        if (!isNullOrUndefined(element.errorCollection) && element.errorCollection.length > 0) {\n            if (!this.documentHelper.isScrollHandler && (element.ischangeDetected || element.paragraph.isChangeDetected)) {\n                this.updateStatusForGlobalErrors(element.errorCollection, element);\n                element.errorCollection = [];\n                element.ischangeDetected = true;\n                return { 'errorFound': hasError, 'elements': erroElements };\n            }\n            for (var i = 0; i < element.errorCollection.length; i++) {\n                if (this.handleErrorCollection(element.errorCollection[i])) {\n                    hasError = true;\n                    erroElements.push(element.errorCollection[i]);\n                }\n            }\n        }\n        else if (!this.documentHelper.isScrollHandler && element.paragraph.isChangeDetected) {\n            element.ischangeDetected = true;\n        }\n        else if (!element.ischangeDetected && this.handleErrorCollection(element)) {\n            hasError = true;\n            erroElements.push(element);\n        }\n        return { 'errorFound': hasError, 'elements': erroElements };\n    };\n    SpellChecker.prototype.updateStatusForGlobalErrors = function (erroElements, parentElement) {\n        if (erroElements.length > 0) {\n            for (var i = 0; i < erroElements.length; i++) {\n                var exactText = this.manageSpecialCharacters(erroElements[i].text, undefined, true);\n                if (this.errorWordCollection.containsKey(exactText)) {\n                    var elements = this.errorWordCollection.get(exactText);\n                    for (var j = 0; j < elements.length; j++) {\n                        if (elements[j] instanceof ErrorTextElementBox && elements[j] === erroElements[i]) {\n                            elements[j].ischangeDetected = true;\n                            elements[j].start.offset = parentElement.line.getOffset(parentElement.istextCombined ? this.getCombinedElement(parentElement) : parentElement, 0);\n                            elements[j].line = parentElement.line;\n                            break;\n                        }\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * Method to handle document error collection.\n     *\n     * @param {string} errorInElement\n     * @private\n     */\n    SpellChecker.prototype.handleErrorCollection = function (errorInElement) {\n        var errors = this.errorWordCollection;\n        var exactText = this.manageSpecialCharacters(errorInElement.text, undefined, true);\n        if (errors.containsKey(exactText) && errorInElement.length > 1) {\n            var ignoreAllIndex = this.ignoreAllItems.indexOf(exactText);\n            if (ignoreAllIndex > -1) {\n                if (errors.containsKey(exactText)) {\n                    errors.remove(exactText);\n                }\n                return false;\n            }\n            return true;\n        }\n        return false;\n    };\n    /* eslint-disable @typescript-eslint/no-explicit-any */\n    SpellChecker.prototype.constructInlineMenu = function (inlineSuggestion) {\n        for (var i = inlineSuggestion.length - 1; i > 0; i--) {\n            if (inlineSuggestion.length > 3) {\n                this.spellCheckSuggestion.push(inlineSuggestion[i]);\n                inlineSuggestion.pop();\n            }\n        }\n        return inlineSuggestion;\n    };\n    /**\n     * Method to retrieve error element text\n     *\n     * @private\n     */\n    SpellChecker.prototype.findCurretText = function () {\n        var insertPosition = this.documentHelper.selection.start;\n        /* eslint-disable @typescript-eslint/no-explicit-any */\n        var element;\n        /* eslint-disable @typescript-eslint/no-explicit-any */\n        var inlineObj = insertPosition.currentWidget.getInline(this.documentHelper.selection.start.offset, 0);\n        var text;\n        if (!isNullOrUndefined(inlineObj.element)) {\n            if (!isNullOrUndefined(inlineObj.element.errorCollection) && inlineObj.element.errorCollection.length > 0) {\n                for (var i = 0; i < inlineObj.element.errorCollection.length; i++) {\n                    var errorElement = inlineObj.element.errorCollection[i];\n                    if (errorElement.start.location.x <= insertPosition.location.x && errorElement.end.location.x >= insertPosition.location.x) {\n                        text = errorElement.text;\n                        element = errorElement;\n                        break;\n                    }\n                }\n            }\n            else {\n                text = inlineObj.element.text;\n            }\n            if (text === ' ') {\n                inlineObj = insertPosition.currentWidget.getInline(this.documentHelper.selection.start.offset + 1, 0);\n                text = inlineObj.element.text;\n            }\n        }\n        return { 'text': text, 'element': element };\n    };\n    SpellChecker.prototype.addErrorCollection = function (text, elementToCompare, suggestions) {\n        text = this.manageSpecialCharacters(text, undefined, true);\n        if (this.errorWordCollection.containsKey(text)) {\n            var errorElements = this.errorWordCollection.get(text);\n            if (elementToCompare instanceof ErrorTextElementBox) {\n                if (!this.compareErrorTextElement(elementToCompare, errorElements)) {\n                    errorElements.push(elementToCompare);\n                }\n            }\n            else if (elementToCompare instanceof TextElementBox) {\n                if (!this.compareTextElement(elementToCompare, errorElements)) {\n                    errorElements.push(elementToCompare);\n                }\n            }\n        }\n        else {\n            if (!isNullOrUndefined(suggestions) && suggestions.length > 0) {\n                this.errorSuggestions.add(text, suggestions);\n            }\n            this.errorWordCollection.add(text, [elementToCompare]);\n            if (!this.uniqueWordsCollection.containsKey(text)) {\n                this.uniqueWordsCollection.add(text, true);\n            }\n        }\n    };\n    SpellChecker.prototype.addCorrectWordCollection = function (text) {\n        text = this.manageSpecialCharacters(text, undefined, true);\n        if (!this.uniqueWordsCollection.containsKey(text)) {\n            this.uniqueWordsCollection.add(text, false);\n        }\n    };\n    /**\n     * @private\n     */\n    SpellChecker.prototype.isInUniqueWords = function (text) {\n        text = text.replace(/[\\s]+/g, '');\n        return this.uniqueWordsCollection.containsKey(text);\n    };\n    /**\n     * @private\n     */\n    SpellChecker.prototype.isErrorWord = function (text) {\n        text = text.replace(/[\\s]+/g, '');\n        return this.uniqueWordsCollection.get(text);\n    };\n    /**\n     * @private\n     */\n    SpellChecker.prototype.isCorrectWord = function (text) {\n        text = text.replace(/[\\s]+/g, '');\n        return !this.uniqueWordsCollection.get(text);\n    };\n    SpellChecker.prototype.compareErrorTextElement = function (errorElement, errorCollection) {\n        var copyElement = [];\n        var isChanged = false;\n        for (var i = 0; i < errorCollection.length; i++) {\n            copyElement.push(errorCollection[i]);\n        }\n        var length = errorCollection.length;\n        for (var i = 0; i < length; i++) {\n            if (copyElement[i] instanceof ErrorTextElementBox) {\n                if (copyElement[i].ischangeDetected) {\n                    var exactText = this.manageSpecialCharacters(copyElement[i].text, undefined, true);\n                    isChanged = true;\n                    this.removeErrorsFromCollection({ 'element': copyElement[i], 'text': exactText });\n                }\n                else {\n                    var currentElement = copyElement[i];\n                    if (errorElement.start.offset === currentElement.start.offset && errorElement.end.offset === currentElement.end.offset) {\n                        return true;\n                    }\n                }\n            }\n        }\n        if (isChanged) {\n            this.errorWordCollection.add(this.manageSpecialCharacters(errorElement.text, undefined, true), [errorElement]);\n        }\n        return false;\n    };\n    /**\n     * Method to compare text elements\n     *\n     * @private\n     */\n    SpellChecker.prototype.compareTextElement = function (errorElement, errorCollection) {\n        for (var i = 0; i < errorCollection.length; i++) {\n            if (errorCollection[i] instanceof TextElementBox) {\n                var currentElement = errorCollection[i];\n                if (currentElement === errorElement) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    };\n    /**\n     * Method to handle Word by word spell check\n     *\n     * @private\n     */\n    SpellChecker.prototype.handleWordByWordSpellCheck = function (jsonObject, elementBox, left, top, underlineY, baselineAlignment, isSamePage) {\n        if (jsonObject.HasSpellingError && isSamePage) {\n            this.addErrorCollection(elementBox.text, elementBox, jsonObject.Suggestions);\n            var backgroundColor = (elementBox.line.paragraph.containerWidget instanceof TableCellWidget) ? elementBox.line.paragraph.containerWidget.cellFormat.shading.backgroundColor : this.documentHelper.backgroundColor;\n            this.documentHelper.render.renderWavyLine(elementBox, left, top, underlineY, '#FF0000', 'Single', baselineAlignment, backgroundColor);\n            elementBox.isSpellChecked = true;\n        }\n        else {\n            this.addCorrectWordCollection(elementBox.text);\n            elementBox.isSpellChecked = true;\n        }\n    };\n    /**\n     * Method to check errors for combined elements\n     *\n     * @private\n     */\n    SpellChecker.prototype.checkElementCanBeCombined = function (elementBox, underlineY, beforeIndex, callSpellChecker, textToCombine, isNext, isPrevious, canCombine) {\n        var currentText = isNullOrUndefined(textToCombine) ? '' : textToCombine;\n        var isCombined = isNullOrUndefined(canCombine) ? false : canCombine;\n        var checkPrevious = !isNullOrUndefined(isPrevious) ? isPrevious : true;\n        var checkNext = !isNullOrUndefined(isNext) ? isNext : true;\n        var combinedElements = [];\n        var line = this.documentHelper.selection.getLineWidget(elementBox, 0);\n        var index = line.children.indexOf(elementBox);\n        var prevText = elementBox.text;\n        combinedElements.push(elementBox);\n        var difference = (isPrevious) ? 0 : 1;\n        var prevCombined = false;\n        var isPrevField = false;\n        if (elementBox.text !== '\\v') {\n            if (checkPrevious) {\n                var textElement = undefined;\n                for (var i = index - difference; i >= 0; i--) {\n                    textElement = line.children[i];\n                    if (textElement instanceof TextElementBox && !isPrevField) {\n                        if (prevText.indexOf(' ') !== 0 && textElement.text.lastIndexOf(' ') !== textElement.text.length - 1) {\n                            prevCombined = !isNullOrUndefined(textToCombine) ? true : false;\n                            currentText = textElement.text + currentText;\n                            prevText = textElement.text;\n                            isPrevField = false;\n                            combinedElements.push(textElement);\n                            isCombined = true;\n                        }\n                        else if (!isNullOrUndefined(textElement)) {\n                            textElement = textElement.nextElement;\n                            break;\n                        }\n                    }\n                    else if (textElement instanceof FieldElementBox && textElement.fieldType !== 1) {\n                        isPrevField = true;\n                    }\n                }\n                var currentElement = (isCombined) ? textElement : elementBox;\n                if (this.lookThroughPreviousLine(currentText, prevText, currentElement, underlineY, beforeIndex)) {\n                    return true;\n                }\n            }\n            if (isPrevious) {\n                currentText = (prevCombined) ? currentText : elementBox.text + currentText;\n            }\n            else {\n                currentText += elementBox.text;\n            }\n            isPrevField = false;\n            var nextText = elementBox.text;\n            if (checkNext) {\n                var canCombine_1 = false;\n                var element = undefined;\n                for (var i = index + 1; i < line.children.length; i++) {\n                    element = line.children[i];\n                    if (element instanceof TextElementBox && !isPrevField) {\n                        if (nextText.lastIndexOf(' ') !== nextText.length - 1 && element.text.indexOf(' ') !== 0) {\n                            currentText += element.text;\n                            nextText = element.text;\n                            isPrevField = false;\n                            combinedElements.push(element);\n                            canCombine_1 = true;\n                            isCombined = true;\n                        }\n                        else if (!isNullOrUndefined(element)) {\n                            element = element.previousElement;\n                            break;\n                        }\n                    }\n                    else if (element instanceof FieldElementBox && element.fieldType !== 2) {\n                        isPrevField = true;\n                    }\n                }\n                var currentElement = (canCombine_1) ? element : elementBox;\n                if (currentElement.text !== '\\f' && currentElement.text !== String.fromCharCode(14) && this.lookThroughNextLine(currentText, prevText, currentElement, underlineY, beforeIndex)) {\n                    return true;\n                }\n            }\n        }\n        if (isCombined && callSpellChecker && !this.checkCombinedElementsBeIgnored(combinedElements, currentText)) {\n            this.handleCombinedElements(elementBox, currentText, underlineY, beforeIndex);\n        }\n        return isCombined;\n    };\n    SpellChecker.prototype.lookThroughPreviousLine = function (currentText, prevText, currentElement, underlineY, beforeIndex) {\n        if (!isNullOrUndefined(currentElement) && currentElement.indexInOwner === 0 && !isNullOrUndefined(currentElement.line.previousLine)) {\n            var previousLine = currentElement.line.previousLine;\n            var index = previousLine.children.length - 1;\n            if (!isNullOrUndefined(previousLine.children[index]) && previousLine.children[index] instanceof TextElementBox) {\n                var firstElement = previousLine.children[index];\n                if (!isNullOrUndefined(currentElement.text)) {\n                    if (currentElement.text.indexOf(' ') !== 0 && firstElement.text.lastIndexOf(' ') !== firstElement.text.length - 1) {\n                        currentText = (currentText.length > 0) ? currentText : prevText;\n                        this.checkElementCanBeCombined(firstElement, underlineY, beforeIndex, true, currentText, false, true, true);\n                        return true;\n                    }\n                }\n            }\n        }\n        return false;\n    };\n    SpellChecker.prototype.lookThroughNextLine = function (currentText, prevText, elementBox, underlineY, beforeIndex) {\n        if (elementBox instanceof TextElementBox && !isNullOrUndefined(elementBox) && elementBox.indexInOwner === elementBox.line.children.length - 1 && !isNullOrUndefined(elementBox.line.nextLine)) {\n            var nextLine = elementBox.line.nextLine;\n            if (!isNullOrUndefined(nextLine.children[0]) && nextLine.children[0] instanceof TextElementBox) {\n                var firstElement = nextLine.children[0];\n                if (elementBox.text.lastIndexOf(' ') !== elementBox.text.length - 1 && firstElement.text.indexOf(' ') !== 0) {\n                    currentText = (currentText.length > 0) ? currentText : prevText;\n                    this.checkElementCanBeCombined(firstElement, underlineY, beforeIndex, true, currentText, true, false, true);\n                    return true;\n                }\n            }\n        }\n        return false;\n    };\n    /**\n     * Method to handle combined elements\n     *\n     * @param {TextElementBox} elementBox\n     * @param {string} currentText\n     * @param {number} underlineY\n     * @param {number} beforeIndex\n     * @private\n     */\n    SpellChecker.prototype.handleCombinedElements = function (elementBox, currentText, underlineY, beforeIndex) {\n        elementBox.istextCombined = true;\n        var splittedText = currentText.split(/[\\s]+/);\n        if (this.ignoreAllItems.indexOf(currentText) === -1 && elementBox instanceof TextElementBox && elementBox.ignoreOnceItems.indexOf(currentText) === -1) {\n            if (splittedText.length > 1) {\n                for (var i = 0; i < splittedText.length; i++) {\n                    var currentText_1 = splittedText[i];\n                    currentText_1 = this.manageSpecialCharacters(currentText_1, undefined, true);\n                    this.documentHelper.render.handleUnorderedElements(currentText_1, elementBox, underlineY, i, 0, i === splittedText.length - 1, beforeIndex);\n                }\n            }\n            else {\n                currentText = this.manageSpecialCharacters(currentText, undefined, true);\n                this.documentHelper.render.handleUnorderedElements(currentText, elementBox, underlineY, 0, 0, true, beforeIndex);\n            }\n        }\n    };\n    /**\n     * Method to check error element collection has unique element\n     *\n     * @param {ErrorTextElementBox[]} errorCollection\n     * @param {ErrorTextElementBox} elementToCheck\n     * @private\n     */\n    SpellChecker.prototype.checkArrayHasSameElement = function (errorCollection, elementToCheck) {\n        for (var i = 0; i < errorCollection.length; i++) {\n            var errorText = errorCollection[i];\n            if ((errorText.start.location.x === elementToCheck.start.location.x) && (errorText.start.location.y === elementToCheck.start.location.y)) {\n                return true;\n            }\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    SpellChecker.prototype.handleSplitWordSpellCheck = function (jsonObject, currentText, elementBox, isSamePage, underlineY, iteration, markIndex, isLastItem) {\n        if (jsonObject.HasSpellingError && elementBox.text !== ' ' && isSamePage) {\n            var matchResults = this.getMatchedResultsFromElement(elementBox, currentText);\n            markIndex = (elementBox.istextCombined) ? elementBox.line.getOffset(this.getCombinedElement(elementBox), 0) : markIndex;\n            this.documentHelper.owner.searchModule.textSearch.updateMatchedTextLocation(matchResults.matches, matchResults.textResults, matchResults.elementInfo, 0, elementBox, false, null, markIndex);\n            this.handleMatchedResults(matchResults.textResults, elementBox, underlineY, iteration, jsonObject.Suggestions, isLastItem);\n        }\n        else {\n            this.addCorrectWordCollection(currentText);\n            if (isLastItem) {\n                elementBox.isSpellChecked = true;\n            }\n        }\n        this.updateUniqueWords([{ Text: currentText, HasSpellError: jsonObject.HasSpellingError }]);\n    };\n    SpellChecker.prototype.handleMatchedResults = function (results, elementBox, wavyLineY, index, suggestions, isLastItem) {\n        if (results.length === 0 && isLastItem) {\n            elementBox.isSpellChecked = true;\n            return;\n        }\n        for (var i = 0; i < results.length; i++) {\n            var span = this.createErrorElementWithInfo(results.innerList[i], elementBox);\n            var color = '#FF0000';\n            if (!isNullOrUndefined(elementBox.errorCollection) && !this.checkArrayHasSameElement(elementBox.errorCollection, span)) {\n                elementBox.errorCollection.splice(index, 0, span);\n            }\n            this.addErrorCollection(span.text, span, suggestions);\n            var backgroundColor = (elementBox.line.paragraph.containerWidget instanceof TableCellWidget) ? elementBox.paragraph.containerWidget.cellFormat.shading.backgroundColor : this.documentHelper.backgroundColor;\n            var para = elementBox.line.paragraph;\n            var lineY = para.y;\n            for (var i_1 = 0; i_1 < para.childWidgets.length; i_1++) {\n                if (para.childWidgets[i_1] == elementBox.line)\n                    break;\n                lineY += para.childWidgets[i_1].height;\n            }\n            if (elementBox.isRightToLeft) {\n                this.documentHelper.render.renderWavyLine(span, span.end.location.x, lineY, wavyLineY, color, 'Single', elementBox.characterFormat.baselineAlignment, backgroundColor);\n            }\n            else {\n                this.documentHelper.render.renderWavyLine(span, span.start.location.x, lineY, wavyLineY, color, 'Single', elementBox.characterFormat.baselineAlignment, backgroundColor);\n            }\n            if (isLastItem) {\n                elementBox.isSpellChecked = true;\n            }\n        }\n    };\n    /**\n     * Calls the spell checker service\n     * @private\n     */\n    /* eslint-disable @typescript-eslint/no-explicit-any */\n    SpellChecker.prototype.callSpellChecker = function (languageID, word, checkSpelling, checkSuggestion, addWord, isByPage) {\n        var _this = this;\n        var spellchecker = this;\n        return new Promise(function (resolve, reject) {\n            if (!isNullOrUndefined(_this)) {\n                var httpRequest_1 = new XMLHttpRequest();\n                var service_1 = _this.documentHelper.owner.serviceUrl;\n                service_1 = (isByPage) ? service_1 + _this.documentHelper.owner.serverActionSettings.spellCheckByPage : service_1 + _this.documentHelper.owner.serverActionSettings.spellCheck;\n                httpRequest_1.open('POST', service_1, true);\n                httpRequest_1.setRequestHeader('Content-Type', 'application/json');\n                _this.setCustomHeaders(httpRequest_1);\n                /* eslint-disable @typescript-eslint/no-explicit-any */\n                var spellCheckData = { LanguageID: languageID, TexttoCheck: word, CheckSpelling: checkSpelling, CheckSuggestion: checkSuggestion, AddWord: addWord };\n                var httprequestEventArgs = { serverActionType: 'SpellCheck', headers: _this.documentHelper.owner.headers, timeout: 0, cancel: false, withCredentials: false };\n                _this.documentHelper.owner.trigger(beforeXmlHttpRequestSend, httprequestEventArgs);\n                if (!httprequestEventArgs.cancel) {\n                    httpRequest_1.send(JSON.stringify(spellCheckData));\n                }\n                httpRequest_1.onreadystatechange = function () {\n                    if (httpRequest_1.readyState === 4) {\n                        if (httpRequest_1.status === 200 || httpRequest_1.status === 304) {\n                            resolve(httpRequest_1.response);\n                        }\n                        else {\n                            var result = {\n                                status: httpRequest_1.status.toString(),\n                                statusText: httpRequest_1.responseText,\n                                url: service_1\n                            };\n                            result.name = 'onFailure';\n                            if (!isNullOrUndefined(spellchecker.documentHelper)) {\n                                spellchecker.documentHelper.owner.fireServiceFailure(result);\n                            }\n                            reject(httpRequest_1.response);\n                        }\n                    }\n                };\n            }\n        });\n    };\n    SpellChecker.prototype.setCustomHeaders = function (httpRequest) {\n        for (var i = 0; i < this.documentHelper.owner.headers.length; i++) {\n            var header = this.documentHelper.owner.headers[i];\n            for (var _i = 0, _a = Object.keys(header); _i < _a.length; _i++) {\n                var key = _a[_i];\n                httpRequest.setRequestHeader(key, header[key]);\n            }\n        }\n    };\n    /**\n     * Method to check for next error\n     *\n     * @private\n     * @returns {void}\n     */\n    SpellChecker.prototype.checkForNextError = function () {\n        if (!isNullOrUndefined(this.viewer)) {\n            var errorWords = this.errorWordCollection;\n            if (errorWords.length > 0) {\n                for (var i = 0; i < errorWords.length; i++) {\n                    var errorElements = errorWords.get(errorWords.keys[i]);\n                    for (var j = 0; j < errorElements.length; j++) {\n                        if (errorElements[j] instanceof ErrorTextElementBox && !errorElements[j].ischangeDetected) {\n                            this.updateErrorElementTextBox(errorWords.keys[i], errorElements[j]);\n                        }\n                        else if (errorElements[j] instanceof TextElementBox) {\n                            var matchResults = this.getMatchedResultsFromElement(errorElements[j]);\n                            var results = matchResults.textResults;\n                            var markIndex = (errorElements[j].ischangeDetected) ? errorElements[j].start.offset : errorElements[j].line.getOffset(errorElements[j], 0);\n                            this.documentHelper.owner.searchModule.textSearch.updateMatchedTextLocation(matchResults.matches, results, matchResults.elementInfo, 0, errorElements[j], false, null, markIndex);\n                            for (var i_2 = 0; i_2 < results.length; i_2++) {\n                                var element = this.createErrorElementWithInfo(results.innerList[i_2], errorElements[j]);\n                                this.updateErrorElementTextBox(element.text, element);\n                                break;\n                            }\n                        }\n                        break;\n                    }\n                    break;\n                }\n            }\n            else {\n                this.documentHelper.clearSelectionHighlight();\n            }\n        }\n    };\n    /**\n     * Method to create error element with matched results\n     *\n     * @param {TextSearchResult} result\n     * @param {ElementBox} errorElement\n     * @private\n     */\n    SpellChecker.prototype.createErrorElementWithInfo = function (result, errorElement) {\n        var element = new ErrorTextElementBox();\n        element.text = result.text;\n        element.start = result.start;\n        element.end = result.end;\n        element.height = errorElement.height;\n        element.canTrigger = errorElement.canTrigger;\n        element.characterFormat.copyFormat(errorElement.characterFormat);\n        // element.width = this.documentHelper.textHelper.getWidth(element.text, errorElement.characterFormat, (errorElement as TextElementBox).scriptType);\n        element.width = Math.abs(element.start.location.x - element.end.location.x);\n        return element;\n    };\n    /**\n     * Method to get matched results from element box\n     *\n     * @private\n     * @param {ElementBox} errorElement - Specifies the error element box.\n     * @param {string} currentText - Specifies the current text\n     * @returns {MatchResults} - Returns match results info.\n     */\n    SpellChecker.prototype.getMatchedResultsFromElement = function (errorElement, currentText) {\n        var line = errorElement.line;\n        var pattern = this.documentHelper.owner.searchModule.textSearch.stringToRegex((isNullOrUndefined(currentText)) ? errorElement.text : currentText, 'CaseSensitive');\n        this.textSearchResults.clearResults();\n        var results = this.textSearchResults;\n        var textLineInfo = this.documentHelper.owner.searchModule.textSearch.getElementInfo(line.children[0], 0, false, pattern, undefined, undefined, undefined, undefined, true);\n        var text = textLineInfo.fullText;\n        var matches = [];\n        var spans = textLineInfo.elementsWithOffset;\n        var matchObject;\n        // eslint-disable  no-cond-assign\n        while (!isNullOrUndefined(matchObject = pattern.exec(text))) {\n            if (this.isChangeAll) {\n                matchObject.index = spans.get(errorElement);\n            }\n            matches.push(matchObject);\n        }\n        return { 'matches': matches, 'elementInfo': spans, 'textResults': results };\n    };\n    /**\n     * Method to update error element information\n     *\n     * @private\n     * @param {string} error - Specifies the error word.\n     * @param {ErrorTextElementBox} errorElement - Specifies the error element box.\n     * @returns {void}\n     */\n    SpellChecker.prototype.updateErrorElementTextBox = function (error, errorElement) {\n        var element = errorElement;\n        this.documentHelper.clearSelectionHighlight();\n        this.documentHelper.selection.start = element.start.clone();\n        this.documentHelper.selection.end = element.end.clone();\n        this.documentHelper.selection.highlight(errorElement.start.paragraph, errorElement.start, errorElement.end);\n        this.documentHelper.owner.spellCheckDialogModule.updateSuggestionDialog(error, element);\n    };\n    /**\n     * Method to retrieve space information in a text\n     *\n     * @private\n     * @param {string} text - Specifies the text\n     * @param {WCharacterFormat} characterFormat - Specifies the character format.\n     * @returns {SpecialCharacterInfo} - Returs special character info.\n     */\n    SpellChecker.prototype.getWhiteSpaceCharacterInfo = function (elementBox) {\n        var text = elementBox.text;\n        var characterFormat = elementBox.characterFormat;\n        /* eslint-disable @typescript-eslint/no-explicit-any */\n        var matchedText = [];\n        var width = 0;\n        var length = 0;\n        matchedText = text.match(/[\\s]+/);\n        if (!isNullOrUndefined(matchedText) && matchedText.length > 0) {\n            for (var i = 0; i < matchedText.length; i++) {\n                width += this.documentHelper.textHelper.getWidth(matchedText[i], characterFormat, elementBox.scriptType);\n                length += matchedText[i].length;\n            }\n        }\n        return { 'width': width, 'wordLength': length, 'isBeginning': (!isNullOrUndefined(matchedText) && matchedText.index === 0) };\n    };\n    /**\n     * Retrieve Special character info\n     *\n     * @private\n     * @param {string} text - Specifies the text\n     * @param {WCharacterFormat} characterFormat - Specifies the character format.\n     * @returns {SpecialCharacterInfo} - Returs special character info.\n     */\n    SpellChecker.prototype.getSpecialCharactersInfo = function (elementBox) {\n        var text = elementBox.text;\n        var characterFormat = elementBox.characterFormat;\n        /* eslint-disable @typescript-eslint/no-explicit-any */\n        var matchedText = [];\n        var beginingwidth = 0;\n        var endWidth = 0;\n        var length = 0;\n        matchedText = text.match(/^[\\#\\@\\!\\~\\$\\%\\^\\&\\*\\(\\)\\-\\_\\+\\=\\{\\}\\[\\]\\:\\;\\\"\\'\\,\\<\\.\\>\\/\\?\\`]*/);\n        for (var i = 0; i < matchedText.length; i++) {\n            if (!isNullOrUndefined(matchedText[i]) && matchedText[i].length > 0) {\n                beginingwidth = this.documentHelper.textHelper.getWidth(matchedText[i], characterFormat, elementBox.scriptType);\n            }\n            length = matchedText.length;\n        }\n        matchedText = text.match(/[\\#\\@\\!\\~\\$\\%\\^\\&\\*\\(\\)\\-\\_\\+\\=\\{\\}\\[\\]\\:\\;\\\"\\'\\,\\<\\.\\>\\/\\?\\`]*$/);\n        for (var i = 0; i < matchedText.length; i++) {\n            if (!isNullOrUndefined(matchedText[i]) && matchedText[i].length > 0) {\n                endWidth = this.documentHelper.textHelper.getWidth(matchedText[i], characterFormat, elementBox.scriptType);\n            }\n            length = matchedText.length;\n        }\n        return { 'beginningWidth': beginingwidth, 'endWidth': endWidth, 'wordLength': length };\n    };\n    /**\n     * Method to retrieve next available combined element\n     *\n     * @private\n     * @param {ElementBox} element - Specified the element.\n     * @returns {ElementBox} - Returns combined element.\n     */\n    SpellChecker.prototype.getCombinedElement = function (element) {\n        var prevElement = element;\n        while (!isNullOrUndefined(element) && element instanceof TextElementBox && element.istextCombined) {\n            prevElement = element;\n            element = element.previousElement;\n        }\n        return prevElement;\n    };\n    SpellChecker.prototype.checkCombinedElementsBeIgnored = function (elements, exactText) {\n        exactText = this.manageSpecialCharacters(exactText, undefined, true);\n        for (var i = 0; i < elements.length; i++) {\n            if (elements[i].ignoreOnceItems.indexOf(exactText) !== -1) {\n                return true;\n            }\n        }\n        return false;\n    };\n    /**\n     * Method to update error collection\n     *\n     * @private\n     * @param {TextElementBox} currentElement - Specifies current element.\n     * @param {TextElementBox} splittedElement - Specifies splitted element.\n     * @returns {void}\n     */\n    SpellChecker.prototype.updateSplittedElementError = function (currentElement, splittedElement) {\n        var errorCount = currentElement.errorCollection.length;\n        if (errorCount > 0) {\n            var errorCollection = [];\n            for (var i = 0; i < errorCount; i++) {\n                errorCollection.push(currentElement.errorCollection[i]);\n            }\n            for (var i = 0; i < errorCount; i++) {\n                if (currentElement.text.indexOf(errorCollection[i].text) === -1) {\n                    splittedElement.ischangeDetected = true;\n                    currentElement.errorCollection.splice(0, 1);\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     * @param {Page} page - Specifies the page.\n     * @returns {string} - Returns page content.\n     */\n    SpellChecker.prototype.getPageContent = function (page) {\n        var content = '';\n        if (this.documentHelper.owner.sfdtExportModule) {\n            var sfdtExport = this.documentHelper.owner.sfdtExportModule;\n            var index = sfdtExport.keywordIndex;\n            sfdtExport.keywordIndex = 0;\n            sfdtExport.Initialize();\n            var document_1 = sfdtExport.writePage(page);\n            sfdtExport.keywordIndex = index;\n            if (this.documentHelper.owner.textExportModule) {\n                var textExport = this.documentHelper.owner.textExportModule;\n                textExport.pageContent = '';\n                textExport.setDocument(document_1);\n                textExport.writeInternal();\n                content = textExport.pageContent;\n            }\n        }\n        return content;\n    };\n    /**\n     * @private\n     * @param {any[]} spelledWords - Specifies spelledWords\n     * @returns {void}\n     */\n    SpellChecker.prototype.updateUniqueWords = function (spelledWords) {\n        if (!isNullOrUndefined(localStorage.getItem(this.uniqueKey))) {\n            this.uniqueSpelledWords = JSON.parse(localStorage.getItem(this.uniqueKey));\n        }\n        this.uniqueSpelledWords = this.uniqueSpelledWords || {};\n        var totalCount = spelledWords.length + Object.keys(this.uniqueSpelledWords).length;\n        if (totalCount <= this.uniqueWordsCount) {\n            for (var i = 0; i < spelledWords.length; i++) {\n                this.checkForUniqueWords(spelledWords[i]);\n            }\n        }\n        localStorage.setItem(this.uniqueKey, JSON.stringify(this.uniqueSpelledWords));\n        this.uniqueSpelledWords = {};\n    };\n    SpellChecker.prototype.checkForUniqueWords = function (spellData) {\n        var identityMatched = this.uniqueSpelledWords[spellData.Text];\n        if (!identityMatched) {\n            this.uniqueSpelledWords[spellData.Text] = spellData.HasSpellError;\n        }\n    };\n    /**\n     * Method to clear cached words for spell check\n     *\n     * @returns {void}\n     */\n    SpellChecker.prototype.clearCache = function () {\n        if (!isNullOrUndefined(localStorage.getItem(this.uniqueKey))) {\n            localStorage.removeItem(this.uniqueKey);\n        }\n    };\n    SpellChecker.prototype.createGuid = function () {\n        var dateTime = new Date().getTime();\n        var uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (char) {\n            var randNo = (dateTime + Math.random() * 16) % 16 | 0;\n            dateTime = Math.floor(dateTime / 16);\n            return (char === 'x' ? randNo : (randNo & 0x3 | 0x8)).toString(16);\n        });\n        return uuid;\n    };\n    /**\n     * Check spelling in page data\n     *\n     * @private\n     * @param {string} wordToCheck - Specifies wordToCheck\n     * @returns {WordSpellInfo} - Retruns WordSpellInfo\n     */\n    SpellChecker.prototype.checkSpellingInPageInfo = function (wordToCheck) {\n        var hasError = false;\n        var elementPresent = false;\n        /* eslint-disable @typescript-eslint/no-explicit-any */\n        var uniqueWords = JSON.parse(localStorage.getItem(this.uniqueKey));\n        if (!isNullOrUndefined(uniqueWords)) {\n            if (!isNullOrUndefined(uniqueWords[wordToCheck])) {\n                return { hasSpellError: uniqueWords[wordToCheck], isElementPresent: true };\n            }\n        }\n        return { hasSpellError: hasError, isElementPresent: elementPresent };\n    };\n    /**\n     * @private\n     * @returns {void}\n     */\n    SpellChecker.prototype.destroy = function () {\n        this.errorWordCollection = undefined;\n        this.ignoreAllItems = undefined;\n        this.errorSuggestions = undefined;\n        this.uniqueWordsCollection = undefined;\n        this.uniqueSpelledWords = {};\n        this.textSearchResults = undefined;\n        if (!isNullOrUndefined(localStorage.getItem(this.uniqueKey))) {\n            localStorage.removeItem(this.uniqueKey);\n        }\n        this.documentHelper = undefined;\n    };\n    return SpellChecker;\n}());\nexport { SpellChecker };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}