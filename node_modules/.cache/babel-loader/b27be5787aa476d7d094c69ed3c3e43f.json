{"ast":null,"code":"var _jsxFileName = \"/home/taymur/Documents/legal2/DATA/Highlight/newmerged/CASEFRONTt/src/TextEditor.js\";\nimport React, { useContext, useCallback, useEffect, useState } from \"react\";\nimport Quill from \"quill\";\nimport \"quill/dist/quill.snow.css\";\nimport { io } from \"socket.io-client\";\nimport { Button, Modal } from \"react-bootstrap\";\nimport { FaRegPaperPlane, FaBriefcase, FaFile } from 'react-icons/fa';\nimport { UserContext } from \"./App\";\nconst SAVE_INTERVAL_MS = 15000;\nconst TOOLBAR_OPTIONS = [[{\n  header: [1, 2, 3, 4, 5, 6, false]\n}], [{\n  font: []\n}], [{\n  list: \"ordered\"\n}, {\n  list: \"bullet\"\n}], [\"bold\", \"italic\", \"underline\"], [{\n  color: []\n}, {\n  background: []\n}], [{\n  script: \"sub\"\n}, {\n  script: \"super\"\n}], [{\n  align: []\n}], [\"blockquote\", \"code-block\"], [\"clean\"]];\nexport default function TextEditor({\n  id,\n  fileName,\n  showTextEditor,\n  setShowTextEditor\n}) {\n  const [socket, setSocket] = useState();\n  const [quill, setQuill] = useState();\n  const [openaiResponses, setOpenaiResponses] = useState([]);\n  const {\n    state\n  } = useContext(UserContext); // Assuming `state` is used elsewhere in your component\n\n  const [editorMode, setEditorMode] = useState(null);\n  useEffect(() => {\n    const s = io(\"http://localhost:8000\");\n    setSocket(s);\n    return () => {\n      s.disconnect();\n    };\n  }, []);\n  useEffect(() => {\n    if (!socket || !quill) return;\n    const interval = editorMode === 'edit_document' ? setInterval(() => {\n      socket.emit(\"save-document\", quill.getContents());\n    }, SAVE_INTERVAL_MS) : null;\n    return () => {\n      if (interval) clearInterval(interval);\n    };\n  }, [socket, quill, editorMode, id, fileName]);\n  const wrapperRef = useCallback(wrapper => {\n    if (wrapper == null) return;\n    wrapper.innerHTML = \"\";\n    const editor = document.createElement(\"div\");\n    wrapper.append(editor);\n    const q = new Quill(editor, {\n      theme: \"snow\",\n      modules: {\n        toolbar: TOOLBAR_OPTIONS\n      }\n    });\n    q.enable();\n    setQuill(q);\n  }, []);\n  useEffect(() => {\n    if (socket == null || quill == null || editorMode !== 'appeal') return;\n\n    const handler = data => {\n      setOpenaiResponses(currentResponses => [...currentResponses, data.message]);\n\n      if (editorMode === 'appeal' && data.message) {\n        const length = quill.getLength();\n        quill.insertText(length, \"\\n\" + data.message);\n      }\n    };\n\n    socket.on(\"openai_response\", handler);\n    return () => {\n      socket.off(\"openai_response\", handler);\n    };\n  }, [socket, quill, editorMode]); // Function definitions that were missing\n\n  const handleEditDocument = () => {\n    setEditorMode('edit_document'); // Possibly more logic here as needed\n  };\n\n  const handleNewDocument = () => {\n    setEditorMode('new_document'); // Possibly more logic here as needed\n  };\n\n  const handleCopyToClipboard = text => {\n    navigator.clipboard.writeText(text).then(() => {\n      console.log('Text copied to clipboard');\n    }, err => {\n      console.error('Could not copy text: ', err);\n    }); // Insert text into Quill editor\n\n    const range = quill.getSelection();\n    const position = range ? range.index : quill.getLength();\n    quill.insertText(position, text);\n    quill.setSelection(position + text.length);\n  };\n\n  const handleNoteSave = () => {\n    if (socket == null || quill == null) return;\n    socket.emit(\"save-document\", quill.getContents());\n    handleClose();\n  };\n\n  const handleAppeal = () => {\n    console.log('Appeal clicked. Emitting openai-call.', `Socket connected: ${socket === null || socket === void 0 ? void 0 : socket.connected}`);\n    setEditorMode('appeal');\n    socket === null || socket === void 0 ? void 0 : socket.emit(\"openai-call\", {\n      documentId: id,\n      fileName\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 3\n    }\n  }, !editorMode ? /*#__PURE__*/React.createElement(Modal, {\n    show: showTextEditor,\n    onHide: handleClose,\n    backdrop: \"static\",\n    centered: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 4\n    }\n  }, /*#__PURE__*/React.createElement(Modal.Header, {\n    closeButton: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 6\n    }\n  }, /*#__PURE__*/React.createElement(Modal.Title, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 5\n    }\n  }, \"Choose an Option\")), /*#__PURE__*/React.createElement(Modal.Body, {\n    style: {\n      textAlign: 'center'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 6\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    variant: \"outline-primary\",\n    onClick: handleAppeal,\n    style: {\n      margin: '10px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(FaRegPaperPlane, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 7\n    }\n  }), \" Appeal\"), /*#__PURE__*/React.createElement(Button, {\n    variant: \"outline-success\",\n    onClick: handleEditDocument,\n    style: {\n      margin: '10px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(FaBriefcase, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 7\n    }\n  }), \" Edit Document\"), /*#__PURE__*/React.createElement(Button, {\n    variant: \"outline-info\",\n    onClick: handleNewDocument,\n    style: {\n      margin: '10px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(FaFile, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 7\n    }\n  }), \" New Document\"))) : /*#__PURE__*/React.createElement(Modal, {\n    style: {\n      color: \"#050505\"\n    },\n    show: showTextEditor,\n    onHide: handleClose,\n    backdrop: \"static\",\n    size: \"xl\",\n    centered: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 4\n    }\n  }, /*#__PURE__*/React.createElement(Modal.Body, {\n    style: {\n      height: '60vh'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 6\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      display: 'flex',\n      flexDirection: 'row',\n      height: '100%'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      flex: 2,\n      borderRight: '1px solid #ccc',\n      paddingRight: '20px',\n      overflowY: 'auto'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"h4\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 6\n    }\n  }, \"Highlights\"), state.highlightTextsForEditor && state.highlightTextsForEditor.length > 0 ? state.highlightTextsForEditor.map((highlight, index) => /*#__PURE__*/React.createElement(\"div\", {\n    key: index,\n    style: {\n      padding: '10px',\n      margin: '5px 0'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 9\n    }\n  }, highlight.commentText), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 9\n    }\n  }, highlight.contentText))) : /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 8\n    }\n  }, \"No highlights to show\")), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      flex: 7,\n      marginRight: '20px'\n    },\n    ref: wrapperRef,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      flex: 3,\n      borderLeft: '1px solid #ccc',\n      paddingLeft: '20px',\n      overflowY: 'auto'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"h4\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 6\n    }\n  }, \"Recommendations\"), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      display: 'flex',\n      flexDirection: 'column-reverse'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 6\n    }\n  }, openaiResponses.map((response, index) => /*#__PURE__*/React.createElement(\"div\", {\n    key: index,\n    style: {\n      border: '1px solid #ccc',\n      padding: '10px',\n      margin: '5px 0',\n      display: 'flex',\n      justifyContent: 'space-between',\n      alignItems: 'center'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 9\n    }\n  }, response), /*#__PURE__*/React.createElement(Button, {\n    variant: \"outline-primary\",\n    onClick: () => handleCopyToClipboard(response),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 9\n    }\n  }, \"Insert\"))))))), /*#__PURE__*/React.createElement(Modal.Footer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 6\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    variant: \"secondary\",\n    onClick: handleClose,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 5\n    }\n  }, \"Close\"), /*#__PURE__*/React.createElement(Button, {\n    variant: \"primary\",\n    onClick: handleNoteSave,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 5\n    }\n  }, \"Save\"))));\n}","map":{"version":3,"sources":["/home/taymur/Documents/legal2/DATA/Highlight/newmerged/CASEFRONTt/src/TextEditor.js"],"names":["React","useContext","useCallback","useEffect","useState","Quill","io","Button","Modal","FaRegPaperPlane","FaBriefcase","FaFile","UserContext","SAVE_INTERVAL_MS","TOOLBAR_OPTIONS","header","font","list","color","background","script","align","TextEditor","id","fileName","showTextEditor","setShowTextEditor","socket","setSocket","quill","setQuill","openaiResponses","setOpenaiResponses","state","editorMode","setEditorMode","s","disconnect","interval","setInterval","emit","getContents","clearInterval","wrapperRef","wrapper","innerHTML","editor","document","createElement","append","q","theme","modules","toolbar","enable","handler","data","currentResponses","message","length","getLength","insertText","on","off","handleEditDocument","handleNewDocument","handleCopyToClipboard","text","navigator","clipboard","writeText","then","console","log","err","error","range","getSelection","position","index","setSelection","handleNoteSave","handleClose","handleAppeal","connected","documentId","textAlign","margin","height","display","flexDirection","flex","borderRight","paddingRight","overflowY","highlightTextsForEditor","map","highlight","padding","commentText","contentText","marginRight","borderLeft","paddingLeft","response","border","justifyContent","alignItems"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,UAAhB,EAA4BC,WAA5B,EAAyCC,SAAzC,EAAoDC,QAApD,QAAoE,OAApE;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAO,2BAAP;AACA,SAASC,EAAT,QAAmB,kBAAnB;AACA,SAASC,MAAT,EAAiBC,KAAjB,QAA8B,iBAA9B;AACA,SAASC,eAAT,EAA0BC,WAA1B,EAAuCC,MAAvC,QAAqD,gBAArD;AACA,SAASC,WAAT,QAA4B,OAA5B;AAEA,MAAMC,gBAAgB,GAAG,KAAzB;AACA,MAAMC,eAAe,GAAG,CACtB,CAAC;AAAEC,EAAAA,MAAM,EAAE,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,EAAa,CAAb,EAAgB,CAAhB,EAAmB,KAAnB;AAAV,CAAD,CADsB,EAEtB,CAAC;AAAEC,EAAAA,IAAI,EAAE;AAAR,CAAD,CAFsB,EAGtB,CAAC;AAAEC,EAAAA,IAAI,EAAE;AAAR,CAAD,EAAsB;AAAEA,EAAAA,IAAI,EAAE;AAAR,CAAtB,CAHsB,EAItB,CAAC,MAAD,EAAS,QAAT,EAAmB,WAAnB,CAJsB,EAKtB,CAAC;AAAEC,EAAAA,KAAK,EAAE;AAAT,CAAD,EAAgB;AAAEC,EAAAA,UAAU,EAAE;AAAd,CAAhB,CALsB,EAMtB,CAAC;AAAEC,EAAAA,MAAM,EAAE;AAAV,CAAD,EAAoB;AAAEA,EAAAA,MAAM,EAAE;AAAV,CAApB,CANsB,EAOtB,CAAC;AAAEC,EAAAA,KAAK,EAAE;AAAT,CAAD,CAPsB,EAQtB,CAAC,YAAD,EAAe,YAAf,CARsB,EAStB,CAAC,OAAD,CATsB,CAAxB;AAYA,eAAe,SAASC,UAAT,CAAoB;AAAEC,EAAAA,EAAF;AAAMC,EAAAA,QAAN;AAAgBC,EAAAA,cAAhB;AAAgCC,EAAAA;AAAhC,CAApB,EAAyE;AACtF,QAAM,CAACC,MAAD,EAASC,SAAT,IAAsBxB,QAAQ,EAApC;AACA,QAAM,CAACyB,KAAD,EAAQC,QAAR,IAAoB1B,QAAQ,EAAlC;AACA,QAAM,CAAC2B,eAAD,EAAkBC,kBAAlB,IAAwC5B,QAAQ,CAAC,EAAD,CAAtD;AACA,QAAM;AAAE6B,IAAAA;AAAF,MAAYhC,UAAU,CAACW,WAAD,CAA5B,CAJsF,CAI3C;;AAC3C,QAAM,CAACsB,UAAD,EAAaC,aAAb,IAA8B/B,QAAQ,CAAC,IAAD,CAA5C;AAEAD,EAAAA,SAAS,CAAC,MAAM;AACd,UAAMiC,CAAC,GAAG9B,EAAE,CAAC,uBAAD,CAAZ;AACAsB,IAAAA,SAAS,CAACQ,CAAD,CAAT;AAEA,WAAO,MAAM;AACXA,MAAAA,CAAC,CAACC,UAAF;AACD,KAFD;AAGD,GAPQ,EAON,EAPM,CAAT;AASAlC,EAAAA,SAAS,CAAC,MAAM;AACd,QAAI,CAACwB,MAAD,IAAW,CAACE,KAAhB,EAAuB;AAEvB,UAAMS,QAAQ,GAAGJ,UAAU,KAAK,eAAf,GAAiCK,WAAW,CAAC,MAAM;AAClEZ,MAAAA,MAAM,CAACa,IAAP,CAAY,eAAZ,EAA6BX,KAAK,CAACY,WAAN,EAA7B;AACD,KAF4D,EAE1D5B,gBAF0D,CAA5C,GAEM,IAFvB;AAIA,WAAO,MAAM;AACX,UAAIyB,QAAJ,EAAcI,aAAa,CAACJ,QAAD,CAAb;AACf,KAFD;AAGD,GAVQ,EAUN,CAACX,MAAD,EAASE,KAAT,EAAgBK,UAAhB,EAA4BX,EAA5B,EAAgCC,QAAhC,CAVM,CAAT;AAYA,QAAMmB,UAAU,GAAGzC,WAAW,CAAC0C,OAAO,IAAI;AACxC,QAAIA,OAAO,IAAI,IAAf,EAAqB;AACrBA,IAAAA,OAAO,CAACC,SAAR,GAAoB,EAApB;AACA,UAAMC,MAAM,GAAGC,QAAQ,CAACC,aAAT,CAAuB,KAAvB,CAAf;AACAJ,IAAAA,OAAO,CAACK,MAAR,CAAeH,MAAf;AACA,UAAMI,CAAC,GAAG,IAAI7C,KAAJ,CAAUyC,MAAV,EAAkB;AAC1BK,MAAAA,KAAK,EAAE,MADmB;AAE1BC,MAAAA,OAAO,EAAE;AAAEC,QAAAA,OAAO,EAAEvC;AAAX;AAFiB,KAAlB,CAAV;AAIAoC,IAAAA,CAAC,CAACI,MAAF;AACAxB,IAAAA,QAAQ,CAACoB,CAAD,CAAR;AACD,GAX6B,EAW3B,EAX2B,CAA9B;AAaA/C,EAAAA,SAAS,CAAC,MAAM;AACd,QAAIwB,MAAM,IAAI,IAAV,IAAkBE,KAAK,IAAI,IAA3B,IAAmCK,UAAU,KAAK,QAAtD,EAAgE;;AAEhE,UAAMqB,OAAO,GAAGC,IAAI,IAAI;AACtBxB,MAAAA,kBAAkB,CAACyB,gBAAgB,IAAI,CAAC,GAAGA,gBAAJ,EAAsBD,IAAI,CAACE,OAA3B,CAArB,CAAlB;;AACA,UAAIxB,UAAU,KAAK,QAAf,IAA2BsB,IAAI,CAACE,OAApC,EAA6C;AAC3C,cAAMC,MAAM,GAAG9B,KAAK,CAAC+B,SAAN,EAAf;AACA/B,QAAAA,KAAK,CAACgC,UAAN,CAAiBF,MAAjB,EAAyB,OAAOH,IAAI,CAACE,OAArC;AACD;AACF,KAND;;AAQA/B,IAAAA,MAAM,CAACmC,EAAP,CAAU,iBAAV,EAA6BP,OAA7B;AAEA,WAAO,MAAM;AACX5B,MAAAA,MAAM,CAACoC,GAAP,CAAW,iBAAX,EAA8BR,OAA9B;AACD,KAFD;AAGD,GAhBQ,EAgBN,CAAC5B,MAAD,EAASE,KAAT,EAAgBK,UAAhB,CAhBM,CAAT,CAzCsF,CA2DtF;;AACA,QAAM8B,kBAAkB,GAAG,MAAM;AAC/B7B,IAAAA,aAAa,CAAC,eAAD,CAAb,CAD+B,CAE/B;AACD,GAHD;;AAKA,QAAM8B,iBAAiB,GAAG,MAAM;AAC9B9B,IAAAA,aAAa,CAAC,cAAD,CAAb,CAD8B,CAE9B;AACD,GAHD;;AAKA,QAAM+B,qBAAqB,GAAGC,IAAI,IAAI;AACpCC,IAAAA,SAAS,CAACC,SAAV,CAAoBC,SAApB,CAA8BH,IAA9B,EAAoCI,IAApC,CAAyC,MAAM;AAC7CC,MAAAA,OAAO,CAACC,GAAR,CAAY,0BAAZ;AACD,KAFD,EAEGC,GAAG,IAAI;AACRF,MAAAA,OAAO,CAACG,KAAR,CAAc,uBAAd,EAAuCD,GAAvC;AACD,KAJD,EADoC,CAMpC;;AACA,UAAME,KAAK,GAAG/C,KAAK,CAACgD,YAAN,EAAd;AACA,UAAMC,QAAQ,GAAGF,KAAK,GAAGA,KAAK,CAACG,KAAT,GAAiBlD,KAAK,CAAC+B,SAAN,EAAvC;AACA/B,IAAAA,KAAK,CAACgC,UAAN,CAAiBiB,QAAjB,EAA2BX,IAA3B;AACAtC,IAAAA,KAAK,CAACmD,YAAN,CAAmBF,QAAQ,GAAGX,IAAI,CAACR,MAAnC;AACD,GAXD;;AAaA,QAAMsB,cAAc,GAAG,MAAM;AAC3B,QAAItD,MAAM,IAAI,IAAV,IAAkBE,KAAK,IAAI,IAA/B,EAAqC;AACrCF,IAAAA,MAAM,CAACa,IAAP,CAAY,eAAZ,EAA6BX,KAAK,CAACY,WAAN,EAA7B;AACAyC,IAAAA,WAAW;AACZ,GAJD;;AAMA,QAAMC,YAAY,GAAG,MAAM;AACzBX,IAAAA,OAAO,CAACC,GAAR,CAAY,uCAAZ,EAAsD,qBAAoB9C,MAArB,aAAqBA,MAArB,uBAAqBA,MAAM,CAAEyD,SAAU,EAA5F;AACAjD,IAAAA,aAAa,CAAC,QAAD,CAAb;AACAR,IAAAA,MAAM,SAAN,IAAAA,MAAM,WAAN,YAAAA,MAAM,CAAEa,IAAR,CAAa,aAAb,EAA4B;AAAE6C,MAAAA,UAAU,EAAE9D,EAAd;AAAkBC,MAAAA;AAAlB,KAA5B;AACD,GAJD;;AAKD,sBACC,oBAAC,KAAD,CAAO,QAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACG,CAACU,UAAD,gBACF,oBAAC,KAAD;AAAO,IAAA,IAAI,EAAET,cAAb;AAA6B,IAAA,MAAM,EAAEyD,WAArC;AAAkD,IAAA,QAAQ,EAAC,QAA3D;AAAoE,IAAA,QAAQ,MAA5E;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,KAAD,CAAO,MAAP;AAAc,IAAA,WAAW,MAAzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACD,oBAAC,KAAD,CAAO,KAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBADC,CADF,eAIE,oBAAC,KAAD,CAAO,IAAP;AAAY,IAAA,KAAK,EAAE;AAAEI,MAAAA,SAAS,EAAE;AAAb,KAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACD,oBAAC,MAAD;AAAQ,IAAA,OAAO,EAAC,iBAAhB;AAAkC,IAAA,OAAO,EAAEH,YAA3C;AAAyD,IAAA,KAAK,EAAE;AAAEI,MAAAA,MAAM,EAAE;AAAV,KAAhE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,eAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,YADC,eAID,oBAAC,MAAD;AAAQ,IAAA,OAAO,EAAC,iBAAhB;AAAkC,IAAA,OAAO,EAAEvB,kBAA3C;AAA+D,IAAA,KAAK,EAAE;AAAEuB,MAAAA,MAAM,EAAE;AAAV,KAAtE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,WAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,mBAJC,eAOD,oBAAC,MAAD;AAAQ,IAAA,OAAO,EAAC,cAAhB;AAA+B,IAAA,OAAO,EAAEtB,iBAAxC;AAA2D,IAAA,KAAK,EAAE;AAAEsB,MAAAA,MAAM,EAAE;AAAV,KAAlE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,kBAPC,CAJF,CADE,gBAkBF,oBAAC,KAAD;AACE,IAAA,KAAK,EAAE;AAAErE,MAAAA,KAAK,EAAE;AAAT,KADT;AAEE,IAAA,IAAI,EAAEO,cAFR;AAGE,IAAA,MAAM,EAAEyD,WAHV;AAIE,IAAA,QAAQ,EAAC,QAJX;AAKE,IAAA,IAAI,EAAC,IALP;AAME,IAAA,QAAQ,MANV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAQE,oBAAC,KAAD,CAAO,IAAP;AAAY,IAAA,KAAK,EAAE;AAAEM,MAAAA,MAAM,EAAE;AAAV,KAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACD;AAAK,IAAA,KAAK,EAAE;AAAEC,MAAAA,OAAO,EAAE,MAAX;AAAmBC,MAAAA,aAAa,EAAE,KAAlC;AAAyCF,MAAAA,MAAM,EAAE;AAAjD,KAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAK,IAAA,KAAK,EAAE;AAAEG,MAAAA,IAAI,EAAE,CAAR;AAAWC,MAAAA,WAAW,EAAE,gBAAxB;AAA0CC,MAAAA,YAAY,EAAE,MAAxD;AAAgEC,MAAAA,SAAS,EAAE;AAA3E,KAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADC,EAEA7D,KAAK,CAAC8D,uBAAN,IAAiC9D,KAAK,CAAC8D,uBAAN,CAA8BpC,MAA9B,GAAuC,CAAxE,GACC1B,KAAK,CAAC8D,uBAAN,CAA8BC,GAA9B,CAAkC,CAACC,SAAD,EAAYlB,KAAZ,kBACnC;AAAK,IAAA,GAAG,EAAEA,KAAV;AAAiB,IAAA,KAAK,EAAE;AAAEmB,MAAAA,OAAO,EAAE,MAAX;AAAmBX,MAAAA,MAAM,EAAE;AAA3B,KAAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAASU,SAAS,CAACE,WAAnB,CADF,eAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAIF,SAAS,CAACG,WAAd,CAFF,CADC,CADD,gBAQC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,6BAVD,CADF,eAcE;AAAK,IAAA,KAAK,EAAE;AAAET,MAAAA,IAAI,EAAE,CAAR;AAAWU,MAAAA,WAAW,EAAE;AAAxB,KAAZ;AAA8C,IAAA,GAAG,EAAE1D,UAAnD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAdF,eAeE;AAAK,IAAA,KAAK,EAAE;AAAEgD,MAAAA,IAAI,EAAE,CAAR;AAAWW,MAAAA,UAAU,EAAE,gBAAvB;AAAyCC,MAAAA,WAAW,EAAE,MAAtD;AAA8DT,MAAAA,SAAS,EAAE;AAAzE,KAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBADC,eAED;AAAK,IAAA,KAAK,EAAE;AAAEL,MAAAA,OAAO,EAAE,MAAX;AAAmBC,MAAAA,aAAa,EAAE;AAAlC,KAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACG3D,eAAe,CAACiE,GAAhB,CAAoB,CAACQ,QAAD,EAAWzB,KAAX,kBACtB;AAAK,IAAA,GAAG,EAAEA,KAAV;AAAiB,IAAA,KAAK,EAAE;AAAE0B,MAAAA,MAAM,EAAE,gBAAV;AAA4BP,MAAAA,OAAO,EAAE,MAArC;AAA6CX,MAAAA,MAAM,EAAE,OAArD;AAA8DE,MAAAA,OAAO,EAAE,MAAvE;AAA+EiB,MAAAA,cAAc,EAAE,eAA/F;AAAgHC,MAAAA,UAAU,EAAE;AAA5H,KAAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAOH,QAAP,CADF,eAEE,oBAAC,MAAD;AAAQ,IAAA,OAAO,EAAC,iBAAhB;AAAkC,IAAA,OAAO,EAAE,MAAMtC,qBAAqB,CAACsC,QAAD,CAAtE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAFF,CADE,CADH,CAFC,CAfF,CADC,CARF,eAqCE,oBAAC,KAAD,CAAO,MAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACD,oBAAC,MAAD;AAAQ,IAAA,OAAO,EAAC,WAAhB;AAA4B,IAAA,OAAO,EAAEtB,WAArC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aADC,eAED,oBAAC,MAAD;AAAQ,IAAA,OAAO,EAAC,SAAhB;AAA0B,IAAA,OAAO,EAAED,cAAnC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAFC,CArCF,CAnBD,CADD;AAiEO","sourcesContent":["import React, { useContext, useCallback, useEffect, useState } from \"react\";\nimport Quill from \"quill\";\nimport \"quill/dist/quill.snow.css\";\nimport { io } from \"socket.io-client\";\nimport { Button, Modal } from \"react-bootstrap\";\nimport { FaRegPaperPlane, FaBriefcase, FaFile } from 'react-icons/fa';\nimport { UserContext } from \"./App\";\n\nconst SAVE_INTERVAL_MS = 15000;\nconst TOOLBAR_OPTIONS = [\n  [{ header: [1, 2, 3, 4, 5, 6, false] }],\n  [{ font: [] }],\n  [{ list: \"ordered\" }, { list: \"bullet\" }],\n  [\"bold\", \"italic\", \"underline\"],\n  [{ color: [] }, { background: [] }],\n  [{ script: \"sub\" }, { script: \"super\" }],\n  [{ align: [] }],\n  [\"blockquote\", \"code-block\"],\n  [\"clean\"],\n];\n\nexport default function TextEditor({ id, fileName, showTextEditor, setShowTextEditor }) {\n  const [socket, setSocket] = useState();\n  const [quill, setQuill] = useState();\n  const [openaiResponses, setOpenaiResponses] = useState([]);\n  const { state } = useContext(UserContext); // Assuming `state` is used elsewhere in your component\n  const [editorMode, setEditorMode] = useState(null);\n\n  useEffect(() => {\n    const s = io(\"http://localhost:8000\");\n    setSocket(s);\n\n    return () => {\n      s.disconnect();\n    };\n  }, []);\n\n  useEffect(() => {\n    if (!socket || !quill) return;\n\n    const interval = editorMode === 'edit_document' ? setInterval(() => {\n      socket.emit(\"save-document\", quill.getContents());\n    }, SAVE_INTERVAL_MS) : null;\n\n    return () => {\n      if (interval) clearInterval(interval);\n    };\n  }, [socket, quill, editorMode, id, fileName]);\n\n  const wrapperRef = useCallback(wrapper => {\n    if (wrapper == null) return;\n    wrapper.innerHTML = \"\";\n    const editor = document.createElement(\"div\");\n    wrapper.append(editor);\n    const q = new Quill(editor, {\n      theme: \"snow\",\n      modules: { toolbar: TOOLBAR_OPTIONS },\n    });\n    q.enable();\n    setQuill(q);\n  }, []);\n\n  useEffect(() => {\n    if (socket == null || quill == null || editorMode !== 'appeal') return;\n  \n    const handler = data => {\n      setOpenaiResponses(currentResponses => [...currentResponses, data.message]);\n      if (editorMode === 'appeal' && data.message) {\n        const length = quill.getLength();\n        quill.insertText(length, \"\\n\" + data.message);\n      }\n    };\n  \n    socket.on(\"openai_response\", handler);\n  \n    return () => {\n      socket.off(\"openai_response\", handler);\n    };\n  }, [socket, quill, editorMode]);\n\n  // Function definitions that were missing\n  const handleEditDocument = () => {\n    setEditorMode('edit_document');\n    // Possibly more logic here as needed\n  };\n\n  const handleNewDocument = () => {\n    setEditorMode('new_document');\n    // Possibly more logic here as needed\n  };\n\n  const handleCopyToClipboard = text => {\n    navigator.clipboard.writeText(text).then(() => {\n      console.log('Text copied to clipboard');\n    }, err => {\n      console.error('Could not copy text: ', err);\n    });\n    // Insert text into Quill editor\n    const range = quill.getSelection();\n    const position = range ? range.index : quill.getLength();\n    quill.insertText(position, text);\n    quill.setSelection(position + text.length);\n  };\n\n  const handleNoteSave = () => {\n    if (socket == null || quill == null) return;\n    socket.emit(\"save-document\", quill.getContents());\n    handleClose();\n  };\n\n  const handleAppeal = () => {\n    console.log('Appeal clicked. Emitting openai-call.', `Socket connected: ${socket?.connected}`);\n    setEditorMode('appeal');\n    socket?.emit(\"openai-call\", { documentId: id, fileName });\n  };\n\treturn (\n\t\t<React.Fragment>\n\t\t  {!editorMode ? (\n\t\t\t<Modal show={showTextEditor} onHide={handleClose} backdrop=\"static\" centered>\n\t\t\t  <Modal.Header closeButton>\n\t\t\t\t<Modal.Title>Choose an Option</Modal.Title>\n\t\t\t  </Modal.Header>\n\t\t\t  <Modal.Body style={{ textAlign: 'center' }}>\n\t\t\t\t<Button variant=\"outline-primary\" onClick={handleAppeal} style={{ margin: '10px' }}>\n\t\t\t\t  <FaRegPaperPlane /> Appeal\n\t\t\t\t</Button>\n\t\t\t\t<Button variant=\"outline-success\" onClick={handleEditDocument} style={{ margin: '10px' }}>\n\t\t\t\t  <FaBriefcase /> Edit Document\n\t\t\t\t</Button>\n\t\t\t\t<Button variant=\"outline-info\" onClick={handleNewDocument} style={{ margin: '10px' }}>\n\t\t\t\t  <FaFile /> New Document\n\t\t\t\t</Button>\n\t\t\t  </Modal.Body>\n\t\t\t</Modal>\n\t\t  ) : (\n\t\t\t<Modal\n\t\t\t  style={{ color: \"#050505\" }}\n\t\t\t  show={showTextEditor}\n\t\t\t  onHide={handleClose}\n\t\t\t  backdrop=\"static\"\n\t\t\t  size=\"xl\"\n\t\t\t  centered\n\t\t\t>\n\t\t\t  <Modal.Body style={{ height: '60vh' }}>\n\t\t\t\t<div style={{ display: 'flex', flexDirection: 'row', height: '100%' }}>\n\t\t\t\t  <div style={{ flex: 2, borderRight: '1px solid #ccc', paddingRight: '20px', overflowY: 'auto' }}>\n\t\t\t\t\t<h4>Highlights</h4>\n\t\t\t\t\t{state.highlightTextsForEditor && state.highlightTextsForEditor.length > 0 ? (\n\t\t\t\t\t  state.highlightTextsForEditor.map((highlight, index) => (\n\t\t\t\t\t\t<div key={index} style={{ padding: '10px', margin: '5px 0' }}>\n\t\t\t\t\t\t  <strong>{highlight.commentText}</strong>\n\t\t\t\t\t\t  <p>{highlight.contentText}</p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t  ))\n\t\t\t\t\t) : (\n\t\t\t\t\t  <div>No highlights to show</div>\n\t\t\t\t\t)}\n\t\t\t\t  </div>\n\t\t\t\t  <div style={{ flex: 7, marginRight: '20px' }} ref={wrapperRef}></div>\n\t\t\t\t  <div style={{ flex: 3, borderLeft: '1px solid #ccc', paddingLeft: '20px', overflowY: 'auto' }}>\n\t\t\t\t\t<h4>Recommendations</h4>\n\t\t\t\t\t<div style={{ display: 'flex', flexDirection: 'column-reverse' }}>\n\t\t\t\t\t  {openaiResponses.map((response, index) => (\n\t\t\t\t\t\t<div key={index} style={{ border: '1px solid #ccc', padding: '10px', margin: '5px 0', display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\n\t\t\t\t\t\t  <span>{response}</span>\n\t\t\t\t\t\t  <Button variant=\"outline-primary\" onClick={() => handleCopyToClipboard(response)}>Insert</Button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t  ))}\n\t\t\t\t\t</div>\n\t\t\t\t  </div>\n\t\t\t\t</div>\n\t\t\t  </Modal.Body>\n\t\t\t  <Modal.Footer>\n\t\t\t\t<Button variant=\"secondary\" onClick={handleClose}>Close</Button>\n\t\t\t\t<Button variant=\"primary\" onClick={handleNoteSave}>Save</Button>\n\t\t\t  </Modal.Footer>\n\t\t\t</Modal>\n\t\t  )}\n\t\t</React.Fragment>\n\t  );\n\t\t\t\t\t  }"]},"metadata":{},"sourceType":"module"}